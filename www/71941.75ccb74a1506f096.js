/*! For license information please see 71941.75ccb74a1506f096.js.LICENSE.txt */
(self.webpackChunkapp=self.webpackChunkapp||[]).push([[71941],{71941:(i,l,d)=>{"use strict";d.r(l),d.d(l,{initializeVideoJSOgvJS:()=>initializeVideoJSOgvJS,videojs:()=>videojs});var u=d(18022),c=d(31400),h=d(12843),p=d.n(h),m=d(90410),g=d.n(m),y=d(17621),_=d.n(y),v=d(80509),b=d.n(v);function _extends(){return _extends=Object.assign?Object.assign.bind():function(i){for(var l=1;l<arguments.length;l++){var d=arguments[l];for(var u in d)({}).hasOwnProperty.call(d,u)&&(i[u]=d[u])}return i},_extends.apply(null,arguments)}var T="https://example.com";const S=function resolveUrl(i,l){if(/^[a-z]+:/i.test(l))return l;/^data:/.test(i)&&(i=p().location&&p().location.href||"");var d=/^\/\//.test(i),u=!p().location&&!/\/\//i.test(i);i=new(p().URL)(i,p().location||T);var c=new URL(l,i);return u?c.href.slice(19):d?c.href.slice(c.protocol.length):c.href};var E=function(){function Stream(){this.listeners={}}var i=Stream.prototype;return i.on=function on(i,l){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(l)},i.off=function off(i,l){if(!this.listeners[i])return!1;var d=this.listeners[i].indexOf(l);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(d,1),d>-1},i.trigger=function trigger(i){var l=this.listeners[i];if(l)if(2===arguments.length)for(var d=l.length,u=0;u<d;++u)l[u].call(this,arguments[1]);else for(var c=Array.prototype.slice.call(arguments,1),h=l.length,p=0;p<h;++p)l[p].apply(this,c)},i.dispose=function dispose(){this.listeners={}},i.pipe=function pipe(i){this.on("data",(function(l){i.push(l)}))},Stream}();function decodeB64ToUint8Array(i){for(var l=function atob(i){return p().atob?p().atob(i):Buffer.from(i,"base64").toString("binary")}(i),d=new Uint8Array(l.length),u=0;u<l.length;u++)d[u]=l.charCodeAt(u);return d}class LineStream extends E{constructor(){super(),this.buffer=""}push(i){let l;for(this.buffer+=i,l=this.buffer.indexOf("\n");l>-1;l=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,l)),this.buffer=this.buffer.substring(l+1)}}const k=String.fromCharCode(9),parseByterange=function(i){const l=/([0-9.]*)?@?([0-9.]*)?/.exec(i||""),d={};return l[1]&&(d.length=parseInt(l[1],10)),l[2]&&(d.offset=parseInt(l[2],10)),d},parseAttributes=function(i){const l={};if(!i)return l;const d=i.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'));let u,c=d.length;for(;c--;)""!==d[c]&&(u=/([^=]*)=(.*)/.exec(d[c]).slice(1),u[0]=u[0].replace(/^\s+|\s+$/g,""),u[1]=u[1].replace(/^\s+|\s+$/g,""),u[1]=u[1].replace(/^['"](.*)['"]$/g,"$1"),l[u[0]]=u[1]);return l},parseResolution=i=>{const l=i.split("x"),d={};return l[0]&&(d.width=parseInt(l[0],10)),l[1]&&(d.height=parseInt(l[1],10)),d};class ParseStream extends E{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(i){let l,d;if(0===(i=i.trim()).length)return;if("#"!==i[0])return this.trigger("data",{type:"uri",uri:i}),void 0;this.tagMappers.reduce(((l,d)=>{const u=d(i);return u===i?l:l.concat([u])}),[i]).forEach((i=>{for(let l=0;l<this.customParsers.length;l++)if(this.customParsers[l].call(this,i))return;if(0!==i.indexOf("#EXT"))return this.trigger("data",{type:"comment",text:i.slice(1)}),void 0;if(i=i.replace("\r",""),l=/^#EXTM3U/.exec(i),l)return this.trigger("data",{type:"tag",tagType:"m3u"}),void 0;if(l=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(i),l)return d={type:"tag",tagType:"inf"},l[1]&&(d.duration=parseFloat(l[1])),l[2]&&(d.title=l[2]),this.trigger("data",d),void 0;if(l=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(i),l)return d={type:"tag",tagType:"targetduration"},l[1]&&(d.duration=parseInt(l[1],10)),this.trigger("data",d),void 0;if(l=/^#EXT-X-VERSION:([0-9.]*)?/.exec(i),l)return d={type:"tag",tagType:"version"},l[1]&&(d.version=parseInt(l[1],10)),this.trigger("data",d),void 0;if(l=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(i),l)return d={type:"tag",tagType:"media-sequence"},l[1]&&(d.number=parseInt(l[1],10)),this.trigger("data",d),void 0;if(l=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(i),l)return d={type:"tag",tagType:"discontinuity-sequence"},l[1]&&(d.number=parseInt(l[1],10)),this.trigger("data",d),void 0;if(l=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(i),l)return d={type:"tag",tagType:"playlist-type"},l[1]&&(d.playlistType=l[1]),this.trigger("data",d),void 0;if(l=/^#EXT-X-BYTERANGE:(.*)?$/.exec(i),l)return d=_extends(parseByterange(l[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",d),void 0;if(l=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(i),l)return d={type:"tag",tagType:"allow-cache"},l[1]&&(d.allowed=!/NO/.test(l[1])),this.trigger("data",d),void 0;if(l=/^#EXT-X-MAP:(.*)$/.exec(i),l){if(d={type:"tag",tagType:"map"},l[1]){const i=parseAttributes(l[1]);i.URI&&(d.uri=i.URI),i.BYTERANGE&&(d.byterange=parseByterange(i.BYTERANGE))}return this.trigger("data",d),void 0}if(l=/^#EXT-X-STREAM-INF:(.*)$/.exec(i),l)return d={type:"tag",tagType:"stream-inf"},l[1]&&(d.attributes=parseAttributes(l[1]),d.attributes.RESOLUTION&&(d.attributes.RESOLUTION=parseResolution(d.attributes.RESOLUTION)),d.attributes.BANDWIDTH&&(d.attributes.BANDWIDTH=parseInt(d.attributes.BANDWIDTH,10)),d.attributes["FRAME-RATE"]&&(d.attributes["FRAME-RATE"]=parseFloat(d.attributes["FRAME-RATE"])),d.attributes["PROGRAM-ID"]&&(d.attributes["PROGRAM-ID"]=parseInt(d.attributes["PROGRAM-ID"],10))),this.trigger("data",d),void 0;if(l=/^#EXT-X-MEDIA:(.*)$/.exec(i),l)return d={type:"tag",tagType:"media"},l[1]&&(d.attributes=parseAttributes(l[1])),this.trigger("data",d),void 0;if(l=/^#EXT-X-ENDLIST/.exec(i),l)return this.trigger("data",{type:"tag",tagType:"endlist"}),void 0;if(l=/^#EXT-X-DISCONTINUITY/.exec(i),l)return this.trigger("data",{type:"tag",tagType:"discontinuity"}),void 0;if(l=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(i),l)return d={type:"tag",tagType:"program-date-time"},l[1]&&(d.dateTimeString=l[1],d.dateTimeObject=new Date(l[1])),this.trigger("data",d),void 0;if(l=/^#EXT-X-KEY:(.*)$/.exec(i),l)return d={type:"tag",tagType:"key"},l[1]&&(d.attributes=parseAttributes(l[1]),d.attributes.IV&&("0x"===d.attributes.IV.substring(0,2).toLowerCase()&&(d.attributes.IV=d.attributes.IV.substring(2)),d.attributes.IV=d.attributes.IV.match(/.{8}/g),d.attributes.IV[0]=parseInt(d.attributes.IV[0],16),d.attributes.IV[1]=parseInt(d.attributes.IV[1],16),d.attributes.IV[2]=parseInt(d.attributes.IV[2],16),d.attributes.IV[3]=parseInt(d.attributes.IV[3],16),d.attributes.IV=new Uint32Array(d.attributes.IV))),this.trigger("data",d),void 0;if(l=/^#EXT-X-START:(.*)$/.exec(i),l)return d={type:"tag",tagType:"start"},l[1]&&(d.attributes=parseAttributes(l[1]),d.attributes["TIME-OFFSET"]=parseFloat(d.attributes["TIME-OFFSET"]),d.attributes.PRECISE=/YES/.test(d.attributes.PRECISE)),this.trigger("data",d),void 0;if(l=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(i),l)return d={type:"tag",tagType:"cue-out-cont"},d.data=l[1]?l[1]:"",this.trigger("data",d),void 0;if(l=/^#EXT-X-CUE-OUT:(.*)?$/.exec(i),l)return d={type:"tag",tagType:"cue-out"},d.data=l[1]?l[1]:"",this.trigger("data",d),void 0;if(l=/^#EXT-X-CUE-IN:?(.*)?$/.exec(i),l)return d={type:"tag",tagType:"cue-in"},d.data=l[1]?l[1]:"",this.trigger("data",d),void 0;if(l=/^#EXT-X-SKIP:(.*)$/.exec(i),l&&l[1])return d={type:"tag",tagType:"skip"},d.attributes=parseAttributes(l[1]),d.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(d.attributes["SKIPPED-SEGMENTS"]=parseInt(d.attributes["SKIPPED-SEGMENTS"],10)),d.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(d.attributes["RECENTLY-REMOVED-DATERANGES"]=d.attributes["RECENTLY-REMOVED-DATERANGES"].split(k)),this.trigger("data",d),void 0;if(l=/^#EXT-X-PART:(.*)$/.exec(i),l&&l[1])return d={type:"tag",tagType:"part"},d.attributes=parseAttributes(l[1]),["DURATION"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=parseFloat(d.attributes[i]))})),["INDEPENDENT","GAP"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=/YES/.test(d.attributes[i]))})),d.attributes.hasOwnProperty("BYTERANGE")&&(d.attributes.byterange=parseByterange(d.attributes.BYTERANGE)),this.trigger("data",d),void 0;if(l=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(i),l&&l[1])return d={type:"tag",tagType:"server-control"},d.attributes=parseAttributes(l[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=parseFloat(d.attributes[i]))})),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=/YES/.test(d.attributes[i]))})),this.trigger("data",d),void 0;if(l=/^#EXT-X-PART-INF:(.*)$/.exec(i),l&&l[1])return d={type:"tag",tagType:"part-inf"},d.attributes=parseAttributes(l[1]),["PART-TARGET"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=parseFloat(d.attributes[i]))})),this.trigger("data",d),void 0;if(l=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(i),l&&l[1])return d={type:"tag",tagType:"preload-hint"},d.attributes=parseAttributes(l[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(i){if(d.attributes.hasOwnProperty(i)){d.attributes[i]=parseInt(d.attributes[i],10);const l="BYTERANGE-LENGTH"===i?"length":"offset";d.attributes.byterange=d.attributes.byterange||{},d.attributes.byterange[l]=d.attributes[i],delete d.attributes[i]}})),this.trigger("data",d),void 0;if(l=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(i),l&&l[1])return d={type:"tag",tagType:"rendition-report"},d.attributes=parseAttributes(l[1]),["LAST-MSN","LAST-PART"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=parseInt(d.attributes[i],10))})),this.trigger("data",d),void 0;if(l=/^#EXT-X-DATERANGE:(.*)$/.exec(i),l&&l[1]){d={type:"tag",tagType:"daterange"},d.attributes=parseAttributes(l[1]),["ID","CLASS"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=String(d.attributes[i]))})),["START-DATE","END-DATE"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=new Date(d.attributes[i]))})),["DURATION","PLANNED-DURATION"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=parseFloat(d.attributes[i]))})),["END-ON-NEXT"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=/YES/i.test(d.attributes[i]))})),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach((function(i){d.attributes.hasOwnProperty(i)&&(d.attributes[i]=d.attributes[i].toString(16))}));const i=/^X-([A-Z]+-)+[A-Z]+$/;for(const l in d.attributes){if(!i.test(l))continue;const u=/[0-9A-Fa-f]{6}/g.test(d.attributes[l]),c=/^\d+(\.\d+)?$/.test(d.attributes[l]);d.attributes[l]=u?d.attributes[l].toString(16):c?parseFloat(d.attributes[l]):String(d.attributes[l])}return this.trigger("data",d),void 0}return l=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(i),l?(this.trigger("data",{type:"tag",tagType:"independent-segments"}),void 0):(l=/^#EXT-X-I-FRAMES-ONLY/.exec(i),l?(this.trigger("data",{type:"tag",tagType:"i-frames-only"}),void 0):(l=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(i),l?(d={type:"tag",tagType:"content-steering"},d.attributes=parseAttributes(l[1]),this.trigger("data",d),void 0):(l=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(i),l?(d={type:"tag",tagType:"i-frame-playlist"},d.attributes=parseAttributes(l[1]),d.attributes.URI&&(d.uri=d.attributes.URI),d.attributes.BANDWIDTH&&(d.attributes.BANDWIDTH=parseInt(d.attributes.BANDWIDTH,10)),d.attributes.RESOLUTION&&(d.attributes.RESOLUTION=parseResolution(d.attributes.RESOLUTION)),d.attributes["AVERAGE-BANDWIDTH"]&&(d.attributes["AVERAGE-BANDWIDTH"]=parseInt(d.attributes["AVERAGE-BANDWIDTH"],10)),d.attributes["FRAME-RATE"]&&(d.attributes["FRAME-RATE"]=parseFloat(d.attributes["FRAME-RATE"])),this.trigger("data",d),void 0):(l=/^#EXT-X-DEFINE:(.*)$/.exec(i),l?(d={type:"tag",tagType:"define"},d.attributes=parseAttributes(l[1]),this.trigger("data",d),void 0):(this.trigger("data",{type:"tag",data:i.slice(4)}),void 0)))))}))}addParser({expression:i,customType:l,dataParser:d,segment:u}){"function"!=typeof d&&(d=i=>i),this.customParsers.push((c=>{if(i.exec(c))return this.trigger("data",{type:"custom",data:d(c),customType:l,segment:u}),!0}))}addTagMapper({expression:i,map:l}){this.tagMappers.push((d=>i.test(d)?l(d):d))}}const camelCaseKeys=function(i){const l={};return Object.keys(i).forEach((function(d){var u;l[(u=d,u.toLowerCase().replace(/-(\w)/g,(i=>i[1].toUpperCase())))]=i[d]})),l},setHoldBack=function(i){const{serverControl:l,targetDuration:d,partTargetDuration:u}=i;if(!l)return;const c="#EXT-X-SERVER-CONTROL",h="holdBack",p="partHoldBack",m=d&&3*d,g=u&&2*u;d&&!l.hasOwnProperty(h)&&(l[h]=m,this.trigger("info",{message:`${c} defaulting HOLD-BACK to targetDuration * 3 (${m}).`})),m&&l[h]<m&&(this.trigger("warn",{message:`${c} clamping HOLD-BACK (${l[h]}) to targetDuration * 3 (${m})`}),l[h]=m),u&&!l.hasOwnProperty(p)&&(l[p]=3*u,this.trigger("info",{message:`${c} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${l[p]}).`})),u&&l[p]<g&&(this.trigger("warn",{message:`${c} clamping PART-HOLD-BACK (${l[p]}) to partTargetDuration * 2 (${g}).`}),l[p]=g)};class Parser extends E{constructor(i={}){super(),this.lineStream=new LineStream,this.parseStream=new ParseStream,this.lineStream.pipe(this.parseStream),this.mainDefinitions=i.mainDefinitions||{},this.params=new URL(i.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const l=this,d=[];let u,c,h={},p=!1;const noop=function(){},m={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};let g=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let y=0,_=0;const v={};this.on("end",(()=>{h.uri||!h.parts&&!h.preloadHints||(!h.map&&u&&(h.map=u),!h.key&&c&&(h.key=c),h.timeline||"number"!=typeof g||(h.timeline=g),this.manifest.preloadSegment=h)})),this.parseStream.on("data",(function(i){let b,T;if(l.manifest.definitions)for(const d in l.manifest.definitions)if(i.uri&&(i.uri=i.uri.replace(`{$${d}}`,l.manifest.definitions[d])),i.attributes)for(const u in i.attributes)"string"==typeof i.attributes[u]&&(i.attributes[u]=i.attributes[u].replace(`{$${d}}`,l.manifest.definitions[d]));({tag(){({version(){i.version&&(this.manifest.version=i.version)},"allow-cache"(){this.manifest.allowCache=i.allowed,"allowed"in i||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const l={};"length"in i&&(h.byterange=l,l.length=i.length,"offset"in i||(i.offset=y)),"offset"in i&&(h.byterange=l,l.offset=i.offset),y=l.offset+l.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),i.title&&(h.title=i.title),i.duration>0&&(h.duration=i.duration),0===i.duration&&(h.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=d},key(){if(!i.attributes)return this.trigger("warn",{message:"ignoring key declaration without attribute list"}),void 0;if("NONE"===i.attributes.METHOD)return c=null,void 0;if(!i.attributes.URI)return this.trigger("warn",{message:"ignoring key declaration without URI"}),void 0;if("com.apple.streamingkeydelivery"===i.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:i.attributes},void 0;if("com.microsoft.playready"===i.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:i.attributes.URI},void 0;if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===i.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(i.attributes.METHOD)?(this.trigger("warn",{message:"invalid key method provided for Widevine"}),void 0):("SAMPLE-AES-CENC"===i.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==i.attributes.URI.substring(0,23)?(this.trigger("warn",{message:"invalid key URI provided for Widevine"}),void 0):i.attributes.KEYID&&"0x"===i.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:i.attributes.KEYFORMAT,keyId:i.attributes.KEYID.substring(2)},pssh:decodeB64ToUint8Array(i.attributes.URI.split(",")[1])},void 0):(this.trigger("warn",{message:"invalid key ID provided for Widevine"}),void 0))}i.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),c={method:i.attributes.METHOD||"AES-128",uri:i.attributes.URI},void 0!==i.attributes.IV&&(c.iv=i.attributes.IV)},"media-sequence"(){if(!isFinite(i.number))return this.trigger("warn",{message:"ignoring invalid media sequence: "+i.number}),void 0;this.manifest.mediaSequence=i.number},"discontinuity-sequence"(){if(!isFinite(i.number))return this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+i.number}),void 0;this.manifest.discontinuitySequence=i.number,g=i.number},"playlist-type"(){if(!/VOD|EVENT/.test(i.playlistType))return this.trigger("warn",{message:"ignoring unknown playlist type: "+i.playlist}),void 0;this.manifest.playlistType=i.playlistType},map(){u={},i.uri&&(u.uri=i.uri),i.byterange&&(u.byterange=i.byterange),c&&(u.key=c)},"stream-inf"(){if(this.manifest.playlists=d,this.manifest.mediaGroups=this.manifest.mediaGroups||m,!i.attributes)return this.trigger("warn",{message:"ignoring empty stream-inf attributes"}),void 0;h.attributes||(h.attributes={}),_extends(h.attributes,i.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||m,!(i.attributes&&i.attributes.TYPE&&i.attributes["GROUP-ID"]&&i.attributes.NAME))return this.trigger("warn",{message:"ignoring incomplete or missing media group"}),void 0;const l=this.manifest.mediaGroups[i.attributes.TYPE];l[i.attributes["GROUP-ID"]]=l[i.attributes["GROUP-ID"]]||{},b=l[i.attributes["GROUP-ID"]],T={default:/yes/i.test(i.attributes.DEFAULT)},T.autoselect=!!T.default||/yes/i.test(i.attributes.AUTOSELECT),i.attributes.LANGUAGE&&(T.language=i.attributes.LANGUAGE),i.attributes.URI&&(T.uri=i.attributes.URI),i.attributes["INSTREAM-ID"]&&(T.instreamId=i.attributes["INSTREAM-ID"]),i.attributes.CHARACTERISTICS&&(T.characteristics=i.attributes.CHARACTERISTICS),i.attributes.FORCED&&(T.forced=/yes/i.test(i.attributes.FORCED)),b[i.attributes.NAME]=T},discontinuity(){g+=1,h.discontinuity=!0,this.manifest.discontinuityStarts.push(d.length)},"program-date-time"(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=i.dateTimeString,this.manifest.dateTimeObject=i.dateTimeObject),h.dateTimeString=i.dateTimeString,h.dateTimeObject=i.dateTimeObject;const{lastProgramDateTime:l}=this;this.lastProgramDateTime=new Date(i.dateTimeString).getTime(),null===l&&this.manifest.segments.reduceRight(((i,l)=>(l.programDateTime=i-1e3*l.duration,l.programDateTime)),this.lastProgramDateTime)},targetduration(){if(!isFinite(i.duration)||i.duration<0)return this.trigger("warn",{message:"ignoring invalid target duration: "+i.duration}),void 0;this.manifest.targetDuration=i.duration,setHoldBack.call(this,this.manifest)},start(){if(!i.attributes||isNaN(i.attributes["TIME-OFFSET"]))return this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"}),void 0;this.manifest.start={timeOffset:i.attributes["TIME-OFFSET"],precise:i.attributes.PRECISE}},"cue-out"(){h.cueOut=i.data},"cue-out-cont"(){h.cueOutCont=i.data},"cue-in"(){h.cueIn=i.data},skip(){this.manifest.skip=camelCaseKeys(i.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",i.attributes,["SKIPPED-SEGMENTS"])},part(){p=!0;const l=this.manifest.segments.length,d=camelCaseKeys(i.attributes);h.parts=h.parts||[],h.parts.push(d),d.byterange&&(d.byterange.hasOwnProperty("offset")||(d.byterange.offset=_),_=d.byterange.offset+d.byterange.length);this.warnOnMissingAttributes_(`#EXT-X-PART #${h.parts.length-1} for segment #${l}`,i.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(((i,l)=>{i.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${l} lacks required attribute(s): LAST-PART`})}))},"server-control"(){const l=this.manifest.serverControl=camelCaseKeys(i.attributes);l.hasOwnProperty("canBlockReload")||(l.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),setHoldBack.call(this,this.manifest),l.canSkipDateranges&&!l.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const l=this.manifest.segments.length,d=camelCaseKeys(i.attributes),u=d.type&&"PART"===d.type;h.preloadHints=h.preloadHints||[],h.preloadHints.push(d),d.byterange&&(d.byterange.hasOwnProperty("offset")||(d.byterange.offset=u?_:0,u&&(_=d.byterange.offset+d.byterange.length)));const c=h.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${c} for segment #${l}`,i.attributes,["TYPE","URI"]),d.type)for(let i=0;i<h.preloadHints.length-1;i++){const u=h.preloadHints[i];u.type&&(u.type===d.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${c} for segment #${l} has the same TYPE ${d.type} as preload hint #${i}`}))}},"rendition-report"(){const l=camelCaseKeys(i.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(l);const d=this.manifest.renditionReports.length-1,u=["LAST-MSN","URI"];p&&u.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${d}`,i.attributes,u)},"part-inf"(){this.manifest.partInf=camelCaseKeys(i.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",i.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),setHoldBack.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(camelCaseKeys(i.attributes));const l=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${l}`,i.attributes,["ID","START-DATE"]);const d=this.manifest.dateRanges[l];d.endDate&&d.startDate&&new Date(d.endDate)<new Date(d.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),d.duration&&d.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),d.plannedDuration&&d.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const u=!!d.endOnNext;if(u&&!d.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),u&&(d.duration||d.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),d.duration&&d.endDate){const i=d.startDate.getTime()+1e3*d.duration;this.manifest.dateRanges[l].endDate=new Date(i)}if(v[d.id]){for(const i in v[d.id])if(d[i]&&JSON.stringify(v[d.id][i])!==JSON.stringify(d[i])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const i=this.manifest.dateRanges.findIndex((i=>i.id===d.id));this.manifest.dateRanges[i]=_extends(this.manifest.dateRanges[i],d),v[d.id]=_extends(v[d.id],d),this.manifest.dateRanges.pop()}else v[d.id]=d},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=camelCaseKeys(i.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",i.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const addDef=(i,l)=>{if(i in this.manifest.definitions)return this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${i}`}),void 0;this.manifest.definitions[i]=l};if("QUERYPARAM"in i.attributes){if("NAME"in i.attributes||"IMPORT"in i.attributes)return this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"}),void 0;const l=this.params.get(i.attributes.QUERYPARAM);return l?(addDef(i.attributes.QUERYPARAM,decodeURIComponent(l)),void 0):(this.trigger("error",{message:`EXT-X-DEFINE: No query param ${i.attributes.QUERYPARAM}`}),void 0)}return"NAME"in i.attributes?"IMPORT"in i.attributes?(this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"}),void 0):"VALUE"in i.attributes&&"string"==typeof i.attributes.VALUE?(addDef(i.attributes.NAME,i.attributes.VALUE),void 0):(this.trigger("error",{message:`EXT-X-DEFINE: No value for ${i.attributes.NAME}`}),void 0):"IMPORT"in i.attributes?this.mainDefinitions[i.attributes.IMPORT]?(addDef(i.attributes.IMPORT,this.mainDefinitions[i.attributes.IMPORT]),void 0):(this.trigger("error",{message:`EXT-X-DEFINE: No value ${i.attributes.IMPORT} to import, or IMPORT used on main playlist`}),void 0):(this.trigger("error",{message:"EXT-X-DEFINE: No attribute"}),void 0)},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:i.attributes,uri:i.uri,timeline:g}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",i.attributes,["BANDWIDTH","URI"])}}[i.tagType]||noop).call(l)},uri(){h.uri=i.uri,d.push(h),this.manifest.targetDuration&&!("duration"in h)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),h.duration=this.manifest.targetDuration),c&&(h.key=c),h.timeline=g,u&&(h.map=u),_=0,null!==this.lastProgramDateTime&&(h.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=1e3*h.duration),h={}},comment(){},custom(){i.segment?(h.custom=h.custom||{},h.custom[i.customType]=i.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[i.customType]=i.data)}})[i.type].call(l)}))}requiredCompatibilityversion(i,l){(i<l||!i)&&this.trigger("warn",{message:`manifest must be at least version ${l}`})}warnOnMissingAttributes_(i,l,d){const u=[];d.forEach((function(i){l.hasOwnProperty(i)||u.push(i)})),u.length&&this.trigger("warn",{message:`${i} lacks required attribute(s): ${u.join(", ")}`})}push(i){this.lineStream.push(i)}end(){this.lineStream.push("\n"),this.manifest.dateRanges.length&&null===this.lastProgramDateTime&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(i){this.parseStream.addParser(i)}addTagMapper(i){this.parseStream.addTagMapper(i)}}var w,C,x={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},A=["video","audio","text"],P=["Video","Audio","Text"],I=function translateLegacyCodec(i){return i?i.replace(/avc1\.(\d+)\.(\d+)/i,(function(i,l,d){return"avc1."+("00"+Number(l).toString(16)).slice(-2)+"00"+("00"+Number(d).toString(16)).slice(-2)})):i},D=function parseCodecs(i){void 0===i&&(i="");var l=i.split(","),d=[];return l.forEach((function(i){var l;i=i.trim(),A.forEach((function(u){var c=x[u].exec(i.toLowerCase());if(c&&!(c.length<=1)){l=u;var h=i.substring(0,c[1].length),p=i.replace(h,"");d.push({type:h,details:p,mediaType:u})}})),l||d.push({type:i,details:"",mediaType:"unknown"})})),d},O=function isAudioCodec(i){return void 0===i&&(i=""),x.audio.test(i.trim().toLowerCase())},L=function getMimeForCodec(i){if(i&&"string"==typeof i){var l=i.toLowerCase().split(",").map((function(i){return I(i.trim())})),d="video";1===l.length&&O(l[0])?d="audio":1===l.length&&function isTextCodec(i){return void 0===i&&(i=""),x.text.test(i.trim().toLowerCase())}(l[0])&&(d="application");var u="mp4";return l.every((function(i){return x.mp4.test(i)}))?u="mp4":l.every((function(i){return x.webm.test(i)}))?u="webm":l.every((function(i){return x.ogg.test(i)}))&&(u="ogg"),d+"/"+u+';codecs="'+i+'"'}},R=function browserSupportsCodec(i,l){return void 0===i&&(i=""),void 0===l&&(l=!1),p().MediaSource&&p().MediaSource.isTypeSupported&&p().MediaSource.isTypeSupported(L(i))||l&&p().ManagedMediaSource&&p().ManagedMediaSource.isTypeSupported&&p().ManagedMediaSource.isTypeSupported(L(i))||!1},V=function muxerSupportsCodec(i){return void 0===i&&(i=""),i.toLowerCase().split(",").every((function(i){i=i.trim();for(var l=0;l<P.length;l++){if(x["muxer"+P[l]].test(i))return!0}return!1}))},M="mp4a.40.2",N=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,B=/^application\/dash\+xml/i,j=function simpleTypeFromSourceType(i){return N.test(i)?"hls":B.test(i)?"dash":"application/vnd.videojs.vhs+json"===i?"vhs-json":null},H=function isArrayBufferView(i){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer},$=function toUint8(i){return i instanceof Uint8Array?i:(Array.isArray(i)||function isTypedArray(i){return H(i)}(i)||i instanceof ArrayBuffer||(i="number"!=typeof i||"number"==typeof i&&i!=i?0:[i]),new Uint8Array(i&&i.buffer||i,i&&i.byteOffset||0,i&&i.byteLength||0))},z=p().BigInt||Number,W=[z("0x1"),z("0x100"),z("0x10000"),z("0x1000000"),z("0x100000000"),z("0x10000000000"),z("0x1000000000000"),z("0x100000000000000"),z("0x10000000000000000")],X=(w=new Uint16Array([65484]),C=new Uint8Array(w.buffer,w.byteOffset,w.byteLength),function bytesToNumber(i,l){var d=void 0===l?{}:l,u=d.signed,c=void 0!==u&&u,h=d.le,p=void 0!==h&&h;i=$(i);var m=p?"reduce":"reduceRight",g=(i[m]?i[m]:Array.prototype[m]).call(i,(function(l,d,u){var c=p?u:Math.abs(u+1-i.length);return l+z(d)*W[c]}),z(0));if(c){var y=W[i.length]/z(2)-z(1);(g=z(g))>y&&(g-=y,g-=y,g-=z(2))}return Number(g)}),K=function numberToBytes(i,l){var d=(void 0===l?{}:l).le,u=void 0!==d&&d;("bigint"!=typeof i&&"number"!=typeof i||"number"==typeof i&&i!=i)&&(i=0);for(var c=function countBytes(i){return Math.ceil(function countBits(i){return i.toString(2).length}(i)/8)}(i=z(i)),h=new Uint8Array(new ArrayBuffer(c)),p=0;p<c;p++){var m=u?p:Math.abs(p+1-h.length);h[m]=Number(i/W[p]&z(255)),i<0&&(h[m]=Math.abs(~h[m]),h[m]-=0===p?1:2)}return h},Y=function stringToBytes(i,l){if("string"!=typeof i&&i&&"function"==typeof i.toString&&(i=i.toString()),"string"!=typeof i)return new Uint8Array;l||(i=unescape(encodeURIComponent(i)));for(var d=new Uint8Array(i.length),u=0;u<i.length;u++)d[u]=i.charCodeAt(u);return d},Q=function bytesMatch(i,l,d){var u=void 0===d?{}:d,c=u.offset,h=void 0===c?0:c,p=u.mask,m=void 0===p?[]:p;return i=$(i),(l=$(l)).length&&i.length-h>=l.length&&(l.every?l.every:Array.prototype.every).call(l,(function(l,d){return l===(m[d]?m[d]&i[h+d]:i[h+d])}))},Z=d(32419);const isObject=i=>!!i&&"object"==typeof i,merge=(...i)=>i.reduce(((i,l)=>("object"!=typeof l||Object.keys(l).forEach((d=>{i[d]=Array.isArray(i[d])&&Array.isArray(l[d])?i[d].concat(l[d]):isObject(i[d])&&isObject(l[d])?merge(i[d],l[d]):l[d]})),i)),{}),values=i=>Object.keys(i).map((l=>i[l])),flatten=i=>i.reduce(((i,l)=>i.concat(l)),[]),from=i=>{if(!i.length)return[];const l=[];for(let d=0;d<i.length;d++)l.push(i[d]);return l};var ee="INVALID_NUMBER_OF_PERIOD",te="DASH_EMPTY_MANIFEST",ie="DASH_INVALID_XML",re="NO_BASE_URL",se="SEGMENT_TIME_UNSPECIFIED",ne="UNSUPPORTED_UTC_TIMING_SCHEME";const urlTypeToSegment=({baseUrl:i="",source:l="",range:d="",indexRange:u=""})=>{const c={uri:l,resolvedUri:S(i||"",l)};if(d||u){const i=(d||u).split("-");let l,h=p().BigInt?p().BigInt(i[0]):parseInt(i[0],10),m=p().BigInt?p().BigInt(i[1]):parseInt(i[1],10);h<Number.MAX_SAFE_INTEGER&&"bigint"==typeof h&&(h=Number(h)),m<Number.MAX_SAFE_INTEGER&&"bigint"==typeof m&&(m=Number(m)),l="bigint"==typeof m||"bigint"==typeof h?p().BigInt(m)-p().BigInt(h)+p().BigInt(1):m-h+1,"bigint"==typeof l&&l<Number.MAX_SAFE_INTEGER&&(l=Number(l)),c.byterange={length:l,offset:h}}return c},parseEndNumber=i=>(i&&"number"!=typeof i&&(i=parseInt(i,10)),isNaN(i)?null:i),ae={static(i){const{duration:l,timescale:d=1,sourceDuration:u,periodDuration:c}=i,h=parseEndNumber(i.endNumber),p=l/d;return"number"==typeof h?{start:0,end:h}:"number"==typeof c?{start:0,end:c/p}:{start:0,end:u/p}},dynamic(i){const{NOW:l,clientOffset:d,availabilityStartTime:u,timescale:c=1,duration:h,periodStart:p=0,minimumUpdatePeriod:m=0,timeShiftBufferDepth:g=1/0}=i,y=parseEndNumber(i.endNumber),_=(l+d)/1e3,v=u+p,b=Math.ceil((_+m-v)*c/h),T=Math.floor((_-v-g)*c/h),S=Math.floor((_-v)*c/h);return{start:Math.max(0,T),end:"number"==typeof y?y:Math.min(b,S)}}},parseByDuration=i=>{const{type:l,duration:d,timescale:u=1,periodDuration:c,sourceDuration:h}=i,{start:p,end:m}=ae[l](i),g=((i,l)=>{const d=[];for(let u=i;u<l;u++)d.push(u);return d})(p,m).map((i=>l=>{const{duration:d,timescale:u=1,periodStart:c,startNumber:h=1}=i;return{number:h+l,duration:d/u,timeline:c,time:l*d}})(i));if("static"===l){const i=g.length-1;g[i].duration=("number"==typeof c?c:h)-d/u*i}return g},segmentsFromBase=i=>{const{baseUrl:l,initialization:d={},sourceDuration:u,indexRange:c="",periodStart:h,presentationTime:p,number:m=0,duration:g}=i;if(!l)throw new Error(re);const y=urlTypeToSegment({baseUrl:l,source:d.sourceURL,range:d.range}),_=urlTypeToSegment({baseUrl:l,source:l,indexRange:c});if(_.map=y,g){const l=parseByDuration(i);l.length&&(_.duration=l[0].duration,_.timeline=l[0].timeline)}else u&&(_.duration=u,_.timeline=h);return _.presentationTime=p||h,_.number=m,[_]},addSidxSegmentsToPlaylist$1=(i,l,d)=>{const u=i.sidx.map?i.sidx.map:null,c=i.sidx.duration,h=i.timeline||0,m=i.sidx.byterange,g=m.offset+m.length,y=l.timescale,_=l.references.filter((i=>1!==i.referenceType)),v=[],b=i.endList?"static":"dynamic",T=i.sidx.timeline;let S,E=T,k=i.mediaSequence||0;S="bigint"==typeof l.firstOffset?p().BigInt(g)+l.firstOffset:g+l.firstOffset;for(let i=0;i<_.length;i++){const m=l.references[i],g=m.referencedSize,_=m.subsegmentDuration;let w;w="bigint"==typeof S?S+p().BigInt(g)-p().BigInt(1):S+g-1;const C=segmentsFromBase({baseUrl:d,timescale:y,timeline:h,periodStart:T,presentationTime:E,number:k,duration:_,sourceDuration:c,indexRange:`${S}-${w}`,type:b})[0];u&&(C.map=u),v.push(C),S+="bigint"==typeof S?p().BigInt(g):g,E+=_/y,k++}return i.segments=v,i},oe=["AUDIO","SUBTITLES"],le=1/60,getUniqueTimelineStarts=i=>{return(l=i,d=({timeline:i})=>i,values(l.reduce(((i,l)=>(l.forEach((l=>{i[d(l)]=l})),i)),{}))).sort(((i,l)=>i.timeline>l.timeline?1:-1));var l,d},getMediaGroupPlaylists=i=>{let l=[];return!function forEachMediaGroup(i,l,d){l.forEach((function(l){for(var u in i.mediaGroups[l])for(var c in i.mediaGroups[l][u])d(i.mediaGroups[l][u][c],l,u,c)}))}(i,oe,((i,d,u,c)=>{l=l.concat(i.playlists||[])})),l},updateMediaSequenceForPlaylist=({playlist:i,mediaSequence:l})=>{i.mediaSequence=l,i.segments.forEach(((l,d)=>{l.number=i.mediaSequence+d}))},positionManifestOnTimeline=({oldManifest:i,newManifest:l})=>{const d=i.playlists.concat(getMediaGroupPlaylists(i)),u=l.playlists.concat(getMediaGroupPlaylists(l));return l.timelineStarts=getUniqueTimelineStarts([i.timelineStarts,l.timelineStarts]),(({oldPlaylists:i,newPlaylists:l,timelineStarts:d})=>{l.forEach((l=>{l.discontinuitySequence=d.findIndex((function({timeline:i}){return i===l.timeline}));const u=((i,l)=>{for(let d=0;d<i.length;d++)if(i[d].attributes.NAME===l)return i[d];return null})(i,l.attributes.NAME);if(!u)return;if(l.sidx)return;const c=l.segments[0],h=u.segments.findIndex((function(i){return Math.abs(i.presentationTime-c.presentationTime)<le}));if(-1===h)return updateMediaSequenceForPlaylist({playlist:l,mediaSequence:u.mediaSequence+u.segments.length}),l.segments[0].discontinuity=!0,l.discontinuityStarts.unshift(0),(!u.segments.length&&l.timeline>u.timeline||u.segments.length&&l.timeline>u.segments[u.segments.length-1].timeline)&&l.discontinuitySequence--,void 0;u.segments[h].discontinuity&&!c.discontinuity&&(c.discontinuity=!0,l.discontinuityStarts.unshift(0),l.discontinuitySequence--),updateMediaSequenceForPlaylist({playlist:l,mediaSequence:u.segments[h].number})}))})({oldPlaylists:d,newPlaylists:u,timelineStarts:l.timelineStarts}),l},generateSidxKey=i=>i&&i.uri+"-"+(i=>{let l;return l="bigint"==typeof i.offset||"bigint"==typeof i.length?p().BigInt(i.offset)+p().BigInt(i.length)-p().BigInt(1):i.offset+i.length-1,`${i.offset}-${l}`})(i.byterange),mergeDiscontiguousPlaylists=i=>{const l=i.reduce((function(i,l){return i[l.attributes.baseUrl]||(i[l.attributes.baseUrl]=[]),i[l.attributes.baseUrl].push(l),i}),{});let d=[];return Object.values(l).forEach((i=>{const l=values(i.reduce(((i,l)=>{const d=l.attributes.id+(l.attributes.lang||"");return i[d]?(l.segments&&(l.segments[0]&&(l.segments[0].discontinuity=!0),i[d].segments.push(...l.segments)),l.attributes.contentProtection&&(i[d].attributes.contentProtection=l.attributes.contentProtection)):(i[d]=l,i[d].attributes.timelineStarts=[]),i[d].attributes.timelineStarts.push({start:l.attributes.periodStart,timeline:l.attributes.periodStart}),i}),{}));d=d.concat(l)})),d.map((i=>{var l;return i.discontinuityStarts=(l="discontinuity",(i.segments||[]).reduce(((i,d,u)=>(d[l]&&i.push(u),i)),[])),i}))},addSidxSegmentsToPlaylist=(i,l)=>{const d=generateSidxKey(i.sidx),u=d&&l[d]&&l[d].sidx;return u&&addSidxSegmentsToPlaylist$1(i,u,i.sidx.resolvedUri),i},addSidxSegmentsToPlaylists=(i,l={})=>{if(!Object.keys(l).length)return i;for(const d in i)i[d]=addSidxSegmentsToPlaylist(i[d],l);return i},formatVideoPlaylist=({attributes:i,segments:l,sidx:d,discontinuityStarts:u})=>{const c={attributes:{NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth,"PROGRAM-ID":1},uri:"",endList:"static"===i.type,timeline:i.periodStart,resolvedUri:i.baseUrl||"",targetDuration:i.duration,discontinuityStarts:u,timelineStarts:i.timelineStarts,segments:l};return i.frameRate&&(c.attributes["FRAME-RATE"]=i.frameRate),i.contentProtection&&(c.contentProtection=i.contentProtection),i.serviceLocation&&(c.attributes.serviceLocation=i.serviceLocation),d&&(c.sidx=d),c},videoOnly=({attributes:i})=>"video/mp4"===i.mimeType||"video/webm"===i.mimeType||"video"===i.contentType,audioOnly=({attributes:i})=>"audio/mp4"===i.mimeType||"audio/webm"===i.mimeType||"audio"===i.contentType,vttOnly=({attributes:i})=>"text/vtt"===i.mimeType||"text"===i.contentType,flattenMediaGroupPlaylists=i=>i?Object.keys(i).reduce(((l,d)=>l.concat(i[d].playlists)),[]):[],toM3u8=({dashPlaylists:i,locations:l,contentSteering:d,sidxMapping:u={},previousManifest:c,eventStream:h})=>{if(!i.length)return{};const{sourceDuration:p,type:m,suggestedPresentationDelay:g,minimumUpdatePeriod:y}=i[0].attributes,_=mergeDiscontiguousPlaylists(i.filter(videoOnly)).map(formatVideoPlaylist),v=mergeDiscontiguousPlaylists(i.filter(audioOnly)),b=mergeDiscontiguousPlaylists(i.filter(vttOnly)),T=i.map((i=>i.attributes.captionServices)).filter(Boolean),S={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:p,playlists:addSidxSegmentsToPlaylists(_,u)};y>=0&&(S.minimumUpdatePeriod=1e3*y),l&&(S.locations=l),d&&(S.contentSteering=d),"dynamic"===m&&(S.suggestedPresentationDelay=g),h&&h.length>0&&(S.eventStream=h);const E=v.length?((i,l={},d=!1)=>{let u;const c=i.reduce(((i,c)=>{const h=c.attributes.role&&c.attributes.role.value||"",p=c.attributes.lang||"";let m=c.attributes.label||"main";p&&!c.attributes.label&&(m=`${c.attributes.lang}${h?` (${h})`:""}`),i[m]||(i[m]={language:p,autoselect:!0,default:"main"===h,playlists:[],uri:""});const g=addSidxSegmentsToPlaylist((({attributes:i,segments:l,sidx:d,mediaSequence:u,discontinuitySequence:c,discontinuityStarts:h},p)=>{const m={attributes:{NAME:i.id,BANDWIDTH:i.bandwidth,CODECS:i.codecs,"PROGRAM-ID":1},uri:"",endList:"static"===i.type,timeline:i.periodStart,resolvedUri:i.baseUrl||"",targetDuration:i.duration,discontinuitySequence:c,discontinuityStarts:h,timelineStarts:i.timelineStarts,mediaSequence:u,segments:l};return i.contentProtection&&(m.contentProtection=i.contentProtection),i.serviceLocation&&(m.attributes.serviceLocation=i.serviceLocation),d&&(m.sidx=d),p&&(m.attributes.AUDIO="audio",m.attributes.SUBTITLES="subs"),m})(c,d),l);return i[m].playlists.push(g),void 0===u&&"main"===h&&(u=c,u.default=!0),i}),{});u||(c[Object.keys(c)[0]].default=!0);return c})(v,u,0===S.playlists.length):null,k=b.length?((i,l={})=>i.reduce(((i,d)=>{const u=d.attributes.label||d.attributes.lang||"text";return i[u]||(i[u]={language:d.attributes.lang||"und",default:!1,autoselect:!1,playlists:[],uri:""}),i[u].playlists.push(addSidxSegmentsToPlaylist((({attributes:i,segments:l,mediaSequence:d,discontinuityStarts:u,discontinuitySequence:c})=>{void 0===l&&(l=[{uri:i.baseUrl,timeline:i.periodStart,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}],i.duration=i.sourceDuration);const h={NAME:i.id,BANDWIDTH:i.bandwidth,"PROGRAM-ID":1};i.codecs&&(h.CODECS=i.codecs);const p={attributes:h,uri:"",endList:"static"===i.type,timeline:i.periodStart,resolvedUri:i.baseUrl||"",targetDuration:i.duration,timelineStarts:i.timelineStarts,discontinuityStarts:u,discontinuitySequence:c,mediaSequence:d,segments:l};return i.serviceLocation&&(p.attributes.serviceLocation=i.serviceLocation),p})(d),l)),i}),{}))(b,u):null,w=_.concat(flattenMediaGroupPlaylists(E),flattenMediaGroupPlaylists(k)),C=w.map((({timelineStarts:i})=>i));var x;return S.timelineStarts=getUniqueTimelineStarts(C),x=S.timelineStarts,w.forEach((i=>{i.mediaSequence=0,i.discontinuitySequence=x.findIndex((function({timeline:l}){return l===i.timeline})),i.segments&&i.segments.forEach(((i,l)=>{i.number=l}))})),E&&(S.mediaGroups.AUDIO.audio=E),k&&(S.mediaGroups.SUBTITLES.subs=k),T.length&&(S.mediaGroups["CLOSED-CAPTIONS"].cc=T.reduce(((i,l)=>l?(l.forEach((l=>{const{channel:d,language:u}=l;i[u]={autoselect:!1,default:!1,instreamId:d,language:u},l.hasOwnProperty("aspectRatio")&&(i[u].aspectRatio=l.aspectRatio),l.hasOwnProperty("easyReader")&&(i[u].easyReader=l.easyReader),l.hasOwnProperty("3D")&&(i[u]["3D"]=l["3D"])})),i):i),{})),c?positionManifestOnTimeline({oldManifest:c,newManifest:S}):S},getLiveRValue=(i,l,d)=>{const{NOW:u,clientOffset:c,availabilityStartTime:h,timescale:p=1,periodStart:m=0,minimumUpdatePeriod:g=0}=i;return Math.ceil((((u+c)/1e3+g-(h+m))*p-l)/d)},parseByTimeline=(i,l)=>{const{type:d,minimumUpdatePeriod:u=0,media:c="",sourceDuration:h,timescale:p=1,startNumber:m=1,periodStart:g}=i,y=[];let _=-1;for(let v=0;v<l.length;v++){const b=l[v],T=b.d,S=b.r||0,E=b.t||0;let k;if(_<0&&(_=E),E&&E>_&&(_=E),S<0){const m=v+1;k=m===l.length?"dynamic"===d&&u>0&&c.indexOf("$Number$")>0?getLiveRValue(i,_,T):(h*p-_)/T:(l[m].t-_)/T}else k=S+1;const w=m+y.length+k;let C=m+y.length;for(;C<w;)y.push({number:C,duration:T/p,time:_,timeline:g}),_+=T,C++}return y},de=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,constructTemplateUrl=(i,l)=>i.replace(de,(i=>(l,d,u,c)=>{if("$$"===l)return"$";if(void 0===i[d])return l;const h=""+i[d];return"RepresentationID"===d?h:(c=u?parseInt(c,10):1,h.length>=c?h:`${new Array(c-h.length+1).join("0")}${h}`)})(l)),segmentsFromTemplate=(i,l)=>{const d={RepresentationID:i.id,Bandwidth:i.bandwidth||0},{initialization:u={sourceURL:"",range:""}}=i,c=urlTypeToSegment({baseUrl:i.baseUrl,source:constructTemplateUrl(u.sourceURL,d),range:u.range}),h=((i,l)=>i.duration||l?i.duration?parseByDuration(i):parseByTimeline(i,l):[{number:i.startNumber||1,duration:i.sourceDuration,time:0,timeline:i.periodStart}])(i,l);return h.map((l=>{d.Number=l.number,d.Time=l.time;const u=constructTemplateUrl(i.media||"",d),h=i.periodStart+(l.time-(i.presentationTimeOffset||0))/(i.timescale||1);return{uri:u,timeline:l.timeline,duration:l.duration,resolvedUri:S(i.baseUrl||"",u),map:c,number:l.number,presentationTime:h}}))},segmentsFromList=(i,l)=>{const{duration:d,segmentUrls:u=[],periodStart:c}=i;if(!d&&!l||d&&l)throw new Error(se);const h=u.map((l=>((i,l)=>{const{baseUrl:d,initialization:u={}}=i,c=urlTypeToSegment({baseUrl:d,source:u.sourceURL,range:u.range}),h=urlTypeToSegment({baseUrl:d,source:l.media,range:l.mediaRange});return h.map=c,h})(i,l)));let p;d&&(p=parseByDuration(i)),l&&(p=parseByTimeline(i,l));return p.map(((l,d)=>{if(h[d]){const u=h[d],p=i.timescale||1,m=i.presentationTimeOffset||0;return u.timeline=l.timeline,u.duration=l.duration,u.number=l.number,u.presentationTime=c+(l.time-m)/p,u}})).filter((i=>i))},generateSegments=({attributes:i,segmentInfo:l})=>{let d,u;l.template?(u=segmentsFromTemplate,d=merge(i,l.template)):l.base?(u=segmentsFromBase,d=merge(i,l.base)):l.list&&(u=segmentsFromList,d=merge(i,l.list));const c={attributes:i};if(!u)return c;const h=u(d,l.segmentTimeline);if(d.duration){const{duration:i,timescale:l=1}=d;d.duration=i/l}else d.duration=h.length?h.reduce(((i,l)=>Math.max(i,Math.ceil(l.duration))),0):0;return c.attributes=d,c.segments=h,l.base&&d.indexRange&&(c.sidx=h[0],c.segments=[]),c},findChildren=(i,l)=>from(i.childNodes).filter((({tagName:i})=>i===l)),getContent=i=>i.textContent.trim(),parseDuration=i=>{const l=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(i);if(!l)return 0;const[d,u,c,h,p,m]=l.slice(1);return 31536e3*parseFloat(d||0)+2592e3*parseFloat(u||0)+86400*parseFloat(c||0)+3600*parseFloat(h||0)+60*parseFloat(p||0)+parseFloat(m||0)},ue={mediaPresentationDuration:i=>parseDuration(i),availabilityStartTime(i){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(l=i)&&(l+="Z"),Date.parse(l)/1e3;var l},minimumUpdatePeriod:i=>parseDuration(i),suggestedPresentationDelay:i=>parseDuration(i),type:i=>i,timeShiftBufferDepth:i=>parseDuration(i),start:i=>parseDuration(i),width:i=>parseInt(i,10),height:i=>parseInt(i,10),bandwidth:i=>parseInt(i,10),frameRate:i=>(i=>parseFloat(i.split("/").reduce(((i,l)=>i/l))))(i),startNumber:i=>parseInt(i,10),timescale:i=>parseInt(i,10),presentationTimeOffset:i=>parseInt(i,10),duration(i){const l=parseInt(i,10);return isNaN(l)?parseDuration(i):l},d:i=>parseInt(i,10),t:i=>parseInt(i,10),r:i=>parseInt(i,10),presentationTime:i=>parseInt(i,10),DEFAULT:i=>i},mpd_parser_es_parseAttributes=i=>i&&i.attributes?from(i.attributes).reduce(((i,l)=>(i[l.name]=(ue[l.name]||ue.DEFAULT)(l.value),i)),{}):{},ce={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},buildBaseUrls=(i,l)=>l.length?flatten(i.map((function(i){return l.map((function(l){const d=getContent(l),u=S(i.baseUrl,d),c=merge(mpd_parser_es_parseAttributes(l),{baseUrl:u});return u!==d&&!c.serviceLocation&&i.serviceLocation&&(c.serviceLocation=i.serviceLocation),c}))}))):i,getSegmentInformation=i=>{const l=findChildren(i,"SegmentTemplate")[0],d=findChildren(i,"SegmentList")[0],u=d&&findChildren(d,"SegmentURL").map((i=>merge({tag:"SegmentURL"},mpd_parser_es_parseAttributes(i)))),c=findChildren(i,"SegmentBase")[0],h=d||l,p=h&&findChildren(h,"SegmentTimeline")[0],m=d||c||l,g=m&&findChildren(m,"Initialization")[0],y=l&&mpd_parser_es_parseAttributes(l);y&&g?y.initialization=g&&mpd_parser_es_parseAttributes(g):y&&y.initialization&&(y.initialization={sourceURL:y.initialization});const _={template:y,segmentTimeline:p&&findChildren(p,"S").map((i=>mpd_parser_es_parseAttributes(i))),list:d&&merge(mpd_parser_es_parseAttributes(d),{segmentUrls:u,initialization:mpd_parser_es_parseAttributes(g)}),base:c&&merge(mpd_parser_es_parseAttributes(c),{initialization:mpd_parser_es_parseAttributes(g)})};return Object.keys(_).forEach((i=>{_[i]||delete _[i]})),_},toEventStream=i=>flatten(findChildren(i.node,"EventStream").map((l=>{const d=mpd_parser_es_parseAttributes(l),u=d.schemeIdUri;return findChildren(l,"Event").map((l=>{const c=mpd_parser_es_parseAttributes(l),h=d.timescale||1,p=(c.presentationTime||0)/h+i.attributes.start;return{schemeIdUri:u,value:d.value,id:c.id,start:p,end:p+(c.duration||0)/h,messageData:getContent(l)||c.messageData,contentEncoding:d.contentEncoding,presentationTimeOffset:d.presentationTimeOffset||0}}))}))),toRepresentations=(i,l,d)=>u=>{const c=mpd_parser_es_parseAttributes(u),h=buildBaseUrls(l,findChildren(u,"BaseURL")),p=findChildren(u,"Role")[0],m={role:mpd_parser_es_parseAttributes(p)};let g=merge(i,c,m);const y=findChildren(u,"Accessibility")[0],_=(i=>{if("urn:scte:dash:cc:cea-608:2015"===i.schemeIdUri)return("string"!=typeof i.value?[]:i.value.split(";")).map((i=>{let l,d;return d=i,/^CC\d=/.test(i)?[l,d]=i.split("="):/^CC\d$/.test(i)&&(l=i),{channel:l,language:d}}));if("urn:scte:dash:cc:cea-708:2015"===i.schemeIdUri)return("string"!=typeof i.value?[]:i.value.split(";")).map((i=>{const l={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(i)){const[d,u=""]=i.split("=");l.channel=d,l.language=i,u.split(",").forEach((i=>{const[d,u]=i.split(":");"lang"===d?l.language=u:"er"===d?l.easyReader=Number(u):"war"===d?l.aspectRatio=Number(u):"3D"===d&&(l["3D"]=Number(u))}))}else l.language=i;return l.channel&&(l.channel="SERVICE"+l.channel),l}))})(mpd_parser_es_parseAttributes(y));_&&(g=merge(g,{captionServices:_}));const v=findChildren(u,"Label")[0];if(v&&v.childNodes.length){const i=v.childNodes[0].nodeValue.trim();g=merge(g,{label:i})}const b=findChildren(u,"ContentProtection").reduce(((i,l)=>{const d=mpd_parser_es_parseAttributes(l);d.schemeIdUri&&(d.schemeIdUri=d.schemeIdUri.toLowerCase());const u=ce[d.schemeIdUri];if(u){i[u]={attributes:d};const c=findChildren(l,"cenc:pssh")[0];if(c){const l=getContent(c);i[u].pssh=l&&decodeB64ToUint8Array(l)}}return i}),{});Object.keys(b).length&&(g=merge(g,{contentProtection:b}));const T=getSegmentInformation(u),S=findChildren(u,"Representation"),E=merge(d,T);return flatten(S.map(((i,l,d)=>u=>{const c=findChildren(u,"BaseURL"),h=buildBaseUrls(l,c),p=merge(i,mpd_parser_es_parseAttributes(u)),m=getSegmentInformation(u);return h.map((i=>({segmentInfo:merge(d,m),attributes:merge(p,i)})))})(g,h,E)))},toAdaptationSets=(i,l)=>(d,u)=>{const c=buildBaseUrls(l,findChildren(d.node,"BaseURL")),h=merge(i,{periodStart:d.attributes.start});"number"==typeof d.attributes.duration&&(h.periodDuration=d.attributes.duration);const p=findChildren(d.node,"AdaptationSet"),m=getSegmentInformation(d.node);return flatten(p.map(toRepresentations(h,c,m)))},generateContentSteeringInformation=(i,l)=>{if(i.length>1&&l({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!i.length)return null;const d=merge({serverURL:getContent(i[0])},mpd_parser_es_parseAttributes(i[0]));return d.queryBeforeStart="true"===d.queryBeforeStart,d},stringToMpdXml=i=>{if(""===i)throw new Error(te);const l=new Z.DOMParser;let d,u;try{d=l.parseFromString(i,"application/xml"),u=d&&"MPD"===d.documentElement.tagName?d.documentElement:null}catch(i){}if(!u||u&&u.getElementsByTagName("parsererror").length>0)throw new Error(ie);return u},parse=(i,l={})=>{const d=((i,l={})=>{const{manifestUri:d="",NOW:u=Date.now(),clientOffset:c=0,eventHandler:h=function(){}}=l,p=findChildren(i,"Period");if(!p.length)throw new Error(ee);const m=findChildren(i,"Location"),g=mpd_parser_es_parseAttributes(i),y=buildBaseUrls([{baseUrl:d}],findChildren(i,"BaseURL")),_=findChildren(i,"ContentSteering");g.type=g.type||"static",g.sourceDuration=g.mediaPresentationDuration||0,g.NOW=u,g.clientOffset=c,m.length&&(g.locations=m.map(getContent));const v=[];return p.forEach(((i,l)=>{const d=mpd_parser_es_parseAttributes(i),u=v[l-1];d.start=(({attributes:i,priorPeriodAttributes:l,mpdType:d})=>"number"==typeof i.start?i.start:l&&"number"==typeof l.start&&"number"==typeof l.duration?l.start+l.duration:l||"static"!==d?null:0)({attributes:d,priorPeriodAttributes:u?u.attributes:null,mpdType:g.type}),v.push({node:i,attributes:d})})),{locations:g.locations,contentSteeringInfo:generateContentSteeringInformation(_,h),representationInfo:flatten(v.map(toAdaptationSets(g,y))),eventStream:flatten(v.map(toEventStream))}})(stringToMpdXml(i),l),u=d.representationInfo.map(generateSegments);return toM3u8({dashPlaylists:u,locations:d.locations,contentSteering:d.contentSteeringInfo,sidxMapping:l.sidxMapping,previousManifest:l.previousManifest,eventStream:d.eventStream})},parseUTCTiming=i=>(i=>{const l=findChildren(i,"UTCTiming")[0];if(!l)return null;const d=mpd_parser_es_parseAttributes(l);switch(d.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":d.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":d.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":d.method="DIRECT",d.value=Date.parse(d.value);break;default:throw new Error(ne)}return d})(stringToMpdXml(i));var he,pe=d(41089),me=d.n(pe),fe=$([73,68,51]),ge=function getId3Offset(i,l){return void 0===l&&(l=0),(i=$(i)).length-l<10||!Q(i,fe,{offset:l})?l:(l+=function getId3Size(i,l){void 0===l&&(l=0);var d=(i=$(i))[l+6]<<21|i[l+7]<<14|i[l+8]<<7|i[l+9];return(16&i[l+5])>>4?d+20:d+10}(i,l),getId3Offset(i,l))},ye=(new Uint8Array([79,112,117,115,72,101,97,100]),function normalizePath(i){return"string"==typeof i?Y(i):("number"==typeof i,i)}),_e=function parseDescriptors(i){i=$(i);for(var l=[],d=0;i.length>d;){var u=i[d],c=0,h=0,p=i[++h];for(h++;128&p;)c=(127&p)<<7,p=i[h],h++;c+=127&p;for(var m=0;m<he.length;m++){var g=he[m];if(u===g.id){l.push((0,g.parser)(i.subarray(h,h+c)));break}}d+=c+h}return l};he=[{id:3,parser:function parser(i){var l={tag:3,id:i[0]<<8|i[1],flags:i[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(128&l.flags&&(l.dependsOnEsId=i[l.size]<<8|i[l.size+1],l.size+=2),64&l.flags){var d=i[l.size];l.url=function bytesToString(i){if(!i)return"";i=Array.prototype.slice.call(i);var l=String.fromCharCode.apply(null,$(i));try{return decodeURIComponent(escape(l))}catch(i){}return l}(i.subarray(l.size+1,l.size+1+d)),l.size+=d}return 32&l.flags&&(l.ocrEsId=i[l.size]<<8|i[l.size+1],l.size+=2),l.descriptors=_e(i.subarray(l.size))||[],l}},{id:4,parser:function parser(i){return{tag:4,oti:i[0],streamType:i[1],bufferSize:i[2]<<16|i[3]<<8|i[4],maxBitrate:i[5]<<24|i[6]<<16|i[7]<<8|i[8],avgBitrate:i[9]<<24|i[10]<<16|i[11]<<8|i[12],descriptors:_e(i.subarray(13))}}},{id:5,parser:function parser(i){return{tag:5,bytes:i}}},{id:6,parser:function parser(i){return{tag:6,bytes:i}}}];var ve=function findBox(i,l,d){void 0===d&&(d=!1),l=function normalizePaths(i){return Array.isArray(i)?i.map((function(i){return ye(i)})):[ye(i)]}(l),i=$(i);var u=[];if(!l.length)return u;for(var c=0;c<i.length;){var h=(i[c]<<24|i[c+1]<<16|i[c+2]<<8|i[c+3])>>>0,p=i.subarray(c+4,c+8);if(0===h)break;var m=c+h;if(m>i.length){if(d)break;m=i.length}var g=i.subarray(c+8,m);Q(p,l[0])&&(1===l.length?u.push(g):u.push.apply(u,findBox(g,l.slice(1),d))),c=m}return u},be={EBML:$([26,69,223,163]),DocType:$([66,130]),Segment:$([24,83,128,103]),SegmentInfo:$([21,73,169,102]),Tracks:$([22,84,174,107]),Track:$([174]),TrackNumber:$([215]),DefaultDuration:$([35,227,131]),TrackEntry:$([174]),TrackType:$([131]),FlagDefault:$([136]),CodecID:$([134]),CodecPrivate:$([99,162]),VideoTrack:$([224]),AudioTrack:$([225]),Cluster:$([31,67,182,117]),Timestamp:$([231]),TimestampScale:$([42,215,177]),BlockGroup:$([160]),BlockDuration:$([155]),Block:$([161]),SimpleBlock:$([163])},Te=[128,64,32,16,8,4,2,1],Se=function getvint(i,l,d,u){void 0===d&&(d=!0),void 0===u&&(u=!1);var c=function getLength(i){for(var l=1,d=0;d<Te.length&&!(i&Te[d]);d++)l++;return l}(i[l]),h=i.subarray(l,l+c);return d&&((h=Array.prototype.slice.call(i,l,l+c))[0]^=Te[c-1]),{length:c,value:X(h,{signed:u}),bytes:h}},Ee=function normalizePath(i){return"string"==typeof i?i.match(/.{1,2}/g).map((function(i){return normalizePath(i)})):"number"==typeof i?K(i):i},ke=function getInfinityDataSize(i,l,d){if(d>=l.length)return l.length;var u=Se(l,d,!1);if(Q(i.bytes,u.bytes))return d;var c=Se(l,d+u.length);return getInfinityDataSize(i,l,d+c.length+c.value+u.length)},we=function findEbml(i,l){l=function normalizePaths(i){return Array.isArray(i)?i.map((function(i){return Ee(i)})):[Ee(i)]}(l),i=$(i);var d=[];if(!l.length)return d;for(var u=0;u<i.length;){var c=Se(i,u,!1),h=Se(i,u+c.length),p=u+c.length+h.length;127===h.value&&(h.value=ke(c,i,p),h.value!==i.length&&(h.value-=p));var m=i.subarray(p,p+h.value>i.length?i.length:p+h.value);Q(l[0],c.bytes)&&(1===l.length?d.push(m):d=d.concat(findEbml(m,l.slice(1)))),u+=c.length+h.length+m.length}return d},Ce=$([0,0,0,1]),xe=$([0,0,1]),Ae=$([0,0,3]),Pe=function discardEmulationPreventionBytes(i){for(var l=[],d=1;d<i.length-2;)Q(i.subarray(d,d+3),Ae)&&(l.push(d+2),d++),d++;if(0===l.length)return i;var u=i.length-l.length,c=new Uint8Array(u),h=0;for(d=0;d<u;h++,d++)h===l[0]&&(h++,l.shift()),c[d]=i[h];return c},Ie=function findNal(i,l,d,u){void 0===u&&(u=1/0),i=$(i),d=[].concat(d);for(var c,h=0,p=0;h<i.length&&(p<u||c);){var m=void 0;if(Q(i.subarray(h),Ce)?m=4:Q(i.subarray(h),xe)&&(m=3),m){if(p++,c)return Pe(i.subarray(c,h));var g=void 0;"h264"===l?g=31&i[h+m]:"h265"===l&&(g=i[h+m]>>1&63),-1!==d.indexOf(g)&&(c=h+m),h+=m+("h264"===l?1:2)}else h++}return i.subarray(0,0)},De={webm:$([119,101,98,109]),matroska:$([109,97,116,114,111,115,107,97]),flac:$([102,76,97,67]),ogg:$([79,103,103,83]),ac3:$([11,119]),riff:$([82,73,70,70]),avi:$([65,86,73]),wav:$([87,65,86,69]),"3gp":$([102,116,121,112,51,103]),mp4:$([102,116,121,112]),fmp4:$([115,116,121,112]),mov:$([102,116,121,112,113,116]),moov:$([109,111,111,118]),moof:$([109,111,111,102])},Oe={aac:function aac(i){var l=ge(i);return Q(i,[255,16],{offset:l,mask:[255,22]})},mp3:function mp3(i){var l=ge(i);return Q(i,[255,2],{offset:l,mask:[255,6]})},webm:function webm(i){var l=we(i,[be.EBML,be.DocType])[0];return Q(l,De.webm)},mkv:function mkv(i){var l=we(i,[be.EBML,be.DocType])[0];return Q(l,De.matroska)},mp4:function mp4(i){return!Oe["3gp"](i)&&!Oe.mov(i)&&(!(!Q(i,De.mp4,{offset:4})&&!Q(i,De.fmp4,{offset:4}))||(!(!Q(i,De.moof,{offset:4})&&!Q(i,De.moov,{offset:4}))||void 0))},mov:function mov(i){return Q(i,De.mov,{offset:4})},"3gp":function gp(i){return Q(i,De["3gp"],{offset:4})},ac3:function ac3(i){var l=ge(i);return Q(i,De.ac3,{offset:l})},ts:function ts(i){if(i.length<189&&i.length>=1)return 71===i[0];for(var l=0;l+188<i.length&&l<188;){if(71===i[l]&&71===i[l+188])return!0;l+=1}return!1},flac:function flac(i){var l=ge(i);return Q(i,De.flac,{offset:l})},ogg:function ogg(i){return Q(i,De.ogg)},avi:function avi(i){return Q(i,De.riff)&&Q(i,De.avi,{offset:8})},wav:function wav(i){return Q(i,De.riff)&&Q(i,De.wav,{offset:8})},h264:function h264(i){return function findH264Nal(i,l,d){return Ie(i,"h264",l,d)}(i,7,3).length},h265:function h265(i){return function findH265Nal(i,l,d){return Ie(i,"h265",l,d)}(i,[32,33],3).length}},Le=Object.keys(Oe).filter((function(i){return"ts"!==i&&"h264"!==i&&"h265"!==i})).concat(["ts","h264","h265"]);Le.forEach((function(i){var l=Oe[i];Oe[i]=function(i){return l($(i))}}));var Re=Oe,Ve=function detectContainerForBytes(i){i=$(i);for(var l=0;l<Le.length;l++){var d=Le[l];if(Re[d](i))return d}return""},Me=d(12915),Ne="8.21.1";const Ue={},hooks=function(i,l){return Ue[i]=Ue[i]||[],l&&(Ue[i]=Ue[i].concat(l)),Ue[i]},removeHook=function(i,l){const d=hooks(i).indexOf(l);return!(d<=-1)&&(Ue[i]=Ue[i].slice(),Ue[i].splice(d,1),!0)},Be={prefixed:!0},Fe=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],je=Fe[0];let qe;for(let i=0;i<Fe.length;i++)if(Fe[i][1]in g()){qe=Fe[i];break}if(qe){for(let i=0;i<qe.length;i++)Be[je[i]]=qe[i];Be.prefixed=qe[0]!==je[0]}let He=[];const $e=function createLogger$1(i,l=":",d=""){let u,c="info";function log(...i){u("log",c,i)}return u=((i,l,d)=>(u,c,h)=>{const m=l.levels[c],g=new RegExp(`^(${m})$`);let y=i;if("log"!==u&&h.unshift(u.toUpperCase()+":"),d&&(y=`%c${i}`,h.unshift(d)),h.unshift(y+":"),He){He.push([].concat(h));const i=He.length-1e3;He.splice(0,i>0?i:0)}if(!p().console)return;let _=p().console[u];_||"debug"!==u||(_=p().console.info||p().console.log),_&&m&&g.test(u)&&_[Array.isArray(h)?"apply":"call"](p().console,h)})(i,log,d),log.createLogger=(u,c,h)=>{const p=void 0!==c?c:l;return createLogger$1(`${i} ${p} ${u}`,p,void 0!==h?h:d)},log.createNewLogger=(i,l,d)=>createLogger$1(i,l,d),log.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:c},log.level=i=>{if("string"==typeof i){if(!log.levels.hasOwnProperty(i))throw new Error(`"${i}" in not a valid log level`);c=i}return c},(log.history=()=>He?[].concat(He):[]).filter=i=>(He||[]).filter((l=>new RegExp(`.*${i}.*`).test(l[0]))),log.history.clear=()=>{He&&(He.length=0)},log.history.disable=()=>{null!==He&&(He.length=0,He=null)},log.history.enable=()=>{null===He&&(He=[])},log.error=(...i)=>u("error",c,i),log.warn=(...i)=>u("warn",c,i),log.debug=(...i)=>u("debug",c,i),log}("VIDEOJS"),ze=$e.createLogger,Ge=Object.prototype.toString,keys=function(i){return video_es_isObject(i)?Object.keys(i):[]};function each(i,l){keys(i).forEach((d=>l(i[d],d)))}function reduce(i,l,d=0){return keys(i).reduce(((d,u)=>l(d,i[u],u)),d)}function video_es_isObject(i){return!!i&&"object"==typeof i}function isPlain(i){return video_es_isObject(i)&&"[object Object]"===Ge.call(i)&&i.constructor===Object}function merge$1(...i){const l={};return i.forEach((i=>{i&&each(i,((i,d)=>{if(!isPlain(i))return l[d]=i,void 0;isPlain(l[d])||(l[d]={}),l[d]=merge$1(l[d],i)}))})),l}function video_es_values(i={}){const l=[];for(const d in i)if(i.hasOwnProperty(d)){l.push(i[d])}return l}function defineLazyProperty(i,l,d,u=!0){const set=d=>Object.defineProperty(i,l,{value:d,enumerable:!0,writable:!0}),c={configurable:!0,enumerable:!0,get(){const i=d();return set(i),i}};return u&&(c.set=set),Object.defineProperty(i,l,c)}var We=Object.freeze({__proto__:null,each,reduce,isObject:video_es_isObject,isPlain,merge:merge$1,values:video_es_values,defineLazyProperty});let Xe,Ke=!1,Ye=null,Qe=!1,Je=!1,Ze=!1,et=!1,tt=!1,it=null,rt=null;const st=Boolean(p().cast&&p().cast.framework&&p().cast.framework.CastReceiverContext);let nt=null,at=!1,ot=!1,lt=!1,dt=!1,ut=!1,ct=!1,ht=!1;const pt=Boolean(isReal()&&("ontouchstart"in p()||p().navigator.maxTouchPoints||p().DocumentTouch&&p().document instanceof p().DocumentTouch)),mt=p().navigator&&p().navigator.userAgentData;if(mt&&mt.platform&&mt.brands&&(Qe="Android"===mt.platform,Ze=Boolean(mt.brands.find((i=>"Microsoft Edge"===i.brand))),et=Boolean(mt.brands.find((i=>"Chromium"===i.brand))),tt=!Ze&&et,it=rt=(mt.brands.find((i=>"Chromium"===i.brand))||{}).version||null,ot="Windows"===mt.platform),!et){const i=p().navigator&&p().navigator.userAgent||"";Ke=/iPod/i.test(i),Ye=function(){const l=i.match(/OS (\d+)_/i);return l&&l[1]?l[1]:null}(),Qe=/Android/i.test(i),Xe=function(){const l=i.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!l)return null;const d=l[1]&&parseFloat(l[1]),u=l[2]&&parseFloat(l[2]);return d&&u?parseFloat(l[1]+"."+l[2]):d||null}(),Je=/Firefox/i.test(i),Ze=/Edg/i.test(i),et=/Chrome/i.test(i)||/CriOS/i.test(i),tt=!Ze&&et,it=rt=function(){const l=i.match(/(Chrome|CriOS)\/(\d+)/);return l&&l[2]?parseFloat(l[2]):null}(),nt=function(){const l=/MSIE\s(\d+)\.\d/.exec(i);let d=l&&parseFloat(l[1]);return!d&&/Trident\/7.0/i.test(i)&&/rv:11.0/.test(i)&&(d=11),d}(),ut=/Tizen/i.test(i),ct=/Web0S/i.test(i),ht=ut||ct,at=/Safari/i.test(i)&&!tt&&!Qe&&!Ze&&!ht,ot=/Windows/i.test(i),lt=/iPad/i.test(i)||at&&pt&&!/iPhone/i.test(i),dt=/iPhone/i.test(i)&&!lt}const ft=dt||lt||Ke,gt=(at||ft)&&!tt;var yt=Object.freeze({__proto__:null,get IS_IPOD(){return Ke},get IOS_VERSION(){return Ye},get IS_ANDROID(){return Qe},get ANDROID_VERSION(){return Xe},get IS_FIREFOX(){return Je},get IS_EDGE(){return Ze},get IS_CHROMIUM(){return et},get IS_CHROME(){return tt},get CHROMIUM_VERSION(){return it},get CHROME_VERSION(){return rt},IS_CHROMECAST_RECEIVER:st,get IE_VERSION(){return nt},get IS_SAFARI(){return at},get IS_WINDOWS(){return ot},get IS_IPAD(){return lt},get IS_IPHONE(){return dt},get IS_TIZEN(){return ut},get IS_WEBOS(){return ct},get IS_SMART_TV(){return ht},TOUCH_ENABLED:pt,IS_IOS:ft,IS_ANY_SAFARI:gt});function isNonBlankString(i){return"string"==typeof i&&Boolean(i.trim())}function isReal(){return g()===p().document}function isEl(i){return video_es_isObject(i)&&1===i.nodeType}function isInFrame(){try{return p().parent!==p().self}catch(i){return!0}}function createQuerier(i){return function(l,d){if(!isNonBlankString(l))return g()[i](null);isNonBlankString(d)&&(d=g().querySelector(d));const u=isEl(d)?d:g();return u[i]&&u[i](l)}}function createEl(i="div",l={},d={},u){const c=g().createElement(i);return Object.getOwnPropertyNames(l).forEach((function(i){const d=l[i];"textContent"===i?textContent(c,d):c[i]===d&&"tabIndex"!==i||(c[i]=d)})),Object.getOwnPropertyNames(d).forEach((function(i){c.setAttribute(i,d[i])})),u&&appendContent(c,u),c}function textContent(i,l){return void 0===i.textContent?i.innerText=l:i.textContent=l,i}function prependTo(i,l){l.firstChild?l.insertBefore(i,l.firstChild):l.appendChild(i)}function hasClass(i,l){return!function throwIfWhitespace(i){if(i.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}(l),i.classList.contains(l)}function addClass(i,...l){return i.classList.add(...l.reduce(((i,l)=>i.concat(l.split(/\s+/))),[])),i}function removeClass(i,...l){return i?(i.classList.remove(...l.reduce(((i,l)=>i.concat(l.split(/\s+/))),[])),i):($e.warn("removeClass was called with an element that doesn't exist"),null)}function toggleClass(i,l,d){return"function"==typeof d&&(d=d(i,l)),"boolean"!=typeof d&&(d=void 0),l.split(/\s+/).forEach((l=>i.classList.toggle(l,d))),i}function setAttributes(i,l){Object.getOwnPropertyNames(l).forEach((function(d){const u=l[d];null==u||!1===u?i.removeAttribute(d):i.setAttribute(d,!0===u?"":u)}))}function getAttributes(i){const l={},d=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(i&&i.attributes&&i.attributes.length>0){const u=i.attributes;for(let i=u.length-1;i>=0;i--){const c=u[i].name;let h=u[i].value;d.includes(c)&&(h=null!==h),l[c]=h}}return l}function getAttribute(i,l){return i.getAttribute(l)}function setAttribute(i,l,d){i.setAttribute(l,d)}function removeAttribute(i,l){i.removeAttribute(l)}function blockTextSelection(){g().body.focus(),g().onselectstart=function(){return!1}}function unblockTextSelection(){g().onselectstart=function(){return!0}}function getBoundingClientRect(i){if(i&&i.getBoundingClientRect&&i.parentNode){const l=i.getBoundingClientRect(),d={};return["bottom","height","left","right","top","width"].forEach((i=>{void 0!==l[i]&&(d[i]=l[i])})),d.height||(d.height=parseFloat(computedStyle(i,"height"))),d.width||(d.width=parseFloat(computedStyle(i,"width"))),d}}function findPosition(i){if(!i||i&&!i.offsetParent)return{left:0,top:0,width:0,height:0};const l=i.offsetWidth,d=i.offsetHeight;let u=0,c=0;for(;i.offsetParent&&i!==g()[Be.fullscreenElement];)u+=i.offsetLeft,c+=i.offsetTop,i=i.offsetParent;return{left:u,top:c,width:l,height:d}}function getPointerPosition(i,l){const d={x:0,y:0};if(ft){let l=i;for(;l&&"html"!==l.nodeName.toLowerCase();){const i=computedStyle(l,"transform");if(/^matrix/.test(i)){const l=i.slice(7,-1).split(/,\s/).map(Number);d.x+=l[4],d.y+=l[5]}else if(/^matrix3d/.test(i)){const l=i.slice(9,-1).split(/,\s/).map(Number);d.x+=l[12],d.y+=l[13]}if(l.assignedSlot&&l.assignedSlot.parentElement&&p().WebKitCSSMatrix){const i=p().getComputedStyle(l.assignedSlot.parentElement).transform,u=new(p().WebKitCSSMatrix)(i);d.x+=u.m41,d.y+=u.m42}l=l.parentNode||l.host}}const u={},c=findPosition(l.target),h=findPosition(i),m=h.width;let g=l.offsetY-(h.top-c.top),y=l.offsetX-(h.left-c.left);return l.changedTouches&&(y=l.changedTouches[0].pageX-h.left,g=l.changedTouches[0].pageY+h.top,ft&&(y-=d.x,g-=d.y)),u.y=1-Math.max(0,Math.min(1,g/h.height)),u.x=Math.max(0,Math.min(1,y/m)),u}function isTextNode(i){return video_es_isObject(i)&&3===i.nodeType}function emptyEl(i){for(;i.firstChild;)i.removeChild(i.firstChild);return i}function normalizeContent(i){return"function"==typeof i&&(i=i()),(Array.isArray(i)?i:[i]).map((i=>("function"==typeof i&&(i=i()),isEl(i)||isTextNode(i)?i:"string"==typeof i&&/\S/.test(i)?g().createTextNode(i):void 0))).filter((i=>i))}function appendContent(i,l){return normalizeContent(l).forEach((l=>i.appendChild(l))),i}function insertContent(i,l){return appendContent(emptyEl(i),l)}function isSingleLeftClick(i){return void 0===i.button&&void 0===i.buttons||(0===i.button&&void 0===i.buttons||("mouseup"===i.type&&0===i.button&&0===i.buttons||("mousedown"===i.type&&0===i.button&&0===i.buttons||0===i.button&&1===i.buttons)))}const _t=createQuerier("querySelector"),vt=createQuerier("querySelectorAll");function computedStyle(i,l){if(!i||!l)return"";if("function"==typeof p().getComputedStyle){let d;try{d=p().getComputedStyle(i)}catch(i){return""}return d?d.getPropertyValue(l)||d[l]:""}return""}function copyStyleSheetsToWindow(i){[...g().styleSheets].forEach((l=>{try{const d=[...l.cssRules].map((i=>i.cssText)).join(""),u=g().createElement("style");u.textContent=d,i.document.head.appendChild(u)}catch(d){const u=g().createElement("link");u.rel="stylesheet",u.type=l.type,u.media=l.media.mediaText,u.href=l.href,i.document.head.appendChild(u)}}))}var bt=Object.freeze({__proto__:null,isReal,isEl,isInFrame,createEl,textContent,prependTo,hasClass,addClass,removeClass,toggleClass,setAttributes,getAttributes,getAttribute,setAttribute,removeAttribute,blockTextSelection,unblockTextSelection,getBoundingClientRect,findPosition,getPointerPosition,isTextNode,emptyEl,normalizeContent,appendContent,insertContent,isSingleLeftClick,$:_t,$$:vt,computedStyle,copyStyleSheetsToWindow});let Tt,St=!1;const autoSetup=function(){if(!1===Tt.options.autoSetup)return;const i=Array.prototype.slice.call(g().getElementsByTagName("video")),l=Array.prototype.slice.call(g().getElementsByTagName("audio")),d=Array.prototype.slice.call(g().getElementsByTagName("video-js")),u=i.concat(l,d);if(u&&u.length>0)for(let i=0,l=u.length;i<l;i++){const l=u[i];if(!l||!l.getAttribute){autoSetupTimeout(1);break}if(void 0===l.player){null!==l.getAttribute("data-setup")&&Tt(l)}}else St||autoSetupTimeout(1)};function autoSetupTimeout(i,l){isReal()&&(l&&(Tt=l),p().setTimeout(autoSetup,i))}function setWindowLoaded(){St=!0,p().removeEventListener("load",setWindowLoaded)}isReal()&&("complete"===g().readyState?setWindowLoaded():p().addEventListener("load",setWindowLoaded));const createStyleElement=function(i){const l=g().createElement("style");return l.className=i,l},setTextContent=function(i,l){i.styleSheet?i.styleSheet.cssText=l:i.textContent=l};var Et=new WeakMap;let kt,wt=3;function newGUID(){return wt++}function _cleanUpEvents(i,l){if(!Et.has(i))return;const d=Et.get(i);0===d.handlers[l].length&&(delete d.handlers[l],i.removeEventListener?i.removeEventListener(l,d.dispatcher,!1):i.detachEvent&&i.detachEvent("on"+l,d.dispatcher)),Object.getOwnPropertyNames(d.handlers).length<=0&&(delete d.handlers,delete d.dispatcher,delete d.disabled),0===Object.getOwnPropertyNames(d).length&&Et.delete(i)}function _handleMultipleEvents(i,l,d,u){d.forEach((function(d){i(l,d,u)}))}function fixEvent(i){if(i.fixed_)return i;function returnTrue(){return!0}function returnFalse(){return!1}if(!i||!i.isPropagationStopped||!i.isImmediatePropagationStopped){const l=i||p().event;i={};const d=["layerX","layerY","keyLocation","path","webkitMovementX","webkitMovementY","mozPressure","mozInputSource"];for(const u in l)d.includes(u)||"returnValue"===u&&l.preventDefault||(i[u]=l[u]);if(i.target||(i.target=i.srcElement||g()),i.relatedTarget||(i.relatedTarget=i.fromElement===i.target?i.toElement:i.fromElement),i.preventDefault=function(){l.preventDefault&&l.preventDefault(),i.returnValue=!1,l.returnValue=!1,i.defaultPrevented=!0},i.defaultPrevented=!1,i.stopPropagation=function(){l.stopPropagation&&l.stopPropagation(),i.cancelBubble=!0,l.cancelBubble=!0,i.isPropagationStopped=returnTrue},i.isPropagationStopped=returnFalse,i.stopImmediatePropagation=function(){l.stopImmediatePropagation&&l.stopImmediatePropagation(),i.isImmediatePropagationStopped=returnTrue,i.stopPropagation()},i.isImmediatePropagationStopped=returnFalse,null!=i.clientX){const l=g().documentElement,d=g().body;i.pageX=i.clientX+(l&&l.scrollLeft||d&&d.scrollLeft||0)-(l&&l.clientLeft||d&&d.clientLeft||0),i.pageY=i.clientY+(l&&l.scrollTop||d&&d.scrollTop||0)-(l&&l.clientTop||d&&d.clientTop||0)}i.which=i.charCode||i.keyCode,null!=i.button&&(i.button=1&i.button?0:4&i.button?1:2&i.button?2:0)}return i.fixed_=!0,i}const Ct=["touchstart","touchmove"];function on(i,l,d){if(Array.isArray(l))return _handleMultipleEvents(on,i,l,d);Et.has(i)||Et.set(i,{});const u=Et.get(i);if(u.handlers||(u.handlers={}),u.handlers[l]||(u.handlers[l]=[]),d.guid||(d.guid=newGUID()),u.handlers[l].push(d),u.dispatcher||(u.disabled=!1,u.dispatcher=function(l,d){if(u.disabled)return;l=fixEvent(l);const c=u.handlers[l.type];if(c){const u=c.slice(0);for(let c=0,h=u.length;c<h&&!l.isImmediatePropagationStopped();c++)try{u[c].call(i,l,d)}catch(i){$e.error(i)}}}),1===u.handlers[l].length)if(i.addEventListener){let d=!1;(function(){if("boolean"!=typeof kt){kt=!1;try{const i=Object.defineProperty({},"passive",{get(){kt=!0}});p().addEventListener("test",null,i),p().removeEventListener("test",null,i)}catch(i){}}return kt})()&&Ct.indexOf(l)>-1&&(d={passive:!0}),i.addEventListener(l,u.dispatcher,d)}else i.attachEvent&&i.attachEvent("on"+l,u.dispatcher)}function off(i,l,d){if(!Et.has(i))return;const u=Et.get(i);if(!u.handlers)return;if(Array.isArray(l))return _handleMultipleEvents(off,i,l,d);const removeType=function(i,l){u.handlers[l]=[],_cleanUpEvents(i,l)};if(void 0===l){for(const l in u.handlers)Object.prototype.hasOwnProperty.call(u.handlers||{},l)&&removeType(i,l);return}const c=u.handlers[l];if(c){if(!d)return removeType(i,l),void 0;if(d.guid)for(let i=0;i<c.length;i++)c[i].guid===d.guid&&c.splice(i--,1);_cleanUpEvents(i,l)}}function trigger(i,l,d){const u=Et.has(i)?Et.get(i):{},c=i.parentNode||i.ownerDocument;if("string"==typeof l?l={type:l,target:i}:l.target||(l.target=i),l=fixEvent(l),u.dispatcher&&u.dispatcher.call(i,l,d),c&&!l.isPropagationStopped()&&!0===l.bubbles)trigger.call(null,c,l,d);else if(!c&&!l.defaultPrevented&&l.target&&l.target[l.type]){Et.has(l.target)||Et.set(l.target,{});const i=Et.get(l.target);l.target[l.type]&&(i.disabled=!0,"function"==typeof l.target[l.type]&&l.target[l.type](),i.disabled=!1)}return!l.defaultPrevented}function one(i,l,d){if(Array.isArray(l))return _handleMultipleEvents(one,i,l,d);const func=function(){off(i,l,func),d.apply(this,arguments)};func.guid=d.guid=d.guid||newGUID(),on(i,l,func)}function any(i,l,d){const func=function(){off(i,l,func),d.apply(this,arguments)};func.guid=d.guid=d.guid||newGUID(),on(i,l,func)}var xt=Object.freeze({__proto__:null,fixEvent,on,off,trigger,one,any});const At=30,bind_=function(i,l,d){l.guid||(l.guid=newGUID());const u=l.bind(i);return u.guid=d?d+"_"+l.guid:l.guid,u},throttle=function(i,l){let d=p().performance.now();return function(...u){const c=p().performance.now();c-d>=l&&(i(...u),d=c)}},debounce$1=function(i,l,d,u=p()){let c;const debounced=function(){const h=this,p=arguments;let later=function(){c=null,later=null,d||i.apply(h,p)};!c&&d&&i.apply(h,p),u.clearTimeout(c),c=u.setTimeout(later,l)};return debounced.cancel=()=>{u.clearTimeout(c),c=null},debounced};var Pt=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:At,bind_,throttle,debounce:debounce$1});let It;class EventTarget$2{on(i,l){const d=this.addEventListener;this.addEventListener=()=>{},on(this,i,l),this.addEventListener=d}off(i,l){off(this,i,l)}one(i,l){const d=this.addEventListener;this.addEventListener=()=>{},one(this,i,l),this.addEventListener=d}any(i,l){const d=this.addEventListener;this.addEventListener=()=>{},any(this,i,l),this.addEventListener=d}trigger(i){const l=i.type||i;"string"==typeof i&&(i={type:l}),i=fixEvent(i),this.allowedEvents_[l]&&this["on"+l]&&this["on"+l](i),trigger(this,i)}queueTrigger(i){It||(It=new Map);const l=i.type||i;let d=It.get(this);d||(d=new Map,It.set(this,d));const u=d.get(l);d.delete(l),p().clearTimeout(u);const c=p().setTimeout((()=>{d.delete(l),0===d.size&&(d=null,It.delete(this)),this.trigger(i)}),0);d.set(l,c)}}EventTarget$2.prototype.allowedEvents_={},EventTarget$2.prototype.addEventListener=EventTarget$2.prototype.on,EventTarget$2.prototype.removeEventListener=EventTarget$2.prototype.off,EventTarget$2.prototype.dispatchEvent=EventTarget$2.prototype.trigger;const objName=i=>"function"==typeof i.name?i.name():"string"==typeof i.name?i.name:i.name_?i.name_:i.constructor&&i.constructor.name?i.constructor.name:typeof i,isEvented=i=>i instanceof EventTarget$2||!!i.eventBusEl_&&["on","one","off","trigger"].every((l=>"function"==typeof i[l])),isValidEventType=i=>"string"==typeof i&&/\S/.test(i)||Array.isArray(i)&&!!i.length,validateTarget=(i,l,d)=>{if(!i||!i.nodeName&&!isEvented(i))throw new Error(`Invalid target for ${objName(l)}#${d}; must be a DOM node or evented object.`)},validateEventType=(i,l,d)=>{if(!isValidEventType(i))throw new Error(`Invalid event type for ${objName(l)}#${d}; must be a non-empty string or array.`)},validateListener=(i,l,d)=>{if("function"!=typeof i)throw new Error(`Invalid listener for ${objName(l)}#${d}; must be a function.`)},normalizeListenArgs=(i,l,d)=>{const u=l.length<3||l[0]===i||l[0]===i.eventBusEl_;let c,h,p;return u?(c=i.eventBusEl_,l.length>=3&&l.shift(),[h,p]=l):(c=l[0],h=l[1],p=l[2]),validateTarget(c,i,d),validateEventType(h,i,d),validateListener(p,i,d),p=bind_(i,p),{isTargetingSelf:u,target:c,type:h,listener:p}},listen=(i,l,d,u)=>{validateTarget(i,i,l),i.nodeName?xt[l](i,d,u):i[l](d,u)},Dt={on(...i){const{isTargetingSelf:l,target:d,type:u,listener:c}=normalizeListenArgs(this,i,"on");if(listen(d,"on",u,c),!l){const removeListenerOnDispose=()=>this.off(d,u,c);removeListenerOnDispose.guid=c.guid;const removeRemoverOnTargetDispose=()=>this.off("dispose",removeListenerOnDispose);removeRemoverOnTargetDispose.guid=c.guid,listen(this,"on","dispose",removeListenerOnDispose),listen(d,"on","dispose",removeRemoverOnTargetDispose)}},one(...i){const{isTargetingSelf:l,target:d,type:u,listener:c}=normalizeListenArgs(this,i,"one");if(l)listen(d,"one",u,c);else{const wrapper=(...i)=>{this.off(d,u,wrapper),c.apply(null,i)};wrapper.guid=c.guid,listen(d,"one",u,wrapper)}},any(...i){const{isTargetingSelf:l,target:d,type:u,listener:c}=normalizeListenArgs(this,i,"any");if(l)listen(d,"any",u,c);else{const wrapper=(...i)=>{this.off(d,u,wrapper),c.apply(null,i)};wrapper.guid=c.guid,listen(d,"any",u,wrapper)}},off(i,l,d){if(!i||isValidEventType(i))off(this.eventBusEl_,i,l);else{const u=i,c=l;validateTarget(u,this,"off"),validateEventType(c,this,"off"),validateListener(d,this,"off"),d=bind_(this,d),this.off("dispose",d),u.nodeName?(off(u,c,d),off(u,"dispose",d)):isEvented(u)&&(u.off(c,d),u.off("dispose",d))}},trigger(i,l){validateTarget(this.eventBusEl_,this,"trigger");if(!isValidEventType(i&&"string"!=typeof i?i.type:i))throw new Error(`Invalid event type for ${objName(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return trigger(this.eventBusEl_,i,l)}};function evented(i,l={}){const{eventBusKey:d}=l;if(d){if(!i[d].nodeName)throw new Error(`The eventBusKey "${d}" does not refer to an element.`);i.eventBusEl_=i[d]}else i.eventBusEl_=createEl("span",{className:"vjs-event-bus"});return Object.assign(i,Dt),i.eventedCallbacks&&i.eventedCallbacks.forEach((i=>{i()})),i.on("dispose",(()=>{i.off(),[i,i.el_,i.eventBusEl_].forEach((function(i){i&&Et.has(i)&&Et.delete(i)})),p().setTimeout((()=>{i.eventBusEl_=null}),0)})),i}const Ot={state:{},setState(i){let l;return"function"==typeof i&&(i=i()),each(i,((i,d)=>{this.state[d]!==i&&(l=l||{},l[d]={from:this.state[d],to:i}),this.state[d]=i})),l&&isEvented(this)&&this.trigger({changes:l,type:"statechanged"}),l}};function stateful(i,l){return Object.assign(i,Ot),i.state=Object.assign({},i.state,l),"function"==typeof i.handleStateChanged&&isEvented(i)&&i.on("statechanged",i.handleStateChanged),i}const toLowerCase=function(i){return"string"!=typeof i?i:i.replace(/./,(i=>i.toLowerCase()))},toTitleCase$1=function(i){return"string"!=typeof i?i:i.replace(/./,(i=>i.toUpperCase()))},titleCaseEquals=function(i,l){return toTitleCase$1(i)===toTitleCase$1(l)};var Lt=Object.freeze({__proto__:null,toLowerCase,toTitleCase:toTitleCase$1,titleCaseEquals});class Component$1{constructor(i,l,d){if(this.player_=!i&&this.play?i=this:i,this.isDisposed_=!1,this.parentComponent_=null,this.options_=merge$1({},this.options_),l=this.options_=merge$1(this.options_,l),this.id_=l.id||l.el&&l.el.id,!this.id_){const l=i&&i.id&&i.id()||"no_player";this.id_=`${l}_component_${newGUID()}`}this.name_=l.name||null,l.el?this.el_=l.el:!1!==l.createEl&&(this.el_=this.createEl()),l.className&&this.el_&&l.className.split(" ").forEach((i=>this.addClass(i))),["on","off","one","any","trigger"].forEach((i=>{this[i]=void 0})),!1!==l.evented&&(evented(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),stateful(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,!1!==l.initChildren&&this.initChildren(),this.ready(d),!1!==l.reportTouchActivity&&this.enableTouchActivity()}dispose(i={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let i=this.children_.length-1;i>=0;i--)this.children_[i].dispose&&this.children_[i].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(i.restoreEl?this.el_.parentNode.replaceChild(i.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(i){return i?(this.options_=merge$1(this.options_,i),this.options_):this.options_}el(){return this.el_}createEl(i,l,d){return createEl(i,l,d)}localize(i,l,d=i){const u=this.player_.language&&this.player_.language(),c=this.player_.languages&&this.player_.languages(),h=c&&c[u],p=u&&u.split("-")[0],m=c&&c[p];let g=d;return h&&h[i]?g=h[i]:m&&m[i]&&(g=m[i]),l&&(g=g.replace(/\{(\d+)\}/g,(function(i,d){const u=l[d-1];let c=u;return void 0===u&&(c=i),c}))),g}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(i){return this.childIndex_[i]}getChild(i){if(i)return this.childNameIndex_[i]}getDescendant(...i){i=i.reduce(((i,l)=>i.concat(l)),[]);let l=this;for(let d=0;d<i.length;d++)if(l=l.getChild(i[d]),!l||!l.getChild)return;return l}setIcon(i,l=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const d="http://www.w3.org/2000/svg",u=createEl("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),c=g().createElementNS(d,"svg");c.setAttributeNS(null,"viewBox","0 0 512 512");const h=g().createElementNS(d,"use");return c.appendChild(h),h.setAttributeNS(null,"href",`#vjs-icon-${i}`),u.appendChild(c),this.iconIsSet_?l.replaceChild(u,l.querySelector(".vjs-icon-placeholder")):l.appendChild(u),this.iconIsSet_=!0,u}addChild(i,l={},d=this.children_.length){let u,c;if("string"==typeof i){c=toTitleCase$1(i);const d=l.componentClass||c;l.name=c;const h=Component$1.getComponent(d);if(!h)throw new Error(`Component ${d} does not exist`);if("function"!=typeof h)return null;u=new h(this.player_||this,l)}else u=i;if(u.parentComponent_&&u.parentComponent_.removeChild(u),this.children_.splice(d,0,u),u.parentComponent_=this,"function"==typeof u.id&&(this.childIndex_[u.id()]=u),c=c||u.name&&toTitleCase$1(u.name()),c&&(this.childNameIndex_[c]=u,this.childNameIndex_[toLowerCase(c)]=u),"function"==typeof u.el&&u.el()){let i=null;this.children_[d+1]&&(this.children_[d+1].el_?i=this.children_[d+1].el_:isEl(this.children_[d+1])&&(i=this.children_[d+1])),this.contentEl().insertBefore(u.el(),i)}return u}removeChild(i){if("string"==typeof i&&(i=this.getChild(i)),!i||!this.children_)return;let l=!1;for(let d=this.children_.length-1;d>=0;d--)if(this.children_[d]===i){l=!0,this.children_.splice(d,1);break}if(!l)return;i.parentComponent_=null,this.childIndex_[i.id()]=null,this.childNameIndex_[toTitleCase$1(i.name())]=null,this.childNameIndex_[toLowerCase(i.name())]=null;const d=i.el();d&&d.parentNode===this.contentEl()&&this.contentEl().removeChild(i.el())}initChildren(){const i=this.options_.children;if(i){const l=this.options_,handleAdd=i=>{const d=i.name;let u=i.opts;if(void 0!==l[d]&&(u=l[d]),!1===u)return;!0===u&&(u={}),u.playerOptions=this.options_.playerOptions;const c=this.addChild(d,u);c&&(this[d]=c)};let d;const u=Component$1.getComponent("Tech");d=Array.isArray(i)?i:Object.keys(i),d.concat(Object.keys(this.options_).filter((function(i){return!d.some((function(l){return"string"==typeof l?i===l:i===l.name}))}))).map((l=>{let d,u;return"string"==typeof l?(d=l,u=i[d]||this.options_[d]||{}):(d=l.name,u=l),{name:d,opts:u}})).filter((i=>{const l=Component$1.getComponent(i.opts.componentClass||toTitleCase$1(i.name));return l&&!u.isTech(l)})).forEach(handleAdd)}}buildCSSClass(){return""}ready(i,l=!1){if(i)return this.isReady_?(l?i.call(this):this.setTimeout(i,1),void 0):(this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(i),void 0)}triggerReady(){this.isReady_=!0,this.setTimeout((function(){const i=this.readyQueue_;this.readyQueue_=[],i&&i.length>0&&i.forEach((function(i){i.call(this)}),this),this.trigger("ready")}),1)}$(i,l){return _t(i,l||this.contentEl())}$$(i,l){return vt(i,l||this.contentEl())}hasClass(i){return hasClass(this.el_,i)}addClass(...i){addClass(this.el_,...i)}removeClass(...i){removeClass(this.el_,...i)}toggleClass(i,l){toggleClass(this.el_,i,l)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(i){return getAttribute(this.el_,i)}setAttribute(i,l){setAttribute(this.el_,i,l)}removeAttribute(i){removeAttribute(this.el_,i)}width(i,l){return this.dimension("width",i,l)}height(i,l){return this.dimension("height",i,l)}dimensions(i,l){this.width(i,!0),this.height(l)}dimension(i,l,d){if(void 0!==l)return null!==l&&l==l||(l=0),this.el_.style[i]=-1!==(""+l).indexOf("%")||-1!==(""+l).indexOf("px")?l:"auto"===l?"":l+"px",d||this.trigger("componentresize"),void 0;if(!this.el_)return 0;const u=this.el_.style[i],c=u.indexOf("px");return-1!==c?parseInt(u.slice(0,c),10):parseInt(this.el_["offset"+toTitleCase$1(i)],10)}currentDimension(i){let l=0;if("width"!==i&&"height"!==i)throw new Error("currentDimension only accepts width or height value");if(l=computedStyle(this.el_,i),l=parseFloat(l),0===l||isNaN(l)){const d=`offset${toTitleCase$1(i)}`;l=this.el_[d]}return l}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}getPositions(){const i=this.el_.getBoundingClientRect();return{boundingClientRect:{x:i.x,y:i.y,width:i.width,height:i.height,top:i.top,right:i.right,bottom:i.bottom,left:i.left},center:{x:i.left+i.width/2,y:i.top+i.height/2,width:0,height:0,top:i.top+i.height/2,right:i.left+i.width/2,bottom:i.top+i.height/2,left:i.left+i.width/2}}}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(i){this.player_&&("Tab"===i.key||this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled||i.stopPropagation(),this.player_.handleKeyDown(i))}handleKeyPress(i){this.handleKeyDown(i)}emitTapEvents(){let i=0,l=null;let d;this.on("touchstart",(function(u){1===u.touches.length&&(l={pageX:u.touches[0].pageX,pageY:u.touches[0].pageY},i=p().performance.now(),d=!0)})),this.on("touchmove",(function(i){if(i.touches.length>1)d=!1;else if(l){const u=i.touches[0].pageX-l.pageX,c=i.touches[0].pageY-l.pageY;Math.sqrt(u*u+c*c)>10&&(d=!1)}}));const noTap=function(){d=!1};this.on("touchleave",noTap),this.on("touchcancel",noTap),this.on("touchend",(function(u){if(l=null,!0===d){p().performance.now()-i<200&&(u.preventDefault(),this.trigger("tap"))}}))}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const i=bind_(this.player(),this.player().reportUserActivity);let l;this.on("touchstart",(function(){i(),this.clearInterval(l),l=this.setInterval(i,250)}));const touchEnd=function(d){i(),this.clearInterval(l)};this.on("touchmove",i),this.on("touchend",touchEnd),this.on("touchcancel",touchEnd)}setTimeout(i,l){var d;return i=bind_(this,i),this.clearTimersOnDispose_(),d=p().setTimeout((()=>{this.setTimeoutIds_.has(d)&&this.setTimeoutIds_.delete(d),i()}),l),this.setTimeoutIds_.add(d),d}clearTimeout(i){return this.setTimeoutIds_.has(i)&&(this.setTimeoutIds_.delete(i),p().clearTimeout(i)),i}setInterval(i,l){i=bind_(this,i),this.clearTimersOnDispose_();const d=p().setInterval(i,l);return this.setIntervalIds_.add(d),d}clearInterval(i){return this.setIntervalIds_.has(i)&&(this.setIntervalIds_.delete(i),p().clearInterval(i)),i}requestAnimationFrame(i){var l;return this.clearTimersOnDispose_(),i=bind_(this,i),l=p().requestAnimationFrame((()=>{this.rafIds_.has(l)&&this.rafIds_.delete(l),i()})),this.rafIds_.add(l),l}requestNamedAnimationFrame(i,l){this.namedRafs_.has(i)&&this.cancelNamedAnimationFrame(i),this.clearTimersOnDispose_(),l=bind_(this,l);const d=this.requestAnimationFrame((()=>{l(),this.namedRafs_.has(i)&&this.namedRafs_.delete(i)}));return this.namedRafs_.set(i,d),i}cancelNamedAnimationFrame(i){this.namedRafs_.has(i)&&(this.cancelAnimationFrame(this.namedRafs_.get(i)),this.namedRafs_.delete(i))}cancelAnimationFrame(i){return this.rafIds_.has(i)&&(this.rafIds_.delete(i),p().cancelAnimationFrame(i)),i}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",(()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((([i,l])=>{this[i].forEach(((i,d)=>this[l](d)))})),this.clearingTimersOnDispose_=!1})))}getIsDisabled(){return Boolean(this.el_.disabled)}getIsExpresslyInert(){return this.el_.inert&&!this.el_.ownerDocument.documentElement.inert}getIsFocusable(i){return(i||this.el_).tabIndex>=0&&!(this.getIsDisabled()||this.getIsExpresslyInert())}getIsAvailableToBeFocused(i){function isVisibleStyleProperty(i){const l=p().getComputedStyle(i,null),d=l.getPropertyValue("visibility");return"none"!==l.getPropertyValue("display")&&!["hidden","collapse"].includes(d)}return i||(i=this.el()),!(!function isVisible(i){if(i.offsetWidth+i.offsetHeight+i.getBoundingClientRect().height+i.getBoundingClientRect().width===0)return!1;const l={x:i.getBoundingClientRect().left+i.offsetWidth/2,y:i.getBoundingClientRect().top+i.offsetHeight/2};if(l.x<0)return!1;if(l.x>(g().documentElement.clientWidth||p().innerWidth))return!1;if(l.y<0)return!1;if(l.y>(g().documentElement.clientHeight||p().innerHeight))return!1;let d=g().elementFromPoint(l.x,l.y);for(;d;){if(d===i)return!0;if(!d.parentNode)return!1;d=d.parentNode}}(i)||!function isBeingRendered(i){return!!isVisibleStyleProperty(i.parentElement)&&!(!isVisibleStyleProperty(i)||"0"===i.style.opacity||"0px"===p().getComputedStyle(i).height||"0px"===p().getComputedStyle(i).width)}(i)||i.parentElement&&!(i.tabIndex>=0))}static registerComponent(i,l){if("string"!=typeof i||!i)throw new Error(`Illegal component name, "${i}"; must be a non-empty string.`);const d=Component$1.getComponent("Tech"),u=d&&d.isTech(l),c=Component$1===l||Component$1.prototype.isPrototypeOf(l.prototype);if(u||!c){let l;throw l=u?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error(`Illegal component, "${i}"; ${l}.`)}i=toTitleCase$1(i),Component$1.components_||(Component$1.components_={});const h=Component$1.getComponent("Player");if("Player"===i&&h&&h.players){const i=h.players,l=Object.keys(i);if(i&&l.length>0&&l.map((l=>i[l])).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return Component$1.components_[i]=l,Component$1.components_[toLowerCase(i)]=l,l}static getComponent(i){if(i&&Component$1.components_)return Component$1.components_[i]}}function getRange(i,l,d,u){return!function rangeCheck(i,l,d){if("number"!=typeof l||l<0||l>d)throw new Error(`Failed to execute '${i}' on 'TimeRanges': The index provided (${l}) is non-numeric or out of bounds (0-${d}).`)}(i,u,d.length-1),d[u][l]}function createTimeRangesObj(i){let l;return l=void 0===i||0===i.length?{length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:{length:i.length,start:getRange.bind(null,"start",0,i),end:getRange.bind(null,"end",1,i)},p().Symbol&&p().Symbol.iterator&&(l[p().Symbol.iterator]=()=>(i||[]).values()),l}function createTimeRanges$1(i,l){return Array.isArray(i)?createTimeRangesObj(i):void 0===i||void 0===l?createTimeRangesObj():createTimeRangesObj([[i,l]])}Component$1.registerComponent("Component",Component$1);const defaultImplementation=function(i,l){i=i<0?0:i;let d=Math.floor(i%60),u=Math.floor(i/60%60),c=Math.floor(i/3600);const h=Math.floor(l/60%60),p=Math.floor(l/3600);return(isNaN(i)||i===1/0)&&(c=u=d="-"),c=c>0||p>0?c+":":"",u=((c||h>=10)&&u<10?"0"+u:u)+":",d=d<10?"0"+d:d,c+u+d};let Rt=defaultImplementation;function setFormatTime(i){Rt=i}function resetFormatTime(){Rt=defaultImplementation}function formatTime(i,l=i){return Rt(i,l)}var Vt=Object.freeze({__proto__:null,createTimeRanges:createTimeRanges$1,createTimeRange:createTimeRanges$1,setFormatTime,resetFormatTime,formatTime});function bufferedPercent(i,l){let d,u,c=0;if(!l)return 0;i&&i.length||(i=createTimeRanges$1(0,0));for(let h=0;h<i.length;h++)d=i.start(h),u=i.end(h),u>l&&(u=l),c+=u-d;return c/l}function MediaError(i){if(i instanceof MediaError)return i;"number"==typeof i?this.code=i:"string"==typeof i?this.message=i:video_es_isObject(i)&&("number"==typeof i.code&&(this.code=i.code),Object.assign(this,i)),this.message||(this.message=MediaError.defaultMessages[this.code]||"")}function isPromise(i){return null!=i&&"function"==typeof i.then}function silencePromise(i){isPromise(i)&&i.then(null,(i=>{}))}MediaError.prototype.code=0,MediaError.prototype.message="",MediaError.prototype.status=null,MediaError.prototype.metadata=null,MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],MediaError.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."},MediaError.MEDIA_ERR_CUSTOM=0,MediaError.prototype.MEDIA_ERR_CUSTOM=0,MediaError.MEDIA_ERR_ABORTED=1,MediaError.prototype.MEDIA_ERR_ABORTED=1,MediaError.MEDIA_ERR_NETWORK=2,MediaError.prototype.MEDIA_ERR_NETWORK=2,MediaError.MEDIA_ERR_DECODE=3,MediaError.prototype.MEDIA_ERR_DECODE=3,MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED=4,MediaError.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4,MediaError.MEDIA_ERR_ENCRYPTED=5,MediaError.prototype.MEDIA_ERR_ENCRYPTED=5;const trackToJson_=function(i){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(((l,d,u)=>(i[d]&&(l[d]=i[d]),l)),{cues:i.cues&&Array.prototype.map.call(i.cues,(function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}}))})};var textTrackConverter_textTracksToJson=function(i){const l=i.$$("track"),d=Array.prototype.map.call(l,(i=>i.track));return Array.prototype.map.call(l,(function(i){const l=trackToJson_(i.track);return i.src&&(l.src=i.src),l})).concat(Array.prototype.filter.call(i.textTracks(),(function(i){return-1===d.indexOf(i)})).map(trackToJson_))},textTrackConverter_jsonToTextTracks=function(i,l){return i.forEach((function(i){const d=l.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach((i=>d.addCue(i)))})),l.textTracks()};const Mt="vjs-modal-dialog";class ModalDialog extends Component$1{constructor(i,l){super(i,l),this.handleKeyDown_=i=>this.handleKeyDown(i),this.close_=i=>this.close(i),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=createEl("div",{className:`${Mt}-content`},{role:"document"}),this.descEl_=createEl("p",{className:`${Mt}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),textContent(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${Mt} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let i=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(i+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),i}open(){if(this.opened_)return this.options_.fillAlways&&this.fill(),void 0;const i=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!i.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&i.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=i.controls(),i.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}opened(i){return"boolean"==typeof i&&this[i?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const i=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&i.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&i.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger({type:"modalclose",bubbles:!0}),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(i){if("boolean"==typeof i){const l=this.closeable_=!!i;let d=this.getChild("closeButton");if(l&&!d){const i=this.contentEl_;this.contentEl_=this.el_,d=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(d,"close",this.close_)}!l&&d&&(this.off(d,"close",this.close_),this.removeChild(d),d.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(i){const l=this.contentEl(),d=l.parentNode,u=l.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,d.removeChild(l),this.empty(),insertContent(l,i),this.trigger("modalfill"),u?d.insertBefore(l,u):d.appendChild(l);const c=this.getChild("closeButton");c&&d.appendChild(c.el_),this.trigger("aftermodalfill")}empty(){this.trigger("beforemodalempty"),emptyEl(this.contentEl()),this.trigger("modalempty")}content(i){return void 0!==i&&(this.content_=i),this.content_}conditionalFocus_(){const i=g().activeElement,l=this.player_.el_;this.previouslyActiveEl_=null,(l.contains(i)||l===i)&&(this.previouslyActiveEl_=i,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(i){if(this.trigger({type:"modalKeydown",originalEvent:i,target:this,bubbles:!0}),i.stopPropagation(),"Escape"===i.key&&this.closeable())return i.preventDefault(),this.close(),void 0;if("Tab"!==i.key)return;const l=this.focusableEls_(),d=this.el_.querySelector(":focus");let u;for(let i=0;i<l.length;i++)if(d===l[i]){u=i;break}g().activeElement===this.el_&&(u=0),i.shiftKey&&0===u?(l[l.length-1].focus(),i.preventDefault()):i.shiftKey||u!==l.length-1||(l[0].focus(),i.preventDefault())}focusableEls_(){const i=this.el_.querySelectorAll("*");return Array.prototype.filter.call(i,(i=>(i instanceof p().HTMLAnchorElement||i instanceof p().HTMLAreaElement)&&i.hasAttribute("href")||(i instanceof p().HTMLInputElement||i instanceof p().HTMLSelectElement||i instanceof p().HTMLTextAreaElement||i instanceof p().HTMLButtonElement)&&!i.hasAttribute("disabled")||i instanceof p().HTMLIFrameElement||i instanceof p().HTMLObjectElement||i instanceof p().HTMLEmbedElement||i.hasAttribute("tabindex")&&-1!==i.getAttribute("tabindex")||i.hasAttribute("contenteditable")))}}ModalDialog.prototype.options_={pauseOnOpen:!0,temporary:!0},Component$1.registerComponent("ModalDialog",ModalDialog);class TrackList extends EventTarget$2{constructor(i=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let l=0;l<i.length;l++)this.addTrack(i[l])}addTrack(i){const l=this.tracks_.length;""+l in this||Object.defineProperty(this,l,{get(){return this.tracks_[l]}}),-1===this.tracks_.indexOf(i)&&(this.tracks_.push(i),this.trigger({track:i,type:"addtrack",target:this})),i.labelchange_=()=>{this.trigger({track:i,type:"labelchange",target:this})},isEvented(i)&&i.addEventListener("labelchange",i.labelchange_)}removeTrack(i){let l;for(let d=0,u=this.length;d<u;d++)if(this[d]===i){l=this[d],l.off&&l.off(),this.tracks_.splice(d,1);break}l&&this.trigger({track:l,type:"removetrack",target:this})}getTrackById(i){let l=null;for(let d=0,u=this.length;d<u;d++){const u=this[d];if(u.id===i){l=u;break}}return l}}TrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const i in TrackList.prototype.allowedEvents_)TrackList.prototype["on"+i]=null;const disableOthers$1=function(i,l){for(let d=0;d<i.length;d++)Object.keys(i[d]).length&&l.id!==i[d].id&&(i[d].enabled=!1)};const disableOthers=function(i,l){for(let d=0;d<i.length;d++)Object.keys(i[d]).length&&l.id!==i[d].id&&(i[d].selected=!1)};class TextTrackList extends TrackList{addTrack(i){super.addTrack(i),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),i.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(i.kind)&&i.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(i){super.removeTrack(i),i.removeEventListener&&(this.queueChange_&&i.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&i.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class TextTrackCueList{constructor(i){TextTrackCueList.prototype.setCues_.call(this,i),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(i){const l=this.length||0;let d=0;const u=i.length;this.cues_=i,this.length_=i.length;const defineProp=function(i){""+i in this||Object.defineProperty(this,""+i,{get(){return this.cues_[i]}})};if(l<u)for(d=l;d<u;d++)defineProp.call(this,d)}getCueById(i){let l=null;for(let d=0,u=this.length;d<u;d++){const u=this[d];if(u.id===i){l=u;break}}return l}}const Nt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Ut={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Bt={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Ft={disabled:"disabled",hidden:"hidden",showing:"showing"};class Track extends EventTarget$2{constructor(i={}){super();const l={id:i.id||"vjs_track_"+newGUID(),kind:i.kind||"",language:i.language||""};let d=i.label||"";for(const i in l)Object.defineProperty(this,i,{get:()=>l[i],set(){}});Object.defineProperty(this,"label",{get:()=>d,set(i){i!==d&&(d=i,this.trigger("labelchange"))}})}}const parseUrl=function(i){return new URL(i,g().baseURI)},getAbsoluteURL=function(i){return new URL(i,g().baseURI).href},getFileExtension=function(i){if("string"==typeof i){const l=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(i);if(l)return l.pop().toLowerCase()}return""},isCrossOrigin=function(i,l=p().location){return parseUrl(i).origin!==l.origin};var jt=Object.freeze({__proto__:null,parseUrl,getAbsoluteURL,getFileExtension,isCrossOrigin});const parseCues=function(i,l){const d=new(p().WebVTT.Parser)(p(),p().vttjs,p().WebVTT.StringDecoder()),u=[];d.oncue=function(i){l.addCue(i)},d.onparsingerror=function(i){u.push(i)},d.onflush=function(){l.trigger({type:"loadeddata",target:l})},d.parse(i),u.length>0&&(p().console&&p().console.groupCollapsed&&p().console.groupCollapsed(`Text Track parsing errors for ${l.src}`),u.forEach((i=>$e.error(i))),p().console&&p().console.groupEnd&&p().console.groupEnd()),d.flush()},loadTrack=function(i,l){const d={uri:i},u=isCrossOrigin(i);u&&(d.cors=u);const c="use-credentials"===l.tech_.crossOrigin();c&&(d.withCredentials=c),_()(d,bind_(this,(function(i,d,u){if(i)return $e.error(i,d);l.loaded_=!0,"function"!=typeof p().WebVTT?l.tech_&&l.tech_.any(["vttjsloaded","vttjserror"],(i=>"vttjserror"===i.type?($e.error(`vttjs failed to load, stopping trying to process ${l.src}`),void 0):parseCues(u,l))):parseCues(u,l)})))};class TextTrack extends Track{constructor(i={}){if(!i.tech)throw new Error("A tech was not provided.");const l=merge$1(i,{kind:Bt[i.kind]||"subtitles",language:i.language||i.srclang||""});let d=Ft[l.mode]||"disabled";const u=l.default;"metadata"!==l.kind&&"chapters"!==l.kind||(d="hidden"),super(l),this.tech_=l.tech,this.cues_=[],this.activeCues_=[],this.preload_=!1!==this.tech_.preloadTextTracks;const c=new TextTrackCueList(this.cues_),h=new TextTrackCueList(this.activeCues_);let p=!1;this.timeupdateHandler=bind_(this,(function(i={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_)return"timeupdate"!==i.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)),void 0;this.activeCues=this.activeCues,p&&(this.trigger("cuechange"),p=!1),"timeupdate"!==i.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}}));this.tech_.one("dispose",(()=>{this.stopTracking()})),"disabled"!==d&&this.startTracking(),Object.defineProperties(this,{default:{get:()=>u,set(){}},mode:{get:()=>d,set(i){Ft[i]&&d!==i&&(d=i,this.preload_||"disabled"===d||0!==this.cues.length||loadTrack(this.src,this),this.stopTracking(),"disabled"!==d&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?c:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(0===this.cues.length)return h;const i=this.tech_.currentTime(),l=[];for(let d=0,u=this.cues.length;d<u;d++){const u=this.cues[d];u.startTime<=i&&u.endTime>=i&&l.push(u)}if(p=!1,l.length!==this.activeCues_.length)p=!0;else for(let i=0;i<l.length;i++)-1===this.activeCues_.indexOf(l[i])&&(p=!0);return this.activeCues_=l,h.setCues_(this.activeCues_),h},set(){}}}),l.src?(this.src=l.src,this.preload_||(this.loaded_=!0),(this.preload_||"subtitles"!==l.kind&&"captions"!==l.kind)&&loadTrack(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(i){let l=i;if(!("getCueAsHTML"in l)){l=new(p().vttjs.VTTCue)(i.startTime,i.endTime,i.text);for(const d in i)d in l||(l[d]=i[d]);l.id=i.id,l.originalCue_=i}const d=this.tech_.textTracks();for(let i=0;i<d.length;i++)d[i]!==this&&d[i].removeCue(l);this.cues_.push(l),this.cues.setCues_(this.cues_)}removeCue(i){let l=this.cues_.length;for(;l--;){const d=this.cues_[l];if(d===i||d.originalCue_&&d.originalCue_===i){this.cues_.splice(l,1),this.cues.setCues_(this.cues_);break}}}}TextTrack.prototype.allowedEvents_={cuechange:"cuechange"};class AudioTrack extends Track{constructor(i={}){const l=merge$1(i,{kind:Ut[i.kind]||""});super(l);let d=!1;Object.defineProperty(this,"enabled",{get:()=>d,set(i){"boolean"==typeof i&&i!==d&&(d=i,this.trigger("enabledchange"))}}),l.enabled&&(this.enabled=l.enabled),this.loaded_=!0}}class VideoTrack extends Track{constructor(i={}){const l=merge$1(i,{kind:Nt[i.kind]||""});super(l);let d=!1;Object.defineProperty(this,"selected",{get:()=>d,set(i){"boolean"==typeof i&&i!==d&&(d=i,this.trigger("selectedchange"))}}),l.selected&&(this.selected=l.selected)}}class HTMLTrackElement extends EventTarget$2{constructor(i={}){let l;super();const d=new TextTrack(i);this.kind=d.kind,this.src=d.src,this.srclang=d.language,this.label=d.label,this.default=d.default,Object.defineProperties(this,{readyState:{get:()=>l},track:{get:()=>d}}),l=HTMLTrackElement.NONE,d.addEventListener("loadeddata",(()=>{l=HTMLTrackElement.LOADED,this.trigger({type:"load",target:this})}))}}HTMLTrackElement.prototype.allowedEvents_={load:"load"},HTMLTrackElement.NONE=0,HTMLTrackElement.LOADING=1,HTMLTrackElement.LOADED=2,HTMLTrackElement.ERROR=3;const qt={audio:{ListClass:class AudioTrackList extends TrackList{constructor(i=[]){for(let l=i.length-1;l>=0;l--)if(i[l].enabled){disableOthers$1(i,i[l]);break}super(i),this.changing_=!1}addTrack(i){i.enabled&&disableOthers$1(this,i),super.addTrack(i),i.addEventListener&&(i.enabledChange_=()=>{this.changing_||(this.changing_=!0,disableOthers$1(this,i),this.changing_=!1,this.trigger("change"))},i.addEventListener("enabledchange",i.enabledChange_))}removeTrack(i){super.removeTrack(i),i.removeEventListener&&i.enabledChange_&&(i.removeEventListener("enabledchange",i.enabledChange_),i.enabledChange_=null)}},TrackClass:AudioTrack,capitalName:"Audio"},video:{ListClass:class VideoTrackList extends TrackList{constructor(i=[]){for(let l=i.length-1;l>=0;l--)if(i[l].selected){disableOthers(i,i[l]);break}super(i),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let i=0;i<this.length;i++)if(this[i].selected)return i;return-1},set(){}})}addTrack(i){i.selected&&disableOthers(this,i),super.addTrack(i),i.addEventListener&&(i.selectedChange_=()=>{this.changing_||(this.changing_=!0,disableOthers(this,i),this.changing_=!1,this.trigger("change"))},i.addEventListener("selectedchange",i.selectedChange_))}removeTrack(i){super.removeTrack(i),i.removeEventListener&&i.selectedChange_&&(i.removeEventListener("selectedchange",i.selectedChange_),i.selectedChange_=null)}},TrackClass:VideoTrack,capitalName:"Video"},text:{ListClass:TextTrackList,TrackClass:TextTrack,capitalName:"Text"}};Object.keys(qt).forEach((function(i){qt[i].getterName=`${i}Tracks`,qt[i].privateName=`${i}Tracks_`}));const Ht={remoteText:{ListClass:TextTrackList,TrackClass:TextTrack,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:class HtmlTrackElementList{constructor(i=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let l=0,d=i.length;l<d;l++)this.addTrackElement_(i[l])}addTrackElement_(i){const l=this.trackElements_.length;""+l in this||Object.defineProperty(this,l,{get(){return this.trackElements_[l]}}),-1===this.trackElements_.indexOf(i)&&this.trackElements_.push(i)}getTrackElementByTrack_(i){let l;for(let d=0,u=this.trackElements_.length;d<u;d++)if(i===this.trackElements_[d].track){l=this.trackElements_[d];break}return l}removeTrackElement_(i){for(let l=0,d=this.trackElements_.length;l<d;l++)if(i===this.trackElements_[l]){this.trackElements_[l].track&&"function"==typeof this.trackElements_[l].track.off&&this.trackElements_[l].track.off(),"function"==typeof this.trackElements_[l].off&&this.trackElements_[l].off(),this.trackElements_.splice(l,1);break}}},TrackClass:HTMLTrackElement,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},$t=Object.assign({},qt,Ht);Ht.names=Object.keys(Ht),qt.names=Object.keys(qt),$t.names=[].concat(Ht.names).concat(qt.names);class Tech extends Component$1{constructor(i={},l=function(){}){i.reportTouchActivity=!1,super(null,i,l),this.onDurationChange_=i=>this.onDurationChange(i),this.trackProgress_=i=>this.trackProgress(i),this.trackCurrentTime_=i=>this.trackCurrentTime(i),this.stopTrackingCurrentTime_=i=>this.stopTrackingCurrentTime(i),this.disposeSourceHandler_=i=>this.disposeSourceHandler(i),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",(function(){this.hasStarted_=!0})),this.on("loadstart",(function(){this.hasStarted_=!1})),$t.names.forEach((l=>{const d=$t[l];i&&i[d.getterName]&&(this[d.privateName]=i[d.getterName])})),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach((l=>{!1===i[`native${l}Tracks`]&&(this[`featuresNative${l}Tracks`]=!1)})),!1===i.nativeCaptions||!1===i.nativeTextTracks?this.featuresNativeTextTracks=!1:!0!==i.nativeCaptions&&!0!==i.nativeTextTracks||(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=!1!==i.preloadTextTracks,this.autoRemoteTextTracks_=new $t.text.ListClass,this.initTrackListeners(),i.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(i){this.isReady_||this.one("ready",(()=>this.setTimeout((()=>this.triggerSourceset(i)),1))),this.trigger({src:i,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(i){this.stopTrackingProgress(),this.progressInterval=this.setInterval(bind_(this,(function(){const i=this.bufferedPercent();this.bufferedPercent_!==i&&this.trigger("progress"),this.bufferedPercent_=i,1===i&&this.stopTrackingProgress()})),500)}onDurationChange(i){this.duration_=this.duration()}buffered(){return createTimeRanges$1(0,0)}bufferedPercent(){return bufferedPercent(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}),250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(qt.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(i){(i=[].concat(i)).forEach((i=>{const l=this[`${i}Tracks`]()||[];let d=l.length;for(;d--;){const u=l[d];"text"===i&&this.removeRemoteTextTrack(u),l.removeTrack(u)}}))}cleanupAutoTextTracks(){const i=this.autoRemoteTextTracks_||[];let l=i.length;for(;l--;){this.removeRemoteTextTrack(i[l])}}reset(){}crossOrigin(){}setCrossOrigin(){}error(i){return void 0!==i&&(this.error_=new MediaError(i),this.trigger("error")),this.error_}played(){return this.hasStarted_?createTimeRanges$1(0,0):createTimeRanges$1()}play(){}setScrubbing(i){}scrubbing(){}setCurrentTime(i){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){qt.names.forEach((i=>{const trackListChanges=()=>{this.trigger(`${i}trackchange`)},l=this[qt[i].getterName]();l.addEventListener("removetrack",trackListChanges),l.addEventListener("addtrack",trackListChanges),this.on("dispose",(()=>{l.removeEventListener("removetrack",trackListChanges),l.removeEventListener("addtrack",trackListChanges)}))}))}addWebVttScript_(){if(!p().WebVTT)if(g().body.contains(this.el())){if(!this.options_["vtt.js"]&&isPlain(b())&&Object.keys(b()).length>0)return this.trigger("vttjsloaded"),void 0;const i=g().createElement("script");i.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",i.onload=()=>{this.trigger("vttjsloaded")},i.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",(()=>{i.onload=null,i.onerror=null})),p().WebVTT=!0,this.el().parentNode.appendChild(i)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const i=this.textTracks(),l=this.remoteTextTracks(),handleAddTrack=l=>i.addTrack(l.track),handleRemoveTrack=l=>i.removeTrack(l.track);l.on("addtrack",handleAddTrack),l.on("removetrack",handleRemoveTrack),this.addWebVttScript_();const updateDisplay=()=>this.trigger("texttrackchange"),textTracksChanges=()=>{updateDisplay();for(let l=0;l<i.length;l++){const d=i[l];d.removeEventListener("cuechange",updateDisplay),"showing"===d.mode&&d.addEventListener("cuechange",updateDisplay)}};textTracksChanges(),i.addEventListener("change",textTracksChanges),i.addEventListener("addtrack",textTracksChanges),i.addEventListener("removetrack",textTracksChanges),this.on("dispose",(function(){l.off("addtrack",handleAddTrack),l.off("removetrack",handleRemoveTrack),i.removeEventListener("change",textTracksChanges),i.removeEventListener("addtrack",textTracksChanges),i.removeEventListener("removetrack",textTracksChanges);for(let l=0;l<i.length;l++){i[l].removeEventListener("cuechange",updateDisplay)}}))}addTextTrack(i,l,d){if(!i)throw new Error("TextTrack kind is required but was not provided");return function createTrackHelper(i,l,d,u,c={}){const h=i.textTracks();c.kind=l,d&&(c.label=d),u&&(c.language=u),c.tech=i;const p=new $t.text.TrackClass(c);return h.addTrack(p),p}(this,i,l,d)}createRemoteTextTrack(i){const l=merge$1(i,{tech:this});return new Ht.remoteTextEl.TrackClass(l)}addRemoteTextTrack(i={},l){const d=this.createRemoteTextTrack(i);return"boolean"!=typeof l&&(l=!1),this.remoteTextTrackEls().addTrackElement_(d),this.remoteTextTracks().addTrack(d.track),!1===l&&this.ready((()=>this.autoRemoteTextTracks_.addTrack(d.track))),d}removeRemoteTextTrack(i){const l=this.remoteTextTrackEls().getTrackElementByTrack_(i);this.remoteTextTrackEls().removeTrackElement_(l),this.remoteTextTracks().removeTrack(i),this.autoRemoteTextTracks_.removeTrack(i)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(i){const l=newGUID();return!this.isReady_||this.paused()?(this.queuedHanders_.add(l),this.one("playing",(()=>{this.queuedHanders_.has(l)&&(this.queuedHanders_.delete(l),i())}))):this.requestNamedAnimationFrame(l,i),l}cancelVideoFrameCallback(i){this.queuedHanders_.has(i)?this.queuedHanders_.delete(i):this.cancelNamedAnimationFrame(i)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(i){}overrideNativeVideoTracks(i){}canPlayType(i){return""}static canPlayType(i){return""}static canPlaySource(i,l){return Tech.canPlayType(i.type)}static isTech(i){return i.prototype instanceof Tech||i instanceof Tech||i===Tech}static registerTech(i,l){if(Tech.techs_||(Tech.techs_={}),!Tech.isTech(l))throw new Error(`Tech ${i} must be a Tech`);if(!Tech.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Tech.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return i=toTitleCase$1(i),Tech.techs_[i]=l,Tech.techs_[toLowerCase(i)]=l,"Tech"!==i&&Tech.defaultTechOrder_.push(i),l}static getTech(i){if(i)return Tech.techs_&&Tech.techs_[i]?Tech.techs_[i]:(i=toTitleCase$1(i),p()&&p().videojs&&p().videojs[i]?($e.warn(`The ${i} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),p().videojs[i]):void 0)}}$t.names.forEach((function(i){const l=$t[i];Tech.prototype[l.getterName]=function(){return this[l.privateName]=this[l.privateName]||new l.ListClass,this[l.privateName]}})),Tech.prototype.featuresVolumeControl=!0,Tech.prototype.featuresMuteControl=!0,Tech.prototype.featuresFullscreenResize=!1,Tech.prototype.featuresPlaybackRate=!1,Tech.prototype.featuresProgressEvents=!1,Tech.prototype.featuresSourceset=!1,Tech.prototype.featuresTimeupdateEvents=!1,Tech.prototype.featuresNativeTextTracks=!1,Tech.prototype.featuresVideoFrameCallback=!1,Tech.withSourceHandlers=function(i){i.registerSourceHandler=function(l,d){let u=i.sourceHandlers;u||(u=i.sourceHandlers=[]),void 0===d&&(d=u.length),u.splice(d,0,l)},i.canPlayType=function(l){const d=i.sourceHandlers||[];let u;for(let i=0;i<d.length;i++)if(u=d[i].canPlayType(l),u)return u;return""},i.selectSourceHandler=function(l,d){const u=i.sourceHandlers||[];let c;for(let i=0;i<u.length;i++)if(c=u[i].canHandleSource(l,d),c)return u[i];return null},i.canPlaySource=function(l,d){const u=i.selectSourceHandler(l,d);return u?u.canHandleSource(l,d):""};["seekable","seeking","duration"].forEach((function(i){const l=this[i];"function"==typeof l&&(this[i]=function(){return this.sourceHandler_&&this.sourceHandler_[i]?this.sourceHandler_[i].apply(this.sourceHandler_,arguments):l.apply(this,arguments)})}),i.prototype),i.prototype.setSource=function(l){let d=i.selectSourceHandler(l,this.options_);d||(i.nativeSourceHandler?d=i.nativeSourceHandler:$e.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),d!==i.nativeSourceHandler&&(this.currentSource_=l),this.sourceHandler_=d.handleSource(l,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},i.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Component$1.registerComponent("Tech",Tech),Tech.registerTech("Tech",Tech),Tech.defaultTechOrder_=[];const zt={},Gt={},Wt={};function setSource(i,l,d){i.setTimeout((()=>setSourceHelper(l,zt[l.type],d,i)),1)}function mediate(i,l,d,u=null){const c="call"+toTitleCase$1(d),h=i.reduce(middlewareIterator(c),u),p=h===Wt,m=p?null:l[d](h);return!function executeRight(i,l,d,u){for(let c=i.length-1;c>=0;c--){const h=i[c];h[l]&&h[l](u,d)}}(i,d,m,p),m}const Xt={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},Kt={setCurrentTime:1,setMuted:1,setVolume:1},Yt={play:1,pause:1};function middlewareIterator(i){return(l,d)=>l===Wt?Wt:d[i]?d[i](l):l}function setSourceHelper(i={},l=[],d,u,c=[],h=!1){const[p,...m]=l;if("string"==typeof p)setSourceHelper(i,zt[p],d,u,c,h);else if(p){const l=function getOrCreateFactory(i,l){const d=Gt[i.id()];let u=null;if(null==d)return u=l(i),Gt[i.id()]=[[l,u]],u;for(let i=0;i<d.length;i++){const[c,h]=d[i];c===l&&(u=h)}return null===u&&(u=l(i),d.push([l,u])),u}(u,p);if(!l.setSource)return c.push(l),setSourceHelper(i,m,d,u,c,h);l.setSource(Object.assign({},i),(function(p,g){if(p)return setSourceHelper(i,m,d,u,c,h);c.push(l),setSourceHelper(g,i.type===g.type?m:zt[g.type],d,u,c,h)}))}else m.length?setSourceHelper(i,m,d,u,c,h):h?d(i,c):setSourceHelper(i,zt["*"],d,u,c,!0)}const Qt={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},getMimetype=function(i=""){const l=getFileExtension(i);return Qt[l.toLowerCase()]||""},filterSource=function(i){if(Array.isArray(i)){let l=[];i.forEach((function(i){i=filterSource(i),Array.isArray(i)?l=l.concat(i):video_es_isObject(i)&&l.push(i)})),i=l}else i="string"==typeof i&&i.trim()?[fixSource({src:i})]:video_es_isObject(i)&&"string"==typeof i.src&&i.src&&i.src.trim()?[fixSource(i)]:[];return i};function fixSource(i){if(!i.type){const l=getMimetype(i.src);l&&(i.type=l)}return i}const Jt=ut?10009:ct?461:8,Zt={codes:{play:415,pause:19,ff:417,rw:412,back:Jt},names:{415:"play",19:"pause",417:"ff",412:"rw",[Jt]:"back"},isEventKey(i,l){return l=l.toLowerCase(),!(!this.names[i.keyCode]||this.names[i.keyCode]!==l)},getEventName(i){if(this.names[i.keyCode])return this.names[i.keyCode];if(this.codes[i.code]){return this.names[this.codes[i.code]]}return null}};class SpatialNavigation extends EventTarget$2{constructor(i){super(),this.player_=i,this.focusableComponents=[],this.isListening_=!1,this.isPaused_=!1,this.onKeyDown_=this.onKeyDown_.bind(this),this.lastFocusedComponent_=null}start(){this.isListening_||(this.player_.on("keydown",this.onKeyDown_),this.player_.on("modalKeydown",this.onKeyDown_),this.player_.on("loadedmetadata",(()=>{this.focus(this.updateFocusableComponents()[0])})),this.player_.on("modalclose",(()=>{this.refocusComponent()})),this.player_.on("focusin",this.handlePlayerFocus_.bind(this)),this.player_.on("focusout",this.handlePlayerBlur_.bind(this)),this.isListening_=!0,this.player_.errorDisplay&&this.player_.errorDisplay.on("aftermodalfill",(()=>{this.updateFocusableComponents(),this.focusableComponents.length&&(this.focusableComponents.length>1?this.focusableComponents[1].focus():this.focusableComponents[0].focus())})))}stop(){this.player_.off("keydown",this.onKeyDown_),this.isListening_=!1}onKeyDown_(i){const l=i.originalEvent?i.originalEvent:i;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(l.key)){if(this.isPaused_)return;l.preventDefault();const i=l.key.substring(5).toLowerCase();this.move(i)}else if(Zt.isEventKey(l,"play")||Zt.isEventKey(l,"pause")||Zt.isEventKey(l,"ff")||Zt.isEventKey(l,"rw")){l.preventDefault();const i=Zt.getEventName(l);this.performMediaAction_(i)}else Zt.isEventKey(l,"Back")&&i.target&&"function"==typeof i.target.closeable&&i.target.closeable()&&(l.preventDefault(),i.target.close())}performMediaAction_(i){if(this.player_)switch(i){case"play":this.player_.paused()&&this.player_.play();break;case"pause":this.player_.paused()||this.player_.pause();break;case"ff":this.userSeek_(this.player_.currentTime()+5);break;case"rw":this.userSeek_(this.player_.currentTime()-5)}}userSeek_(i){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(i)}pause(){this.isPaused_=!0}resume(){this.isPaused_=!1}handlePlayerBlur_(i){const l=i.relatedTarget;let d=null;const u=this.getCurrentComponent(i.target);l&&(d=Boolean(l.closest(".video-js")),l.classList.contains("vjs-text-track-settings")&&!this.isPaused_&&this.searchForTrackSelect_()),(i.currentTarget.contains(i.relatedTarget)||d)&&l||(u&&"CloseButton"===u.name()?this.refocusComponent():(this.pause(),u&&u.el()&&(this.lastFocusedComponent_=u)))}handlePlayerFocus_(){this.getCurrentComponent()&&this.getCurrentComponent().getIsFocusable()&&this.resume()}updateFocusableComponents(){const i=[];function searchForChildrenCandidates(l){for(const d of l)d.hasOwnProperty("el_")&&d.getIsFocusable()&&d.getIsAvailableToBeFocused(d.el())&&i.push(d),d.hasOwnProperty("children_")&&d.children_.length>0&&searchForChildrenCandidates(d.children_)}return this.player_.children_.forEach((l=>{if(l.hasOwnProperty("el_")){if(l.getIsFocusable&&l.getIsAvailableToBeFocused&&l.getIsFocusable()&&l.getIsAvailableToBeFocused(l.el()))return i.push(l),void 0;l.hasOwnProperty("children_")&&l.children_.length>0?searchForChildrenCandidates(l.children_):l.hasOwnProperty("items")&&l.items.length>0?searchForChildrenCandidates(l.items):this.findSuitableDOMChild(l)&&i.push(l)}if("ErrorDisplay"===l.name_&&l.opened_){const d=l.el_.querySelector(".vjs-errors-ok-button-container");if(d){d.querySelectorAll("button").forEach(((l,d)=>{i.push({name:()=>"ModalButton"+(d+1),el:()=>l,getPositions:()=>{const i=l.getBoundingClientRect();return{boundingClientRect:{x:i.x,y:i.y,width:i.width,height:i.height,top:i.top,right:i.right,bottom:i.bottom,left:i.left},center:{x:i.left+i.width/2,y:i.top+i.height/2,width:0,height:0,top:i.top+i.height/2,right:i.left+i.width/2,bottom:i.top+i.height/2,left:i.left+i.width/2}}},getIsAvailableToBeFocused:()=>!0,getIsFocusable:i=>!0,focus:()=>l.focus()})}))}}})),this.focusableComponents=i,this.focusableComponents}findSuitableDOMChild(i){return i.el()?function searchForSuitableChild(l){if(i.getIsFocusable(l)&&i.getIsAvailableToBeFocused(l))return l;for(let i=0;i<l.children.length;i++){const d=searchForSuitableChild(l.children[i]);if(d)return d}return null}(i.el()):null}getCurrentComponent(i){this.updateFocusableComponents();const l=i||document.activeElement;if(this.focusableComponents.length)for(const i of this.focusableComponents)if(i.el()===l)return i}add(i){const l=[...this.focusableComponents];i.hasOwnProperty("el_")&&i.getIsFocusable()&&i.getIsAvailableToBeFocused(i.el())&&l.push(i),this.focusableComponents=l,this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}remove(i){for(let l=0;l<this.focusableComponents.length;l++)if(this.focusableComponents[l].name()===i.name())return this.focusableComponents.splice(l,1),this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}),void 0}clear(){this.focusableComponents.length>0&&(this.focusableComponents=[],this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}))}move(i){const l=this.getCurrentComponent();if(!l)return;const d=l.getPositions(),u=this.focusableComponents.filter((u=>u!==l&&this.isInDirection_(d.boundingClientRect,u.getPositions().boundingClientRect,i))),c=this.findBestCandidate_(d.center,u,i);c?this.focus(c):this.trigger({type:"endOfFocusableComponents",direction:i,focusedComponent:l})}findBestCandidate_(i,l,d){let u=1/0,c=null;for(const h of l){const l=h.getPositions().center,p=this.calculateDistance_(i,l,d);p<u&&(u=p,c=h)}return c}isInDirection_(i,l,d){switch(d){case"right":return l.left>=i.right;case"left":return l.right<=i.left;case"down":return l.top>=i.bottom;case"up":return l.bottom<=i.top;default:return!1}}refocusComponent(){if(this.lastFocusedComponent_){this.player_.userActive()||this.player_.userActive(!0),this.updateFocusableComponents();for(let i=0;i<this.focusableComponents.length;i++)if(this.focusableComponents[i].name()===this.lastFocusedComponent_.name())return this.focus(this.focusableComponents[i]),void 0}else this.focus(this.updateFocusableComponents()[0])}focus(i){"object"==typeof i&&(i.getIsAvailableToBeFocused(i.el())?i.focus():this.findSuitableDOMChild(i)&&this.findSuitableDOMChild(i).focus())}calculateDistance_(i,l,d){const u=Math.abs(i.x-l.x),c=Math.abs(i.y-l.y);let h;switch(d){case"right":case"left":h=u+100*c;break;case"up":h=2*c+.5*u;break;case"down":h=5*c+u;break;default:h=u+c}return h}searchForTrackSelect_(){const i=this;for(const l of i.updateFocusableComponents())if("TextTrackSelect"===l.constructor.name){i.focus(l);break}}}Component$1.registerComponent("MediaLoader",class MediaLoader extends Component$1{constructor(i,l,d){if(super(i,merge$1({createEl:!1},l),d),l.playerOptions.sources&&0!==l.playerOptions.sources.length)i.src(l.playerOptions.sources);else for(let d=0,u=l.playerOptions.techOrder;d<u.length;d++){const l=toTitleCase$1(u[d]);let c=Tech.getTech(l);if(l||(c=Component$1.getComponent(l)),c&&c.isSupported()){i.loadTech_(l);break}}}});class ClickableComponent extends Component$1{constructor(i,l){super(i,l),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=i=>this.handleMouseOver(i),this.handleMouseOut_=i=>this.handleMouseOut(i),this.handleClick_=i=>this.handleClick(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.emitTapEvents(),this.enable()}createEl(i="div",l={},d={}){l=Object.assign({className:this.buildCSSClass(),tabIndex:0},l),"button"===i&&$e.error(`Creating a ClickableComponent with an HTML element of ${i} is not supported; use a Button instead.`),d=Object.assign({role:"button"},d),this.tabIndex_=l.tabIndex;const u=createEl(i,l,d);return this.player_.options_.experimentalSvgIcons||u.appendChild(createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(u),u}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(i){return this.controlTextEl_=createEl("span",{className:"vjs-control-text"},{"aria-live":"polite"}),i&&i.appendChild(this.controlTextEl_),this.controlText(this.controlText_,i),this.controlTextEl_}controlText(i,l=this.el()){if(void 0===i)return this.controlText_||"Need Text";const d=this.localize(i);this.controlText_=i,textContent(this.controlTextEl_,d),this.nonIconControl||this.player_.options_.noUITitleAttributes||l.setAttribute("title",d)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(i){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(i){" "===i.key||"Enter"===i.key?(i.preventDefault(),i.stopPropagation(),this.trigger("click")):super.handleKeyDown(i)}}Component$1.registerComponent("ClickableComponent",ClickableComponent);class PosterImage extends ClickableComponent{constructor(i,l){super(i,l),this.update(),this.update_=i=>this.update(i),i.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return createEl("div",{className:"vjs-poster"})}crossOrigin(i){return void 0===i?this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null:null!==i&&"anonymous"!==i&&"use-credentials"!==i?(this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${i}"`),void 0):(this.$("img")&&(this.$("img").crossOrigin=i),void 0)}update(i){const l=this.player().poster();this.setSrc(l),l?this.show():this.hide()}setSrc(i){if(!i)return this.el_.textContent="",void 0;this.$("img")||this.el_.appendChild(createEl("picture",{className:"vjs-poster",tabIndex:-1},{},createEl("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=i}handleClick(i){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?silencePromise(this.player_.play()):this.player_.pause())}}PosterImage.prototype.crossorigin=PosterImage.prototype.crossOrigin,Component$1.registerComponent("PosterImage",PosterImage);const ei="#222",ti="#ccc",ii={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function constructColor(i,l){let d;if(4===i.length)d=i[1]+i[1]+i[2]+i[2]+i[3]+i[3];else{if(7!==i.length)throw new Error("Invalid color code provided, "+i+"; must be formatted as e.g. #f0e or #f604e2.");d=i.slice(1)}return"rgba("+parseInt(d.slice(0,2),16)+","+parseInt(d.slice(2,4),16)+","+parseInt(d.slice(4,6),16)+","+l+")"}function tryUpdateStyle(i,l,d){try{i.style[l]=d}catch(i){return}}function getCSSPositionValue(i){return i?`${i}px`:""}Component$1.registerComponent("TextTrackDisplay",class TextTrackDisplay extends Component$1{constructor(i,l,d){super(i,l,d);const updateDisplayHandler=i=>{this.updateDisplayOverlay(),this.updateDisplay(i)};i.on("loadstart",(i=>this.toggleDisplay(i))),i.on("texttrackchange",(i=>this.updateDisplay(i))),i.on("loadedmetadata",(i=>{this.updateDisplayOverlay(),this.preselectTrack(i)})),i.ready(bind_(this,(function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)return this.hide(),void 0;i.on("fullscreenchange",updateDisplayHandler),i.on("playerresize",updateDisplayHandler);const l=p().screen.orientation||p(),d=p().screen.orientation?"change":"orientationchange";l.addEventListener(d,updateDisplayHandler),i.on("dispose",(()=>l.removeEventListener(d,updateDisplayHandler)));const u=this.options_.playerOptions.tracks||[];for(let i=0;i<u.length;i++)this.player_.addRemoteTextTrack(u[i],!0);this.preselectTrack()})))}preselectTrack(){const i={captions:1,subtitles:1},l=this.player_.textTracks(),d=this.player_.cache_.selectedLanguage;let u,c,h;for(let p=0;p<l.length;p++){const m=l[p];d&&d.enabled&&d.language&&d.language===m.language&&m.kind in i?m.kind===d.kind?h=m:h||(h=m):d&&!d.enabled?(h=null,u=null,c=null):m.default&&("descriptions"!==m.kind||u?m.kind in i&&!c&&(c=m):u=m)}h?h.mode="showing":c?c.mode="showing":u&&(u.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){"function"==typeof p().WebVTT&&p().WebVTT.processCues(p(),[],this.el_)}updateDisplay(){const i=this.player_.textTracks(),l=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),l){const l=[];for(let d=0;d<i.length;++d){const u=i[d];"showing"===u.mode&&l.push(u)}return this.updateForTrack(l),void 0}let d=null,u=null,c=i.length;for(;c--;){const l=i[c];"showing"===l.mode&&("descriptions"===l.kind?d=l:u=l)}if(u?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(u)):d&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(d)),!p().CSS.supports("inset","10px")){const i=this.el_,l=i.querySelectorAll(".vjs-text-track-cue"),d=this.player_.controlBar.el_.getBoundingClientRect().height,u=this.player_.el_.getBoundingClientRect().height;i.style="",tryUpdateStyle(i,"position","relative"),tryUpdateStyle(i,"height",u-d+"px"),tryUpdateStyle(i,"top","unset"),tryUpdateStyle(i,"bottom",ht?u+"px":"0px"),l.length>0&&l.forEach((i=>{if(i.style.inset){const l=i.style.inset.split(" ");3===l.length&&Object.assign(i.style,{top:l[0],right:l[1],bottom:l[2],left:"unset"})}}))}}updateDisplayOverlay(){if(!this.player_.videoHeight()||!p().CSS.supports("inset-inline: 10px"))return;const i=this.player_.currentWidth(),l=this.player_.currentHeight(),d=i/l,u=this.player_.videoWidth()/this.player_.videoHeight();let c=0,h=0;Math.abs(d-u)>.1&&(d>u?c=Math.round((i-l*u)/2):h=Math.round((l-i/u)/2)),tryUpdateStyle(this.el_,"insetInline",getCSSPositionValue(c)),tryUpdateStyle(this.el_,"insetBlock",getCSSPositionValue(h))}updateDisplayState(i){const l=this.player_.textTrackSettings.getValues(),d=i.activeCues;let u=d.length;for(;u--;){const i=d[u];if(!i)continue;const c=i.displayState;if(l.color&&(c.firstChild.style.color=l.color),l.textOpacity&&tryUpdateStyle(c.firstChild,"color",constructColor(l.color||"#fff",l.textOpacity)),l.backgroundColor&&(c.firstChild.style.backgroundColor=l.backgroundColor),l.backgroundOpacity&&tryUpdateStyle(c.firstChild,"backgroundColor",constructColor(l.backgroundColor||"#000",l.backgroundOpacity)),l.windowColor&&(l.windowOpacity?tryUpdateStyle(c,"backgroundColor",constructColor(l.windowColor,l.windowOpacity)):c.style.backgroundColor=l.windowColor),l.edgeStyle&&("dropshadow"===l.edgeStyle?c.firstChild.style.textShadow=`2px 2px 3px ${ei}, 2px 2px 4px ${ei}, 2px 2px 5px ${ei}`:"raised"===l.edgeStyle?c.firstChild.style.textShadow=`1px 1px ${ei}, 2px 2px ${ei}, 3px 3px ${ei}`:"depressed"===l.edgeStyle?c.firstChild.style.textShadow=`1px 1px ${ti}, 0 1px ${ti}, -1px -1px ${ei}, 0 -1px ${ei}`:"uniform"===l.edgeStyle&&(c.firstChild.style.textShadow=`0 0 4px ${ei}, 0 0 4px ${ei}, 0 0 4px ${ei}, 0 0 4px ${ei}`)),l.fontPercent&&1!==l.fontPercent){const i=p().parseFloat(c.style.fontSize);c.style.fontSize=i*l.fontPercent+"px",c.style.height="auto",c.style.top="auto"}l.fontFamily&&"default"!==l.fontFamily&&("small-caps"===l.fontFamily?c.firstChild.style.fontVariant="small-caps":c.firstChild.style.fontFamily=ii[l.fontFamily])}}updateForTrack(i){if(Array.isArray(i)||(i=[i]),"function"!=typeof p().WebVTT||i.every((i=>!i.activeCues)))return;const l=[];for(let d=0;d<i.length;++d){const u=i[d];for(let i=0;i<u.activeCues.length;++i)l.push(u.activeCues[i])}p().WebVTT.processCues(p(),l,this.el_);for(let l=0;l<i.length;++l){const d=i[l];for(let i=0;i<d.activeCues.length;++i){const u=d.activeCues[i].displayState;addClass(u,"vjs-text-track-cue","vjs-text-track-cue-"+(d.language?d.language:l)),d.language&&setAttribute(u,"lang",d.language)}this.player_.textTrackSettings&&this.updateDisplayState(d)}}});Component$1.registerComponent("LoadingSpinner",class LoadingSpinner extends Component$1{createEl(){const i=this.player_.isAudio(),l=this.localize(i?"Audio Player":"Video Player"),d=createEl("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[l])}),u=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return u.appendChild(d),u}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}});class Button extends ClickableComponent{createEl(i,l={},d={}){0;const u=createEl("button",l=Object.assign({className:this.buildCSSClass()},l),d=Object.assign({type:"button"},d));return this.player_.options_.experimentalSvgIcons||u.appendChild(createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(u),u}addChild(i,l={}){return $e.warn(`Adding an actionable (user controllable) child to a Button (${this.constructor.name}) is not supported; use a ClickableComponent instead.`),Component$1.prototype.addChild.call(this,i,l)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(i){if(" "===i.key||"Enter"===i.key)return i.stopPropagation(),void 0;super.handleKeyDown(i)}}Component$1.registerComponent("Button",Button);class BigPlayButton extends Button{constructor(i,l){super(i,l),this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",(i=>this.handleMouseDown(i)))}buildCSSClass(){return"vjs-big-play-button"}handleClick(i){const l=this.player_.play();if(this.mouseused_&&"clientX"in i&&"clientY"in i)return silencePromise(l),this.player_.tech(!0)&&this.player_.tech(!0).focus(),void 0;const d=this.player_.getChild("controlBar"),u=d&&d.getChild("playToggle");if(!u)return this.player_.tech(!0).focus(),void 0;const playFocus=()=>u.focus();isPromise(l)?l.then(playFocus,(()=>{})):this.setTimeout(playFocus,1)}handleKeyDown(i){this.mouseused_=!1,super.handleKeyDown(i)}handleMouseDown(i){this.mouseused_=!0}}BigPlayButton.prototype.controlText_="Play Video",Component$1.registerComponent("BigPlayButton",BigPlayButton);Component$1.registerComponent("CloseButton",class CloseButton extends Button{constructor(i,l){super(i,l),this.setIcon("cancel"),this.controlText(l&&l.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(i){this.trigger({type:"close",bubbles:!1})}handleKeyDown(i){"Escape"===i.key?(i.preventDefault(),i.stopPropagation(),this.trigger("click")):super.handleKeyDown(i)}});class PlayToggle extends Button{constructor(i,l={}){super(i,l),l.replay=void 0===l.replay||l.replay,this.setIcon("play"),this.on(i,"play",(i=>this.handlePlay(i))),this.on(i,"pause",(i=>this.handlePause(i))),l.replay&&this.on(i,"ended",(i=>this.handleEnded(i)))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(i){this.player_.paused()?silencePromise(this.player_.play()):this.player_.pause()}handleSeeked(i){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(i):this.handlePlay(i)}handlePlay(i){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(i){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(i){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",(i=>this.handleSeeked(i)))}}PlayToggle.prototype.controlText_="Play",Component$1.registerComponent("PlayToggle",PlayToggle);class TimeDisplay extends Component$1{constructor(i,l){super(i,l),this.on(i,["timeupdate","ended","seeking"],(i=>this.update(i))),this.updateTextNode_()}createEl(){const i=this.buildCSSClass(),l=super.createEl("div",{className:`${i} vjs-time-control vjs-control`}),d=createEl("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)} `},{role:"presentation"});return l.appendChild(d),this.contentEl_=createEl("span",{className:`${i}-display`},{role:"presentation"}),l.appendChild(this.contentEl_),l}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(i){(this.player_.options_.enableSmoothSeeking||"seeking"!==i.type)&&this.updateContent(i)}updateTextNode_(i=0){i=formatTime(i),this.formattedTime_!==i&&(this.formattedTime_=i,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",(()=>{if(!this.contentEl_)return;let i=this.textNode_;i&&this.contentEl_.firstChild!==i&&(i=null,$e.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=g().createTextNode(this.formattedTime_),this.textNode_&&(i?this.contentEl_.replaceChild(this.textNode_,i):this.contentEl_.appendChild(this.textNode_))})))}updateContent(i){}}TimeDisplay.prototype.labelText_="Time",TimeDisplay.prototype.controlText_="Time",Component$1.registerComponent("TimeDisplay",TimeDisplay);class CurrentTimeDisplay extends TimeDisplay{buildCSSClass(){return"vjs-current-time"}updateContent(i){let l;l=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(l)}}CurrentTimeDisplay.prototype.labelText_="Current Time",CurrentTimeDisplay.prototype.controlText_="Current Time",Component$1.registerComponent("CurrentTimeDisplay",CurrentTimeDisplay);class DurationDisplay extends TimeDisplay{constructor(i,l){super(i,l);const updateContent=i=>this.updateContent(i);this.on(i,"durationchange",updateContent),this.on(i,"loadstart",updateContent),this.on(i,"loadedmetadata",updateContent)}buildCSSClass(){return"vjs-duration"}updateContent(i){const l=this.player_.duration();this.updateTextNode_(l)}}DurationDisplay.prototype.labelText_="Duration",DurationDisplay.prototype.controlText_="Duration",Component$1.registerComponent("DurationDisplay",DurationDisplay);Component$1.registerComponent("TimeDivider",class TimeDivider extends Component$1{createEl(){const i=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),l=super.createEl("div"),d=super.createEl("span",{textContent:"/"});return l.appendChild(d),i.appendChild(l),i}});class RemainingTimeDisplay extends TimeDisplay{constructor(i,l){super(i,l),this.on(i,"durationchange",(i=>this.updateContent(i)))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const i=super.createEl();return!1!==this.options_.displayNegative&&i.insertBefore(createEl("span",{},{"aria-hidden":!0},"-"),this.contentEl_),i}updateContent(i){if("number"!=typeof this.player_.duration())return;let l;l=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(l)}}RemainingTimeDisplay.prototype.labelText_="Remaining Time",RemainingTimeDisplay.prototype.controlText_="Remaining Time",Component$1.registerComponent("RemainingTimeDisplay",RemainingTimeDisplay);Component$1.registerComponent("LiveDisplay",class LiveDisplay extends Component$1{constructor(i,l){super(i,l),this.updateShowing(),this.on(this.player(),"durationchange",(i=>this.updateShowing(i)))}createEl(){const i=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=createEl("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(createEl("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")} `})),this.contentEl_.appendChild(g().createTextNode(this.localize("LIVE"))),i.appendChild(this.contentEl_),i}dispose(){this.contentEl_=null,super.dispose()}updateShowing(i){this.player().duration()===1/0?this.show():this.hide()}});class SeekToLive extends Button{constructor(i,l){super(i,l),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=i=>this.updateLiveEdgeStatus(i),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const i=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",i),this.textEl_=createEl("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),i.appendChild(this.textEl_),i}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}function clamp(i,l,d){return i=Number(i),Math.min(d,Math.max(l,isNaN(i)?l:i))}SeekToLive.prototype.controlText_="Seek to live, currently playing live",Component$1.registerComponent("SeekToLive",SeekToLive);var ri=Object.freeze({__proto__:null,clamp});class Slider extends Component$1{constructor(i,l){super(i,l),this.handleMouseDown_=i=>this.handleMouseDown(i),this.handleMouseUp_=i=>this.handleMouseUp(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.handleClick_=i=>this.handleClick(i),this.handleMouseMove_=i=>this.handleMouseMove(i),this.update_=i=>this.update(i),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const i=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(i,"mousemove",this.handleMouseMove_),this.off(i,"mouseup",this.handleMouseUp_),this.off(i,"touchmove",this.handleMouseMove_),this.off(i,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(i,l={},d={}){return l.className=l.className+" vjs-slider",l=Object.assign({tabIndex:0},l),d=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},d),super.createEl(i,l,d)}handleMouseDown(i){const l=this.bar.el_.ownerDocument;"mousedown"===i.type&&i.preventDefault(),"touchstart"!==i.type||tt||i.preventDefault(),blockTextSelection(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(l,"mousemove",this.handleMouseMove_),this.on(l,"mouseup",this.handleMouseUp_),this.on(l,"touchmove",this.handleMouseMove_),this.on(l,"touchend",this.handleMouseUp_),this.handleMouseMove(i,!0)}handleMouseMove(i){}handleMouseUp(i){const l=this.bar.el_.ownerDocument;unblockTextSelection(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(l,"mousemove",this.handleMouseMove_),this.off(l,"mouseup",this.handleMouseUp_),this.off(l,"touchmove",this.handleMouseMove_),this.off(l,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const i=this.getProgress();return i===this.progress_||(this.progress_=i,this.requestNamedAnimationFrame("Slider#update",(()=>{const l=this.vertical()?"height":"width";this.bar.el().style[l]=(100*i).toFixed(2)+"%"}))),i}getProgress(){return Number(clamp(this.getPercent(),0,1).toFixed(4))}calculateDistance(i){const l=getPointerPosition(this.el_,i);return this.vertical()?l.y:l.x}handleKeyDown(i){const l=this.options_.playerOptions.spatialNavigation,d=l&&l.horizontalSeek;l&&l.enabled?d&&"ArrowLeft"===i.key||!d&&"ArrowDown"===i.key?(i.preventDefault(),i.stopPropagation(),this.stepBack()):d&&"ArrowRight"===i.key||!d&&"ArrowUp"===i.key?(i.preventDefault(),i.stopPropagation(),this.stepForward()):super.handleKeyDown(i):"ArrowLeft"===i.key||"ArrowDown"===i.key?(i.preventDefault(),i.stopPropagation(),this.stepBack()):"ArrowUp"===i.key||"ArrowRight"===i.key?(i.preventDefault(),i.stopPropagation(),this.stepForward()):super.handleKeyDown(i)}handleClick(i){i.stopPropagation(),i.preventDefault()}vertical(i){if(void 0===i)return this.vertical_||!1;this.vertical_=!!i,this.addClass(this.vertical_?"vjs-slider-vertical":"vjs-slider-horizontal")}}Component$1.registerComponent("Slider",Slider);const percentify=(i,l)=>clamp(i/l*100,0,100).toFixed(2)+"%";Component$1.registerComponent("LoadProgressBar",class LoadProgressBar extends Component$1{constructor(i,l){super(i,l),this.partEls_=[],this.on(i,"progress",(i=>this.update(i)))}createEl(){const i=super.createEl("div",{className:"vjs-load-progress"}),l=createEl("span",{className:"vjs-control-text"}),d=createEl("span",{textContent:this.localize("Loaded")}),u=g().createTextNode(": ");return this.percentageEl_=createEl("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),i.appendChild(l),l.appendChild(d),l.appendChild(u),l.appendChild(this.percentageEl_),i}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(i){this.requestNamedAnimationFrame("LoadProgressBar#update",(()=>{const i=this.player_.liveTracker,l=this.player_.buffered(),d=i&&i.isLive()?i.seekableEnd():this.player_.duration(),u=this.player_.bufferedEnd(),c=this.partEls_,h=percentify(u,d);this.percent_!==h&&(this.el_.style.width=h,textContent(this.percentageEl_,h),this.percent_=h);for(let i=0;i<l.length;i++){const d=l.start(i),h=l.end(i);let p=c[i];p||(p=this.el_.appendChild(createEl()),c[i]=p),p.dataset.start===d&&p.dataset.end===h||(p.dataset.start=d,p.dataset.end=h,p.style.left=percentify(d,u),p.style.width=percentify(h-d,u))}for(let i=c.length;i>l.length;i--)this.el_.removeChild(c[i-1]);c.length=l.length}))}});Component$1.registerComponent("TimeTooltip",class TimeTooltip extends Component$1{constructor(i,l){super(i,l),this.update=throttle(bind_(this,this.update),At)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(i,l,d){const u=findPosition(this.el_),c=getBoundingClientRect(this.player_.el()),h=i.width*l;if(!c||!u)return;let p=i.left-c.left+h,m=i.width-h+(c.right-i.right);m||(m=i.width-h,p=h);let g=u.width/2;p<g?g+=g-p:m<g&&(g=m),g<0?g=0:g>u.width&&(g=u.width),g=Math.round(g),this.el_.style.right=`-${g}px`,this.write(d)}write(i){textContent(this.el_,i)}updateTime(i,l,d,u){this.requestNamedAnimationFrame("TimeTooltip#updateTime",(()=>{let c;const h=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const i=this.player_.liveTracker.liveWindow(),d=i-l*i;c=(d<1?"":"-")+formatTime(d,i)}else c=formatTime(d,h);this.update(i,l,c),u&&u()}))}});class PlayProgressBar extends Component$1{constructor(i,l){super(i,l),this.setIcon("circle"),this.update=throttle(bind_(this,this.update),At)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(i,l){const d=this.getChild("timeTooltip");if(!d)return;const u=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();d.updateTime(i,l,u)}}PlayProgressBar.prototype.options_={children:[]},ft||Qe||PlayProgressBar.prototype.options_.children.push("timeTooltip"),Component$1.registerComponent("PlayProgressBar",PlayProgressBar);class MouseTimeDisplay extends Component$1{constructor(i,l){super(i,l),this.update=throttle(bind_(this,this.update),At)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(i,l){const d=l*this.player_.duration();this.getChild("timeTooltip").updateTime(i,l,d,(()=>{this.el_.style.left=i.width*l+"px"}))}}MouseTimeDisplay.prototype.options_={children:["timeTooltip"]},Component$1.registerComponent("MouseTimeDisplay",MouseTimeDisplay);class SeekBar extends Slider{constructor(i,l){(l=merge$1(SeekBar.prototype.options_,l)).children=[...l.children];const d=i.options_.disableSeekWhileScrubbingOnMobile&&(ft||Qe);(!ft&&!Qe||d)&&l.children.splice(1,0,"mouseTimeDisplay"),super(i,l),this.shouldDisableSeekWhileScrubbingOnMobile_=d,this.pendingSeekTime_=null,this.setEventHandlers_()}setEventHandlers_(){this.update_=bind_(this,this.update),this.update=throttle(this.update_,At),this.on(this.player_,["durationchange","timeupdate"],this.update),this.on(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=i=>this.enableInterval_(i),this.disableIntervalHandler_=i=>this.disableInterval_(i),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in g()&&"visibilityState"in g()&&this.on(g(),"visibilitychange",this.toggleVisibility_)}toggleVisibility_(i){"hidden"===g().visibilityState?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(i)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,At))}disableInterval_(i){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&i&&"ended"!==i.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(i){if("hidden"===g().visibilityState)return;const l=super.update();return this.requestNamedAnimationFrame("SeekBar#update",(()=>{const i=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),d=this.player_.liveTracker;let u=this.player_.duration();d&&d.isLive()&&(u=this.player_.liveTracker.liveCurrentTime()),this.percent_!==l&&(this.el_.setAttribute("aria-valuenow",(100*l).toFixed(2)),this.percent_=l),this.currentTime_===i&&this.duration_===u||(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[formatTime(i,u),formatTime(u,u)],"{1} of {2}")),this.currentTime_=i,this.duration_=u),this.bar&&this.bar.update(getBoundingClientRect(this.el()),this.getProgress())})),l}userSeek_(i){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(i)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){if(this.pendingSeekTime_)return this.pendingSeekTime_/this.player_.duration();const i=this.getCurrentTime_();let l;const d=this.player_.liveTracker;return d&&d.isLive()?(l=(i-d.seekableStart())/d.liveWindow(),d.atLiveEdge()&&(l=1)):l=i/this.player_.duration(),l}handleMouseDown(i){isSingleLeftClick(i)&&(i.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.shouldDisableSeekWhileScrubbingOnMobile_||this.player_.pause(),super.handleMouseDown(i))}handleMouseMove(i,l=!1){if(!isSingleLeftClick(i)||isNaN(this.player_.duration()))return;let d;l||this.player_.scrubbing()||this.player_.scrubbing(!0);const u=this.calculateDistance(i),c=this.player_.liveTracker;if(c&&c.isLive()){if(u>=.99)return c.seekToLiveEdge(),void 0;const i=c.seekableStart(),l=c.liveCurrentTime();if(d=i+u*c.liveWindow(),d>=l&&(d=l),d<=i&&(d=i+.1),d===1/0)return}else d=u*this.player_.duration(),d===this.player_.duration()&&(d-=.1);this.shouldDisableSeekWhileScrubbingOnMobile_?this.pendingSeekTime_=d:this.userSeek_(d),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const i=this.getChild("mouseTimeDisplay");i&&i.show()}disable(){super.disable();const i=this.getChild("mouseTimeDisplay");i&&i.hide()}handleMouseUp(i){super.handleMouseUp(i),i&&i.stopPropagation(),this.player_.scrubbing(!1),this.pendingSeekTime_&&(this.userSeek_(this.pendingSeekTime_),this.pendingSeekTime_=null),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?silencePromise(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+5)}stepBack(){this.userSeek_(this.player_.currentTime()-5)}handleAction(i){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(i){const l=this.player_.liveTracker;if(" "===i.key||"Enter"===i.key)i.preventDefault(),i.stopPropagation(),this.handleAction(i);else if("Home"===i.key)i.preventDefault(),i.stopPropagation(),this.userSeek_(0);else if("End"===i.key)i.preventDefault(),i.stopPropagation(),l&&l.isLive()?this.userSeek_(l.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(i.key)){i.preventDefault(),i.stopPropagation();const d=.1*parseInt(i.key,10);l&&l.isLive()?this.userSeek_(l.seekableStart()+l.liveWindow()*d):this.userSeek_(this.player_.duration()*d)}else"PageDown"===i.key?(i.preventDefault(),i.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):"PageUp"===i.key?(i.preventDefault(),i.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):super.handleKeyDown(i)}dispose(){this.disableInterval_(),this.off(this.player_,["durationchange","timeupdate"],this.update),this.off(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in g()&&"visibilityState"in g()&&this.off(g(),"visibilitychange",this.toggleVisibility_),super.dispose()}}SeekBar.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Component$1.registerComponent("SeekBar",SeekBar);class ProgressControl extends Component$1{constructor(i,l){super(i,l),this.handleMouseMove=throttle(bind_(this,this.handleMouseMove),At),this.throttledHandleMouseSeek=throttle(bind_(this,this.handleMouseSeek),At),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.handleMouseDownHandler_=i=>this.handleMouseDown(i),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(i){const l=this.getChild("seekBar");if(!l)return;const d=l.getChild("playProgressBar"),u=l.getChild("mouseTimeDisplay");if(!d&&!u)return;const c=l.el(),h=findPosition(c);let p=getPointerPosition(c,i).x;p=clamp(p,0,1),u&&u.update(h,p),d&&d.update(h,l.getProgress())}handleMouseSeek(i){const l=this.getChild("seekBar");l&&l.handleMouseMove(i)}enabled(){return this.enabled_}disable(){if(this.children().forEach((i=>i.disable&&i.disable())),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const i=this.getChild("seekBar");this.player_.scrubbing(!1),i.videoWasPlaying&&silencePromise(this.player_.play())}}enable(){this.children().forEach((i=>i.enable&&i.enable())),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseSeek),this.off(i,"touchmove",this.throttledHandleMouseSeek),this.off(i,"mouseup",this.handleMouseUpHandler_),this.off(i,"touchend",this.handleMouseUpHandler_)}handleMouseDown(i){const l=this.el_.ownerDocument,d=this.getChild("seekBar");d&&d.handleMouseDown(i),this.on(l,"mousemove",this.throttledHandleMouseSeek),this.on(l,"touchmove",this.throttledHandleMouseSeek),this.on(l,"mouseup",this.handleMouseUpHandler_),this.on(l,"touchend",this.handleMouseUpHandler_)}handleMouseUp(i){const l=this.getChild("seekBar");l&&l.handleMouseUp(i),this.removeListenersAddedOnMousedownAndTouchstart()}}ProgressControl.prototype.options_={children:["seekBar"]},Component$1.registerComponent("ProgressControl",ProgressControl);class PictureInPictureToggle extends Button{constructor(i,l){super(i,l),this.setIcon("picture-in-picture-enter"),this.on(i,["enterpictureinpicture","leavepictureinpicture"],(i=>this.handlePictureInPictureChange(i))),this.on(i,["disablepictureinpicturechanged","loadedmetadata"],(i=>this.handlePictureInPictureEnabledChange(i))),this.on(i,["loadedmetadata","audioonlymodechange","audiopostermodechange"],(()=>this.handlePictureInPictureAudioModeChange())),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!("audio"===this.player_.currentType().substring(0,5)||this.player_.audioPosterMode()||this.player_.audioOnlyMode()))return this.show(),void 0;this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){g().pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in p()?this.enable():this.disable()}handlePictureInPictureChange(i){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(i){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){"function"==typeof g().exitPictureInPicture&&super.show()}}PictureInPictureToggle.prototype.controlText_="Picture-in-Picture",Component$1.registerComponent("PictureInPictureToggle",PictureInPictureToggle);class FullscreenToggle extends Button{constructor(i,l){super(i,l),this.setIcon("fullscreen-enter"),this.on(i,"fullscreenchange",(i=>this.handleFullscreenChange(i))),!1===g()[i.fsApi_.fullscreenEnabled]&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(i){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(i){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}FullscreenToggle.prototype.controlText_="Fullscreen",Component$1.registerComponent("FullscreenToggle",FullscreenToggle);Component$1.registerComponent("VolumeLevel",class VolumeLevel extends Component$1{createEl(){const i=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",i),i.appendChild(super.createEl("span",{className:"vjs-control-text"})),i}});Component$1.registerComponent("VolumeLevelTooltip",class VolumeLevelTooltip extends Component$1{constructor(i,l){super(i,l),this.update=throttle(bind_(this,this.update),At)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(i,l,d,u){if(!d){const d=getBoundingClientRect(this.el_),u=getBoundingClientRect(this.player_.el()),c=i.width*l;if(!u||!d)return;const h=i.left-u.left+c,p=i.width-c+(u.right-i.right);let m=d.width/2;h<m?m+=m-h:p<m&&(m=p),m<0?m=0:m>d.width&&(m=d.width),this.el_.style.right=`-${m}px`}this.write(`${u}%`)}write(i){textContent(this.el_,i)}updateVolume(i,l,d,u,c){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",(()=>{this.update(i,l,d,u.toFixed(0)),c&&c()}))}});class MouseVolumeLevelDisplay extends Component$1{constructor(i,l){super(i,l),this.update=throttle(bind_(this,this.update),At)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(i,l,d){const u=100*l;this.getChild("volumeLevelTooltip").updateVolume(i,l,d,u,(()=>{d?this.el_.style.bottom=i.height*l+"px":this.el_.style.left=i.width*l+"px"}))}}MouseVolumeLevelDisplay.prototype.options_={children:["volumeLevelTooltip"]},Component$1.registerComponent("MouseVolumeLevelDisplay",MouseVolumeLevelDisplay);class VolumeBar extends Slider{constructor(i,l){super(i,l),this.on("slideractive",(i=>this.updateLastVolume_(i))),this.on(i,"volumechange",(i=>this.updateARIAAttributes(i))),i.ready((()=>this.updateARIAAttributes()))}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(i){isSingleLeftClick(i)&&super.handleMouseDown(i)}handleMouseMove(i){const l=this.getChild("mouseVolumeLevelDisplay");if(l){const d=this.el(),u=getBoundingClientRect(d),c=this.vertical();let h=getPointerPosition(d,i);h=c?h.y:h.x,h=clamp(h,0,1),l.update(u,h,c)}isSingleLeftClick(i)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(i)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(i){const l=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",l),this.el_.setAttribute("aria-valuetext",l+"%")}volumeAsPercentage_(){return Math.round(100*this.player_.volume())}updateLastVolume_(){const i=this.player_.volume();this.one("sliderinactive",(()=>{0===this.player_.volume()&&this.player_.lastVolume_(i)}))}}VolumeBar.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},ft||Qe||VolumeBar.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),VolumeBar.prototype.playerEvent="volumechange",Component$1.registerComponent("VolumeBar",VolumeBar);class VolumeControl extends Component$1{constructor(i,l={}){l.vertical=l.vertical||!1,(void 0===l.volumeBar||isPlain(l.volumeBar))&&(l.volumeBar=l.volumeBar||{},l.volumeBar.vertical=l.vertical),super(i,l),function(i,l){l.tech_&&!l.tech_.featuresVolumeControl&&i.addClass("vjs-hidden"),i.on(l,"loadstart",(function(){l.tech_.featuresVolumeControl?i.removeClass("vjs-hidden"):i.addClass("vjs-hidden")}))}(this,i),this.throttledHandleMouseMove=throttle(bind_(this,this.handleMouseMove),At),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.on("mousedown",(i=>this.handleMouseDown(i))),this.on("touchstart",(i=>this.handleMouseDown(i))),this.on("mousemove",(i=>this.handleMouseMove(i))),this.on(this.volumeBar,["focus","slideractive"],(()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")})),this.on(this.volumeBar,["blur","sliderinactive"],(()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")}))}createEl(){let i="vjs-volume-horizontal";return this.options_.vertical&&(i="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${i}`})}handleMouseDown(i){const l=this.el_.ownerDocument;this.on(l,"mousemove",this.throttledHandleMouseMove),this.on(l,"touchmove",this.throttledHandleMouseMove),this.on(l,"mouseup",this.handleMouseUpHandler_),this.on(l,"touchend",this.handleMouseUpHandler_)}handleMouseUp(i){const l=this.el_.ownerDocument;this.off(l,"mousemove",this.throttledHandleMouseMove),this.off(l,"touchmove",this.throttledHandleMouseMove),this.off(l,"mouseup",this.handleMouseUpHandler_),this.off(l,"touchend",this.handleMouseUpHandler_)}handleMouseMove(i){this.volumeBar.handleMouseMove(i)}}VolumeControl.prototype.options_={children:["volumeBar"]},Component$1.registerComponent("VolumeControl",VolumeControl);class MuteToggle extends Button{constructor(i,l){super(i,l),function(i,l){l.tech_&&!l.tech_.featuresMuteControl&&i.addClass("vjs-hidden"),i.on(l,"loadstart",(function(){l.tech_.featuresMuteControl?i.removeClass("vjs-hidden"):i.addClass("vjs-hidden")}))}(this,i),this.on(i,["loadstart","volumechange"],(i=>this.update(i)))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(i){const l=this.player_.volume(),d=this.player_.lastVolume_();if(0===l){this.player_.volume(d<.1?.1:d),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(i){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const i=this.player_.volume();let l=3;this.setIcon("volume-high"),ft&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===i||this.player_.muted()?(this.setIcon("volume-mute"),l=0):i<.33?(this.setIcon("volume-low"),l=1):i<.67&&(this.setIcon("volume-medium"),l=2),removeClass(this.el_,[0,1,2,3].reduce(((i,l)=>i+`${l?" ":""}vjs-vol-${l}`),"")),addClass(this.el_,`vjs-vol-${l}`)}updateControlText_(){const i=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==i&&this.controlText(i)}}MuteToggle.prototype.controlText_="Mute",Component$1.registerComponent("MuteToggle",MuteToggle);class VolumePanel extends Component$1{constructor(i,l={}){l.inline=void 0===l.inline||l.inline,(void 0===l.volumeControl||isPlain(l.volumeControl))&&(l.volumeControl=l.volumeControl||{},l.volumeControl.vertical=!l.inline),super(i,l),this.handleKeyPressHandler_=i=>this.handleKeyPress(i),this.on(i,["loadstart"],(i=>this.volumePanelState_(i))),this.on(this.muteToggle,"keyup",(i=>this.handleKeyPress(i))),this.on(this.volumeControl,"keyup",(i=>this.handleVolumeControlKeyUp(i))),this.on("keydown",(i=>this.handleKeyPress(i))),this.on("mouseover",(i=>this.handleMouseOver(i))),this.on("mouseout",(i=>this.handleMouseOut(i))),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let i="vjs-volume-panel-horizontal";return this.options_.inline||(i="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${i}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(i){"Escape"===i.key&&this.muteToggle.focus()}handleMouseOver(i){this.addClass("vjs-hover"),on(g(),"keyup",this.handleKeyPressHandler_)}handleMouseOut(i){this.removeClass("vjs-hover"),off(g(),"keyup",this.handleKeyPressHandler_)}handleKeyPress(i){"Escape"===i.key&&this.handleMouseOut()}}VolumePanel.prototype.options_={children:["muteToggle","volumeControl"]},Component$1.registerComponent("VolumePanel",VolumePanel);class SkipForward extends Button{constructor(i,l){super(i,l),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(i.language())])),this.show()):this.hide()}getSkipForwardTime(){const i=this.options_.playerOptions;return i.controlBar&&i.controlBar.skipButtons&&i.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(i){if(isNaN(this.player_.duration()))return;const l=this.player_.currentTime(),d=this.player_.liveTracker,u=d&&d.isLive()?d.seekableEnd():this.player_.duration();let c;c=l+this.skipTime<=u?l+this.skipTime:u,this.player_.currentTime(c)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}SkipForward.prototype.controlText_="Skip Forward",Component$1.registerComponent("SkipForward",SkipForward);class SkipBackward extends Button{constructor(i,l){super(i,l),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(i.language())])),this.show()):this.hide()}getSkipBackwardTime(){const i=this.options_.playerOptions;return i.controlBar&&i.controlBar.skipButtons&&i.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(i){const l=this.player_.currentTime(),d=this.player_.liveTracker,u=d&&d.isLive()&&d.seekableStart();let c;c=u&&l-this.skipTime<=u?u:l>=this.skipTime?l-this.skipTime:0,this.player_.currentTime(c)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}SkipBackward.prototype.controlText_="Skip Backward",Component$1.registerComponent("SkipBackward",SkipBackward);class Menu extends Component$1{constructor(i,l){super(i,l),l&&(this.menuButton_=l.menuButton),this.focusedChild_=-1,this.on("keydown",(i=>this.handleKeyDown(i))),this.boundHandleBlur_=i=>this.handleBlur(i),this.boundHandleTapClick_=i=>this.handleTapClick(i)}addEventListenerForItem(i){i instanceof Component$1&&(this.on(i,"blur",this.boundHandleBlur_),this.on(i,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(i){i instanceof Component$1&&(this.off(i,"blur",this.boundHandleBlur_),this.off(i,["tap","click"],this.boundHandleTapClick_))}removeChild(i){"string"==typeof i&&(i=this.getChild(i)),this.removeEventListenerForItem(i),super.removeChild(i)}addItem(i){const l=this.addChild(i);l&&this.addEventListenerForItem(l)}createEl(){this.contentEl_=createEl(this.options_.contentElType||"ul",{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const i=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return i.appendChild(this.contentEl_),on(i,"click",(function(i){i.preventDefault(),i.stopImmediatePropagation()})),i}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(i){const l=i.relatedTarget||g().activeElement;if(!this.children().some((i=>i.el()===l))){const i=this.menuButton_;i&&i.buttonPressed_&&l!==i.el().firstChild&&i.unpressButton()}}handleTapClick(i){if(this.menuButton_){this.menuButton_.unpressButton();const l=this.children();if(!Array.isArray(l))return;const d=l.filter((l=>l.el()===i.target))[0];if(!d)return;"CaptionSettingsMenuItem"!==d.name()&&this.menuButton_.focus()}}handleKeyDown(i){"ArrowLeft"===i.key||"ArrowDown"===i.key?(i.preventDefault(),i.stopPropagation(),this.stepForward()):"ArrowRight"!==i.key&&"ArrowUp"!==i.key||(i.preventDefault(),i.stopPropagation(),this.stepBack())}stepForward(){let i=0;void 0!==this.focusedChild_&&(i=this.focusedChild_+1),this.focus(i)}stepBack(){let i=0;void 0!==this.focusedChild_&&(i=this.focusedChild_-1),this.focus(i)}focus(i=0){const l=this.children().slice();l.length&&l[0].hasClass("vjs-menu-title")&&l.shift(),l.length>0&&(i<0?i=0:i>=l.length&&(i=l.length-1),this.focusedChild_=i,l[i].el_.focus())}}Component$1.registerComponent("Menu",Menu);class MenuButton extends Component$1{constructor(i,l={}){super(i,l),this.menuButton_=new Button(i,l),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const d=Button.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+d,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const handleClick=i=>this.handleClick(i);this.handleMenuKeyUp_=i=>this.handleMenuKeyUp(i),this.on(this.menuButton_,"tap",handleClick),this.on(this.menuButton_,"click",handleClick),this.on(this.menuButton_,"keydown",(i=>this.handleKeyDown(i))),this.on(this.menuButton_,"mouseenter",(()=>{this.addClass("vjs-hover"),this.menu.show(),on(g(),"keyup",this.handleMenuKeyUp_)})),this.on("mouseleave",(i=>this.handleMouseLeave(i))),this.on("keydown",(i=>this.handleSubmenuKeyDown(i)))}update(){const i=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=i,this.addChild(i),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const i=new Menu(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const l=createEl("li",{className:"vjs-menu-title",textContent:toTitleCase$1(this.options_.title),tabIndex:-1}),d=new Component$1(this.player_,{el:l});i.addItem(d)}if(this.items=this.createItems(),this.items)for(let l=0;l<this.items.length;l++)i.addItem(this.items[l]);return i}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(i){super.setIcon(i,this.menuButton_.el_)}buildWrapperCSSClass(){let i="vjs-menu-button";i+=!0===this.options_.inline?"-inline":"-popup";return`vjs-menu-button ${i} ${Button.prototype.buildCSSClass()} ${super.buildCSSClass()}`}buildCSSClass(){let i="vjs-menu-button";return i+=!0===this.options_.inline?"-inline":"-popup",`vjs-menu-button ${i} ${super.buildCSSClass()}`}controlText(i,l=this.menuButton_.el()){return this.menuButton_.controlText(i,l)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(i){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(i){this.removeClass("vjs-hover"),off(g(),"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(i){"Escape"===i.key||"Tab"===i.key?(this.buttonPressed_&&this.unpressButton(),"Tab"===!i.key&&(i.preventDefault(),this.menuButton_.focus())):"Up"!==i.key&&("Down"!==i.key||this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled)||this.buttonPressed_||(i.preventDefault(),this.pressButton())}handleMenuKeyUp(i){"Escape"!==i.key&&"Tab"!==i.key||this.removeClass("vjs-hover")}handleSubmenuKeyPress(i){this.handleSubmenuKeyDown(i)}handleSubmenuKeyDown(i){"Escape"!==i.key&&"Tab"!==i.key||(this.buttonPressed_&&this.unpressButton(),"Tab"===!i.key&&(i.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),ft&&isInFrame())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}Component$1.registerComponent("MenuButton",MenuButton);class TrackButton extends MenuButton{constructor(i,l){const d=l.tracks;if(super(i,l),this.items.length<=1&&this.hide(),!d)return;const u=bind_(this,this.update);d.addEventListener("removetrack",u),d.addEventListener("addtrack",u),d.addEventListener("labelchange",u),this.player_.on("ready",u),this.player_.on("dispose",(function(){d.removeEventListener("removetrack",u),d.removeEventListener("addtrack",u),d.removeEventListener("labelchange",u)}))}}Component$1.registerComponent("TrackButton",TrackButton);class MenuItem extends ClickableComponent{constructor(i,l){super(i,l),this.selectable=l.selectable,this.isSelected_=l.selected||!1,this.multiSelectable=l.multiSelectable,this.selected(this.isSelected_),this.el_.setAttribute("role",this.selectable?this.multiSelectable?"menuitemcheckbox":"menuitemradio":"menuitem")}createEl(i,l,d){this.nonIconControl=!0;const u=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},l),d),c=createEl("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?u.appendChild(c):u.replaceChild(c,u.querySelector(".vjs-icon-placeholder")),u}handleKeyDown(i){["Tab","Escape","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"].includes(i.key)||super.handleKeyDown(i)}handleClick(i){this.selected(!0)}selected(i){this.selectable&&(i?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}Component$1.registerComponent("MenuItem",MenuItem);class TextTrackMenuItem extends MenuItem{constructor(i,l){const d=l.track,u=i.textTracks();l.label=d.label||d.language||"Unknown",l.selected="showing"===d.mode,super(i,l),this.track=d,this.kinds=(l.kinds||[l.kind||this.track.kind]).filter(Boolean);const changeHandler=(...i)=>{this.handleTracksChange.apply(this,i)},selectedLanguageChangeHandler=(...i)=>{this.handleSelectedLanguageChange.apply(this,i)};if(i.on(["loadstart","texttrackchange"],changeHandler),u.addEventListener("change",changeHandler),u.addEventListener("selectedlanguagechange",selectedLanguageChangeHandler),this.on("dispose",(function(){i.off(["loadstart","texttrackchange"],changeHandler),u.removeEventListener("change",changeHandler),u.removeEventListener("selectedlanguagechange",selectedLanguageChangeHandler)})),void 0===u.onchange){let i;this.on(["tap","click"],(function(){if("object"!=typeof p().Event)try{i=new(p().Event)("change")}catch(i){}i||(i=g().createEvent("Event"),i.initEvent("change",!0,!0)),u.dispatchEvent(i)}))}this.handleTracksChange()}handleClick(i){const l=this.track,d=this.player_.textTracks();if(super.handleClick(i),d)for(let i=0;i<d.length;i++){const u=d[i];-1!==this.kinds.indexOf(u.kind)&&(u===l?"showing"!==u.mode&&(u.mode="showing"):"disabled"!==u.mode&&(u.mode="disabled"))}}handleTracksChange(i){const l="showing"===this.track.mode;l!==this.isSelected_&&this.selected(l)}handleSelectedLanguageChange(i){if("showing"===this.track.mode){const i=this.player_.cache_.selectedLanguage;if(i&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}Component$1.registerComponent("TextTrackMenuItem",TextTrackMenuItem);class OffTextTrackMenuItem extends TextTrackMenuItem{constructor(i,l){l.track={player:i,kind:l.kind,kinds:l.kinds,default:!1,mode:"disabled"},l.kinds||(l.kinds=[l.kind]),l.track.label=l.label?l.label:l.kinds.join(" and ")+" off",l.selectable=!0,l.multiSelectable=!1,super(i,l)}handleTracksChange(i){const l=this.player().textTracks();let d=!0;for(let i=0,u=l.length;i<u;i++){const u=l[i];if(this.options_.kinds.indexOf(u.kind)>-1&&"showing"===u.mode){d=!1;break}}d!==this.isSelected_&&this.selected(d)}handleSelectedLanguageChange(i){const l=this.player().textTracks();let d=!0;for(let i=0,u=l.length;i<u;i++){const u=l[i];if(["captions","descriptions","subtitles"].indexOf(u.kind)>-1&&"showing"===u.mode){d=!1;break}}d&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}Component$1.registerComponent("OffTextTrackMenuItem",OffTextTrackMenuItem);class TextTrackButton extends TrackButton{constructor(i,l={}){l.tracks=i.textTracks(),super(i,l)}createItems(i=[],l=TextTrackMenuItem){let d;this.label_&&(d=`${this.label_} off`),i.push(new OffTextTrackMenuItem(this.player_,{kinds:this.kinds_,kind:this.kind_,label:d})),this.hideThreshold_+=1;const u=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let d=0;d<u.length;d++){const c=u[d];if(this.kinds_.indexOf(c.kind)>-1){const d=new l(this.player_,{track:c,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});d.addClass(`vjs-${c.kind}-menu-item`),i.push(d)}}return i}}Component$1.registerComponent("TextTrackButton",TextTrackButton);class ChaptersTrackMenuItem extends MenuItem{constructor(i,l){const d=l.track,u=l.cue,c=i.currentTime();l.selectable=!0,l.multiSelectable=!1,l.label=u.text,l.selected=u.startTime<=c&&c<u.endTime,super(i,l),this.track=d,this.cue=u}handleClick(i){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}Component$1.registerComponent("ChaptersTrackMenuItem",ChaptersTrackMenuItem);class ChaptersButton extends TextTrackButton{constructor(i,l,d){super(i,l,d),this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach((i=>{i.selected(this.track_.activeCues[0]===i.cue)}))}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(i){if(i&&i.track&&"chapters"!==i.track.kind)return;const l=this.findChaptersTrack();l!==this.track_?(this.setTrack(l),super.update()):(!this.items||l&&l.cues&&l.cues.length!==this.items.length)&&super.update()}setTrack(i){if(this.track_!==i){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=i,this.track_){this.track_.mode="hidden";const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const i=this.player_.textTracks()||[];for(let l=i.length-1;l>=0;l--){const d=i[l];if(d.kind===this.kind_)return d}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(toTitleCase$1(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const i=[];if(!this.track_)return i;const l=this.track_.cues;if(!l)return i;for(let d=0,u=l.length;d<u;d++){const u=new ChaptersTrackMenuItem(this.player_,{track:this.track_,cue:l[d]});i.push(u)}return i}}ChaptersButton.prototype.kind_="chapters",ChaptersButton.prototype.controlText_="Chapters",Component$1.registerComponent("ChaptersButton",ChaptersButton);class DescriptionsButton extends TextTrackButton{constructor(i,l,d){super(i,l,d),this.setIcon("audio-description");const u=i.textTracks(),c=bind_(this,this.handleTracksChange);u.addEventListener("change",c),this.on("dispose",(function(){u.removeEventListener("change",c)}))}handleTracksChange(i){const l=this.player().textTracks();let d=!1;for(let i=0,u=l.length;i<u;i++){const u=l[i];if(u.kind!==this.kind_&&"showing"===u.mode){d=!0;break}}d?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}DescriptionsButton.prototype.kind_="descriptions",DescriptionsButton.prototype.controlText_="Descriptions",Component$1.registerComponent("DescriptionsButton",DescriptionsButton);class SubtitlesButton extends TextTrackButton{constructor(i,l,d){super(i,l,d),this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}SubtitlesButton.prototype.kind_="subtitles",SubtitlesButton.prototype.controlText_="Subtitles",Component$1.registerComponent("SubtitlesButton",SubtitlesButton);class CaptionSettingsMenuItem extends TextTrackMenuItem{constructor(i,l){l.track={player:i,kind:l.kind,label:l.kind+" settings",selectable:!1,default:!1,mode:"disabled"},l.selectable=!1,l.name="CaptionSettingsMenuItem",super(i,l),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+l.kind+" settings dialog")}handleClick(i){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}Component$1.registerComponent("CaptionSettingsMenuItem",CaptionSettingsMenuItem);class CaptionsButton extends TextTrackButton{constructor(i,l,d){super(i,l,d),this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const i=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(i.push(new CaptionSettingsMenuItem(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(i)}}CaptionsButton.prototype.kind_="captions",CaptionsButton.prototype.controlText_="Captions",Component$1.registerComponent("CaptionsButton",CaptionsButton);class SubsCapsMenuItem extends TextTrackMenuItem{createEl(i,l,d){const u=super.createEl(i,l,d),c=u.querySelector(".vjs-menu-item-text");return"captions"===this.options_.track.kind&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",u):c.appendChild(createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),c.appendChild(createEl("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),u}}Component$1.registerComponent("SubsCapsMenuItem",SubsCapsMenuItem);class SubsCapsButton extends TextTrackButton{constructor(i,l={}){super(i,l),this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(toTitleCase$1(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let i=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(i.push(new CaptionSettingsMenuItem(this.player_,{kind:this.label_})),this.hideThreshold_+=1),i=super.createItems(i,SubsCapsMenuItem),i}}SubsCapsButton.prototype.kinds_=["captions","subtitles"],SubsCapsButton.prototype.controlText_="Subtitles",Component$1.registerComponent("SubsCapsButton",SubsCapsButton);class AudioTrackMenuItem extends MenuItem{constructor(i,l){const d=l.track,u=i.audioTracks();l.label=d.label||d.language||"Unknown",l.selected=d.enabled,super(i,l),this.track=d,this.addClass(`vjs-${d.kind}-menu-item`);const changeHandler=(...i)=>{this.handleTracksChange.apply(this,i)};u.addEventListener("change",changeHandler),this.on("dispose",(()=>{u.removeEventListener("change",changeHandler)}))}createEl(i,l,d){const u=super.createEl(i,l,d),c=u.querySelector(".vjs-menu-item-text");return["main-desc","descriptions"].indexOf(this.options_.track.kind)>=0&&(c.appendChild(createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),c.appendChild(createEl("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),u}handleClick(i){if(super.handleClick(i),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const i=this.player_.audioTracks();for(let l=0;l<i.length;l++){const d=i[l];d!==this.track&&(d.enabled=d===this.track)}}}handleTracksChange(i){this.selected(this.track.enabled)}}Component$1.registerComponent("AudioTrackMenuItem",AudioTrackMenuItem);class AudioTrackButton extends TrackButton{constructor(i,l={}){l.tracks=i.audioTracks(),super(i,l),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(i=[]){this.hideThreshold_=1;const l=this.player_.audioTracks();for(let d=0;d<l.length;d++){i.push(new AudioTrackMenuItem(this.player_,{track:l[d],selectable:!0,multiSelectable:!1}))}return i}}AudioTrackButton.prototype.controlText_="Audio Track",Component$1.registerComponent("AudioTrackButton",AudioTrackButton);class PlaybackRateMenuItem extends MenuItem{constructor(i,l){const d=l.rate,u=parseFloat(d,10);l.label=d,l.selected=u===i.playbackRate(),l.selectable=!0,l.multiSelectable=!1,super(i,l),this.label=d,this.rate=u,this.on(i,"ratechange",(i=>this.update(i)))}handleClick(i){super.handleClick(),this.player().playbackRate(this.rate)}update(i){this.selected(this.player().playbackRate()===this.rate)}}PlaybackRateMenuItem.prototype.contentElType="button",Component$1.registerComponent("PlaybackRateMenuItem",PlaybackRateMenuItem);class PlaybackRateMenuButton extends MenuButton{constructor(i,l){super(i,l),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(i,"loadstart",(i=>this.updateVisibility(i))),this.on(i,"ratechange",(i=>this.updateLabel(i))),this.on(i,"playbackrateschange",(i=>this.handlePlaybackRateschange(i)))}createEl(){const i=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=createEl("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),i.appendChild(this.labelEl_),i}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const i=this.playbackRates(),l=[];for(let d=i.length-1;d>=0;d--)l.push(new PlaybackRateMenuItem(this.player(),{rate:i[d]+"x"}));return l}handlePlaybackRateschange(i){this.update()}playbackRates(){const i=this.player();return i.playbackRates&&i.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(i){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(i){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}PlaybackRateMenuButton.prototype.controlText_="Playback Rate",Component$1.registerComponent("PlaybackRateMenuButton",PlaybackRateMenuButton);class Spacer extends Component$1{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(i="div",l={},d={}){return l.className||(l.className=this.buildCSSClass()),super.createEl(i,l,d)}}Component$1.registerComponent("Spacer",Spacer);Component$1.registerComponent("CustomControlSpacer",class CustomControlSpacer extends Spacer{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:" "})}});class ControlBar extends Component$1{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}ControlBar.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},Component$1.registerComponent("ControlBar",ControlBar);class ErrorDisplay extends ModalDialog{constructor(i,l){super(i,l),this.on(i,"error",(i=>{this.open(i)}))}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const i=this.player().error();return i?this.localize(i.message):""}}ErrorDisplay.prototype.options_=Object.assign({},ModalDialog.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Component$1.registerComponent("ErrorDisplay",ErrorDisplay);class TextTrackSelect extends Component$1{constructor(i,l={}){super(i,l),this.el_.setAttribute("aria-labelledby",this.selectLabelledbyIds)}createEl(){this.selectLabelledbyIds=[this.options_.legendId,this.options_.labelId].join(" ").trim();return createEl("select",{id:this.options_.id},{},this.options_.SelectOptions.map((i=>{const l=(this.options_.labelId?this.options_.labelId:`vjs-track-option-${newGUID()}`)+"-"+i[1].replace(/\W+/g,""),d=createEl("option",{id:l,value:this.localize(i[0]),textContent:this.localize(i[1])});return d.setAttribute("aria-labelledby",`${this.selectLabelledbyIds} ${l}`),d})))}}Component$1.registerComponent("TextTrackSelect",TextTrackSelect);class TextTrackFieldset extends Component$1{constructor(i,l={}){super(i,l);const d=createEl("legend",{textContent:this.localize(this.options_.legendText),id:this.options_.legendId});this.el().appendChild(d);const u=this.options_.selects;for(const l of u){const d=this.options_.selectConfigs[l],u=d.className,c=d.id.replace("%s",this.options_.id_);let h=null;const p=`vjs_select_${newGUID()}`;if("colors"===this.options_.type){h=createEl("span",{className:u});const i=createEl("label",{id:c,className:"vjs-label",textContent:this.localize(d.label)});i.setAttribute("for",p),h.appendChild(i)}const m=new TextTrackSelect(i,{SelectOptions:d.options,legendId:this.options_.legendId,id:p,labelId:c});this.addChild(m),"colors"===this.options_.type&&(h.appendChild(m.el()),this.el().appendChild(h))}}createEl(){return createEl("fieldset",{className:this.options_.className})}}Component$1.registerComponent("TextTrackFieldset",TextTrackFieldset);class TextTrackSettingsColors extends Component$1{constructor(i,l={}){super(i,l);const d=this.options_.textTrackComponentid,u=new TextTrackFieldset(i,{id_:d,legendId:`captions-text-legend-${d}`,legendText:this.localize("Text"),className:"vjs-fg vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(u);const c=new TextTrackFieldset(i,{id_:d,legendId:`captions-background-${d}`,legendText:this.localize("Text Background"),className:"vjs-bg vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(c);const h=new TextTrackFieldset(i,{id_:d,legendId:`captions-window-${d}`,legendText:this.localize("Caption Area Background"),className:"vjs-window vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(h)}createEl(){return createEl("div",{className:"vjs-track-settings-colors"})}}Component$1.registerComponent("TextTrackSettingsColors",TextTrackSettingsColors);class TextTrackSettingsFont extends Component$1{constructor(i,l={}){super(i,l);const d=this.options_.textTrackComponentid,u=new TextTrackFieldset(i,{id_:d,legendId:`captions-font-size-${d}`,legendText:"Font Size",className:"vjs-font-percent vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(u);const c=new TextTrackFieldset(i,{id_:d,legendId:`captions-edge-style-${d}`,legendText:this.localize("Text Edge Style"),className:"vjs-edge-style vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(c);const h=new TextTrackFieldset(i,{id_:d,legendId:`captions-font-family-${d}`,legendText:this.localize("Font Family"),className:"vjs-font-family vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(h)}createEl(){return createEl("div",{className:"vjs-track-settings-font"})}}Component$1.registerComponent("TextTrackSettingsFont",TextTrackSettingsFont);class TrackSettingsControls extends Component$1{constructor(i,l={}){super(i,l);const d=this.localize("restore all settings to the default values"),u=new Button(i,{controlText:d,className:"vjs-default-button"});u.el().classList.remove("vjs-control","vjs-button"),u.el().textContent=this.localize("Reset"),this.addChild(u);const c=new Button(i,{controlText:d,className:"vjs-done-button"});c.el().classList.remove("vjs-control","vjs-button"),c.el().textContent=this.localize("Done"),this.addChild(c)}createEl(){return createEl("div",{className:"vjs-track-settings-controls"})}}Component$1.registerComponent("TrackSettingsControls",TrackSettingsControls);const si="vjs-text-track-settings",ni=["#000","Black"],ai=["#00F","Blue"],oi=["#0FF","Cyan"],li=["#0F0","Green"],di=["#F0F","Magenta"],ui=["#F00","Red"],ci=["#FFF","White"],hi=["#FF0","Yellow"],pi=["1","Opaque"],mi=["0.5","Semi-Transparent"],fi=["0","Transparent"],gi={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ni,ci,ui,li,ai,hi,di,oi],className:"vjs-bg-color"},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[pi,mi,fi],className:"vjs-bg-opacity vjs-opacity"},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[ci,ni,ui,li,ai,hi,di,oi],className:"vjs-text-color"},edgeStyle:{selector:".vjs-edge-style > select",id:"",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:i=>"1.00"===i?null:Number(i)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[pi,mi],className:"vjs-text-opacity vjs-opacity"},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color",className:"vjs-window-color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[fi,mi,pi],className:"vjs-window-opacity vjs-opacity"}};function parseOptionValue(i,l){if(l&&(i=l(i)),i&&"none"!==i)return i}gi.windowColor.options=gi.backgroundColor.options;Component$1.registerComponent("TextTrackSettings",class TextTrackSettings extends ModalDialog{constructor(i,l){l.temporary=!1,super(i,l),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.renderModalComponents(i),this.endDialog=createEl("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),void 0===l.persistTextTrackSettings&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.bindFunctionsToSelectsAndButtons(),this.options_.persistTextTrackSettings&&this.restoreSettings()}renderModalComponents(i){const l=new TextTrackSettingsColors(i,{textTrackComponentid:this.id_,selectConfigs:gi,fieldSets:[["color","textOpacity"],["backgroundColor","backgroundOpacity"],["windowColor","windowOpacity"]]});this.addChild(l);const d=new TextTrackSettingsFont(i,{textTrackComponentid:this.id_,selectConfigs:gi,fieldSets:[["fontPercent"],["edgeStyle"],["fontFamily"]]});this.addChild(d);const u=new TrackSettingsControls(i);this.addChild(u)}bindFunctionsToSelectsAndButtons(){this.on(this.$(".vjs-done-button"),["click","tap"],(()=>{this.saveSettings(),this.close()})),this.on(this.$(".vjs-default-button"),["click","tap"],(()=>{this.setDefaults(),this.updateDisplay()})),each(gi,(i=>{this.on(this.$(i.selector),"change",this.updateDisplay)}))}dispose(){this.endDialog=null,super.dispose()}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return reduce(gi,((i,l,d)=>{const u=function getSelectedOptionValue(i,l){return parseOptionValue(i.options[i.options.selectedIndex].value,l)}(this.$(l.selector),l.parser);return void 0!==u&&(i[d]=u),i}),{})}setValues(i){each(gi,((l,d)=>{!function setSelectedOption(i,l,d){if(l)for(let u=0;u<i.options.length;u++)if(parseOptionValue(i.options[u].value,d)===l){i.selectedIndex=u;break}}(this.$(l.selector),i[d],l.parser)}))}setDefaults(){each(gi,(i=>{const l=i.hasOwnProperty("default")?i.default:0;this.$(i.selector).selectedIndex=l}))}restoreSettings(){let i;try{i=JSON.parse(p().localStorage.getItem(si))}catch(i){$e.warn(i)}i&&this.setValues(i)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const i=this.getValues();try{Object.keys(i).length?p().localStorage.setItem(si,JSON.stringify(i)):p().localStorage.removeItem(si)}catch(i){$e.warn(i)}}updateDisplay(){const i=this.player_.getChild("textTrackDisplay");i&&i.updateDisplay()}handleLanguagechange(){this.fill(),this.renderModalComponents(this.player_),this.bindFunctionsToSelectsAndButtons()}});Component$1.registerComponent("ResizeManager",class ResizeManager extends Component$1{constructor(i,l){let d=l.ResizeObserver||p().ResizeObserver;null===l.ResizeObserver&&(d=!1);super(i,merge$1({createEl:!d,reportTouchActivity:!1},l)),this.ResizeObserver=l.ResizeObserver||p().ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=debounce$1((()=>{this.resizeHandler()}),100,!1,this),d?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(i.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const i=this.debouncedHandler_;let l=this.unloadListener_=function(){off(this,"resize",i),off(this,"unload",l),l=null};on(this.el_.contentWindow,"unload",l),on(this.el_.contentWindow,"resize",i)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}});const yi={trackingThreshold:20,liveTolerance:15};Component$1.registerComponent("LiveTracker",class LiveTracker extends Component$1{constructor(i,l){super(i,merge$1(yi,l,{createEl:!1})),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=i=>this.handlePlay(i),this.handleFirstTimeupdate_=i=>this.handleFirstTimeupdate(i),this.handleSeeked_=i=>this.handleSeeked(i),this.seekToLiveEdge_=i=>this.seekToLiveEdge(i),this.reset_(),this.on(this.player_,"durationchange",(i=>this.handleDurationchange(i))),this.on(this.player_,"canplay",(()=>this.toggleTracking()))}trackLive_(){const i=this.player_.seekable();if(!i||!i.length)return;const l=Number(p().performance.now().toFixed(4)),d=-1===this.lastTime_?0:(l-this.lastTime_)/1e3;this.lastTime_=l,this.pastSeekEnd_=this.pastSeekEnd()+d;const u=this.liveCurrentTime(),c=this.player_.currentTime();let h=this.player_.paused()||this.seekedBehindLive_||Math.abs(u-c)>this.options_.liveTolerance;this.timeupdateSeen_&&u!==1/0||(h=!1),h!==this.behindLiveEdge_&&(this.behindLiveEdge_=h,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,At),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const i=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&i>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const i=this.player_.seekable(),l=[];let d=i?i.length:0;for(;d--;)l.push(i.end(d));return l.length?l.sort()[l.length-1]:1/0}seekableStart(){const i=this.player_.seekable(),l=[];let d=i?i.length:0;for(;d--;)l.push(i.start(d));return l.length?l.sort()[0]:0}liveWindow(){const i=this.liveCurrentTime();return i===1/0?0:i-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const i=this.seekableEnd();return-1!==this.lastSeekEnd_&&i!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=i,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return"number"==typeof this.trackingInterval_}seekToLiveEdge(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}});Component$1.registerComponent("TitleBar",class TitleBar extends Component$1{constructor(i,l){super(i,l),this.on("statechanged",(i=>this.updateDom_())),this.updateDom_()}createEl(){return this.els={title:createEl("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${newGUID()}`}),description:createEl("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${newGUID()}`})},createEl("div",{className:"vjs-title-bar"},{},video_es_values(this.els))}updateDom_(){const i=this.player_.tech_,l=i&&i.el_,d={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach((i=>{const u=this.state[i],c=this.els[i],h=d[i];emptyEl(c),u&&textContent(c,u),l&&(l.removeAttribute(h),u&&l.setAttribute(h,c.id))})),this.state.title||this.state.description?this.show():this.hide()}update(i){this.setState(i)}dispose(){const i=this.player_.tech_,l=i&&i.el_;l&&(l.removeAttribute("aria-labelledby"),l.removeAttribute("aria-describedby")),super.dispose(),this.els=null}});const _i={initialDisplay:4e3,position:[],takeFocus:!1};Component$1.registerComponent("TransientButton",class TransientButton extends Button{constructor(i,l){super(i,l=merge$1(_i,l)),this.controlText(l.controlText),this.hide(),this.on(this.player_,["useractive","userinactive"],(i=>{this.removeClass("force-display")}))}buildCSSClass(){return`vjs-transient-button focus-visible ${this.options_.position.map((i=>`vjs-${i}`)).join(" ")}`}createEl(){const i=createEl("button",{},{type:"button",class:this.buildCSSClass()},createEl("span"));return this.controlTextEl_=i.querySelector("span"),i}show(){super.show(),this.addClass("force-display"),this.options_.takeFocus&&this.el().focus({preventScroll:!0}),this.forceDisplayTimeout=this.player_.setTimeout((()=>{this.removeClass("force-display")}),this.options_.initialDisplay)}hide(){this.removeClass("force-display"),super.hide()}dispose(){this.player_.clearTimeout(this.forceDisplayTimeout),super.dispose()}});const sourcesetLoad=i=>{const l=i.el();if(l.hasAttribute("src"))return i.triggerSourceset(l.src),!0;const d=i.$$("source"),u=[];let c="";if(!d.length)return!1;for(let i=0;i<d.length;i++){const l=d[i].src;l&&-1===u.indexOf(l)&&u.push(l)}return!!u.length&&(1===u.length&&(c=u[0]),i.triggerSourceset(c),!0)},vi=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(i){const l=g().createElement(this.nodeName.toLowerCase());l.innerHTML=i;const d=g().createDocumentFragment();for(;l.childNodes.length;)d.appendChild(l.childNodes[0]);return this.innerText="",p().Element.prototype.appendChild.call(this,d),this.innerHTML}}),getDescriptor=(i,l)=>{let d={};for(let u=0;u<i.length&&(d=Object.getOwnPropertyDescriptor(i[u],l),!(d&&d.set&&d.get));u++);return d.enumerable=!0,d.configurable=!0,d},firstSourceWatch=function(i){const l=i.el();if(l.resetSourceWatch_)return;const d={},u=(i=>getDescriptor([i.el(),p().HTMLMediaElement.prototype,p().Element.prototype,vi],"innerHTML"))(i),appendWrapper=d=>(...u)=>{const c=d.apply(l,u);return sourcesetLoad(i),c};["append","appendChild","insertAdjacentHTML"].forEach((i=>{l[i]&&(d[i]=l[i],l[i]=appendWrapper(d[i]))})),Object.defineProperty(l,"innerHTML",merge$1(u,{set:appendWrapper(u.set)})),l.resetSourceWatch_=()=>{l.resetSourceWatch_=null,Object.keys(d).forEach((i=>{l[i]=d[i]})),Object.defineProperty(l,"innerHTML",u)},i.one("sourceset",l.resetSourceWatch_)},bi=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?getAbsoluteURL(p().Element.prototype.getAttribute.call(this,"src")):""},set(i){return p().Element.prototype.setAttribute.call(this,"src",i),i}}),setupSourceset=function(i){if(!i.featuresSourceset)return;const l=i.el();if(l.resetSourceset_)return;const d=(i=>getDescriptor([i.el(),p().HTMLMediaElement.prototype,bi],"src"))(i),u=l.setAttribute,c=l.load;Object.defineProperty(l,"src",merge$1(d,{set:u=>{const c=d.set.call(l,u);return i.triggerSourceset(l.src),c}})),l.setAttribute=(d,c)=>{const h=u.call(l,d,c);return/src/i.test(d)&&i.triggerSourceset(l.src),h},l.load=()=>{const d=c.call(l);return sourcesetLoad(i)||(i.triggerSourceset(""),firstSourceWatch(i)),d},l.currentSrc?i.triggerSourceset(l.currentSrc):sourcesetLoad(i)||firstSourceWatch(i),l.resetSourceset_=()=>{l.resetSourceset_=null,l.load=c,l.setAttribute=u,Object.defineProperty(l,"src",d),l.resetSourceWatch_&&l.resetSourceWatch_()}};class Html5 extends Tech{constructor(i,l){super(i,l);const d=i.source;let u=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&"VIDEO"===this.el_.tagName,d&&(this.el_.currentSrc!==d.src||i.tag&&3===i.tag.initNetworkState_)?this.setSource(d):this.handleLateInit_(this.el_),i.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const i=this.el_.childNodes;let l=i.length;const d=[];for(;l--;){const c=i[l];"track"===c.nodeName.toLowerCase()&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(c),this.remoteTextTracks().addTrack(c.track),this.textTracks().addTrack(c.track),u||this.el_.hasAttribute("crossorigin")||!isCrossOrigin(c.src)||(u=!0)):d.push(c))}for(let i=0;i<d.length;i++)this.el_.removeChild(d[i])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&u&&$e.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),this.restoreMetadataTracksInIOSNativePlayer_(),(pt||dt)&&!0===i.nativeControlsForTouch&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Html5.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){setupSourceset(this)}restoreMetadataTracksInIOSNativePlayer_(){const i=this.textTracks();let l;const takeMetadataTrackSnapshot=()=>{l=[];for(let d=0;d<i.length;d++){const u=i[d];"metadata"===u.kind&&l.push({track:u,storedMode:u.mode})}};takeMetadataTrackSnapshot(),i.addEventListener("change",takeMetadataTrackSnapshot),this.on("dispose",(()=>i.removeEventListener("change",takeMetadataTrackSnapshot)));const restoreTrackMode=()=>{for(let i=0;i<l.length;i++){const d=l[i];"disabled"===d.track.mode&&d.track.mode!==d.storedMode&&(d.track.mode=d.storedMode)}i.removeEventListener("change",restoreTrackMode)};this.on("webkitbeginfullscreen",(()=>{i.removeEventListener("change",takeMetadataTrackSnapshot),i.removeEventListener("change",restoreTrackMode),i.addEventListener("change",restoreTrackMode)})),this.on("webkitendfullscreen",(()=>{i.removeEventListener("change",takeMetadataTrackSnapshot),i.addEventListener("change",takeMetadataTrackSnapshot),i.removeEventListener("change",restoreTrackMode)}))}overrideNative_(i,l){if(l!==this[`featuresNative${i}Tracks`])return;const d=i.toLowerCase();this[`${d}TracksListeners_`]&&Object.keys(this[`${d}TracksListeners_`]).forEach((i=>{this.el()[`${d}Tracks`].removeEventListener(i,this[`${d}TracksListeners_`][i])})),this[`featuresNative${i}Tracks`]=!l,this[`${d}TracksListeners_`]=null,this.proxyNativeTracksForType_(d)}overrideNativeAudioTracks(i){this.overrideNative_("Audio",i)}overrideNativeVideoTracks(i){this.overrideNative_("Video",i)}proxyNativeTracksForType_(i){const l=qt[i],d=this.el()[l.getterName],u=this[l.getterName]();if(!this[`featuresNative${l.capitalName}Tracks`]||!d||!d.addEventListener)return;const c={change:l=>{const d={type:"change",target:u,currentTarget:u,srcElement:u};u.trigger(d),"text"===i&&this[Ht.remoteText.getterName]().trigger(d)},addtrack(i){u.addTrack(i.track)},removetrack(i){u.removeTrack(i.track)}},removeOldTracks=function(){const i=[];for(let l=0;l<u.length;l++){let c=!1;for(let i=0;i<d.length;i++)if(d[i]===u[l]){c=!0;break}c||i.push(u[l])}for(;i.length;)u.removeTrack(i.shift())};this[l.getterName+"Listeners_"]=c,Object.keys(c).forEach((i=>{const l=c[i];d.addEventListener(i,l),this.on("dispose",(u=>d.removeEventListener(i,l)))})),this.on("loadstart",removeOldTracks),this.on("dispose",(i=>this.off("loadstart",removeOldTracks)))}proxyNativeTracks_(){qt.names.forEach((i=>{this.proxyNativeTracksForType_(i)}))}createEl(){let i=this.options_.tag;if(!i||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(i){const l=i.cloneNode(!0);i.parentNode&&i.parentNode.insertBefore(l,i),Html5.disposeMediaElement(i),i=l}else{i=g().createElement("video");const l=merge$1({},this.options_.tag&&getAttributes(this.options_.tag));pt&&!0===this.options_.nativeControlsForTouch||delete l.controls,setAttributes(i,Object.assign(l,{id:this.options_.techId,class:"vjs-tech"}))}i.playerId=this.options_.playerId}void 0!==this.options_.preload&&setAttribute(i,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(i.disablePictureInPicture=this.options_.disablePictureInPicture);const l=["loop","muted","playsinline","autoplay"];for(let d=0;d<l.length;d++){const u=l[d],c=this.options_[u];void 0!==c&&(c?setAttribute(i,u,u):removeAttribute(i,u),i[u]=c)}return i}handleLateInit_(i){if(0===i.networkState||3===i.networkState)return;if(0===i.readyState){let i=!1;const setLoadstartFired=function(){i=!0};this.on("loadstart",setLoadstartFired);const triggerLoadstart=function(){i||this.trigger("loadstart")};return this.on("loadedmetadata",triggerLoadstart),this.ready((function(){this.off("loadstart",setLoadstartFired),this.off("loadedmetadata",triggerLoadstart),i||this.trigger("loadstart")})),void 0}const l=["loadstart"];l.push("loadedmetadata"),i.readyState>=2&&l.push("loadeddata"),i.readyState>=3&&l.push("canplay"),i.readyState>=4&&l.push("canplaythrough"),this.ready((function(){l.forEach((function(i){this.trigger(i)}),this)}))}setScrubbing(i){this.isScrubbing_=i}scrubbing(){return this.isScrubbing_}setCurrentTime(i){try{this.isScrubbing_&&this.el_.fastSeek&&gt?this.el_.fastSeek(i):this.el_.currentTime=i}catch(i){$e(i,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Qe&&tt&&0===this.el_.currentTime){const checkProgress=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",checkProgress))};return this.on("timeupdate",checkProgress),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const endFn=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},beginFn=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",endFn),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",beginFn),this.on("dispose",(()=>{this.off("webkitbeginfullscreen",beginFn),this.off("webkitendfullscreen",endFn)}))}supportsFullScreen(){return"function"==typeof this.el_.webkitEnterFullScreen}enterFullScreen(){const i=this.el_;if(i.paused&&i.networkState<=i.HAVE_METADATA)silencePromise(this.el_.play()),this.setTimeout((function(){i.pause();try{i.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}}),0);else try{i.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen)return this.trigger("fullscreenerror",new Error("The video is not fullscreen")),void 0;this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(i){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(i):super.requestVideoFrameCallback(i)}cancelVideoFrameCallback(i){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(i):super.cancelVideoFrameCallback(i)}src(i){if(void 0===i)return this.el_.src;this.setSrc(i)}addSourceElement(i,l){if(!i)return $e.error("Invalid source URL."),!1;const d={src:i};l&&(d.type=l);const u=createEl("source",{},d);return this.el_.appendChild(u),!0}removeSourceElement(i){if(!i)return $e.error("Source URL is required to remove the source element."),!1;const l=this.el_.querySelectorAll("source");for(const d of l)if(d.src===i)return this.el_.removeChild(d),!0;return $e.warn(`No matching source element found with src: ${i}`),!1}reset(){Html5.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(i){this.el_.controls=!!i}addTextTrack(i,l,d){return this.featuresNativeTextTracks?this.el_.addTextTrack(i,l,d):super.addTextTrack(i,l,d)}createRemoteTextTrack(i){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(i);const l=g().createElement("track");return i.kind&&(l.kind=i.kind),i.label&&(l.label=i.label),(i.language||i.srclang)&&(l.srclang=i.language||i.srclang),i.default&&(l.default=i.default),i.id&&(l.id=i.id),i.src&&(l.src=i.src),l}addRemoteTextTrack(i,l){const d=super.addRemoteTextTrack(i,l);return this.featuresNativeTextTracks&&this.el().appendChild(d),d}removeRemoteTextTrack(i){if(super.removeRemoteTextTrack(i),this.featuresNativeTextTracks){const l=this.$$("track");let d=l.length;for(;d--;)i!==l[d]&&i!==l[d].track||this.el().removeChild(l[d])}}getVideoPlaybackQuality(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();const i={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(i.droppedVideoFrames=this.el().webkitDroppedFrameCount,i.totalVideoFrames=this.el().webkitDecodedFrameCount),p().performance&&(i.creationTime=p().performance.now()),i}}defineLazyProperty(Html5,"TEST_VID",(function(){if(!isReal())return;const i=g().createElement("video"),l=g().createElement("track");return l.kind="captions",l.srclang="en",l.label="English",i.appendChild(l),i})),Html5.isSupported=function(){try{Html5.TEST_VID.volume=.5}catch(i){return!1}return!(!Html5.TEST_VID||!Html5.TEST_VID.canPlayType)},Html5.canPlayType=function(i){return Html5.TEST_VID.canPlayType(i)},Html5.canPlaySource=function(i,l){return Html5.canPlayType(i.type)},Html5.canControlVolume=function(){try{const i=Html5.TEST_VID.volume;Html5.TEST_VID.volume=i/2+.1;const l=i!==Html5.TEST_VID.volume;return l&&ft?(p().setTimeout((()=>{Html5&&Html5.prototype&&(Html5.prototype.featuresVolumeControl=i!==Html5.TEST_VID.volume)})),!1):l}catch(i){return!1}},Html5.canMuteVolume=function(){try{const i=Html5.TEST_VID.muted;return Html5.TEST_VID.muted=!i,Html5.TEST_VID.muted?setAttribute(Html5.TEST_VID,"muted","muted"):removeAttribute(Html5.TEST_VID,"muted"),i!==Html5.TEST_VID.muted}catch(i){return!1}},Html5.canControlPlaybackRate=function(){if(Qe&&tt&&rt<58)return!1;try{const i=Html5.TEST_VID.playbackRate;return Html5.TEST_VID.playbackRate=i/2+.1,i!==Html5.TEST_VID.playbackRate}catch(i){return!1}},Html5.canOverrideAttributes=function(){try{const noop=()=>{};Object.defineProperty(g().createElement("video"),"src",{get:noop,set:noop}),Object.defineProperty(g().createElement("audio"),"src",{get:noop,set:noop}),Object.defineProperty(g().createElement("video"),"innerHTML",{get:noop,set:noop}),Object.defineProperty(g().createElement("audio"),"innerHTML",{get:noop,set:noop})}catch(i){return!1}return!0},Html5.supportsNativeTextTracks=function(){return gt||ft&&tt},Html5.supportsNativeVideoTracks=function(){return!(!Html5.TEST_VID||!Html5.TEST_VID.videoTracks)},Html5.supportsNativeAudioTracks=function(){return!(!Html5.TEST_VID||!Html5.TEST_VID.audioTracks)},Html5.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function([i,l]){defineLazyProperty(Html5.prototype,i,(()=>Html5[l]()),!0)})),Html5.prototype.featuresVolumeControl=Html5.canControlVolume(),Html5.prototype.movingMediaElementInDOM=!ft,Html5.prototype.featuresFullscreenResize=!0,Html5.prototype.featuresProgressEvents=!0,Html5.prototype.featuresTimeupdateEvents=!0,Html5.prototype.featuresVideoFrameCallback=!(!Html5.TEST_VID||!Html5.TEST_VID.requestVideoFrameCallback),Html5.disposeMediaElement=function(i){if(i){for(i.parentNode&&i.parentNode.removeChild(i);i.hasChildNodes();)i.removeChild(i.firstChild);i.removeAttribute("src"),"function"==typeof i.load&&function(){try{i.load()}catch(i){}}()}},Html5.resetMediaElement=function(i){if(!i)return;const l=i.querySelectorAll("source");let d=l.length;for(;d--;)i.removeChild(l[d]);i.removeAttribute("src"),"function"==typeof i.load&&function(){try{i.load()}catch(i){}}()},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(i){Html5.prototype[i]=function(){return this.el_[i]||this.el_.hasAttribute(i)}})),["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(i){Html5.prototype["set"+toTitleCase$1(i)]=function(l){this.el_[i]=l,l?this.el_.setAttribute(i,i):this.el_.removeAttribute(i)}})),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(i){Html5.prototype[i]=function(){return this.el_[i]}})),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach((function(i){Html5.prototype["set"+toTitleCase$1(i)]=function(l){this.el_[i]=l}})),["pause","load","play"].forEach((function(i){Html5.prototype[i]=function(){return this.el_[i]()}})),Tech.withSourceHandlers(Html5),Html5.nativeSourceHandler={},Html5.nativeSourceHandler.canPlayType=function(i){try{return Html5.TEST_VID.canPlayType(i)}catch(i){return""}},Html5.nativeSourceHandler.canHandleSource=function(i,l){if(i.type)return Html5.nativeSourceHandler.canPlayType(i.type);if(i.src){const l=getFileExtension(i.src);return Html5.nativeSourceHandler.canPlayType(`video/${l}`)}return""},Html5.nativeSourceHandler.handleSource=function(i,l,d){l.setSrc(i.src)},Html5.nativeSourceHandler.dispose=function(){},Html5.registerSourceHandler(Html5.nativeSourceHandler),Tech.registerTech("Html5",Html5);const Ti=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Si={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Ei=["tiny","xsmall","small","medium","large","xlarge","huge"],ki={};Ei.forEach((i=>{const l="x"===i.charAt(0)?`x-${i.substring(1)}`:i;ki[i]=`vjs-layout-${l}`}));const wi={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};class Player extends Component$1{constructor(i,l,d){if(i.id=i.id||l.id||`vjs_video_${newGUID()}`,(l=Object.assign(Player.getTagSettings(i),l)).initChildren=!1,l.createEl=!1,l.evented=!1,l.reportTouchActivity=!1,!l.language){const d=i.closest("[lang]");d&&(l.language=d.getAttribute("lang"))}if(super(null,l,d),this.boundDocumentFullscreenChange_=i=>this.documentFullscreenChange_(i),this.boundFullWindowOnEscKey_=i=>this.fullWindowOnEscKey(i),this.boundUpdateStyleEl_=i=>this.updateStyleEl_(i),this.boundApplyInitTime_=i=>this.applyInitTime_(i),this.boundUpdateCurrentBreakpoint_=i=>this.updateCurrentBreakpoint_(i),this.boundHandleTechClick_=i=>this.handleTechClick_(i),this.boundHandleTechDoubleClick_=i=>this.handleTechDoubleClick_(i),this.boundHandleTechTouchStart_=i=>this.handleTechTouchStart_(i),this.boundHandleTechTouchMove_=i=>this.handleTechTouchMove_(i),this.boundHandleTechTouchEnd_=i=>this.handleTechTouchEnd_(i),this.boundHandleTechTap_=i=>this.handleTechTap_(i),this.boundUpdatePlayerHeightOnAudioOnlyMode_=i=>this.updatePlayerHeightOnAudioOnlyMode_(i),this.isFullscreen_=!1,this.log=ze(this.id_),this.fsApi_=Be,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={controlBarHeight:null,playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=i,this.tagAttributes=i&&getAttributes(i),this.language(this.options_.language),l.languages){const i={};Object.getOwnPropertyNames(l.languages).forEach((function(d){i[d.toLowerCase()]=l.languages[d]})),this.languages_=i}else this.languages_=Player.prototype.options_.languages;this.resetCache_(),this.poster_=l.poster||"",this.controls_=!!l.controls,i.controls=!1,i.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],i.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),l.plugins&&Object.keys(l.plugins).forEach((i=>{if("function"!=typeof this[i])throw new Error(`plugin "${i}" does not exist`)})),this.scrubbing_=!1,this.el_=this.createEl(),evented(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(on(g(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const u=merge$1(this.options_);if(l.plugins&&Object.keys(l.plugins).forEach((i=>{this[i](l.plugins[i])})),l.debug&&this.debug(!0),this.options_.playerOptions=u,this.middleware_=[],this.playbackRates(l.playbackRates),l.experimentalSvgIcons){const i=(new(p().DOMParser)).parseFromString('<svg xmlns="http://www.w3.org/2000/svg">\n  <defs>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-play">\n      <path d="M16 10v28l22-14z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">\n      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">\n      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">\n      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">\n      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">\n      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">\n      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">\n      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">\n      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">\n      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">\n      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">\n      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">\n      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>\n    </symbol>\n    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">\n      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">\n      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>\n    </symbol>\n    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">\n      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">\n      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">\n      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">\n      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-share">\n      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">\n      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-square">\n      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">\n      <circle cx="24" cy="24" r="20"></circle>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">\n      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">\n      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">\n      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">\n      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">\n      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">\n      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">\n      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">\n      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">\n      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">\n      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">\n      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>\n    </symbol>\n    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">\n      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">\n      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">\n      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">\n      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">\n      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">\n      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>\n    </symbol>\n    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">\n      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>\n      <path fill="none" d="M-1-3h24v24H-1z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">\n      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">\n      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1200 1227" id="vjs-icon-twitter">\n      <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">\n      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">\n      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>\n    </symbol>\n  </defs>\n</svg>',"image/svg+xml");if(i.querySelector("parsererror"))$e.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const l=i.documentElement;l.style.display="none",this.el_.appendChild(l),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio("audio"===i.nodeName.toLowerCase()),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),l.spatialNavigation&&l.spatialNavigation.enabled&&(this.spatialNavigation=new SpatialNavigation(this),this.addClass("vjs-spatial-navigation-enabled")),pt&&this.addClass("vjs-touch-enabled"),ft||this.addClass("vjs-workinghover"),Player.players[this.id_]=this;const c=Ne.split(".")[0];this.addClass(`vjs-v${c}`),this.userActive(!0),this.reportUserActivity(),this.one("play",(i=>this.listenForUserActivity_(i))),this.on("keydown",(i=>this.handleKeyDown(i))),this.on("languagechange",(i=>this.handleLanguagechange(i))),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",(()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)}))}dispose(){this.trigger("dispose"),this.off("dispose"),off(g(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),off(g(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),Player.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),function clearCacheForPlayer(i){Gt.hasOwnProperty(i.id())&&delete Gt[i.id()]}(this),$t.names.forEach((i=>{const l=this[$t[i].getterName]();l&&l.off&&l.off()})),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let i,l=this.tag,d=this.playerElIngest_=l.parentNode&&l.parentNode.hasAttribute&&l.parentNode.hasAttribute("data-vjs-player");const u="video-js"===this.tag.tagName.toLowerCase();d?i=this.el_=l.parentNode:u||(i=this.el_=super.createEl("div"));const c=getAttributes(l);if(u){for(i=this.el_=l,l=this.tag=g().createElement("video");i.children.length;)l.appendChild(i.firstChild);hasClass(i,"video-js")||addClass(i,"video-js"),i.appendChild(l),d=this.playerElIngest_=i,Object.keys(i).forEach((d=>{try{l[d]=i[d]}catch(i){}}))}l.setAttribute("tabindex","-1"),c.tabindex="-1",tt&&ot&&(l.setAttribute("role","application"),c.role="application"),l.removeAttribute("width"),l.removeAttribute("height"),"width"in c&&delete c.width,"height"in c&&delete c.height,Object.getOwnPropertyNames(c).forEach((function(d){u&&"class"===d||i.setAttribute(d,c[d]),u&&l.setAttribute(d,c[d])})),l.playerId=l.id,l.id+="_html5_api",l.className="vjs-tech",l.player=i.player=this,this.addClass("vjs-paused");const h=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE","IS_CHROMECAST_RECEIVER"].filter((i=>yt[i])).map((i=>"vjs-device-"+i.substring(3).toLowerCase().replace(/\_/g,"-")));if(this.addClass(...h),!0!==p().VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=createStyleElement("vjs-styles-dimensions");const i=_t(".vjs-styles-defaults"),l=_t("head");l.insertBefore(this.styleEl_,i?i.nextSibling:l.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const m=l.getElementsByTagName("a");for(let i=0;i<m.length;i++){const l=m.item(i);addClass(l,"vjs-hidden"),l.setAttribute("hidden","hidden")}return l.initNetworkState_=l.networkState,l.parentNode&&!d&&l.parentNode.insertBefore(i,l),prependTo(l,i),this.children_.unshift(l),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=i,i}crossOrigin(i){return void 0===i?this.techGet_("crossOrigin"):null!==i&&"anonymous"!==i&&"use-credentials"!==i?($e.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${i}"`),void 0):(this.techCall_("setCrossOrigin",i),this.posterImage&&this.posterImage.crossOrigin(i),void 0)}width(i){return this.dimension("width",i)}height(i){return this.dimension("height",i)}dimension(i,l){const d=i+"_";if(void 0===l)return this[d]||0;if(""===l||"auto"===l)return this[d]=void 0,this.updateStyleEl_(),void 0;const u=parseFloat(l);if(isNaN(u))return $e.error(`Improper value "${l}" supplied for for ${i}`),void 0;this[d]=u,this.updateStyleEl_()}fluid(i){if(void 0===i)return!!this.fluid_;var l,d;this.fluid_=!!i,isEvented(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),i?(this.addClass("vjs-fluid"),this.fill(!1),d=()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)},isEvented(l=this)?d():(l.eventedCallbacks||(l.eventedCallbacks=[]),l.eventedCallbacks.push(d))):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(i){if(void 0===i)return!!this.fill_;this.fill_=!!i,i?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(i){if(void 0===i)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(i))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=i,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(!0===p().VIDEOJS_NO_DYNAMIC_STYLE){const i="number"==typeof this.width_?this.width_:this.options_.width,l="number"==typeof this.height_?this.height_:this.options_.height,d=this.tech_&&this.tech_.el();return d&&(i>=0&&(d.width=i),l>=0&&(d.height=l)),void 0}let i,l,d,u;d=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";const c=d.split(":"),h=c[1]/c[0];i=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/h:this.videoWidth()||300,l=void 0!==this.height_?this.height_:i*h,u=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(u),setTextContent(this.styleEl_,`\n      .${u} {\n        width: ${i}px;\n        height: ${l}px;\n      }\n\n      .${u}.vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: ${100*h}%;\n      }\n    `)}loadTech_(i,l){this.tech_&&this.unloadTech_();const d=toTitleCase$1(i),u=i.charAt(0).toLowerCase()+i.slice(1);"Html5"!==d&&this.tag&&(Tech.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=d,this.isReady_=!1;let c=this.autoplay();("string"==typeof this.autoplay()||!0===this.autoplay()&&this.options_.normalizeAutoplay)&&(c=!1);const h={source:l,autoplay:c,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${u}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};$t.names.forEach((i=>{const l=$t[i];h[l.getterName]=this[l.privateName]})),Object.assign(h,this.options_[d]),Object.assign(h,this.options_[u]),Object.assign(h,this.options_[i.toLowerCase()]),this.tag&&(h.tag=this.tag),l&&l.src===this.cache_.src&&this.cache_.currentTime>0&&(h.startTime=this.cache_.currentTime);const p=Tech.getTech(i);if(!p)throw new Error(`No Tech named '${d}' exists! '${d}' should be registered using videojs.registerTech()'`);this.tech_=new p(h),this.tech_.ready(bind_(this,this.handleTechReady_),!0),textTrackConverter_jsonToTextTracks(this.textTracksJson_||[],this.tech_),Ti.forEach((i=>{this.on(this.tech_,i,(l=>this[`handleTech${toTitleCase$1(i)}_`](l)))})),Object.keys(Si).forEach((i=>{this.on(this.tech_,i,(l=>{if(0===this.tech_.playbackRate()&&this.tech_.seeking())return this.queuedCallbacks_.push({callback:this[`handleTech${Si[i]}_`].bind(this),event:l}),void 0;this[`handleTech${Si[i]}_`](l)}))})),this.on(this.tech_,"loadstart",(i=>this.handleTechLoadStart_(i))),this.on(this.tech_,"sourceset",(i=>this.handleTechSourceset_(i))),this.on(this.tech_,"waiting",(i=>this.handleTechWaiting_(i))),this.on(this.tech_,"ended",(i=>this.handleTechEnded_(i))),this.on(this.tech_,"seeking",(i=>this.handleTechSeeking_(i))),this.on(this.tech_,"play",(i=>this.handleTechPlay_(i))),this.on(this.tech_,"pause",(i=>this.handleTechPause_(i))),this.on(this.tech_,"durationchange",(i=>this.handleTechDurationChange_(i))),this.on(this.tech_,"fullscreenchange",((i,l)=>this.handleTechFullscreenChange_(i,l))),this.on(this.tech_,"fullscreenerror",((i,l)=>this.handleTechFullscreenError_(i,l))),this.on(this.tech_,"enterpictureinpicture",(i=>this.handleTechEnterPictureInPicture_(i))),this.on(this.tech_,"leavepictureinpicture",(i=>this.handleTechLeavePictureInPicture_(i))),this.on(this.tech_,"error",(i=>this.handleTechError_(i))),this.on(this.tech_,"posterchange",(i=>this.handleTechPosterChange_(i))),this.on(this.tech_,"textdata",(i=>this.handleTechTextData_(i))),this.on(this.tech_,"ratechange",(i=>this.handleTechRateChange_(i))),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===d&&this.tag||prependTo(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){$t.names.forEach((i=>{const l=$t[i];this[l.privateName]=this[l.getterName]()})),this.textTracksJson_=textTrackConverter_textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(i){return void 0===i&&$e.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_}version(){return{"video.js":Ne}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(!0===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(i){if(!this.tech_||"string"!=typeof i)return;const resolveMuted=()=>{const i=this.muted();this.muted(!0);const restoreMuted=()=>{this.muted(i)};this.playTerminatedQueue_.push(restoreMuted);const l=this.play();if(isPromise(l))return l.catch((i=>{throw restoreMuted(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${i||""}`)}))};let l;return"any"!==i||this.muted()?l="muted"!==i||this.muted()?this.play():resolveMuted():(l=this.play(),isPromise(l)&&(l=l.catch(resolveMuted))),isPromise(l)?l.then((()=>{this.trigger({type:"autoplay-success",autoplay:i})})).catch((()=>{this.trigger({type:"autoplay-failure",autoplay:i})})):void 0}updateSourceCaches_(i=""){let l=i,d="";"string"!=typeof l&&(l=i.src,d=i.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],l&&!d&&(d=((i,l)=>{if(!l)return"";if(i.cache_.source.src===l&&i.cache_.source.type)return i.cache_.source.type;const d=i.cache_.sources.filter((i=>i.src===l));if(d.length)return d[0].type;const u=i.$$("source");for(let i=0;i<u.length;i++){const d=u[i];if(d.type&&d.src&&d.src===l)return d.type}return getMimetype(l)})(this,l)),this.cache_.source=merge$1({},i,{src:l,type:d});const u=this.cache_.sources.filter((i=>i.src&&i.src===l)),c=[],h=this.$$("source"),p=[];for(let i=0;i<h.length;i++){const d=getAttributes(h[i]);c.push(d),d.src&&d.src===l&&p.push(d.src)}p.length&&!u.length?this.cache_.sources=c:u.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=l}handleTechSourceset_(i){if(!this.changingSrc_){let updateSourceCaches=i=>this.updateSourceCaches_(i);const l=this.currentSource().src,d=i.src;l&&!/^blob:/.test(l)&&/^blob:/.test(d)&&(!this.lastSource_||this.lastSource_.tech!==d&&this.lastSource_.player!==l)&&(updateSourceCaches=()=>{}),updateSourceCaches(d),i.src||this.tech_.any(["sourceset","loadstart"],(i=>{if("sourceset"===i.type)return;const l=this.techGet_("currentSrc");this.lastSource_.tech=l,this.updateSourceCaches_(l)}))}this.lastSource_={player:this.currentSource().src,tech:i.src},this.trigger({src:i.src,type:"sourceset"})}hasStarted(i){if(void 0===i)return this.hasStarted_;i!==this.hasStarted_&&(this.hasStarted_=i,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach((i=>i.callback(i.event))),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const i=this.currentTime(),timeUpdateListener=()=>{i!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",timeUpdateListener))};this.on("timeupdate",timeUpdateListener)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(i){this.controls_&&(void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.click&&!1===this.options_.userActions.click||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.click?this.options_.userActions.click.call(this,i):this.paused()?silencePromise(this.play()):this.pause()))}handleTechDoubleClick_(i){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(l=>l.contains(i.target)))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,i):this.isInPictureInPicture()&&!g().pictureInPictureElement?this.exitPictureInPicture():this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(i){i.cancelable&&i.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(i){const l=i.target.player;if(l&&l!==this)return;const d=this.el();let u=g()[this.fsApi_.fullscreenElement]===d;!u&&d.matches&&(u=d.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(u)}handleTechFullscreenChange_(i,l){l&&(l.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",(()=>{this.removeClass("vjs-ios-native-fs")}))),this.isFullscreen(l.isFullscreen))}handleTechFullscreenError_(i,l){this.trigger("fullscreenerror",l)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(i){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(i){this.isInPictureInPicture(!1)}handleTechError_(){const i=this.tech_.error();i&&this.error(i)}handleTechTextData_(){let i=null;arguments.length>1&&(i=arguments[1]),this.trigger("textdata",i)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(i,l){this.ready((function(){if(i in Kt)return function set(i,l,d,u){return l[d](i.reduce(middlewareIterator(d),u))}(this.middleware_,this.tech_,i,l);if(i in Yt)return mediate(this.middleware_,this.tech_,i,l);try{this.tech_&&this.tech_[i](l)}catch(i){throw $e(i),i}}),!0)}techGet_(i){if(this.tech_&&this.tech_.isReady_){if(i in Xt)return function get(i,l,d){return i.reduceRight(middlewareIterator(d),l[d]())}(this.middleware_,this.tech_,i);if(i in Yt)return mediate(this.middleware_,this.tech_,i);try{return this.tech_[i]()}catch(l){if(void 0===this.tech_[i])throw $e(`Video.js: ${i} method not defined for ${this.techName_} playback technology.`,l),l;if("TypeError"===l.name)throw $e(`Video.js: ${i} unavailable on ${this.techName_} playback technology element.`,l),this.tech_.isReady_=!1,l;throw $e(l),l}}}play(){return new Promise((i=>{this.play_(i)}))}play_(i=silencePromise){this.playCallbacks_.push(i);const l=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),d=Boolean(gt||ft);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!l)return this.waitToPlay_=i=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!l&&d&&this.load(),void 0;const u=this.techGet_("play");d&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),null===u?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(u)}runPlayTerminatedQueue_(){const i=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],i.forEach((function(i){i()}))}runPlayCallbacks_(i){const l=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],l.forEach((function(l){l(i)}))}pause(){this.techCall_("pause")}paused(){return!1!==this.techGet_("paused")}played(){return this.techGet_("played")||createTimeRanges$1(0,0)}scrubbing(i){if(void 0===i)return this.scrubbing_;this.scrubbing_=!!i,this.techCall_("setScrubbing",this.scrubbing_),i?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(i){return void 0===i?(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime):(i<0&&(i=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",i),this.cache_.initTime=0,isFinite(i)&&(this.cache_.currentTime=Number(i)),void 0):(this.cache_.initTime=i,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_),void 0))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(i){if(void 0===i)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(i=parseFloat(i))<0&&(i=1/0),i!==this.cache_.duration&&(this.cache_.duration=i,i===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(i)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let i=this.techGet_("buffered");return i&&i.length||(i=createTimeRanges$1(0,0)),i}seekable(){let i=this.techGet_("seekable");return i&&i.length||(i=createTimeRanges$1(0,0)),i}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return bufferedPercent(this.buffered(),this.duration())}bufferedEnd(){const i=this.buffered(),l=this.duration();let d=i.end(i.length-1);return d>l&&(d=l),d}volume(i){let l;return void 0!==i?(l=Math.max(0,Math.min(1,i)),this.cache_.volume=l,this.techCall_("setVolume",l),l>0&&this.lastVolume_(l),void 0):(l=parseFloat(this.techGet_("volume")),isNaN(l)?1:l)}muted(i){return void 0!==i?(this.techCall_("setMuted",i),void 0):this.techGet_("muted")||!1}defaultMuted(i){return void 0!==i&&this.techCall_("setDefaultMuted",i),this.techGet_("defaultMuted")||!1}lastVolume_(i){return void 0!==i&&0!==i?(this.cache_.lastVolume=i,void 0):this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(i){if(void 0!==i){const l=this.isFullscreen_;return this.isFullscreen_=Boolean(i),this.isFullscreen_!==l&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_(),void 0}return this.isFullscreen_}requestFullscreen(i){this.isInPictureInPicture()&&this.exitPictureInPicture();const l=this;return new Promise(((d,u)=>{function offHandler(){l.off("fullscreenerror",errorHandler),l.off("fullscreenchange",changeHandler)}function changeHandler(){offHandler(),d()}function errorHandler(i,l){offHandler(),u(l)}l.one("fullscreenchange",changeHandler),l.one("fullscreenerror",errorHandler);const c=l.requestFullscreenHelper_(i);c&&(c.then(offHandler,offHandler),c.then(d,u))}))}requestFullscreenHelper_(i){let l;if(this.fsApi_.prefixed||(l=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==i&&(l=i)),this.fsApi_.requestFullscreen){const i=this.el_[this.fsApi_.requestFullscreen](l);return i&&i.then((()=>this.isFullscreen(!0)),(()=>this.isFullscreen(!1))),i}this.tech_.supportsFullScreen()&&!0==!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const i=this;return new Promise(((l,d)=>{function offHandler(){i.off("fullscreenerror",errorHandler),i.off("fullscreenchange",changeHandler)}function changeHandler(){offHandler(),l()}function errorHandler(i,l){offHandler(),d(l)}i.one("fullscreenchange",changeHandler),i.one("fullscreenerror",errorHandler);const u=i.exitFullscreenHelper_();u&&(u.then(offHandler,offHandler),u.then(l,d))}))}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const i=g()[this.fsApi_.exitFullscreen]();return i&&silencePromise(i.then((()=>this.isFullscreen(!1)))),i}this.tech_.supportsFullScreen()&&!0==!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=g().documentElement.style.overflow,on(g(),"keydown",this.boundFullWindowOnEscKey_),g().documentElement.style.overflow="hidden",addClass(g().body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(i){"Escape"===i.key&&!0===this.isFullscreen()&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,off(g(),"keydown",this.boundFullWindowOnEscKey_),g().documentElement.style.overflow=this.docOrigOverflow,removeClass(g().body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(i){if(void 0===i)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",i),this.options_.disablePictureInPicture=i,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(i){return void 0!==i?(this.isInPictureInPicture_=!!i,this.togglePictureInPictureClass_(),void 0):!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&p().documentPictureInPicture){const i=g().createElement(this.el().tagName);return i.classList=this.el().classList,i.classList.add("vjs-pip-container"),this.posterImage&&i.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&i.appendChild(this.titleBar.el().cloneNode(!0)),i.appendChild(createEl("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),p().documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then((l=>(copyStyleSheetsToWindow(l),this.el_.parentNode.insertBefore(i,this.el_),l.document.body.appendChild(this.el_),l.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:l}),l.addEventListener("pagehide",(l=>{const d=l.target.querySelector(".video-js");i.parentNode.replaceChild(d,i),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")})),l)))}return"pictureInPictureEnabled"in g()&&!1===this.disablePictureInPicture()?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){return p().documentPictureInPicture&&p().documentPictureInPicture.window?(p().documentPictureInPicture.window.close(),Promise.resolve()):"pictureInPictureEnabled"in g()?g().exitPictureInPicture():void 0}handleKeyDown(i){const{userActions:l}=this.options_;if(!l||!l.hotkeys)return;(i=>{const l=i.tagName.toLowerCase();if(i.isContentEditable)return!0;if("input"===l)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(i.type);return-1!==["textarea"].indexOf(l)})(this.el_.ownerDocument.activeElement)||("function"==typeof l.hotkeys?l.hotkeys.call(this,i):this.handleHotkeys(i))}handleHotkeys(i){const l=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:d=l=>"f"===i.key.toLowerCase(),muteKey:u=l=>"m"===i.key.toLowerCase(),playPauseKey:c=l=>"k"===i.key.toLowerCase()||" "===i.key.toLowerCase()}=l;if(d.call(this,i)){i.preventDefault(),i.stopPropagation();const l=Component$1.getComponent("FullscreenToggle");!1!==g()[this.fsApi_.fullscreenEnabled]&&l.prototype.handleClick.call(this,i)}else if(u.call(this,i)){i.preventDefault(),i.stopPropagation();Component$1.getComponent("MuteToggle").prototype.handleClick.call(this,i)}else if(c.call(this,i)){i.preventDefault(),i.stopPropagation();Component$1.getComponent("PlayToggle").prototype.handleClick.call(this,i)}}canPlayType(i){let l;for(let d=0,u=this.options_.techOrder;d<u.length;d++){const c=u[d];let h=Tech.getTech(c);if(h||(h=Component$1.getComponent(c)),h){if(h.isSupported()&&(l=h.canPlayType(i),l))return l}else $e.error(`The "${c}" tech is undefined. Skipped browser support check for that tech.`)}return""}selectSource(i){const l=this.options_.techOrder.map((i=>[i,Tech.getTech(i)])).filter((([i,l])=>l?l.isSupported():($e.error(`The "${i}" tech is undefined. Skipped browser support check for that tech.`),!1))),findFirstPassingTechSourcePair=function(i,l,d){let u;return i.some((i=>l.some((l=>{if(u=d(i,l),u)return!0})))),u};let d;const finder=([i,l],d)=>{if(l.canPlaySource(d,this.options_[i.toLowerCase()]))return{source:d,tech:i}};var u;return d=this.options_.sourceOrder?findFirstPassingTechSourcePair(i,l,(u=finder,(i,l)=>u(l,i))):findFirstPassingTechSourcePair(l,i,finder),d||!1}handleSrc_(i,l){if(void 0===i)return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const d=filterSource(i);if(!d.length)return this.setTimeout((function(){this.error({code:4,message:this.options_.notSupportedMessage})}),0),void 0;if(this.changingSrc_=!0,l||(this.cache_.sources=d),this.updateSourceCaches_(d[0]),setSource(this,d[0],((i,u)=>{this.middleware_=u,l||(this.cache_.sources=d),this.updateSourceCaches_(i);if(this.src_(i))return d.length>1?this.handleSrc_(d.slice(1)):(this.changingSrc_=!1,this.setTimeout((function(){this.error({code:4,message:this.options_.notSupportedMessage})}),0),this.triggerReady(),void 0);!function setTech(i,l){i.forEach((i=>i.setTech&&i.setTech(l)))}(u,this.tech_)})),d.length>1){const retry=()=>{this.error(null),this.handleSrc_(d.slice(1),!0)},stopListeningForErrors=()=>{this.off("error",retry)};this.one("error",retry),this.one("playing",stopListeningForErrors),this.resetRetryOnError_=()=>{this.off("error",retry),this.off("playing",stopListeningForErrors)}}}src(i){return this.handleSrc_(i,!1)}src_(i){const l=this.selectSource([i]);return!l||(titleCaseEquals(l.tech,this.techName_)?(this.ready((function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",i):this.techCall_("src",i.src),this.changingSrc_=!1}),!0),!1):(this.changingSrc_=!0,this.loadTech_(l.tech,l.source),this.tech_.ready((()=>{this.changingSrc_=!1})),!1))}addSourceElement(i,l){return!!this.tech_&&this.tech_.addSourceElement(i,l)}removeSourceElement(i){return!!this.tech_&&this.tech_.removeSourceElement(i)}load(){if(this.tech_&&this.tech_.vhs)return this.src(this.currentSource()),void 0;this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{silencePromise(this.play().then((()=>this.doReset_())))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),isEvented(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:i,durationDisplay:l,progressControl:d,remainingTimeDisplay:u}=this.controlBar||{},{seekBar:c}=d||{};i&&i.updateContent(),l&&l.updateContent(),u&&u.updateContent(),c&&(c.update(),c.loadProgressBar&&c.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const i=this.currentSource(),l=[];return 0!==Object.keys(i).length&&l.push(i),this.cache_.sources||l}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(i){return void 0!==i?(this.techCall_("setPreload",i),this.options_.preload=i,void 0):this.techGet_("preload")}autoplay(i){if(void 0===i)return this.options_.autoplay||!1;let l;"string"==typeof i&&/(any|play|muted)/.test(i)||!0===i&&this.options_.normalizeAutoplay?(this.options_.autoplay=i,this.manualAutoplay_("string"==typeof i?i:"play"),l=!1):this.options_.autoplay=!!i,l=void 0===l?this.options_.autoplay:l,this.tech_&&this.techCall_("setAutoplay",l)}playsinline(i){return void 0!==i&&(this.techCall_("setPlaysinline",i),this.options_.playsinline=i),this.techGet_("playsinline")}loop(i){return void 0!==i?(this.techCall_("setLoop",i),this.options_.loop=i,void 0):this.techGet_("loop")}poster(i){if(void 0===i)return this.poster_;i||(i=""),i!==this.poster_&&(this.poster_=i,this.techCall_("setPoster",i),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const i=this.tech_.poster()||"";i!==this.poster_&&(this.poster_=i,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(i){if(void 0===i)return!!this.controls_;this.controls_!==(i=!!i)&&(this.controls_=i,this.usingNativeControls()&&this.techCall_("setControls",i),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(i){if(void 0===i)return!!this.usingNativeControls_;this.usingNativeControls_!==(i=!!i)&&(this.usingNativeControls_=i,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(i){if(void 0===i)return this.error_||null;if(hooks("beforeerror").forEach((l=>{const d=l(this,i);if((!video_es_isObject(d)||Array.isArray(d))&&"string"!=typeof d&&"number"!=typeof d&&null!==d)return this.log.error("please return a value that MediaError expects in beforeerror hooks"),void 0;i=d})),this.options_.suppressNotSupportedError&&i&&4===i.code){const triggerSuppressedError=function(){this.error(i)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],triggerSuppressedError),this.one("loadstart",(function(){this.off(["click","touchstart"],triggerSuppressedError)})),void 0}if(null===i)return this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close(),void 0;this.error_=new MediaError(i),this.addClass("vjs-error"),$e.error(`(CODE:${this.error_.code} ${MediaError.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),hooks("error").forEach((i=>i(this,this.error_)))}reportUserActivity(i){this.userActivity_=!0}userActive(i){if(void 0===i)return this.userActive_;if((i=!!i)!==this.userActive_){if(this.userActive_=i,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive"),void 0;this.tech_&&this.tech_.one("mousemove",(function(i){i.stopPropagation(),i.preventDefault()})),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let i,l,d;const u=bind_(this,this.reportUserActivity),handleMouseUpAndMouseLeave=function(l){u(),this.clearInterval(i)};this.on("mousedown",(function(){u(),this.clearInterval(i),i=this.setInterval(u,250)})),this.on("mousemove",(function(i){i.screenX===l&&i.screenY===d||(l=i.screenX,d=i.screenY,u())})),this.on("mouseup",handleMouseUpAndMouseLeave),this.on("mouseleave",handleMouseUpAndMouseLeave);const c=this.getChild("controlBar");let h;!c||ft||Qe||(c.on("mouseenter",(function(i){0!==this.player().options_.inactivityTimeout&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0})),c.on("mouseleave",(function(i){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))),this.on("keydown",u),this.on("keyup",u);this.setInterval((function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(h);const i=this.options_.inactivityTimeout;i<=0||(h=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),i))}),250)}playbackRate(i){return void 0!==i?(this.techCall_("setPlaybackRate",i),void 0):this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(i){return void 0!==i?this.techCall_("setDefaultPlaybackRate",i):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(i){return void 0!==i?(this.isAudio_=!!i,void 0):!!this.isAudio_}updatePlayerHeightOnAudioOnlyMode_(){const i=this.getChild("ControlBar");i&&this.audioOnlyCache_.controlBarHeight!==i.currentHeight()&&(this.audioOnlyCache_.controlBarHeight=i.currentHeight(),this.height(this.audioOnlyCache_.controlBarHeight))}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const i=this.children(),l=this.getChild("ControlBar"),d=l&&l.currentHeight();i.forEach((i=>{i!==l&&i.el_&&!i.hasClass("vjs-hidden")&&(i.hide(),this.audioOnlyCache_.hiddenChildren.push(i))})),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.audioOnlyCache_.controlBarHeight=d,this.on("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.height(d),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.off("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.audioOnlyCache_.hiddenChildren.forEach((i=>i.show())),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(i){if("boolean"!=typeof i||i===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=i,i){const i=[];return this.isInPictureInPicture()&&i.push(this.exitPictureInPicture()),this.isFullscreen()&&i.push(this.exitFullscreen()),this.audioPosterMode()&&i.push(this.audioPosterMode(!1)),Promise.all(i).then((()=>this.enableAudioOnlyUI_()))}return Promise.resolve().then((()=>this.disableAudioOnlyUI_()))}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(i){if("boolean"!=typeof i||i===this.audioPosterMode_)return this.audioPosterMode_;if(this.audioPosterMode_=i,i){if(this.audioOnlyMode()){return this.audioOnlyMode(!1).then((()=>{this.enablePosterModeUI_()}))}return Promise.resolve().then((()=>{this.enablePosterModeUI_()}))}return Promise.resolve().then((()=>{this.disablePosterModeUI_()}))}addTextTrack(i,l,d){if(this.tech_)return this.tech_.addTextTrack(i,l,d)}addRemoteTextTrack(i,l){if(this.tech_)return this.tech_.addRemoteTextTrack(i,l)}removeRemoteTextTrack(i={}){let{track:l}=i;if(l||(l=i),this.tech_)return this.tech_.removeRemoteTextTrack(l)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(i){if(void 0===i)return this.language_;this.language_!==String(i).toLowerCase()&&(this.language_=String(i).toLowerCase(),isEvented(this)&&this.trigger("languagechange"))}languages(){return merge$1(Player.prototype.options_.languages,this.languages_)}toJSON(){const i=merge$1(this.options_),l=i.tracks;i.tracks=[];for(let d=0;d<l.length;d++){let u=l[d];u=merge$1(u),u.player=void 0,i.tracks[d]=u}return i}createModal(i,l){(l=l||{}).content=i||"";const d=new ModalDialog(this,l);return this.addChild(d),d.on("dispose",(()=>{this.removeChild(d)})),d.open(),d}updateCurrentBreakpoint_(){if(!this.responsive())return;const i=this.currentBreakpoint(),l=this.currentWidth();for(let d=0;d<Ei.length;d++){const u=Ei[d];if(l<=this.breakpoints_[u]){if(i===u)return;i&&this.removeClass(ki[i]),this.addClass(ki[u]),this.breakpoint_=u;break}}}removeCurrentBreakpoint_(){const i=this.currentBreakpointClass();this.breakpoint_="",i&&this.removeClass(i)}breakpoints(i){return void 0===i||(this.breakpoint_="",this.breakpoints_=Object.assign({},wi,i),this.updateCurrentBreakpoint_()),Object.assign(this.breakpoints_)}responsive(i){if(void 0===i)return this.responsive_;return(i=Boolean(i))!==this.responsive_?(this.responsive_=i,i?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),i):void 0}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return ki[this.breakpoint_]||""}loadMedia(i,l){if(!i||"object"!=typeof i)return;const d=this.crossOrigin();this.reset(),this.cache_.media=merge$1(i);const{artist:u,artwork:c,description:h,poster:p,src:m,textTracks:g,title:y}=this.cache_.media;!c&&p&&(this.cache_.media.artwork=[{src:p,type:getMimetype(p)}]),d&&this.crossOrigin(d),m&&this.src(m),p&&this.poster(p),Array.isArray(g)&&g.forEach((i=>this.addRemoteTextTrack(i,!1))),this.titleBar&&this.titleBar.update({title:y,description:h||u||""}),this.ready(l)}getMedia(){if(!this.cache_.media){const i=this.poster(),l={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),(i=>({kind:i.kind,label:i.label,language:i.language,src:i.src})))};return i&&(l.poster=i,l.artwork=[{src:l.poster,type:getMimetype(l.poster)}]),l}return merge$1(this.cache_.media)}static getTagSettings(i){const l={sources:[],tracks:[]},d=getAttributes(i),u=d["data-setup"];if(hasClass(i,"vjs-fill")&&(d.fill=!0),hasClass(i,"vjs-fluid")&&(d.fluid=!0),null!==u)try{Object.assign(d,JSON.parse(u||"{}"))}catch(i){$e.error("data-setup",i)}if(Object.assign(l,d),i.hasChildNodes()){const d=i.childNodes;for(let i=0,u=d.length;i<u;i++){const u=d[i],c=u.nodeName.toLowerCase();"source"===c?l.sources.push(getAttributes(u)):"track"===c&&l.tracks.push(getAttributes(u))}}return l}debug(i){if(void 0===i)return this.debugEnabled_;i?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(i){if(void 0===i)return this.cache_.playbackRates;Array.isArray(i)&&i.every((i=>"number"==typeof i))&&(this.cache_.playbackRates=i,this.trigger("playbackrateschange"))}}$t.names.forEach((function(i){const l=$t[i];Player.prototype[l.getterName]=function(){return this.tech_?this.tech_[l.getterName]():(this[l.privateName]=this[l.privateName]||new l.ListClass,this[l.privateName])}})),Player.prototype.crossorigin=Player.prototype.crossOrigin,Player.players={};const Ci=p().navigator;Player.prototype.options_={techOrder:Tech.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Ci&&(Ci.languages&&Ci.languages[0]||Ci.userLanguage||Ci.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,spatialNavigation:{enabled:!1,horizontalSeek:!1},enableSmoothSeeking:!1,disableSeekWhileScrubbingOnMobile:!1},Ti.forEach((function(i){Player.prototype[`handleTech${toTitleCase$1(i)}_`]=function(){return this.trigger(i)}})),Component$1.registerComponent("Player",Player);const xi="plugin",Ai="activePlugins_",Pi={},pluginExists=i=>Pi.hasOwnProperty(i),getPlugin=i=>pluginExists(i)?Pi[i]:void 0,markPluginAsActive=(i,l)=>{i[Ai]=i[Ai]||{},i[Ai][l]=!0},triggerSetupEvent=(i,l,d)=>{const u=(d?"before":"")+"pluginsetup";i.trigger(u,l),i.trigger(u+":"+l.name,l)},createPluginFactory=(i,l)=>(l.prototype.name=i,function(...d){triggerSetupEvent(this,{name:i,plugin:l,instance:null},!0);const u=new l(...[this,...d]);return this[i]=()=>u,triggerSetupEvent(this,u.getEventHash()),u});let Ii=(()=>{class Plugin{constructor(i){if(this.constructor===Plugin)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=i,this.log||(this.log=this.player.log.createLogger(this.name)),evented(this),delete this.trigger,stateful(this,this.constructor.defaultState),markPluginAsActive(i,this.name),this.dispose=this.dispose.bind(this),i.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(i={}){return i.name=this.name,i.plugin=this.constructor,i.instance=this,i}trigger(i,l={}){return trigger(this.eventBusEl_,i,this.getEventHash(l))}handleStateChanged(i){}dispose(){const{name:i,player:l}=this;this.trigger("dispose"),this.off(),l.off("dispose",this.dispose),l[Ai][i]=!1,this.player=this.state=null,l[i]=createPluginFactory(i,Pi[i])}static isBasic(i){const l="string"==typeof i?getPlugin(i):i;return"function"==typeof l&&!Plugin.prototype.isPrototypeOf(l.prototype)}static registerPlugin(i,l){if("string"!=typeof i)throw new Error(`Illegal plugin name, "${i}", must be a string, was ${typeof i}.`);if(pluginExists(i))$e.warn(`A plugin named "${i}" already exists. You may want to avoid re-registering plugins!`);else if(Player.prototype.hasOwnProperty(i))throw new Error(`Illegal plugin name, "${i}", cannot share a name with an existing player method!`);if("function"!=typeof l)throw new Error(`Illegal plugin for "${i}", must be a function, was ${typeof l}.`);return Pi[i]=l,i!==xi&&(Player.prototype[i]=Plugin.isBasic(l)?function(i,l){const basicPluginWrapper=function(){triggerSetupEvent(this,{name:i,plugin:l,instance:null},!0);const d=l.apply(this,arguments);return markPluginAsActive(this,i),triggerSetupEvent(this,{name:i,plugin:l,instance:d}),d};return Object.keys(l).forEach((function(i){basicPluginWrapper[i]=l[i]})),basicPluginWrapper}(i,l):createPluginFactory(i,l)),l}static deregisterPlugin(i){if(i===xi)throw new Error("Cannot de-register base plugin.");pluginExists(i)&&(delete Pi[i],delete Player.prototype[i])}static getPlugins(i=Object.keys(Pi)){let l;return i.forEach((i=>{const d=getPlugin(i);d&&(l=l||{},l[i]=d)})),l}static getPluginVersion(i){const l=getPlugin(i);return l&&l.VERSION||""}}return Plugin.getPlugin=getPlugin,Plugin.BASE_PLUGIN_NAME=xi,Plugin})();function deprecateForMajor(i,l,d,u){return function deprecate(i,l){let d=!1;return function(...u){return d||$e.warn(i),d=!0,l.apply(this,u)}}(`${l} is deprecated and will be removed in ${i}.0; please use ${d} instead.`,u)}Ii.registerPlugin(xi,Ii),Player.prototype.usingPlugin=function(i){return!!this[Ai]&&!0===this[Ai][i]},Player.prototype.hasPlugin=function(i){return!!pluginExists(i)};const normalizeId=i=>0===i.indexOf("#")?i.slice(1):i;function videojs(i,l,d){let u=videojs.getPlayer(i);if(u)return l&&$e.warn(`Player "${i}" is already initialised. Options will not be applied.`),d&&u.ready(d),u;const c="string"==typeof i?_t("#"+normalizeId(i)):i;if(!isEl(c))throw new TypeError("The element or ID supplied is not valid. (videojs)");const h="getRootNode"in c&&c.getRootNode()instanceof p().ShadowRoot?c.getRootNode():c.ownerDocument.body;c.ownerDocument.defaultView&&h.contains(c)||$e.warn("The element supplied is not included in the DOM"),!0===(l=l||{}).restoreEl&&(l.restoreEl=(c.parentNode&&c.parentNode.hasAttribute&&c.parentNode.hasAttribute("data-vjs-player")?c.parentNode:c).cloneNode(!0)),hooks("beforesetup").forEach((i=>{const d=i(c,merge$1(l));if(!video_es_isObject(d)||Array.isArray(d))return $e.error("please return an object in beforesetup hooks"),void 0;l=merge$1(l,d)}));const m=Component$1.getComponent("Player");return u=new m(c,l,d),hooks("setup").forEach((i=>i(u))),u}if(videojs.hooks_=Ue,videojs.hooks=hooks,videojs.hook=function(i,l){hooks(i,l)},videojs.hookOnce=function(i,l){hooks(i,[].concat(l).map((l=>{const wrapper=(...d)=>(removeHook(i,wrapper),l(...d));return wrapper})))},videojs.removeHook=removeHook,!0!==p().VIDEOJS_NO_DYNAMIC_STYLE&&isReal()){let i=_t(".vjs-styles-defaults");if(!i){i=createStyleElement("vjs-styles-defaults");const l=_t("head");l&&l.insertBefore(i,l.firstChild),setTextContent(i,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: 56.25%\n      }\n    ")}}autoSetupTimeout(1,videojs),videojs.VERSION=Ne,videojs.options=Player.prototype.options_,videojs.getPlayers=()=>Player.players,videojs.getPlayer=i=>{const l=Player.players;let d;if("string"==typeof i){const u=normalizeId(i),c=l[u];if(c)return c;d=_t("#"+u)}else d=i;if(isEl(d)){const{player:i,playerId:u}=d;if(i||l[u])return i||l[u]}},videojs.getAllPlayers=()=>Object.keys(Player.players).map((i=>Player.players[i])).filter(Boolean),videojs.players=Player.players,videojs.getComponent=Component$1.getComponent,videojs.registerComponent=(i,l)=>(Tech.isTech(l)&&$e.warn(`The ${i} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),Component$1.registerComponent.call(Component$1,i,l)),videojs.getTech=Tech.getTech,videojs.registerTech=Tech.registerTech,videojs.use=function use(i,l){zt[i]=zt[i]||[],zt[i].push(l)},Object.defineProperty(videojs,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(videojs.middleware,"TERMINATOR",{value:Wt,writeable:!1,enumerable:!0}),videojs.browser=yt,videojs.obj=We,videojs.mergeOptions=deprecateForMajor(9,"videojs.mergeOptions","videojs.obj.merge",merge$1),videojs.defineLazyProperty=deprecateForMajor(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",defineLazyProperty),videojs.bind=deprecateForMajor(9,"videojs.bind","native Function.prototype.bind",bind_),videojs.registerPlugin=Ii.registerPlugin,videojs.deregisterPlugin=Ii.deregisterPlugin,videojs.plugin=(i,l)=>($e.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Ii.registerPlugin(i,l)),videojs.getPlugins=Ii.getPlugins,videojs.getPlugin=Ii.getPlugin,videojs.getPluginVersion=Ii.getPluginVersion,videojs.addLanguage=function(i,l){return i=(""+i).toLowerCase(),(videojs.options.languages=merge$1(videojs.options.languages,{[i]:l}))[i]},videojs.log=$e,videojs.createLogger=ze,videojs.time=Vt,videojs.createTimeRange=deprecateForMajor(9,"videojs.createTimeRange","videojs.time.createTimeRanges",createTimeRanges$1),videojs.createTimeRanges=deprecateForMajor(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",createTimeRanges$1),videojs.formatTime=deprecateForMajor(9,"videojs.formatTime","videojs.time.formatTime",formatTime),videojs.setFormatTime=deprecateForMajor(9,"videojs.setFormatTime","videojs.time.setFormatTime",setFormatTime),videojs.resetFormatTime=deprecateForMajor(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",resetFormatTime),videojs.parseUrl=deprecateForMajor(9,"videojs.parseUrl","videojs.url.parseUrl",parseUrl),videojs.isCrossOrigin=deprecateForMajor(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",isCrossOrigin),videojs.EventTarget=EventTarget$2,videojs.any=any,videojs.on=on,videojs.one=one,videojs.off=off,videojs.trigger=trigger,videojs.xhr=_(),videojs.TextTrack=TextTrack,videojs.AudioTrack=AudioTrack,videojs.VideoTrack=VideoTrack,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((i=>{videojs[i]=function(){return $e.warn(`videojs.${i}() is deprecated; use videojs.dom.${i}() instead`),bt[i].apply(null,arguments)}})),videojs.computedStyle=deprecateForMajor(9,"videojs.computedStyle","videojs.dom.computedStyle",computedStyle),videojs.dom=bt,videojs.fn=Pt,videojs.num=ri,videojs.str=Lt,videojs.url=jt,videojs.Error={NetworkBadStatus:"networkbadstatus",NetworkRequestFailed:"networkrequestfailed",NetworkRequestAborted:"networkrequestaborted",NetworkRequestTimeout:"networkrequesttimeout",NetworkBodyParserFailed:"networkbodyparserfailed",StreamingHlsPlaylistParserError:"streaminghlsplaylistparsererror",StreamingDashManifestParserError:"streamingdashmanifestparsererror",StreamingContentSteeringParserError:"streamingcontentsteeringparsererror",StreamingVttParserError:"streamingvttparsererror",StreamingFailedToSelectNextSegment:"streamingfailedtoselectnextsegment",StreamingFailedToDecryptSegment:"streamingfailedtodecryptsegment",StreamingFailedToTransmuxSegment:"streamingfailedtotransmuxsegment",StreamingFailedToAppendSegment:"streamingfailedtoappendsegment",StreamingCodecsChangeError:"streamingcodecschangeerror"};class QualityLevel{constructor(i){let l=this;return l.id=i.id,l.label=l.id,l.width=i.width,l.height=i.height,l.bitrate=i.bandwidth,l.frameRate=i.frameRate,l.enabled_=i.enabled,Object.defineProperty(l,"enabled",{get:()=>l.enabled_(),set(i){l.enabled_(i)}}),l}}class QualityLevelList extends videojs.EventTarget{constructor(){super();let i=this;return i.levels_=[],i.selectedIndex_=-1,Object.defineProperty(i,"selectedIndex",{get:()=>i.selectedIndex_}),Object.defineProperty(i,"length",{get:()=>i.levels_.length}),i[Symbol.iterator]=()=>i.levels_.values(),i}addQualityLevel(i){let l=this.getQualityLevelById(i.id);if(l)return l;const d=this.levels_.length;return l=new QualityLevel(i),""+d in this||Object.defineProperty(this,d,{get(){return this.levels_[d]}}),this.levels_.push(l),this.trigger({qualityLevel:l,type:"addqualitylevel"}),l}removeQualityLevel(i){let l=null;for(let d=0,u=this.length;d<u;d++)if(this[d]===i){l=this.levels_.splice(d,1)[0],this.selectedIndex_===d?this.selectedIndex_=-1:this.selectedIndex_>d&&this.selectedIndex_--;break}return l&&this.trigger({qualityLevel:i,type:"removequalitylevel"}),l}getQualityLevelById(i){for(let l=0,d=this.length;l<d;l++){const d=this[l];if(d.id===i)return d}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}QualityLevelList.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const i in QualityLevelList.prototype.allowedEvents_)QualityLevelList.prototype["on"+i]=null;var Di="4.1.0";const qualityLevels=function(i){return function(i){const l=i.qualityLevels,d=new QualityLevelList,disposeHandler=function(){d.dispose(),i.qualityLevels=l,i.off("dispose",disposeHandler)};return i.on("dispose",disposeHandler),i.qualityLevels=()=>d,i.qualityLevels.VERSION=Di,d}(this,videojs.obj.merge({},i))};videojs.registerPlugin("qualityLevels",qualityLevels),qualityLevels.VERSION=Di;const Oi=S,resolveManifestRedirect=(i,l)=>l&&l.responseURL&&i!==l.responseURL?l.responseURL:i,logger=i=>videojs.log.debug?videojs.log.debug.bind(videojs,"VHS:",`${i} >`):function(){};function video_es_merge(...i){const l=videojs.obj||videojs;return(l.merge||l.mergeOptions).apply(l,i)}function createTimeRanges(...i){const l=videojs.time||videojs;return(l.createTimeRanges||l.createTimeRanges).apply(l,i)}const Li=1/30,Ri=.1,filterRanges=function(i,l){const d=[];let u;if(i&&i.length)for(u=0;u<i.length;u++)l(i.start(u),i.end(u))&&d.push([i.start(u),i.end(u)]);return createTimeRanges(d)},findRange=function(i,l){return filterRanges(i,(function(i,d){return i-Ri<=l&&d+Ri>=l}))},findNextRange=function(i,l){return filterRanges(i,(function(i){return i-Li>=l}))},printableRange=i=>{const l=[];if(!i||!i.length)return"";for(let d=0;d<i.length;d++)l.push(i.start(d)+" => "+i.end(d));return l.join(", ")},timeRangesToArray=i=>{const l=[];for(let d=0;d<i.length;d++)l.push({start:i.start(d),end:i.end(d)});return l},lastBufferedEnd=function(i){if(i&&i.length&&i.end)return i.end(i.length-1)},timeAheadOf=function(i,l){let d=0;if(!i||!i.length)return d;for(let u=0;u<i.length;u++){const c=i.start(u),h=i.end(u);l>h||(d+=l>c&&l<=h?h-l:h-c)}return d},segmentDurationWithParts=(i,l)=>{if(!l.preload)return l.duration;let d=0;return(l.parts||[]).forEach((function(i){d+=i.duration})),(l.preloadHints||[]).forEach((function(l){"PART"===l.type&&(d+=i.partTargetDuration)})),d},getPartsAndSegments=i=>(i.segments||[]).reduce(((i,l,d)=>(l.parts?l.parts.forEach((function(u,c){i.push({duration:u.duration,segmentIndex:d,partIndex:c,part:u,segment:l})})):i.push({duration:l.duration,segmentIndex:d,partIndex:null,segment:l,part:null}),i)),[]),getLastParts=i=>{const l=i.segments&&i.segments.length&&i.segments[i.segments.length-1];return l&&l.parts||[]},getKnownPartCount=({preloadSegment:i})=>{if(!i)return;const{parts:l,preloadHints:d}=i;let u=(d||[]).reduce(((i,l)=>i+("PART"===l.type?1:0)),0);return u+=l&&l.length?l.length:0,u},liveEdgeDelay=(i,l)=>{if(l.endList)return 0;if(i&&i.suggestedPresentationDelay)return i.suggestedPresentationDelay;const d=getLastParts(l).length>0;return d&&l.serverControl&&l.serverControl.partHoldBack?l.serverControl.partHoldBack:d&&l.partTargetDuration?3*l.partTargetDuration:l.serverControl&&l.serverControl.holdBack?l.serverControl.holdBack:l.targetDuration?3*l.targetDuration:0},intervalDuration=function(i,l,d){if(void 0===l&&(l=i.mediaSequence+i.segments.length),l<i.mediaSequence)return 0;const u=function(i,l){let d=0,u=l-i.mediaSequence,c=i.segments[u];if(c){if(void 0!==c.start)return{result:c.start,precise:!0};if(void 0!==c.end)return{result:c.end-c.duration,precise:!0}}for(;u--;){if(c=i.segments[u],void 0!==c.end)return{result:d+c.end,precise:!0};if(d+=segmentDurationWithParts(i,c),void 0!==c.start)return{result:d+c.start,precise:!0}}return{result:d,precise:!1}}(i,l);if(u.precise)return u.result;const c=function(i,l){let d,u=0,c=l-i.mediaSequence;for(;c<i.segments.length;c++){if(d=i.segments[c],void 0!==d.start)return{result:d.start-u,precise:!0};if(u+=segmentDurationWithParts(i,d),void 0!==d.end)return{result:d.end-u,precise:!0}}return{result:-1,precise:!1}}(i,l);return c.precise?c.result:u.result+d},duration=function(i,l,d){if(!i)return 0;if("number"!=typeof d&&(d=0),void 0===l){if(i.totalDuration)return i.totalDuration;if(!i.endList)return p()[1/0]}return intervalDuration(i,l,d)},sumDurations=function({defaultDuration:i,durationList:l,startIndex:d,endIndex:u}){let c=0;if(d>u&&([d,u]=[u,d]),d<0){for(let l=d;l<Math.min(0,u);l++)c+=i;d=0}for(let i=d;i<u;i++)c+=l[i].duration;return c},playlistEnd=function(i,l,d,u){if(!i||!i.segments)return null;if(i.endList)return duration(i);if(null===l)return null;let c=intervalDuration(i,i.mediaSequence+i.segments.length,l=l||0);return d&&(c-=u="number"==typeof u?u:liveEdgeDelay(null,i)),Math.max(0,c)},isExcluded=function(i){return i.excludeUntil&&i.excludeUntil>Date.now()},isIncompatible=function(i){return i.excludeUntil&&i.excludeUntil===1/0},isEnabled=function(i){const l=isExcluded(i);return!i.disabled&&!l},hasAttribute=function(i,l){return l.attributes&&l.attributes[i]},isLowestEnabledRendition=(i,l)=>{if(1===i.playlists.length)return!0;const d=l.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===i.playlists.filter((i=>!!isEnabled(i)&&(i.attributes.BANDWIDTH||0)<d)).length},playlistMatch=(i,l)=>!(!i&&!l||!i&&l||i&&!l)&&(i===l||(!(!i.id||!l.id||i.id!==l.id)||(!(!i.resolvedUri||!l.resolvedUri||i.resolvedUri!==l.resolvedUri)||!(!i.uri||!l.uri||i.uri!==l.uri)))),someAudioVariant=function(i,l){const d=i&&i.mediaGroups&&i.mediaGroups.AUDIO||{};let u=!1;for(const i in d){for(const c in d[i])if(u=l(d[i][c]),u)break;if(u)break}return!!u},isAudioOnly=i=>{if(!i||!i.playlists||!i.playlists.length){return someAudioVariant(i,(i=>i.playlists&&i.playlists.length||i.uri))}for(let l=0;l<i.playlists.length;l++){const d=i.playlists[l],u=d.attributes&&d.attributes.CODECS;if(u&&u.split(",").every((i=>O(i))))continue;if(!someAudioVariant(i,(i=>playlistMatch(d,i))))return!1}return!0};var Vi={liveEdgeDelay,duration,seekable:function(i,l,d){const u=l||0;let c=playlistEnd(i,l,!0,d);return null===c?createTimeRanges():(c<u&&(c=u),createTimeRanges(u,c))},getMediaInfoForTime:function({playlist:i,currentTime:l,startingSegmentIndex:d,startingPartIndex:u,startTime:c,exactManifestTimings:h}){let p=l-c;const m=getPartsAndSegments(i);let g=0;for(let i=0;i<m.length;i++){const l=m[i];if(d===l.segmentIndex&&("number"!=typeof u||"number"!=typeof l.partIndex||u===l.partIndex)){g=i;break}}if(p<0){if(g>0)for(let l=g-1;l>=0;l--){const d=m[l];if(p+=d.duration,h){if(p<0)continue}else if(p+Li<=0)continue;return{partIndex:d.partIndex,segmentIndex:d.segmentIndex,startTime:c-sumDurations({defaultDuration:i.targetDuration,durationList:m,startIndex:g,endIndex:l})}}return{partIndex:m[0]&&m[0].partIndex||null,segmentIndex:m[0]&&m[0].segmentIndex||0,startTime:l}}if(g<0){for(let d=g;d<0;d++)if(p-=i.targetDuration,p<0)return{partIndex:m[0]&&m[0].partIndex||null,segmentIndex:m[0]&&m[0].segmentIndex||0,startTime:l};g=0}for(let l=g;l<m.length;l++){const d=m[l];p-=d.duration;if(!(0===p)&&!(d.duration>Li&&p+Li>=0)||l===m.length-1){if(h){if(p>0)continue}else if(p-Li>=0)continue;return{partIndex:d.partIndex,segmentIndex:d.segmentIndex,startTime:c+sumDurations({defaultDuration:i.targetDuration,durationList:m,startIndex:g,endIndex:l})}}}return{segmentIndex:m[m.length-1].segmentIndex,partIndex:m[m.length-1].partIndex,startTime:l}},isEnabled,isDisabled:function(i){return i.disabled},isExcluded,isIncompatible,playlistEnd,isAes:function(i){for(let l=0;l<i.segments.length;l++)if(i.segments[l].key)return!0;return!1},hasAttribute,estimateSegmentRequestTime:function(i,l,d,u=0){if(!hasAttribute("BANDWIDTH",d))return NaN;return(i*d.attributes.BANDWIDTH-8*u)/l},isLowestEnabledRendition,isAudioOnly,playlistMatch,segmentDurationWithParts};const{log:Mi}=videojs,createPlaylistID=(i,l)=>`${i}-${l}`,groupID=(i,l,d)=>`placeholder-uri-${i}-${l}-${d}`,video_es_forEachMediaGroup=(i,l)=>{i.mediaGroups&&["AUDIO","SUBTITLES"].forEach((d=>{if(i.mediaGroups[d])for(const u in i.mediaGroups[d])for(const c in i.mediaGroups[d][u]){l(i.mediaGroups[d][u][c],d,u,c)}}))},setupMediaPlaylist=({playlist:i,uri:l,id:d})=>{i.id=d,i.playlistErrors_=0,l&&(i.uri=l),i.attributes=i.attributes||{}},addPropertiesToMain=(i,l,d=groupID)=>{i.uri=l;for(let l=0;l<i.playlists.length;l++)if(!i.playlists[l].uri){i.playlists[l].uri=`placeholder-uri-${l}`}const u=isAudioOnly(i);video_es_forEachMediaGroup(i,((l,c,h,p)=>{if(!l.playlists||!l.playlists.length){if(u&&"AUDIO"===c&&!l.uri)for(let l=0;l<i.playlists.length;l++){const d=i.playlists[l];if(d.attributes&&d.attributes.AUDIO&&d.attributes.AUDIO===h)return}l.playlists=[_extends({},l)]}l.playlists.forEach((function(l,u){const m=d(c,h,p,l),g=createPlaylistID(u,m);l.uri?l.resolvedUri=l.resolvedUri||Oi(i.uri,l.uri):(l.uri=0===u?m:g,l.resolvedUri=l.uri),l.id=l.id||g,l.attributes=l.attributes||{},i.playlists[l.id]=l,i.playlists[l.uri]=l}))})),(i=>{let l=i.playlists.length;for(;l--;){const d=i.playlists[l];setupMediaPlaylist({playlist:d,id:createPlaylistID(l,d.uri)}),d.resolvedUri=Oi(i.uri,d.uri),i.playlists[d.id]=d,i.playlists[d.uri]=d,d.attributes.BANDWIDTH||Mi.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}})(i),(i=>{video_es_forEachMediaGroup(i,(l=>{l.uri&&(l.resolvedUri=Oi(i.uri,l.uri))}))})(i)};class DateRangesStorage{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(i=[]){if(null!==this.offset_)return;if(!i.length)return;const[l]=i;void 0!==l.programDateTime&&(this.offset_=l.programDateTime/1e3)}setPendingDateRanges(i=[]){if(!i.length)return;const[l]=i,d=l.startDate.getTime();this.trimProcessedDateRanges_(d),this.pendingDateRanges_=i.reduce(((i,l)=>(i.set(l.id,l),i)),new Map)}processDateRange(i){this.pendingDateRanges_.delete(i.id),this.processedDateRanges_.set(i.id,i)}getDateRangesToProcess(){if(null===this.offset_)return[];const i={},l=[];this.pendingDateRanges_.forEach(((d,u)=>{if(!this.processedDateRanges_.has(u)&&(d.startTime=d.startDate.getTime()/1e3-this.offset_,d.processDateRange=()=>this.processDateRange(d),l.push(d),d.class))if(i[d.class]){const l=i[d.class].push(d);d.classListIndex=l-1}else i[d.class]=[d],d.classListIndex=0}));for(const d of l){const l=i[d.class]||[];d.endTime=d.endDate?d.endDate.getTime()/1e3-this.offset_:d.endOnNext&&l[d.classListIndex+1]?l[d.classListIndex+1].startTime:d.duration?d.startTime+d.duration:d.plannedDuration?d.startTime+d.plannedDuration:d.startTime}return l}trimProcessedDateRanges_(i){new Map(this.processedDateRanges_).forEach(((l,d)=>{l.startDate.getTime()<i&&this.processedDateRanges_.delete(d)}))}}const getStreamingNetworkErrorMetadata=({requestType:i,request:l,error:d,parseFailure:u})=>{const c=l.status>=400&&l.status<=499,h={uri:l.uri,requestType:i},p=(l.status<200||l.status>299)&&!c||u;if(d&&c)h.error=_extends({},d),h.errorType=videojs.Error.NetworkRequestFailed;else if(l.aborted)h.errorType=videojs.Error.NetworkRequestAborted;else if(l.timedout)h.erroType=videojs.Error.NetworkRequestTimeout;else if(p){h.errorType=u?videojs.Error.NetworkBodyParserFailed:videojs.Error.NetworkBadStatus,h.status=l.status,h.headers=l.headers}return h},{EventTarget:Ni}=videojs,updateSegment=(i,l)=>{if(!i)return l;const d=video_es_merge(i,l);if(i.preloadHints&&!l.preloadHints&&delete d.preloadHints,i.parts&&!l.parts)delete d.parts;else if(i.parts&&l.parts)for(let u=0;u<l.parts.length;u++)i.parts&&i.parts[u]&&(d.parts[u]=video_es_merge(i.parts[u],l.parts[u]));return!i.skipped&&l.skipped&&(d.skipped=!1),i.preload&&!l.preload&&(d.preload=!1),d},resolveSegmentUris=(i,l)=>{!i.resolvedUri&&i.uri&&(i.resolvedUri=Oi(l,i.uri)),i.key&&!i.key.resolvedUri&&(i.key.resolvedUri=Oi(l,i.key.uri)),i.map&&!i.map.resolvedUri&&(i.map.resolvedUri=Oi(l,i.map.uri)),i.map&&i.map.key&&!i.map.key.resolvedUri&&(i.map.key.resolvedUri=Oi(l,i.map.key.uri)),i.parts&&i.parts.length&&i.parts.forEach((i=>{i.resolvedUri||(i.resolvedUri=Oi(l,i.uri))})),i.preloadHints&&i.preloadHints.length&&i.preloadHints.forEach((i=>{i.resolvedUri||(i.resolvedUri=Oi(l,i.uri))}))},getAllSegments=function(i){const l=i.segments||[],d=i.preloadSegment;if(d&&d.parts&&d.parts.length){if(d.preloadHints)for(let i=0;i<d.preloadHints.length;i++)if("MAP"===d.preloadHints[i].type)return l;d.duration=i.targetDuration,d.preload=!0,l.push(d)}return l},isPlaylistUnchanged=(i,l)=>i===l||i.segments&&l.segments&&i.segments.length===l.segments.length&&i.endList===l.endList&&i.mediaSequence===l.mediaSequence&&i.preloadSegment===l.preloadSegment,updateMain$1=(i,l,d=isPlaylistUnchanged)=>{const u=video_es_merge(i,{}),c=u.playlists[l.id];if(!c)return null;if(d(c,l))return null;l.segments=getAllSegments(l);const h=video_es_merge(c,l);if(h.preloadSegment&&!l.preloadSegment&&delete h.preloadSegment,c.segments){if(l.skip){l.segments=l.segments||[];for(let i=0;i<l.skip.skippedSegments;i++)l.segments.unshift({skipped:!0})}h.segments=((i,l,d)=>{const u=i.slice(),c=l.slice();d=d||0;const h=[];let p;for(let i=0;i<c.length;i++){const l=u[i+d],m=c[i];l?(p=l.map||p,h.push(updateSegment(l,m))):(p&&!m.map&&(m.map=p),h.push(m))}return h})(c.segments,l.segments,l.mediaSequence-c.mediaSequence)}h.segments.forEach((i=>{resolveSegmentUris(i,h.resolvedUri)}));for(let i=0;i<u.playlists.length;i++)u.playlists[i].id===l.id&&(u.playlists[i]=h);return u.playlists[l.id]=h,u.playlists[l.uri]=h,video_es_forEachMediaGroup(i,((i,d,u,c)=>{if(i.playlists)for(let d=0;d<i.playlists.length;d++)l.id===i.playlists[d].id&&(i.playlists[d]=h)})),u},refreshDelay=(i,l)=>{const d=i.segments||[],u=d[d.length-1],c=u&&u.parts&&u.parts[u.parts.length-1],h=c&&c.duration||u&&u.duration;return l&&h?1e3*h:500*(i.partTargetDuration||i.targetDuration||10)},playlistMetadataPayload=(i,l,d)=>{if(!i)return;const u=[];return i.forEach((i=>{if(!i.attributes)return;const{BANDWIDTH:l,RESOLUTION:d,CODECS:c}=i.attributes;u.push({id:i.id,bandwidth:l,resolution:d,codecs:c})})),{type:l,isLive:d,renditions:u}};class PlaylistLoader extends Ni{constructor(i,l,d={}){if(super(),!i)throw new Error("A non-empty playlist URL or object is required");this.logger_=logger("PlaylistLoader");const{withCredentials:u=!1}=d;this.src=i,this.vhs_=l,this.withCredentials=u,this.addDateRangesToTextTrack_=d.addDateRangesToTextTrack;const c=l.options_;this.customTagParsers=c&&c.customTagParsers||[],this.customTagMappers=c&&c.customTagMappers||[],this.llhls=c&&c.llhls,this.dateRangesStorage_=new DateRangesStorage,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const i=this.media();if(!i)return;this.dateRangesStorage_.setOffset(i.segments),this.dateRangesStorage_.setPendingDateRanges(i.dateRanges);const l=this.dateRangesStorage_.getDateRangesToProcess();l.length&&this.addDateRangesToTextTrack_&&this.addDateRangesToTextTrack_(l)}handleMediaupdatetimeout_(){if("HAVE_METADATA"!==this.state)return;const i=this.media();let l=Oi(this.main.uri,i.uri);this.llhls&&(l=((i,l)=>{if(l.endList||!l.serverControl)return i;const d={};if(l.serverControl.canBlockReload){const{preloadSegment:i}=l;let u=l.mediaSequence+l.segments.length;if(i){const c=i.parts||[],h=getKnownPartCount(l)-1;h>-1&&h!==c.length-1&&(d._HLS_part=h),(h>-1||c.length)&&u--}d._HLS_msn=u}if(l.serverControl&&l.serverControl.canSkipUntil&&(d._HLS_skip=l.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(d).length){const l=new(p().URL)(i);["_HLS_skip","_HLS_msn","_HLS_part"].forEach((function(i){d.hasOwnProperty(i)&&l.searchParams.set(i,d[i])})),i=l.toString()}return i})(l,i)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:l,withCredentials:this.withCredentials,requestType:"hls-playlist"},((i,l)=>{if(this.request)return i?this.playlistRequestError(this.request,this.media(),"HAVE_METADATA"):(this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id}),void 0)}))}playlistRequestError(i,l,d){const{uri:u,id:c}=l;this.request=null,d&&(this.state=d),this.error={playlist:this.main.playlists[c],status:i.status,message:`HLS playlist request error at URL: ${u}.`,responseText:i.responseText,code:i.status>=500?4:2,metadata:getStreamingNetworkErrorMetadata({requestType:i.requestType,request:i,error:i.error})},this.trigger("error")}parseManifest_({url:i,manifestString:l}){try{return(({onwarn:i,oninfo:l,manifestString:d,customTagParsers:u=[],customTagMappers:c=[],llhls:h})=>{const p=new Parser;i&&p.on("warn",i),l&&p.on("info",l),u.forEach((i=>p.addParser(i))),c.forEach((i=>p.addTagMapper(i))),p.push(d),p.end();const m=p.manifest;if(h||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach((function(i){m.hasOwnProperty(i)&&delete m[i]})),m.segments&&m.segments.forEach((function(i){["parts","preloadHints"].forEach((function(l){i.hasOwnProperty(l)&&delete i[l]}))}))),!m.targetDuration){let l=10;m.segments&&m.segments.length&&(l=m.segments.reduce(((i,l)=>Math.max(i,l.duration)),0)),i&&i({message:`manifest has no targetDuration defaulting to ${l}`}),m.targetDuration=l}const g=getLastParts(m);if(g.length&&!m.partTargetDuration){const l=g.reduce(((i,l)=>Math.max(i,l.duration)),0);i&&(i({message:`manifest has no partTargetDuration defaulting to ${l}`}),Mi.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),m.partTargetDuration=l}return m})({onwarn:({message:l})=>this.logger_(`m3u8-parser warn for ${i}: ${l}`),oninfo:({message:l})=>this.logger_(`m3u8-parser info for ${i}: ${l}`),manifestString:l,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}catch(i){this.error=i,this.error.metadata={errorType:videojs.Error.StreamingHlsPlaylistParserError,error:i}}}haveMetadata({playlistString:i,playlistObject:l,url:d,id:u}){this.request=null,this.state="HAVE_METADATA";const c={playlistInfo:{type:"media",uri:d}};this.trigger({type:"playlistparsestart",metadata:c});const h=l||this.parseManifest_({url:d,manifestString:i});h.lastRequest=Date.now(),setupMediaPlaylist({playlist:h,uri:d,id:u});const p=updateMain$1(this.main,h);this.targetDuration=h.partTargetDuration||h.targetDuration,this.pendingMedia_=null,p?(this.main=p,this.media_=this.main.playlists[u]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(refreshDelay(this.media(),!!p)),c.parsedPlaylist=playlistMetadataPayload(this.main.playlists,c.playlistInfo.type,!this.media_.endList),this.trigger({type:"playlistparsecomplete",metadata:c}),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),p().clearTimeout(this.mediaUpdateTimeout),p().clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new DateRangesStorage,this.off()}stopRequest(){if(this.request){const i=this.request;this.request=null,i.onreadystatechange=null,i.abort()}}media(i,l){if(!i)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof i){if(!this.main.playlists[i])throw new Error("Unknown playlist URI: "+i);i=this.main.playlists[i]}if(p().clearTimeout(this.finalRenditionTimeout),l){const l=(i.partTargetDuration||i.targetDuration)/2*1e3||5e3;return this.finalRenditionTimeout=p().setTimeout(this.media.bind(this,i,!1),l),void 0}const d=this.state,u=!this.media_||i.id!==this.media_.id,c=this.main.playlists[i.id];if(c&&c.endList||i.endList&&i.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=i,u&&(this.trigger("mediachanging"),this.trigger("HAVE_MAIN_MANIFEST"===d?"loadedmetadata":"mediachange")),void 0;if(this.updateMediaUpdateTimeout_(refreshDelay(i,!0)),!u)return;if(this.state="SWITCHING_MEDIA",this.request){if(i.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=i;const h={playlistInfo:{type:"media",uri:i.uri}};this.trigger({type:"playlistrequeststart",metadata:h}),this.request=this.vhs_.xhr({uri:i.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},((l,u)=>{if(this.request){if(i.lastRequest=Date.now(),i.resolvedUri=resolveManifestRedirect(i.resolvedUri,u),l)return this.playlistRequestError(this.request,i,d);this.trigger({type:"playlistrequestcomplete",metadata:h}),this.haveMetadata({playlistString:u.responseText,url:i.uri,id:i.id}),this.trigger("HAVE_MAIN_MANIFEST"===d?"loadedmetadata":"mediachange")}}))}pause(){this.mediaUpdateTimeout&&(p().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.state=this.media_?"HAVE_METADATA":"HAVE_MAIN_MANIFEST":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}load(i){this.mediaUpdateTimeout&&(p().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const l=this.media();if(i){const i=l?(l.partTargetDuration||l.targetDuration)/2*1e3:5e3;return this.mediaUpdateTimeout=p().setTimeout((()=>{this.mediaUpdateTimeout=null,this.load()}),i),void 0}if(!this.started)return this.start(),void 0;this.trigger(l&&!l.endList?"mediaupdatetimeout":"loadedplaylist")}updateMediaUpdateTimeout_(i){this.mediaUpdateTimeout&&(p().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=p().setTimeout((()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(i)}),i))}start(){if(this.started=!0,"object"==typeof this.src)return this.src.uri||(this.src.uri=p().location.href),this.src.resolvedUri=this.src.uri,setTimeout((()=>{this.setupInitialPlaylist(this.src)}),0),void 0;const i={playlistInfo:{type:"multivariant",uri:this.src}};this.trigger({type:"playlistrequeststart",metadata:i}),this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},((l,d)=>{if(!this.request)return;if(this.request=null,l)return this.error={status:d.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:d.responseText,code:2,metadata:getStreamingNetworkErrorMetadata({requestType:d.requestType,request:d,error:l})},"HAVE_NOTHING"===this.state&&(this.started=!1),this.trigger("error");this.trigger({type:"playlistrequestcomplete",metadata:i}),this.src=resolveManifestRedirect(this.src,d),this.trigger({type:"playlistparsestart",metadata:i});const u=this.parseManifest_({manifestString:d.responseText,url:this.src});i.parsedPlaylist=playlistMetadataPayload(u.playlists,i.playlistInfo.type,!1),this.trigger({type:"playlistparsecomplete",metadata:i}),this.setupInitialPlaylist(u)}))}srcUri(){return"string"==typeof this.src?this.src:this.src.uri}setupInitialPlaylist(i){if(this.state="HAVE_MAIN_MANIFEST",i.playlists)return this.main=i,addPropertiesToMain(this.main,this.srcUri()),i.playlists.forEach((i=>{i.segments=getAllSegments(i),i.segments.forEach((l=>{resolveSegmentUris(l,i.resolvedUri)}))})),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]),void 0;const l=this.srcUri()||p().location.href;this.main=((i,l)=>{const d=createPlaylistID(0,l),u={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:p().location.href,resolvedUri:p().location.href,playlists:[{uri:l,id:d,resolvedUri:l,attributes:{}}]};return u.playlists[d]=u.playlists[0],u.playlists[l]=u.playlists[0],u})(0,l),this.haveMetadata({playlistObject:i,url:l,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(i,l){const d=this.main,u=i.ID;let c=d.playlists.length;for(;c--;){const h=d.playlists[c];if(h.attributes["PATHWAY-ID"]===u){const p=h.resolvedUri,m=h.id;if(l){const l=this.createCloneURI_(h.resolvedUri,i),p=createPlaylistID(u,l),m=this.createCloneAttributes_(u,h.attributes),g=this.createClonePlaylist_(h,p,i,m);d.playlists[c]=g,d.playlists[p]=g,d.playlists[l]=g}else d.playlists.splice(c,1);delete d.playlists[m],delete d.playlists[p]}}this.updateOrDeleteCloneMedia(i,l)}updateOrDeleteCloneMedia(i,l){const d=this.main,u=i.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((i=>{if(d.mediaGroups[i]&&d.mediaGroups[i][u])for(const l in d.mediaGroups[i])if(l===u){for(const u in d.mediaGroups[i][l]){d.mediaGroups[i][l][u].playlists.forEach(((i,l)=>{const u=d.playlists[i.id],c=u.resolvedUri;delete d.playlists[u.id],delete d.playlists[c]}))}delete d.mediaGroups[i][l]}})),l&&this.createClonedMediaGroups_(i)}addClonePathway(i,l={}){const d=this.main,u=d.playlists.length,c=this.createCloneURI_(l.resolvedUri,i),h=createPlaylistID(i.ID,c),p=this.createCloneAttributes_(i.ID,l.attributes),m=this.createClonePlaylist_(l,h,i,p);d.playlists[u]=m,d.playlists[h]=m,d.playlists[c]=m,this.createClonedMediaGroups_(i)}createClonedMediaGroups_(i){const l=i.ID,d=i["BASE-ID"],u=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((c=>{if(u.mediaGroups[c]&&!u.mediaGroups[c][l])for(const h in u.mediaGroups[c])if(h===d){u.mediaGroups[c][l]={};for(const d in u.mediaGroups[c][h]){const p=u.mediaGroups[c][h][d];u.mediaGroups[c][l][d]=_extends({},p);const m=u.mediaGroups[c][l][d],g=this.createCloneURI_(p.resolvedUri,i);m.resolvedUri=g,m.uri=g,m.playlists=[],p.playlists.forEach(((h,p)=>{const g=u.playlists[h.id],y=groupID(c,l,d),_=createPlaylistID(l,y);if(g&&!u.playlists[_]){const l=this.createClonePlaylist_(g,_,i),d=l.resolvedUri;u.playlists[_]=l,u.playlists[d]=l}m.playlists[p]=this.createClonePlaylist_(h,_,i)}))}}}))}createClonePlaylist_(i,l,d,u){const c=this.createCloneURI_(i.resolvedUri,d),h={resolvedUri:c,uri:c,id:l};return i.segments&&(h.segments=[]),u&&(h.attributes=u),video_es_merge(i,h)}createCloneURI_(i,l){const d=new URL(i);d.hostname=l["URI-REPLACEMENT"].HOST;const u=l["URI-REPLACEMENT"].PARAMS;for(const i of Object.keys(u))d.searchParams.set(i,u[i]);return d.href}createCloneAttributes_(i,l){const d={"PATHWAY-ID":i};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((u=>{l[u]&&(d[u]=i)})),d}getKeyIdSet(i){if(i.contentProtection){const l=new Set;for(const d in i.contentProtection){const u=i.contentProtection[d].attributes.keyId;u&&l.add(u.toLowerCase())}return l}}}const callbackWrapper=function(i,l,d,u){const c="arraybuffer"===i.responseType?i.response:i.responseText;!l&&c&&(i.responseTime=Date.now(),i.roundTripTime=i.responseTime-i.requestTime,i.bytesReceived=c.byteLength||c.length,i.bandwidth||(i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3))),d.headers&&(i.responseHeaders=d.headers),l&&"ETIMEDOUT"===l.code&&(i.timedout=!0),l||i.aborted||200===d.statusCode||206===d.statusCode||0===d.statusCode||(l=new Error("XHR Failed with a response of: "+(i&&(c||i.responseText)))),u(l,i)},xhrFactory=function(){const i=function XhrFunction(i,l){i=video_es_merge({timeout:45e3},i);const d=XhrFunction.beforeRequest||videojs.Vhs.xhr.beforeRequest,u=XhrFunction._requestCallbackSet||videojs.Vhs.xhr._requestCallbackSet||new Set,c=XhrFunction._responseCallbackSet||videojs.Vhs.xhr._responseCallbackSet;d&&"function"==typeof d&&(videojs.log.warn("beforeRequest is deprecated, use onRequest instead."),u.add(d));const h=!0===videojs.Vhs.xhr.original?videojs.xhr:videojs.Vhs.xhr,p=((i,l)=>{if(!i||!i.size)return;let d=l;return i.forEach((i=>{d=i(d)})),d})(u,i);u.delete(d);const m=h(p||i,(function(i,d){return((i,l,d,u)=>{i&&i.size&&i.forEach((i=>{i(l,d,u)}))})(c,m,i,d),callbackWrapper(m,i,d,l)})),g=m.abort;return m.abort=function(){return m.aborted=!0,g.apply(m,arguments)},m.uri=i.uri,m.requestType=i.requestType,m.requestTime=Date.now(),m};return i.original=!0,i},segmentXhrHeaders=function(i){const l={};return i.byterange&&(l.Range=function(i){let l;const d=i.offset;return l="bigint"==typeof i.offset||"bigint"==typeof i.length?p().BigInt(i.offset)+p().BigInt(i.length)-p().BigInt(1):i.offset+i.length-1,"bytes="+d+"-"+l}(i.byterange)),l},textRange=function(i,l){return i.start(l)+"-"+i.end(l)},formatHexString=function(i,l){const d=i.toString(16);return"00".substring(0,2-d.length)+d+(l%2?" ":"")},formatAsciiString=function(i){return i>=32&&i<126?String.fromCharCode(i):"."},createTransferableMessage=function(i){const l={};return Object.keys(i).forEach((d=>{const u=i[d];l[d]=H(u)?{bytes:u.buffer,byteOffset:u.byteOffset,byteLength:u.byteLength}:u})),l},initSegmentId=function(i){const l=i.byterange||{length:1/0,offset:0};return[l.length,l.offset,i.resolvedUri].join(",")},segmentKeyId=function(i){return i.resolvedUri},hexDump=i=>{const l=Array.prototype.slice.call(i),d=16;let u,c,h="";for(let i=0;i<l.length/d;i++)u=l.slice(i*d,i*d+d).map(formatHexString).join(""),c=l.slice(i*d,i*d+d).map(formatAsciiString).join(""),h+=u+" "+c+"\n";return h};var Ui=Object.freeze({__proto__:null,createTransferableMessage,initSegmentId,segmentKeyId,hexDump,tagDump:({bytes:i})=>hexDump(i),textRanges:i=>{let l,d="";for(l=0;l<i.length;l++)d+=textRange(i,l)+" ";return d}});const getProgramTime=({playlist:i,time:l,callback:d})=>{if(!d)throw new Error("getProgramTime: callback must be provided");if(!i||void 0===l)return d({message:"getProgramTime: playlist and time must be provided"});const u=((i,l)=>{if(!l||!l.segments||0===l.segments.length)return null;let d,u=0;for(let c=0;c<l.segments.length&&(d=l.segments[c],u=d.videoTimingInfo?d.videoTimingInfo.transmuxedPresentationEnd:u+d.duration,!(i<=u));c++);const c=l.segments[l.segments.length-1];if(c.videoTimingInfo&&c.videoTimingInfo.transmuxedPresentationEnd<i)return null;if(i>u){if(i>u+.25*c.duration)return null;d=c}return{segment:d,estimatedStart:d.videoTimingInfo?d.videoTimingInfo.transmuxedPresentationStart:u-d.duration,type:d.videoTimingInfo?"accurate":"estimate"}})(l,i);if(!u)return d({message:"valid programTime was not found"});if("estimate"===u.type)return d({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:u.estimatedStart});const c={mediaSeconds:l},h=((i,l)=>{if(!l.dateTimeObject)return null;const d=i-(l.videoTimingInfo.transmuxedPresentationStart+l.videoTimingInfo.transmuxerPrependedSeconds);return new Date(l.dateTimeObject.getTime()+1e3*d)})(l,u.segment);return h&&(c.programDateTime=h.toISOString()),d(null,c)},seekToProgramTime=({programTime:i,playlist:l,retryCount:d=2,seekTo:u,pauseAfterSeek:c=!0,tech:h,callback:p})=>{if(!p)throw new Error("seekToProgramTime: callback must be provided");if(void 0===i||!l||!u)return p({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!l.endList&&!h.hasStarted_)return p({message:"player must be playing a live stream to start buffering"});if(!(i=>{if(!i.segments||0===i.segments.length)return!1;for(let l=0;l<i.segments.length;l++)if(!i.segments[l].dateTimeObject)return!1;return!0})(l))return p({message:"programDateTime tags must be provided in the manifest "+l.resolvedUri});const m=((i,l)=>{let d;try{d=new Date(i)}catch(i){return null}if(!l||!l.segments||0===l.segments.length)return null;let u=l.segments[0];if(d<new Date(u.dateTimeObject))return null;for(let i=0;i<l.segments.length-1&&(u=l.segments[i],!(d<new Date(l.segments[i+1].dateTimeObject)));i++);const c=l.segments[l.segments.length-1],h=c.dateTimeObject,p=c.videoTimingInfo?(m=c.videoTimingInfo).transmuxedPresentationEnd-m.transmuxedPresentationStart-m.transmuxerPrependedSeconds:c.duration+.25*c.duration;var m;return d>new Date(h.getTime()+1e3*p)?null:(d>new Date(h)&&(u=c),{segment:u,estimatedStart:u.videoTimingInfo?u.videoTimingInfo.transmuxedPresentationStart:Vi.duration(l,l.mediaSequence+l.segments.indexOf(u)),type:u.videoTimingInfo?"accurate":"estimate"})})(i,l);if(!m)return p({message:`${i} was not found in the stream`});const g=m.segment,y=((i,l)=>{let d,u;try{d=new Date(i),u=new Date(l)}catch(i){}const c=d.getTime();return(u.getTime()-c)/1e3})(g.dateTimeObject,i);if("estimate"===m.type)return 0===d?p({message:`${i} is not buffered yet. Try again`}):(u(m.estimatedStart+y),h.one("seeked",(()=>{seekToProgramTime({programTime:i,playlist:l,retryCount:d-1,seekTo:u,pauseAfterSeek:c,tech:h,callback:p})})),void 0);const _=g.start+y;h.one("seeked",(()=>p(null,h.currentTime()))),c&&h.pause(),u(_)},callbackOnCompleted=(i,l)=>{if(4===i.readyState)return l()},containerRequest=(i,l,d,u)=>{let c,h=[],p=!1;const endRequestAndCallback=function(i,l,u,c){return l.abort(),p=!0,d(i,l,u,c)},progressListener=function(i,l){if(p)return;if(i)return i.metadata=getStreamingNetworkErrorMetadata({requestType:u,request:l,error:i}),endRequestAndCallback(i,l,"",h);const d=l.responseText.substring(h&&h.byteLength||0,l.responseText.length);if(h=function concatTypedArrays(){for(var i=arguments.length,l=new Array(i),d=0;d<i;d++)l[d]=arguments[d];if(l=l.filter((function(i){return i&&(i.byteLength||i.length)&&"string"!=typeof i})),l.length<=1)return $(l[0]);var u=l.reduce((function(i,l,d){return i+(l.byteLength||l.length)}),0),c=new Uint8Array(u),h=0;return l.forEach((function(i){i=$(i),c.set(i,h),h+=i.byteLength})),c}(h,Y(d,!0)),c=c||ge(h),h.length<10||c&&h.length<c+2)return callbackOnCompleted(l,(()=>endRequestAndCallback(i,l,"",h)));const m=Ve(h);return"ts"===m&&h.length<188||!m&&h.length<376?callbackOnCompleted(l,(()=>endRequestAndCallback(i,l,"",h))):endRequestAndCallback(null,l,m,h)},m={uri:i,beforeSend(i){i.overrideMimeType("text/plain; charset=x-user-defined"),i.addEventListener("progress",(function({}){return callbackWrapper(i,null,{statusCode:i.status},progressListener)}))}},g=l(m,(function(i,l){return callbackWrapper(g,i,l,progressListener)}));return g},{EventTarget:Bi}=videojs,dashPlaylistUnchanged=function(i,l){if(!isPlaylistUnchanged(i,l))return!1;if(i.sidx&&l.sidx&&(i.sidx.offset!==l.sidx.offset||i.sidx.length!==l.sidx.length))return!1;if(!i.sidx&&l.sidx||i.sidx&&!l.sidx)return!1;if(i.segments&&!l.segments||!i.segments&&l.segments)return!1;if(!i.segments&&!l.segments)return!0;for(let d=0;d<i.segments.length;d++){const u=i.segments[d],c=l.segments[d];if(u.uri!==c.uri)return!1;if(!u.byterange&&!c.byterange)continue;const h=u.byterange,p=c.byterange;if(h&&!p||!h&&p)return!1;if(h.offset!==p.offset||h.length!==p.length)return!1}return!0},dashGroupId=(i,l,d,u)=>`placeholder-uri-${i}-${l}-${u.attributes.NAME||d}`,updateMain=(i,l,d)=>{let u=!0,c=video_es_merge(i,{duration:l.duration,minimumUpdatePeriod:l.minimumUpdatePeriod,timelineStarts:l.timelineStarts});for(let i=0;i<l.playlists.length;i++){const h=l.playlists[i];if(h.sidx){const i=generateSidxKey(h.sidx);d&&d[i]&&d[i].sidx&&addSidxSegmentsToPlaylist$1(h,d[i].sidx,h.sidx.resolvedUri)}const p=updateMain$1(c,h,dashPlaylistUnchanged);p&&(c=p,u=!1)}return video_es_forEachMediaGroup(l,((i,l,d,h)=>{if(i.playlists&&i.playlists.length){const p=i.playlists[0].id,m=updateMain$1(c,i.playlists[0],dashPlaylistUnchanged);m&&(c=m,h in c.mediaGroups[l][d]||(c.mediaGroups[l][d][h]=i),c.mediaGroups[l][d][h].playlists[0]=c.playlists[p],u=!1)}})),((i,l)=>{video_es_forEachMediaGroup(i,((d,u,c,h)=>{l.mediaGroups[u][c]&&h in l.mediaGroups[u][c]||delete i.mediaGroups[u][c][h]}))})(c,l),l.minimumUpdatePeriod!==i.minimumUpdatePeriod&&(u=!1),u?null:c},equivalentSidx=(i,l)=>(Boolean(!i.map&&!l.map)||Boolean(i.map&&l.map&&i.map.byterange.offset===l.map.byterange.offset&&i.map.byterange.length===l.map.byterange.length))&&i.uri===l.uri&&i.byterange.offset===l.byterange.offset&&i.byterange.length===l.byterange.length,compareSidxEntry=(i,l)=>{const d={};for(const u in i){const c=i[u].sidx;if(c){const i=generateSidxKey(c);if(!l[i])break;equivalentSidx(l[i].sidxInfo,c)&&(d[i]=l[i])}}return d};class DashPlaylistLoader extends Bi{constructor(i,l,d={},u){super(),this.isPaused_=!0,this.mainPlaylistLoader_=u||this,u||(this.isMain_=!0);const{withCredentials:c=!1}=d;if(this.vhs_=l,this.withCredentials=c,this.addMetadataToTextTrack=d.addMetadataToTextTrack,!i)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",(()=>{this.refreshXml_()})),this.on("mediaupdatetimeout",(()=>{this.refreshMedia_(this.media().id)})),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=logger("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=i,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=i}get isPaused(){return this.isPaused_}requestErrored_(i,l,d){return!this.request||(this.request=null,i?(this.error="object"!=typeof i||i instanceof Error?{status:l.status,message:"DASH request error at URL: "+l.uri,response:l.response,code:2,metadata:i.metadata}:i,d&&(this.state=d),this.trigger("error"),!0):void 0)}addSidxSegments_(i,l,d){const u=i.sidx&&generateSidxKey(i.sidx);if(!i.sidx||!u||this.mainPlaylistLoader_.sidxMapping_[u])return p().clearTimeout(this.mediaRequest_),this.mediaRequest_=p().setTimeout((()=>d(!1)),0),void 0;const c=resolveManifestRedirect(i.sidx.resolvedUri),fin=(c,h)=>{if(this.requestErrored_(c,h,l))return;const p=this.mainPlaylistLoader_.sidxMapping_,{requestType:m}=h;let g;try{g=me()($(h.response).subarray(8))}catch(i){return i.metadata=getStreamingNetworkErrorMetadata({requestType:m,request:h,parseFailure:!0}),this.requestErrored_(i,h,l),void 0}return p[u]={sidxInfo:i.sidx,sidx:g},addSidxSegmentsToPlaylist$1(i,g,i.sidx.resolvedUri),d(!0)};this.request=containerRequest(c,this.vhs_.xhr,((l,d,u,h)=>{if(l)return fin(l,d);if(!u||"mp4"!==u){return fin({status:d.status,message:`Unsupported ${u||"unknown"} container type for sidx segment at URL: ${c}`,response:"",playlist:i,internal:!0,playlistExclusionDuration:1/0,code:2},d)}const{offset:p,length:m}=i.sidx.byterange;if(h.length>=m+p)return fin(l,{response:h.subarray(p,p+m),status:d.status,uri:d.uri});this.request=this.vhs_.xhr({uri:c,responseType:"arraybuffer",requestType:"dash-sidx",headers:segmentXhrHeaders({byterange:i.sidx.byterange})},fin)}),"dash-sidx")}dispose(){this.isPaused_=!0,this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},p().clearTimeout(this.minimumUpdatePeriodTimeout_),p().clearTimeout(this.mediaRequest_),p().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const i=this.request;this.request=null,i.onreadystatechange=null,i.abort()}}media(i){if(!i)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);const l=this.state;if("string"==typeof i){if(!this.mainPlaylistLoader_.main.playlists[i])throw new Error("Unknown playlist URI: "+i);i=this.mainPlaylistLoader_.main.playlists[i]}const d=!this.media_||i.id!==this.media_.id;if(d&&this.loadedPlaylists_[i.id]&&this.loadedPlaylists_[i.id].endList)return this.state="HAVE_METADATA",this.media_=i,d&&(this.trigger("mediachanging"),this.trigger("mediachange")),void 0;d&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(i,l,(d=>{this.haveMetadata({startingState:l,playlist:i})})))}haveMetadata({startingState:i,playlist:l}){this.state="HAVE_METADATA",this.loadedPlaylists_[l.id]=l,p().clearTimeout(this.mediaRequest_),this.mediaRequest_=null,this.refreshMedia_(l.id),this.trigger("HAVE_MAIN_MANIFEST"===i?"loadedmetadata":"mediachange")}pause(){this.isPaused_=!0,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),p().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(p().clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),"HAVE_NOTHING"===this.state&&(this.started=!1)}load(i){this.isPaused_=!1,p().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const l=this.media();if(i){const i=l?l.targetDuration/2*1e3:5e3;return this.mediaUpdateTimeout=p().setTimeout((()=>this.load()),i),void 0}if(!this.started)return this.start(),void 0;l&&!l.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_)return p().clearTimeout(this.mediaRequest_),this.mediaRequest_=p().setTimeout((()=>this.haveMain_()),0),void 0;this.requestMain_(((i,l)=>{this.haveMain_(),this.hasPendingRequest()||this.media_||this.media(this.mainPlaylistLoader_.main.playlists[0])}))}requestMain_(i){const l={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestrequeststart",metadata:l}),this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},((d,u)=>{if(d){const{requestType:i}=u;d.metadata=getStreamingNetworkErrorMetadata({requestType:i,request:u,error:d})}if(this.requestErrored_(d,u))return"HAVE_NOTHING"===this.state&&(this.started=!1),void 0;this.trigger({type:"manifestrequestcomplete",metadata:l});const c=u.responseText!==this.mainPlaylistLoader_.mainXml_;return this.mainPlaylistLoader_.mainXml_=u.responseText,this.mainLoaded_=u.responseHeaders&&u.responseHeaders.date?Date.parse(u.responseHeaders.date):Date.now(),this.mainPlaylistLoader_.srcUrl=resolveManifestRedirect(this.mainPlaylistLoader_.srcUrl,u),c?(this.handleMain_(),this.syncClientServerClock_((()=>i(u,c))),void 0):i(u,c)}))}syncClientServerClock_(i){const l=parseUTCTiming(this.mainPlaylistLoader_.mainXml_);return null===l?(this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),i()):"DIRECT"===l.method?(this.mainPlaylistLoader_.clientOffset_=l.value-Date.now(),i()):(this.request=this.vhs_.xhr({uri:Oi(this.mainPlaylistLoader_.srcUrl,l.value),method:l.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},((d,u)=>{if(!this.request)return;if(d){const{requestType:l}=u;return this.error.metadata=getStreamingNetworkErrorMetadata({requestType:l,request:u,error:d}),this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),i()}let c;c="HEAD"===l.method?u.responseHeaders&&u.responseHeaders.date?Date.parse(u.responseHeaders.date):this.mainLoaded_:Date.parse(u.responseText),this.mainPlaylistLoader_.clientOffset_=c-Date.now(),i()})),void 0)}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){p().clearTimeout(this.mediaRequest_),this.mediaRequest_=null;const i=this.mainPlaylistLoader_.main,l={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};let d;this.trigger({type:"manifestparsestart",metadata:l});try{d=(({mainXml:i,srcUrl:l,clientOffset:d,sidxMapping:u,previousManifest:c})=>{const h=parse(i,{manifestUri:l,clientOffset:d,sidxMapping:u,previousManifest:c});return addPropertiesToMain(h,l,dashGroupId),h})({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:i})}catch(i){this.error=i,this.error.metadata={errorType:videojs.Error.StreamingDashManifestParserError,error:i},this.trigger("error")}i&&(d=updateMain(i,d,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=d||i;const u=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];if(u&&u!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=u),(!i||d&&d.minimumUpdatePeriod!==i.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(d),d){const{duration:i,endList:u}=d,c=[];d.playlists.forEach((i=>{c.push({id:i.id,bandwidth:i.attributes.BANDWIDTH,resolution:i.attributes.RESOLUTION,codecs:i.attributes.CODECS})}));l.parsedManifest={duration:i,isLive:!u,renditions:c},this.trigger({type:"manifestparsecomplete",metadata:l})}return Boolean(d)}updateMinimumUpdatePeriodTimeout_(){const i=this.mainPlaylistLoader_;i.createMupOnMedia_&&(i.off("loadedmetadata",i.createMupOnMedia_),i.createMupOnMedia_=null),i.minimumUpdatePeriodTimeout_&&(p().clearTimeout(i.minimumUpdatePeriodTimeout_),i.minimumUpdatePeriodTimeout_=null);let l=i.main&&i.main.minimumUpdatePeriod;if(0===l&&(i.media()?l=1e3*i.media().targetDuration:(i.createMupOnMedia_=i.updateMinimumUpdatePeriodTimeout_,i.one("loadedmetadata",i.createMupOnMedia_))),"number"!=typeof l||l<=0)return l<0&&this.logger_(`found invalid minimumUpdatePeriod of ${l}, not setting a timeout`),void 0;this.createMUPTimeout_(l)}createMUPTimeout_(i){const l=this.mainPlaylistLoader_;l.minimumUpdatePeriodTimeout_=p().setTimeout((()=>{l.minimumUpdatePeriodTimeout_=null,l.trigger("minimumUpdatePeriod"),l.createMUPTimeout_(i)}),i)}refreshXml_(){this.requestMain_(((i,l)=>{l&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=((i,l)=>{let d=compareSidxEntry(i.playlists,l);return video_es_forEachMediaGroup(i,((i,u,c,h)=>{i.playlists&&i.playlists.length&&(d=video_es_merge(d,compareSidxEntry(i.playlists,l)))})),d})(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,(i=>{this.refreshMedia_(this.media().id)})))}))}refreshMedia_(i){if(!i)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const l=this.mainPlaylistLoader_.main.playlists,d=!this.media_||this.media_!==l[i];if(d?this.media_=l[i]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const createMediaUpdateTimeout=()=>{this.media().endList||(this.mediaUpdateTimeout=p().setTimeout((()=>{this.trigger("mediaupdatetimeout"),createMediaUpdateTimeout()}),refreshDelay(this.media(),Boolean(d))))};createMediaUpdateTimeout()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(i){if(i&&this.mainPlaylistLoader_.main.eventStream){const i=this.mainPlaylistLoader_.main.eventStream.map((i=>({cueTime:i.start,frames:[{data:i.messageData}]})));this.addMetadataToTextTrack("EventStream",i,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(i){if(i.contentProtection){const l=new Set;for(const d in i.contentProtection){const u=i.contentProtection[d].attributes["cenc:default_KID"];u&&l.add(u.replace(/-/g,"").toLowerCase())}return l}}}var Fi={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const browserWorkerPolyFill=function(i){return i.on=i.addEventListener,i.off=i.removeEventListener,i},factory=function(i){return function(){const l=function(i){try{return URL.createObjectURL(new Blob([i],{type:"application/javascript"}))}catch(l){const d=new BlobBuilder;return d.append(i),URL.createObjectURL(d.getBlob())}}(i),d=browserWorkerPolyFill(new Worker(l));d.objURL=l;const u=d.terminate;return d.on=d.addEventListener,d.off=d.removeEventListener,d.terminate=function(){return URL.revokeObjectURL(l),u.call(this)},d}},transform=function(i){return`var browserWorkerPolyFill = ${browserWorkerPolyFill.toString()};\nbrowserWorkerPolyFill(self);\n`+i},getWorkerString=function(i){return i.toString().replace(/^function.+?{/,"").slice(0,-1)},ji=transform(getWorkerString((function(){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Stream$8=function(){this.init=function(){var i={};this.on=function(l,d){i[l]||(i[l]=[]),i[l]=i[l].concat(d)},this.off=function(l,d){var u;return!!i[l]&&(u=i[l].indexOf(d),i[l]=i[l].slice(),i[l].splice(u,1),u>-1)},this.trigger=function(l){var d,u,c,h;if(d=i[l])if(2===arguments.length)for(c=d.length,u=0;u<c;++u)d[u].call(this,arguments[1]);else{for(h=[],u=arguments.length,u=1;u<arguments.length;++u)h.push(arguments[u]);for(c=d.length,u=0;u<c;++u)d[u].apply(this,h)}},this.dispose=function(){i={}}}};Stream$8.prototype.pipe=function(i){return this.on("data",(function(l){i.push(l)})),this.on("done",(function(l){i.flush(l)})),this.on("partialdone",(function(l){i.partialFlush(l)})),this.on("endedtimeline",(function(l){i.endTimeline(l)})),this.on("reset",(function(l){i.reset(l)})),i},Stream$8.prototype.push=function(i){this.trigger("data",i)},Stream$8.prototype.flush=function(i){this.trigger("done",i)},Stream$8.prototype.partialFlush=function(i){this.trigger("partialdone",i)},Stream$8.prototype.endTimeline=function(i){this.trigger("endedtimeline",i)},Stream$8.prototype.reset=function(i){this.trigger("reset",i)};var l,d,u,c,h,p,m,g,y,_,v,b,T,S,E,k,w,C,x,A,P,I,D,O,L,R,V,M,N,B,j,H,$,z,W,X,K,Y,Q,Z,ee=Stream$8,te=Math.pow(2,32),ie={getUint64:function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength);return d.getBigUint64?(l=d.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(l):l:d.getUint32(0)*te+d.getUint32(4)},MAX_UINT32:te},re=ie.MAX_UINT32;!function(){var i;if(I={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(i in I)I.hasOwnProperty(i)&&(I[i]=[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3)]);D=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),L=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),O=new Uint8Array([0,0,0,1]),R=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),V=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),M={video:R,audio:V},j=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),B=new Uint8Array([0,0,0,0,0,0,0,0]),H=new Uint8Array([0,0,0,0,0,0,0,0]),$=H,z=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),W=H,N=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),l=function(i){var l,d,u=[],c=0;for(l=1;l<arguments.length;l++)u.push(arguments[l]);for(l=u.length;l--;)c+=u[l].byteLength;for(d=new Uint8Array(c+8),new DataView(d.buffer,d.byteOffset,d.byteLength).setUint32(0,d.byteLength),d.set(i,4),l=0,c=8;l<u.length;l++)d.set(u[l],c),c+=u[l].byteLength;return d},d=function(){return l(I.dinf,l(I.dref,j))},u=function(i){return l(I.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,i.audioobjecttype<<3|i.samplingfrequencyindex>>>1,i.samplingfrequencyindex<<7|i.channelcount<<3,6,1,2]))},E=function(i){return l(I.hdlr,M[i])},S=function(i){var d=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,i.duration>>>24&255,i.duration>>>16&255,i.duration>>>8&255,255&i.duration,85,196,0,0]);return i.samplerate&&(d[12]=i.samplerate>>>24&255,d[13]=i.samplerate>>>16&255,d[14]=i.samplerate>>>8&255,d[15]=255&i.samplerate),l(I.mdhd,d)},T=function(i){return l(I.mdia,S(i),E(i.type),p(i))},h=function(i){return l(I.mfhd,new Uint8Array([0,0,0,0,(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))},p=function(i){return l(I.minf,"video"===i.type?l(I.vmhd,N):l(I.smhd,B),d(),w(i))},m=function(i,d){for(var u=[],c=d.length;c--;)u[c]=x(d[c]);return l.apply(null,[I.moof,h(i)].concat(u))},g=function(i){for(var d=i.length,u=[];d--;)u[d]=v(i[d]);return l.apply(null,[I.moov,_(4294967295)].concat(u).concat(y(i)))},y=function(i){for(var d=i.length,u=[];d--;)u[d]=A(i[d]);return l.apply(null,[I.mvex].concat(u))},_=function(i){var d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return l(I.mvhd,d)},k=function(i){var d,u,c=i.samples||[],h=new Uint8Array(4+c.length);for(u=0;u<c.length;u++)h[u+4]=(d=c[u].flags).dependsOn<<4|d.isDependedOn<<2|d.hasRedundancy;return l(I.sdtp,h)},w=function(i){return l(I.stbl,C(i),l(I.stts,W),l(I.stsc,$),l(I.stsz,z),l(I.stco,H))},C=function(i){return l(I.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===i.type?X(i):K(i))},X=function(i){var d,u,c=i.sps||[],h=i.pps||[],p=[],m=[];for(d=0;d<c.length;d++)p.push((65280&c[d].byteLength)>>>8),p.push(255&c[d].byteLength),p=p.concat(Array.prototype.slice.call(c[d]));for(d=0;d<h.length;d++)m.push((65280&h[d].byteLength)>>>8),m.push(255&h[d].byteLength),m=m.concat(Array.prototype.slice.call(h[d]));if(u=[I.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&i.width)>>8,255&i.width,(65280&i.height)>>8,255&i.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l(I.avcC,new Uint8Array([1,i.profileIdc,i.profileCompatibility,i.levelIdc,255].concat([c.length],p,[h.length],m))),l(I.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],i.sarRatio){var g=i.sarRatio[0],y=i.sarRatio[1];u.push(l(I.pasp,new Uint8Array([(4278190080&g)>>24,(16711680&g)>>16,(65280&g)>>8,255&g,(4278190080&y)>>24,(16711680&y)>>16,(65280&y)>>8,255&y])))}return l.apply(null,u)},K=function(i){return l(I.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&i.channelcount)>>8,255&i.channelcount,(65280&i.samplesize)>>8,255&i.samplesize,0,0,0,0,(65280&i.samplerate)>>8,255&i.samplerate,0,0]),u(i))},b=function(i){var d=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&i.id)>>24,(16711680&i.id)>>16,(65280&i.id)>>8,255&i.id,0,0,0,0,(4278190080&i.duration)>>24,(16711680&i.duration)>>16,(65280&i.duration)>>8,255&i.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&i.width)>>8,255&i.width,0,0,(65280&i.height)>>8,255&i.height,0,0]);return l(I.tkhd,d)},x=function(i){var d,u,c,h,p,m;return d=l(I.tfhd,new Uint8Array([0,0,0,58,(4278190080&i.id)>>24,(16711680&i.id)>>16,(65280&i.id)>>8,255&i.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),p=Math.floor(i.baseMediaDecodeTime/re),m=Math.floor(i.baseMediaDecodeTime%re),u=l(I.tfdt,new Uint8Array([1,0,0,0,p>>>24&255,p>>>16&255,p>>>8&255,255&p,m>>>24&255,m>>>16&255,m>>>8&255,255&m])),"audio"===i.type?(c=P(i,92),l(I.traf,d,u,c)):(h=k(i),c=P(i,h.length+92),l(I.traf,d,u,c,h))},v=function(i){return i.duration=i.duration||4294967295,l(I.trak,b(i),T(i))},A=function(i){var d=new Uint8Array([0,0,0,0,(4278190080&i.id)>>24,(16711680&i.id)>>16,(65280&i.id)>>8,255&i.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==i.type&&(d[d.length-1]=0),l(I.trex,d)},Z=function(i,l){var d=0,u=0,c=0,h=0;return i.length&&(void 0!==i[0].duration&&(d=1),void 0!==i[0].size&&(u=2),void 0!==i[0].flags&&(c=4),void 0!==i[0].compositionTimeOffset&&(h=8)),[0,0,d|u|c|h,1,(4278190080&i.length)>>>24,(16711680&i.length)>>>16,(65280&i.length)>>>8,255&i.length,(4278190080&l)>>>24,(16711680&l)>>>16,(65280&l)>>>8,255&l]},Q=function(i,d){var u,c,h,p,m,g;for(h=Z(p=i.samples||[],d+=20+16*p.length),(c=new Uint8Array(h.length+16*p.length)).set(h),u=h.length,g=0;g<p.length;g++)c[u++]=(4278190080&(m=p[g]).duration)>>>24,c[u++]=(16711680&m.duration)>>>16,c[u++]=(65280&m.duration)>>>8,c[u++]=255&m.duration,c[u++]=(4278190080&m.size)>>>24,c[u++]=(16711680&m.size)>>>16,c[u++]=(65280&m.size)>>>8,c[u++]=255&m.size,c[u++]=m.flags.isLeading<<2|m.flags.dependsOn,c[u++]=m.flags.isDependedOn<<6|m.flags.hasRedundancy<<4|m.flags.paddingValue<<1|m.flags.isNonSyncSample,c[u++]=61440&m.flags.degradationPriority,c[u++]=15&m.flags.degradationPriority,c[u++]=(4278190080&m.compositionTimeOffset)>>>24,c[u++]=(16711680&m.compositionTimeOffset)>>>16,c[u++]=(65280&m.compositionTimeOffset)>>>8,c[u++]=255&m.compositionTimeOffset;return l(I.trun,c)},Y=function(i,d){var u,c,h,p,m,g;for(h=Z(p=i.samples||[],d+=20+8*p.length),(u=new Uint8Array(h.length+8*p.length)).set(h),c=h.length,g=0;g<p.length;g++)u[c++]=(4278190080&(m=p[g]).duration)>>>24,u[c++]=(16711680&m.duration)>>>16,u[c++]=(65280&m.duration)>>>8,u[c++]=255&m.duration,u[c++]=(4278190080&m.size)>>>24,u[c++]=(16711680&m.size)>>>16,u[c++]=(65280&m.size)>>>8,u[c++]=255&m.size;return l(I.trun,u)},P=function(i,l){return"audio"===i.type?Y(i,l):Q(i,l)};var se,ne,ae,oe,le,de,ue,ce,he={ftyp:c=function(){return l(I.ftyp,D,O,D,L)},mdat:function(i){return l(I.mdat,i)},moof:m,moov:g,initSegment:function(i){var l,d=c(),u=g(i);return(l=new Uint8Array(d.byteLength+u.byteLength)).set(d),l.set(u,d.byteLength),l}},sampleForFrame=function(i,l){var d={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return d.dataOffset=l,d.compositionTimeOffset=i.pts-i.dts,d.duration=i.duration,d.size=4*i.length,d.size+=i.byteLength,i.keyFrame&&(d.flags.dependsOn=2,d.flags.isNonSyncSample=0),d},pe={groupNalsIntoFrames:function(i){var l,d,u=[],c=[];for(c.byteLength=0,c.nalCount=0,c.duration=0,u.byteLength=0,l=0;l<i.length;l++)"access_unit_delimiter_rbsp"===(d=i[l]).nalUnitType?(u.length&&(u.duration=d.dts-u.dts,c.byteLength+=u.byteLength,c.nalCount+=u.length,c.duration+=u.duration,c.push(u)),(u=[d]).byteLength=d.data.byteLength,u.pts=d.pts,u.dts=d.dts):("slice_layer_without_partitioning_rbsp_idr"===d.nalUnitType&&(u.keyFrame=!0),u.duration=d.dts-u.dts,u.byteLength+=d.data.byteLength,u.push(d));return c.length&&(!u.duration||u.duration<=0)&&(u.duration=c[c.length-1].duration),c.byteLength+=u.byteLength,c.nalCount+=u.length,c.duration+=u.duration,c.push(u),c},groupFramesIntoGops:function(i){var l,d,u=[],c=[];for(u.byteLength=0,u.nalCount=0,u.duration=0,u.pts=i[0].pts,u.dts=i[0].dts,c.byteLength=0,c.nalCount=0,c.duration=0,c.pts=i[0].pts,c.dts=i[0].dts,l=0;l<i.length;l++)(d=i[l]).keyFrame?(u.length&&(c.push(u),c.byteLength+=u.byteLength,c.nalCount+=u.nalCount,c.duration+=u.duration),(u=[d]).nalCount=d.length,u.byteLength=d.byteLength,u.pts=d.pts,u.dts=d.dts,u.duration=d.duration):(u.duration+=d.duration,u.nalCount+=d.length,u.byteLength+=d.byteLength,u.push(d));return c.length&&u.duration<=0&&(u.duration=c[c.length-1].duration),c.byteLength+=u.byteLength,c.nalCount+=u.nalCount,c.duration+=u.duration,c.push(u),c},extendFirstKeyFrame:function(i){var l;return!i[0][0].keyFrame&&i.length>1&&(l=i.shift(),i.byteLength-=l.byteLength,i.nalCount-=l.nalCount,i[0][0].dts=l.dts,i[0][0].pts=l.pts,i[0][0].duration+=l.duration),i},generateSampleTable:function(i,l){var d,u,c,h,p=l||0,m=[];for(d=0;d<i.length;d++)for(h=i[d],u=0;u<h.length;u++)p+=(c=sampleForFrame(h[u],p)).size,m.push(c);return m},concatenateNalData:function(i){var l,d,u,c,h,p,m=0,g=new Uint8Array(i.byteLength+4*i.nalCount),y=new DataView(g.buffer);for(l=0;l<i.length;l++)for(c=i[l],d=0;d<c.length;d++)for(h=c[d],u=0;u<h.length;u++)y.setUint32(m,(p=h[u]).data.byteLength),g.set(p.data,m+=4),m+=p.data.byteLength;return g},generateSampleTableForFrame:function(i,l){var d,u=[];return d=sampleForFrame(i,l||0),u.push(d),u},concatenateNalDataForFrame:function(i){var l,d,u=0,c=new Uint8Array(i.byteLength+4*i.length),h=new DataView(c.buffer);for(l=0;l<i.length;l++)h.setUint32(u,(d=i[l]).data.byteLength),c.set(d.data,u+=4),u+=d.data.byteLength;return c}},me=[33,16,5,32,164,27],fe=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],zeroFill=function(i){for(var l=[];i--;)l.push(0);return l},ge=9e4;de=function(i,l){return ne(le(i,l))},ue=function(i,l){return ae(oe(i),l)},ce=function(i,l,d){return oe(d?i:i-l)};var ye={ONE_SECOND_IN_TS:ge,secondsToVideoTs:ne=function(i){return i*ge},secondsToAudioTs:ae=function(i,l){return i*l},videoTsToSeconds:oe=function(i){return i/ge},audioTsToSeconds:le=function(i,l){return i/l},audioTsToVideoTs:de,videoTsToAudioTs:ue,metadataTsToSeconds:ce},coneOfSilence=function(){if(!se){var i={96e3:[me,[227,64],zeroFill(154),[56]],88200:[me,[231],zeroFill(170),[56]],64e3:[me,[248,192],zeroFill(240),[56]],48e3:[me,[255,192],zeroFill(268),[55,148,128],zeroFill(54),[112]],44100:[me,[255,192],zeroFill(268),[55,163,128],zeroFill(84),[112]],32e3:[me,[255,192],zeroFill(268),[55,234],zeroFill(226),[112]],24e3:[me,[255,192],zeroFill(268),[55,255,128],zeroFill(268),[111,112],zeroFill(126),[224]],16e3:[me,[255,192],zeroFill(268),[55,255,128],zeroFill(268),[111,255],zeroFill(269),[223,108],zeroFill(195),[1,192]],12e3:[fe,zeroFill(268),[3,127,248],zeroFill(268),[6,255,240],zeroFill(268),[13,255,224],zeroFill(268),[27,253,128],zeroFill(259),[56]],11025:[fe,zeroFill(268),[3,127,248],zeroFill(268),[6,255,240],zeroFill(268),[13,255,224],zeroFill(268),[27,255,192],zeroFill(268),[55,175,128],zeroFill(108),[112]],8e3:[fe,zeroFill(268),[3,121,16],zeroFill(47),[7]]};l=i,se=Object.keys(l).reduce((function(i,d){return i[d]=new Uint8Array(l[d].reduce((function(i,l){return i.concat(l)}),[])),i}),{})}var l;return se},_e=ye,ve={prefixWithSilence:function(i,l,d,u){var c,h,p,m,g,y=0,_=0,v=0;if(l.length&&(c=_e.audioTsToVideoTs(i.baseMediaDecodeTime,i.samplerate),h=Math.ceil(_e.ONE_SECOND_IN_TS/(i.samplerate/1024)),d&&u&&(y=c-Math.max(d,u),v=(_=Math.floor(y/h))*h),!(_<1||v>_e.ONE_SECOND_IN_TS/2))){for((p=coneOfSilence()[i.samplerate])||(p=l[0].data),m=0;m<_;m++)l.splice(0,0,{data:p,dts:(g=l[0]).dts-h,pts:g.pts-h});return i.baseMediaDecodeTime-=Math.floor(_e.videoTsToAudioTs(v,i.samplerate)),v}},trimAdtsFramesByEarliestDts:function(i,l,d){return l.minSegmentDts>=d?i:(l.minSegmentDts=1/0,i.filter((function(i){return i.dts>=d&&(l.minSegmentDts=Math.min(l.minSegmentDts,i.dts),l.minSegmentPts=l.minSegmentDts,!0)})))},generateSampleTable:function(i){var l,d=[];for(l=0;l<i.length;l++)d.push({size:i[l].data.byteLength,duration:1024});return d},concatenateFrameData:function(i){var l,d,u=0,c=new Uint8Array(function(i){var l,d=0;for(l=0;l<i.length;l++)d+=i[l].data.byteLength;return d}(i));for(l=0;l<i.length;l++)c.set((d=i[l]).data,u),u+=d.data.byteLength;return c}},be=ye.ONE_SECOND_IN_TS,Te={clearDtsInfo:function(i){delete i.minSegmentDts,delete i.maxSegmentDts,delete i.minSegmentPts,delete i.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(i,l){var d,u=i.minSegmentDts;return l||(u-=i.timelineStartInfo.dts),d=i.timelineStartInfo.baseMediaDecodeTime,d+=u,d=Math.max(0,d),"audio"===i.type&&(d*=i.samplerate/be,d=Math.floor(d)),d},collectDtsInfo:function(i,l){"number"==typeof l.pts&&(void 0===i.timelineStartInfo.pts&&(i.timelineStartInfo.pts=l.pts),i.minSegmentPts=void 0===i.minSegmentPts?l.pts:Math.min(i.minSegmentPts,l.pts),i.maxSegmentPts=void 0===i.maxSegmentPts?l.pts:Math.max(i.maxSegmentPts,l.pts)),"number"==typeof l.dts&&(void 0===i.timelineStartInfo.dts&&(i.timelineStartInfo.dts=l.dts),i.minSegmentDts=void 0===i.minSegmentDts?l.dts:Math.min(i.minSegmentDts,l.dts),i.maxSegmentDts=void 0===i.maxSegmentDts?l.dts:Math.max(i.maxSegmentDts,l.dts))}},Se={parseSei:function(i){for(var l=0,d={payloadType:-1,payloadSize:0},u=0,c=0;l<i.byteLength&&128!==i[l];){for(;255===i[l];)u+=255,l++;for(u+=i[l++];255===i[l];)c+=255,l++;if(c+=i[l++],!d.payload&&4===u){if("GA94"===String.fromCharCode(i[l+3],i[l+4],i[l+5],i[l+6])){d.payloadType=u,d.payloadSize=c,d.payload=i.subarray(l,l+c);break}d.payload=void 0}l+=c,u=0,c=0}return d},parseUserData:function(i){return 181!==i.payload[0]||49!=(i.payload[1]<<8|i.payload[2])||"GA94"!==String.fromCharCode(i.payload[3],i.payload[4],i.payload[5],i.payload[6])||3!==i.payload[7]?null:i.payload.subarray(8,i.payload.length-1)},parseCaptionPackets:function(i,l){var d,u,c,h,p=[];if(!(64&l[0]))return p;for(u=31&l[0],d=0;d<u;d++)h={type:3&l[(c=3*d)+2],pts:i},4&l[c+2]&&(h.ccData=l[c+3]<<8|l[c+4],p.push(h));return p},discardEmulationPreventionBytes:function(i){for(var l,d,u=i.byteLength,c=[],h=1;h<u-2;)0===i[h]&&0===i[h+1]&&3===i[h+2]?(c.push(h+2),h+=2):h++;if(0===c.length)return i;l=u-c.length,d=new Uint8Array(l);var p=0;for(h=0;h<l;p++,h++)p===c[0]&&(p++,c.shift()),d[h]=i[p];return d},USER_DATA_REGISTERED_ITU_T_T35:4},Ee=ee,ke=Se,CaptionStream$2=function(i){i=i||{},CaptionStream$2.prototype.init.call(this),this.parse708captions_="boolean"!=typeof i.parse708captions||i.parse708captions,this.captionPackets_=[],this.ccStreams_=[new Cea608Stream(0,0),new Cea608Stream(0,1),new Cea608Stream(1,0),new Cea608Stream(1,1)],this.parse708captions_&&(this.cc708Stream_=new Cea708Stream({captionServices:i.captionServices})),this.reset(),this.ccStreams_.forEach((function(i){i.on("data",this.trigger.bind(this,"data")),i.on("partialdone",this.trigger.bind(this,"partialdone")),i.on("done",this.trigger.bind(this,"done"))}),this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};CaptionStream$2.prototype=new Ee,CaptionStream$2.prototype.push=function(i){var l,d,u;if("sei_rbsp"===i.nalUnitType&&(l=ke.parseSei(i.escapedRBSP)).payload&&l.payloadType===ke.USER_DATA_REGISTERED_ITU_T_T35&&(d=ke.parseUserData(l))){if(i.dts<this.latestDts_)return this.ignoreNextEqualDts_=!0,void 0;if(i.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1),void 0;u=ke.parseCaptionPackets(i.pts,d),this.captionPackets_=this.captionPackets_.concat(u),this.latestDts_!==i.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=i.dts}},CaptionStream$2.prototype.flushCCStreams=function(i){this.ccStreams_.forEach((function(l){return"flush"===i?l.flush():l.partialFlush()}),this)},CaptionStream$2.prototype.flushStream=function(i){if(!this.captionPackets_.length)return this.flushCCStreams(i),void 0;this.captionPackets_.forEach((function(i,l){i.presortIndex=l})),this.captionPackets_.sort((function(i,l){return i.pts===l.pts?i.presortIndex-l.presortIndex:i.pts-l.pts})),this.captionPackets_.forEach((function(i){i.type<2?this.dispatchCea608Packet(i):this.dispatchCea708Packet(i)}),this),this.captionPackets_.length=0,this.flushCCStreams(i)},CaptionStream$2.prototype.flush=function(){return this.flushStream("flush")},CaptionStream$2.prototype.partialFlush=function(){return this.flushStream("partialFlush")},CaptionStream$2.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(i){i.reset()}))},CaptionStream$2.prototype.dispatchCea608Packet=function(i){this.setsTextOrXDSActive(i)?this.activeCea608Channel_[i.type]=null:this.setsChannel1Active(i)?this.activeCea608Channel_[i.type]=0:this.setsChannel2Active(i)&&(this.activeCea608Channel_[i.type]=1),null!==this.activeCea608Channel_[i.type]&&this.ccStreams_[(i.type<<1)+this.activeCea608Channel_[i.type]].push(i)},CaptionStream$2.prototype.setsChannel1Active=function(i){return 4096==(30720&i.ccData)},CaptionStream$2.prototype.setsChannel2Active=function(i){return 6144==(30720&i.ccData)},CaptionStream$2.prototype.setsTextOrXDSActive=function(i){return 256==(28928&i.ccData)||4138==(30974&i.ccData)||6186==(30974&i.ccData)},CaptionStream$2.prototype.dispatchCea708Packet=function(i){this.parse708captions_&&this.cc708Stream_.push(i)};var we={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},within708TextBlock=function(i){return 32<=i&&i<=127||160<=i&&i<=255},Cea708Window=function(i){this.windowNum=i,this.reset()};Cea708Window.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Cea708Window.prototype.getText=function(){return this.rows.join("\n")},Cea708Window.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Cea708Window.prototype.newLine=function(i){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(i),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Cea708Window.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},Cea708Window.prototype.addText=function(i){this.rows[this.rowIdx]+=i},Cea708Window.prototype.backspace=function(){if(!this.isEmpty()){var i=this.rows[this.rowIdx];this.rows[this.rowIdx]=i.substr(0,i.length-1)}};var Cea708Service=function(i,l,d){this.serviceNum=i,this.text="",this.currentWindow=new Cea708Window(-1),this.windows=[],this.stream=d,"string"==typeof l&&this.createTextDecoder(l)};Cea708Service.prototype.init=function(i,l){this.startPts=i;for(var d=0;d<8;d++)this.windows[d]=new Cea708Window(d),"function"==typeof l&&(this.windows[d].beforeRowOverflow=l)},Cea708Service.prototype.setCurrentWindow=function(i){this.currentWindow=this.windows[i]},Cea708Service.prototype.createTextDecoder=function(i){if("undefined"==typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(i)}catch(l){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+i+" encoding. "+l})}};var Cea708Stream=function(i){i=i||{},Cea708Stream.prototype.init.call(this);var l,d=this,u=i.captionServices||{},c={};Object.keys(u).forEach((i=>{l=u[i],/^SERVICE/.test(i)&&(c[i]=l.encoding)})),this.serviceEncodings=c,this.current708Packet=null,this.services={},this.push=function(i){3===i.type?(d.new708Packet(),d.add708Bytes(i)):(null===d.current708Packet&&d.new708Packet(),d.add708Bytes(i))}};Cea708Stream.prototype=new Ee,Cea708Stream.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Cea708Stream.prototype.add708Bytes=function(i){var l=i.ccData,d=l>>>8,u=255&l;this.current708Packet.ptsVals.push(i.pts),this.current708Packet.data.push(d),this.current708Packet.data.push(u)},Cea708Stream.prototype.push708Packet=function(){var i=this.current708Packet,l=i.data,d=null,u=null,c=0,h=l[c++];for(i.seq=h>>6,i.sizeCode=63&h;c<l.length;c++)u=31&(h=l[c++]),7===(d=h>>5)&&u>0&&(d=h=l[c++]),this.pushServiceBlock(d,c,u),u>0&&(c+=u-1)},Cea708Stream.prototype.pushServiceBlock=function(i,l,d){var u,c=l,h=this.current708Packet.data,p=this.services[i];for(p||(p=this.initService(i,c));c<l+d&&c<h.length;c++)within708TextBlock(u=h[c])?c=this.handleText(c,p):24===u?c=this.multiByteCharacter(c,p):16===u?c=this.extendedCommands(c,p):128<=u&&u<=135?c=this.setCurrentWindow(c,p):152<=u&&u<=159?c=this.defineWindow(c,p):136===u?c=this.clearWindows(c,p):140===u?c=this.deleteWindows(c,p):137===u?c=this.displayWindows(c,p):138===u?c=this.hideWindows(c,p):139===u?c=this.toggleWindows(c,p):151===u?c=this.setWindowAttributes(c,p):144===u?c=this.setPenAttributes(c,p):145===u?c=this.setPenColor(c,p):146===u?c=this.setPenLocation(c,p):143===u?p=this.reset(c,p):8===u?p.currentWindow.backspace():12===u?p.currentWindow.clearText():13===u?p.currentWindow.pendingNewLine=!0:14===u?p.currentWindow.clearText():141===u&&c++},Cea708Stream.prototype.extendedCommands=function(i,l){var d=this.current708Packet.data[++i];return within708TextBlock(d)&&(i=this.handleText(i,l,{isExtended:!0})),i},Cea708Stream.prototype.getPts=function(i){return this.current708Packet.ptsVals[Math.floor(i/2)]},Cea708Stream.prototype.initService=function(i,l){var d,u,c=this;return(d="SERVICE"+i)in this.serviceEncodings&&(u=this.serviceEncodings[d]),this.services[i]=new Cea708Service(i,u,c),this.services[i].init(this.getPts(l),(function(l){c.flushDisplayed(l,c.services[i])})),this.services[i]},Cea708Stream.prototype.handleText=function(i,l,d){var u,c,h,p,m=d&&d.isExtended,g=d&&d.isMultiByte,y=this.current708Packet.data,_=m?4096:0,v=y[i],b=l.currentWindow;if(g?(c=[v,y[i+1]],i++):c=[v],l.textDecoder_&&!m)u=l.textDecoder_.decode(new Uint8Array(c));else if(g){const i=function toHexString(i){return i.map((i=>("0"+(255&i).toString(16)).slice(-2))).join("")}(c);u=String.fromCharCode(parseInt(i,16))}else p=we[h=_|v]||h,u=4096&h&&h===p?"":String.fromCharCode(p);return b.pendingNewLine&&!b.isEmpty()&&b.newLine(this.getPts(i)),b.pendingNewLine=!1,b.addText(u),i},Cea708Stream.prototype.multiByteCharacter=function(i,l){var d=this.current708Packet.data,u=d[i+2];return within708TextBlock(d[i+1])&&within708TextBlock(u)&&(i=this.handleText(++i,l,{isMultiByte:!0})),i},Cea708Stream.prototype.setCurrentWindow=function(i,l){return l.setCurrentWindow(7&this.current708Packet.data[i]),i},Cea708Stream.prototype.defineWindow=function(i,l){var d=this.current708Packet.data,u=d[i];l.setCurrentWindow(7&u);var c=l.currentWindow;return u=d[++i],c.visible=(32&u)>>5,c.rowLock=(16&u)>>4,c.columnLock=(8&u)>>3,c.priority=7&u,u=d[++i],c.relativePositioning=(128&u)>>7,c.anchorVertical=127&u,u=d[++i],c.anchorHorizontal=u,u=d[++i],c.anchorPoint=(240&u)>>4,c.rowCount=15&u,u=d[++i],c.columnCount=63&u,u=d[++i],c.windowStyle=(56&u)>>3,c.penStyle=7&u,c.virtualRowCount=c.rowCount+1,i},Cea708Stream.prototype.setWindowAttributes=function(i,l){var d=this.current708Packet.data,u=d[i],c=l.currentWindow.winAttr;return u=d[++i],c.fillOpacity=(192&u)>>6,c.fillRed=(48&u)>>4,c.fillGreen=(12&u)>>2,c.fillBlue=3&u,u=d[++i],c.borderType=(192&u)>>6,c.borderRed=(48&u)>>4,c.borderGreen=(12&u)>>2,c.borderBlue=3&u,u=d[++i],c.borderType+=(128&u)>>5,c.wordWrap=(64&u)>>6,c.printDirection=(48&u)>>4,c.scrollDirection=(12&u)>>2,c.justify=3&u,u=d[++i],c.effectSpeed=(240&u)>>4,c.effectDirection=(12&u)>>2,c.displayEffect=3&u,i},Cea708Stream.prototype.flushDisplayed=function(i,l){for(var d=[],u=0;u<8;u++)l.windows[u].visible&&!l.windows[u].isEmpty()&&d.push(l.windows[u].getText());l.endPts=i,l.text=d.join("\n\n"),this.pushCaption(l),l.startPts=i},Cea708Stream.prototype.pushCaption=function(i){""!==i.text&&(this.trigger("data",{startPts:i.startPts,endPts:i.endPts,text:i.text,stream:"cc708_"+i.serviceNum}),i.text="",i.startPts=i.endPts)},Cea708Stream.prototype.displayWindows=function(i,l){var d=this.current708Packet.data[++i],u=this.getPts(i);this.flushDisplayed(u,l);for(var c=0;c<8;c++)d&1<<c&&(l.windows[c].visible=1);return i},Cea708Stream.prototype.hideWindows=function(i,l){var d=this.current708Packet.data[++i],u=this.getPts(i);this.flushDisplayed(u,l);for(var c=0;c<8;c++)d&1<<c&&(l.windows[c].visible=0);return i},Cea708Stream.prototype.toggleWindows=function(i,l){var d=this.current708Packet.data[++i],u=this.getPts(i);this.flushDisplayed(u,l);for(var c=0;c<8;c++)d&1<<c&&(l.windows[c].visible^=1);return i},Cea708Stream.prototype.clearWindows=function(i,l){var d=this.current708Packet.data[++i],u=this.getPts(i);this.flushDisplayed(u,l);for(var c=0;c<8;c++)d&1<<c&&l.windows[c].clearText();return i},Cea708Stream.prototype.deleteWindows=function(i,l){var d=this.current708Packet.data[++i],u=this.getPts(i);this.flushDisplayed(u,l);for(var c=0;c<8;c++)d&1<<c&&l.windows[c].reset();return i},Cea708Stream.prototype.setPenAttributes=function(i,l){var d=this.current708Packet.data,u=d[i],c=l.currentWindow.penAttr;return u=d[++i],c.textTag=(240&u)>>4,c.offset=(12&u)>>2,c.penSize=3&u,u=d[++i],c.italics=(128&u)>>7,c.underline=(64&u)>>6,c.edgeType=(56&u)>>3,c.fontStyle=7&u,i},Cea708Stream.prototype.setPenColor=function(i,l){var d=this.current708Packet.data,u=d[i],c=l.currentWindow.penColor;return u=d[++i],c.fgOpacity=(192&u)>>6,c.fgRed=(48&u)>>4,c.fgGreen=(12&u)>>2,c.fgBlue=3&u,u=d[++i],c.bgOpacity=(192&u)>>6,c.bgRed=(48&u)>>4,c.bgGreen=(12&u)>>2,c.bgBlue=3&u,u=d[++i],c.edgeRed=(48&u)>>4,c.edgeGreen=(12&u)>>2,c.edgeBlue=3&u,i},Cea708Stream.prototype.setPenLocation=function(i,l){var d=this.current708Packet.data,u=d[i],c=l.currentWindow.penLoc;return l.currentWindow.pendingNewLine=!0,u=d[++i],c.row=15&u,u=d[++i],c.column=63&u,i},Cea708Stream.prototype.reset=function(i,l){var d=this.getPts(i);return this.flushDisplayed(d,l),this.initService(l.serviceNum,i)};var Ce={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},getCharFromCode=function(i){return null===i?"":(i=Ce[i]||i,String.fromCharCode(i))},xe=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],createDisplayBuffer=function(){for(var i=[],l=15;l--;)i.push({text:"",indent:0,offset:0});return i},Cea608Stream=function(i,l){Cea608Stream.prototype.init.call(this),this.field_=i||0,this.dataChannel_=l||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(i){var l,d,u,c,h;if((l=32639&i.ccData)===this.lastControlCode_)return this.lastControlCode_=null,void 0;if(4096==(61440&l)?this.lastControlCode_=l:l!==this.PADDING_&&(this.lastControlCode_=null),u=l>>>8,c=255&l,l!==this.PADDING_)if(l===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(l===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(i.pts),this.flushDisplayed(i.pts),d=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=d,this.startPts_=i.pts;else if(l===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(i.pts);else if(l===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(i.pts);else if(l===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(i.pts);else if(l===this.CARRIAGE_RETURN_)this.clearFormatting(i.pts),this.flushDisplayed(i.pts),this.shiftRowsUp_(),this.startPts_=i.pts;else if(l===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(l===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(i.pts),this.displayed_=createDisplayBuffer();else if(l===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=createDisplayBuffer();else if(l===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(i.pts),this.displayed_=createDisplayBuffer()),this.mode_="paintOn",this.startPts_=i.pts;else if(this.isSpecialCharacter(u,c))h=getCharFromCode((u=(3&u)<<8)|c),this[this.mode_](i.pts,h),this.column_++;else if(this.isExtCharacter(u,c))"popOn"===this.mode_?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),h=getCharFromCode((u=(3&u)<<8)|c),this[this.mode_](i.pts,h),this.column_++;else if(this.isMidRowCode(u,c))this.clearFormatting(i.pts),this[this.mode_](i.pts," "),this.column_++,14&~c||this.addFormatting(i.pts,["i"]),1&~c||this.addFormatting(i.pts,["u"]);else if(this.isOffsetControlCode(u,c)){const i=3&c;this.nonDisplayed_[this.row_].offset=i,this.column_+=i}else if(this.isPAC(u,c)){var p=xe.indexOf(7968&l);if("rollUp"===this.mode_&&(p-this.rollUpRows_+1<0&&(p=this.rollUpRows_-1),this.setRollUp(i.pts,p)),p!==this.row_&&p>=0&&p<=14&&(this.clearFormatting(i.pts),this.row_=p),1&c&&-1===this.formatting_.indexOf("u")&&this.addFormatting(i.pts,["u"]),!(16&~l)){const i=(14&l)>>1;this.column_=4*i,this.nonDisplayed_[this.row_].indent+=i}this.isColorPAC(c)&&(14&~c||this.addFormatting(i.pts,["i"]))}else this.isNormalChar(u)&&(0===c&&(c=null),h=getCharFromCode(u),h+=getCharFromCode(c),this[this.mode_](i.pts,h),this.column_+=h.length)}};Cea608Stream.prototype=new Ee,Cea608Stream.prototype.flushDisplayed=function(i){const logWarning=i=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+i+"."})},l=[];this.displayed_.forEach(((i,d)=>{if(i&&i.text&&i.text.length){try{i.text=i.text.trim()}catch(i){logWarning(d)}i.text.length&&l.push({text:i.text,line:d+1,position:10+Math.min(70,10*i.indent)+2.5*i.offset})}else null==i&&logWarning(d)})),l.length&&this.trigger("data",{startPts:this.startPts_,endPts:i,content:l,stream:this.name_})},Cea608Stream.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=createDisplayBuffer(),this.nonDisplayed_=createDisplayBuffer(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Cea608Stream.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Cea608Stream.prototype.isSpecialCharacter=function(i,l){return i===this.EXT_&&l>=48&&l<=63},Cea608Stream.prototype.isExtCharacter=function(i,l){return(i===this.EXT_+1||i===this.EXT_+2)&&l>=32&&l<=63},Cea608Stream.prototype.isMidRowCode=function(i,l){return i===this.EXT_&&l>=32&&l<=47},Cea608Stream.prototype.isOffsetControlCode=function(i,l){return i===this.OFFSET_&&l>=33&&l<=35},Cea608Stream.prototype.isPAC=function(i,l){return i>=this.BASE_&&i<this.BASE_+8&&l>=64&&l<=127},Cea608Stream.prototype.isColorPAC=function(i){return i>=64&&i<=79||i>=96&&i<=127},Cea608Stream.prototype.isNormalChar=function(i){return i>=32&&i<=127},Cea608Stream.prototype.setRollUp=function(i,l){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(i),this.nonDisplayed_=createDisplayBuffer(),this.displayed_=createDisplayBuffer()),void 0!==l&&l!==this.row_)for(var d=0;d<this.rollUpRows_;d++)this.displayed_[l-d]=this.displayed_[this.row_-d],this.displayed_[this.row_-d]={text:"",indent:0,offset:0};void 0===l&&(l=this.row_),this.topRow_=l-this.rollUpRows_+1},Cea608Stream.prototype.addFormatting=function(i,l){this.formatting_=this.formatting_.concat(l);var d=l.reduce((function(i,l){return i+"<"+l+">"}),"");this[this.mode_](i,d)},Cea608Stream.prototype.clearFormatting=function(i){if(this.formatting_.length){var l=this.formatting_.reverse().reduce((function(i,l){return i+"</"+l+">"}),"");this.formatting_=[],this[this.mode_](i,l)}},Cea608Stream.prototype.popOn=function(i,l){var d=this.nonDisplayed_[this.row_].text;this.nonDisplayed_[this.row_].text=d+=l},Cea608Stream.prototype.rollUp=function(i,l){var d=this.displayed_[this.row_].text;this.displayed_[this.row_].text=d+=l},Cea608Stream.prototype.shiftRowsUp_=function(){var i;for(i=0;i<this.topRow_;i++)this.displayed_[i]={text:"",indent:0,offset:0};for(i=this.row_+1;i<15;i++)this.displayed_[i]={text:"",indent:0,offset:0};for(i=this.topRow_;i<this.row_;i++)this.displayed_[i]=this.displayed_[i+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},Cea608Stream.prototype.paintOn=function(i,l){var d=this.displayed_[this.row_].text;this.displayed_[this.row_].text=d+=l};var Ae={CaptionStream:CaptionStream$2,Cea608Stream,Cea708Stream},Pe={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Ie="shared",handleRollover$1=function(i,l){var d=1;for(i>l&&(d=-1);Math.abs(l-i)>4294967296;)i+=8589934592*d;return i},TimestampRolloverStream$1=function(i){var l,d;TimestampRolloverStream$1.prototype.init.call(this),this.type_=i||Ie,this.push=function(i){if("metadata"===i.type)return this.trigger("data",i),void 0;this.type_!==Ie&&i.type!==this.type_||(void 0===d&&(d=i.dts),i.dts=handleRollover$1(i.dts,d),i.pts=handleRollover$1(i.pts,d),l=i.dts,this.trigger("data",i))},this.flush=function(){d=l,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){d=void 0,l=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};TimestampRolloverStream$1.prototype=new ee;var De,Oe={TimestampRolloverStream:TimestampRolloverStream$1,handleRollover:handleRollover$1},typedArray_typedArrayIndexOf=(i,l,d)=>{if(!i)return-1;for(var u=d;u<i.length;u++)if(i[u]===l)return u;return-1},Le=typedArray_typedArrayIndexOf,Re=3,percentEncode$1=function(i,l,d){var u,c="";for(u=l;u<d;u++)c+="%"+("00"+i[u].toString(16)).slice(-2);return c},parseUtf8=function(i,l,d){return decodeURIComponent(percentEncode$1(i,l,d))},parseIso88591$1=function(i,l,d){return unescape(percentEncode$1(i,l,d))},parseSyncSafeInteger$1=function(i){return i[0]<<21|i[1]<<14|i[2]<<7|i[3]},Ve={APIC:function(i){var l,d,u=1;i.data[0]===Re&&((l=Le(i.data,0,u))<0||(i.mimeType=parseIso88591$1(i.data,u,l),i.pictureType=i.data[u=l+1],u++,(d=Le(i.data,0,u))<0||(i.description=parseUtf8(i.data,u,d),u=d+1,"--\x3e"===i.mimeType?i.url=parseIso88591$1(i.data,u,i.data.length):i.pictureData=i.data.subarray(u,i.data.length))))},"T*":function(i){i.data[0]===Re&&(i.value=parseUtf8(i.data,1,i.data.length).replace(/\0*$/,""),i.values=i.value.split("\0"))},TXXX:function(i){var l;i.data[0]===Re&&-1!==(l=Le(i.data,0,1))&&(i.description=parseUtf8(i.data,1,l),i.value=parseUtf8(i.data,l+1,i.data.length).replace(/\0*$/,""),i.data=i.value)},"W*":function(i){i.url=parseIso88591$1(i.data,0,i.data.length).replace(/\0.*$/,"")},WXXX:function(i){var l;i.data[0]===Re&&-1!==(l=Le(i.data,0,1))&&(i.description=parseUtf8(i.data,1,l),i.url=parseIso88591$1(i.data,l+1,i.data.length).replace(/\0.*$/,""))},PRIV:function(i){var l;for(l=0;l<i.data.length;l++)if(0===i.data[l]){i.owner=parseIso88591$1(i.data,0,l);break}i.privateData=i.data.subarray(l+1),i.data=i.privateData}},Me={parseId3Frames:function(i){var l,d=10,u=0,c=[];if(!(i.length<10||i[0]!=="I".charCodeAt(0)||i[1]!=="D".charCodeAt(0)||i[2]!=="3".charCodeAt(0))){u=parseSyncSafeInteger$1(i.subarray(6,10)),u+=10,64&i[5]&&(d+=4,d+=parseSyncSafeInteger$1(i.subarray(10,14)),u-=parseSyncSafeInteger$1(i.subarray(16,20)));do{if((l=parseSyncSafeInteger$1(i.subarray(d+4,d+8)))<1)break;var h={id:String.fromCharCode(i[d],i[d+1],i[d+2],i[d+3]),data:i.subarray(d+10,d+l+10)};h.key=h.id,Ve[h.id]?Ve[h.id](h):"T"===h.id[0]?Ve["T*"](h):"W"===h.id[0]&&Ve["W*"](h),c.push(h),d+=10,d+=l}while(d<u);return c}},parseSyncSafeInteger:parseSyncSafeInteger$1,frameParsers:Ve},Ne=Pe,Ue=Me;(De=function(i){var l,d={descriptor:i&&i.descriptor},u=0,c=[],h=0;if(De.prototype.init.call(this),this.dispatchType=Ne.METADATA_STREAM_TYPE.toString(16),d.descriptor)for(l=0;l<d.descriptor.length;l++)this.dispatchType+=("00"+d.descriptor[l].toString(16)).slice(-2);this.push=function(i){var l,d,p,m,g;if("timed-metadata"===i.type){if(i.dataAlignmentIndicator&&(h=0,c.length=0),0===c.length&&(i.data.length<10||i.data[0]!=="I".charCodeAt(0)||i.data[1]!=="D".charCodeAt(0)||i.data[2]!=="3".charCodeAt(0)))return this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"}),void 0;if(c.push(i),h+=i.data.byteLength,1===c.length&&(u=Ue.parseSyncSafeInteger(i.data.subarray(6,10)),u+=10),!(h<u)){for(l={data:new Uint8Array(u),frames:[],pts:c[0].pts,dts:c[0].dts},g=0;g<u;)l.data.set(c[0].data.subarray(0,u-g),g),g+=c[0].data.byteLength,h-=c[0].data.byteLength,c.shift();d=10,64&l.data[5]&&(d+=4,d+=Ue.parseSyncSafeInteger(l.data.subarray(10,14)),u-=Ue.parseSyncSafeInteger(l.data.subarray(16,20)));do{if((p=Ue.parseSyncSafeInteger(l.data.subarray(d+4,d+8)))<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if((m={id:String.fromCharCode(l.data[d],l.data[d+1],l.data[d+2],l.data[d+3]),data:l.data.subarray(d+10,d+p+10)}).key=m.id,Ue.frameParsers[m.id]?Ue.frameParsers[m.id](m):"T"===m.id[0]?Ue.frameParsers["T*"](m):"W"===m.id[0]&&Ue.frameParsers["W*"](m),"com.apple.streaming.transportStreamTimestamp"===m.owner){var y=m.data,_=(1&y[3])<<30|y[4]<<22|y[5]<<14|y[6]<<6|y[7]>>>2;_*=4,m.timeStamp=_+=3&y[7],void 0===l.pts&&void 0===l.dts&&(l.pts=m.timeStamp,l.dts=m.timeStamp),this.trigger("timestamp",m)}l.frames.push(m),d+=10,d+=p}while(d<u);this.trigger("data",l)}}}}).prototype=new ee;var Be,Fe,je,qe=De,He=ee,$e=Ae,ze=Pe,Ge=Oe.TimestampRolloverStream,We=188;(Be=function(){var i=new Uint8Array(We),l=0;Be.prototype.init.call(this),this.push=function(d){var u,c=0,h=We;for(l?((u=new Uint8Array(d.byteLength+l)).set(i.subarray(0,l)),u.set(d,l),l=0):u=d;h<u.byteLength;)71!==u[c]||71!==u[h]?(c++,h++):(this.trigger("data",u.subarray(c,h)),c+=We,h+=We);c<u.byteLength&&(i.set(u.subarray(c),0),l=u.byteLength-c)},this.flush=function(){l===We&&71===i[0]&&(this.trigger("data",i),l=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){l=0,this.trigger("reset")}}).prototype=new He,Fe=function(){var i,l,d,u;Fe.prototype.init.call(this),u=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,i=function(i,u){var c=0;u.payloadUnitStartIndicator&&(c+=i[c]+1),"pat"===u.type?l(i.subarray(c),u):d(i.subarray(c),u)},l=function(i,l){l.section_number=i[7],l.last_section_number=i[8],u.pmtPid=(31&i[10])<<8|i[11],l.pmtPid=u.pmtPid},d=function(i,l){var d,c;if(1&i[5]){for(u.programMapTable={video:null,audio:null,"timed-metadata":{}},d=3+((15&i[1])<<8|i[2])-4,c=12+((15&i[10])<<8|i[11]);c<d;){var h=i[c],p=(31&i[c+1])<<8|i[c+2];h===ze.H264_STREAM_TYPE&&null===u.programMapTable.video?u.programMapTable.video=p:h===ze.ADTS_STREAM_TYPE&&null===u.programMapTable.audio?u.programMapTable.audio=p:h===ze.METADATA_STREAM_TYPE&&(u.programMapTable["timed-metadata"][p]=h),c+=5+((15&i[c+3])<<8|i[c+4])}l.programMapTable=u.programMapTable}},this.push=function(l){var d={},u=4;if(d.payloadUnitStartIndicator=!!(64&l[1]),d.pid=31&l[1],d.pid<<=8,d.pid|=l[2],(48&l[3])>>>4>1&&(u+=l[u]+1),0===d.pid)d.type="pat",i(l.subarray(u),d),this.trigger("data",d);else if(d.pid===this.pmtPid)for(d.type="pmt",i(l.subarray(u),d),this.trigger("data",d);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([l,u,d]):this.processPes_(l,u,d)},this.processPes_=function(i,l,d){d.streamType=d.pid===this.programMapTable.video?ze.H264_STREAM_TYPE:d.pid===this.programMapTable.audio?ze.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][d.pid],d.type="pes",d.data=i.subarray(l),this.trigger("data",d)}},Fe.prototype=new He,Fe.STREAM_TYPES={h264:27,adts:15},je=function(){var i,l=this,d=!1,u={data:[],size:0},c={data:[],size:0},h={data:[],size:0},flushStream=function(i,d,u){var c,h,p=new Uint8Array(i.size),m={type:d},g=0,y=0;if(i.data.length&&!(i.size<9)){for(m.trackId=i.data[0].pid,g=0;g<i.data.length;g++)p.set((h=i.data[g]).data,y),y+=h.data.byteLength;!function(i,l){var d;const u=i[0]<<16|i[1]<<8|i[2];l.data=new Uint8Array,1===u&&(l.packetLength=6+(i[4]<<8|i[5]),l.dataAlignmentIndicator=!!(4&i[6]),192&(d=i[7])&&(l.pts=(14&i[9])<<27|(255&i[10])<<20|(254&i[11])<<12|(255&i[12])<<5|(254&i[13])>>>3,l.pts*=4,l.pts+=(6&i[13])>>>1,l.dts=l.pts,64&d&&(l.dts=(14&i[14])<<27|(255&i[15])<<20|(254&i[16])<<12|(255&i[17])<<5|(254&i[18])>>>3,l.dts*=4,l.dts+=(6&i[18])>>>1)),l.data=i.subarray(9+i[8]))}(p,m),c="video"===d||m.packetLength<=i.size,(u||c)&&(i.size=0,i.data.length=0),c&&l.trigger("data",m)}};je.prototype.init.call(this),this.push=function(p){({pat:function(){},pes:function(){var i,l;switch(p.streamType){case ze.H264_STREAM_TYPE:i=u,l="video";break;case ze.ADTS_STREAM_TYPE:i=c,l="audio";break;case ze.METADATA_STREAM_TYPE:i=h,l="timed-metadata";break;default:return}p.payloadUnitStartIndicator&&flushStream(i,l,!0),i.data.push(p),i.size+=p.data.byteLength},pmt:function(){var u={type:"metadata",tracks:[]};null!==(i=p.programMapTable).video&&u.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.video,codec:"avc",type:"video"}),null!==i.audio&&u.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.audio,codec:"adts",type:"audio"}),d=!0,l.trigger("data",u)}})[p.type]()},this.reset=function(){u.size=0,u.data.length=0,c.size=0,c.data.length=0,this.trigger("reset")},this.flushStreams_=function(){flushStream(u,"video"),flushStream(c,"audio"),flushStream(h,"timed-metadata")},this.flush=function(){if(!d&&i){var u={type:"metadata",tracks:[]};null!==i.video&&u.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.video,codec:"avc",type:"video"}),null!==i.audio&&u.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.audio,codec:"adts",type:"audio"}),l.trigger("data",u)}d=!1,this.flushStreams_(),this.trigger("done")}},je.prototype=new He;var Xe={PAT_PID:0,MP2T_PACKET_LENGTH:We,TransportPacketStream:Be,TransportParseStream:Fe,ElementaryStream:je,TimestampRolloverStream:Ge,CaptionStream:$e.CaptionStream,Cea608Stream:$e.Cea608Stream,Cea708Stream:$e.Cea708Stream,MetadataStream:qe};for(var Ke in ze)ze.hasOwnProperty(Ke)&&(Xe[Ke]=ze[Ke]);var Ye,Qe=Xe,Je=ye.ONE_SECOND_IN_TS,Ze=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Ye=function(i){var l,d=0;Ye.prototype.init.call(this),this.skipWarn_=function(i,l){this.trigger("log",{level:"warn",message:`adts skiping bytes ${i} to ${l} in frame ${d} outside syncword`})},this.push=function(u){var c,h,p,m,g,y=0;if(i||(d=0),"audio"===u.type){var _;for(l&&l.length?(p=l,(l=new Uint8Array(p.byteLength+u.data.byteLength)).set(p),l.set(u.data,p.byteLength)):l=u.data;y+7<l.length;)if(255===l[y]&&240==(246&l[y+1])){if("number"==typeof _&&(this.skipWarn_(_,y),_=null),h=2*(1&~l[y+1]),g=(m=1024*(1+(3&l[y+6])))*Je/Ze[(60&l[y+2])>>>2],l.byteLength-y<(c=(3&l[y+3])<<11|l[y+4]<<3|(224&l[y+5])>>5))break;this.trigger("data",{pts:u.pts+d*g,dts:u.dts+d*g,sampleCount:m,audioobjecttype:1+(l[y+2]>>>6&3),channelcount:(1&l[y+2])<<2|(192&l[y+3])>>>6,samplerate:Ze[(60&l[y+2])>>>2],samplingfrequencyindex:(60&l[y+2])>>>2,samplesize:16,data:l.subarray(y+7+h,y+c)}),d++,y+=c}else"number"!=typeof _&&(_=y),y++;"number"==typeof _&&(this.skipWarn_(_,y),_=null),l=l.subarray(y)}},this.flush=function(){d=0,this.trigger("done")},this.reset=function(){l=void 0,this.trigger("reset")},this.endTimeline=function(){l=void 0,this.trigger("endedtimeline")}}).prototype=new ee;var et,tt,it,rt=Ye,st=ee,ExpGolomb=function(i){var l=i.byteLength,d=0,u=0;this.length=function(){return 8*l},this.bitsAvailable=function(){return 8*l+u},this.loadWord=function(){var c=i.byteLength-l,h=new Uint8Array(4),p=Math.min(4,l);if(0===p)throw new Error("no bytes available");h.set(i.subarray(c,c+p)),d=new DataView(h.buffer).getUint32(0),u=8*p,l-=p},this.skipBits=function(i){var c;u>i?(d<<=i,u-=i):(i-=u,i-=8*(c=Math.floor(i/8)),l-=c,this.loadWord(),d<<=i,u-=i)},this.readBits=function(i){var c=Math.min(u,i),h=d>>>32-c;return(u-=c)>0?d<<=c:l>0&&this.loadWord(),(c=i-c)>0?h<<c|this.readBits(c):h},this.skipLeadingZeros=function(){var i;for(i=0;i<u;++i)if(d&2147483648>>>i)return d<<=i,u-=i,i;return this.loadWord(),i+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var i=this.skipLeadingZeros();return this.readBits(i+1)-1},this.readExpGolomb=function(){var i=this.readUnsignedExpGolomb();return 1&i?1+i>>>1:-1*(i>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(tt=function(){var i,l,d=0;tt.prototype.init.call(this),this.push=function(u){var c;l?((c=new Uint8Array(l.byteLength+u.data.byteLength)).set(l),c.set(u.data,l.byteLength),l=c):l=u.data;for(var h=l.byteLength;d<h-3;d++)if(1===l[d+2]){i=d+5;break}for(;i<h;)switch(l[i]){case 0:if(0!==l[i-1]){i+=2;break}if(0!==l[i-2]){i++;break}d+3!==i-2&&this.trigger("data",l.subarray(d+3,i-2));do{i++}while(1!==l[i]&&i<h);d=i-2,i+=3;break;case 1:if(0!==l[i-1]||0!==l[i-2]){i+=3;break}this.trigger("data",l.subarray(d+3,i-2)),d=i-2,i+=3;break;default:i+=3}l=l.subarray(d),i-=d,d=0},this.reset=function(){l=null,d=0,this.trigger("reset")},this.flush=function(){l&&l.byteLength>3&&this.trigger("data",l.subarray(d+3)),l=null,d=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new st,it={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},et=function(){var i,l,d,u,c,h,p,m=new tt;et.prototype.init.call(this),i=this,this.push=function(i){"video"===i.type&&(l=i.trackId,d=i.pts,u=i.dts,m.push(i))},m.on("data",(function(p){var m={trackId:l,pts:d,dts:u,data:p,nalUnitTypeCode:31&p[0]};switch(m.nalUnitTypeCode){case 5:m.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:m.nalUnitType="sei_rbsp",m.escapedRBSP=c(p.subarray(1));break;case 7:m.nalUnitType="seq_parameter_set_rbsp",m.escapedRBSP=c(p.subarray(1)),m.config=h(m.escapedRBSP);break;case 8:m.nalUnitType="pic_parameter_set_rbsp";break;case 9:m.nalUnitType="access_unit_delimiter_rbsp"}i.trigger("data",m)})),m.on("done",(function(){i.trigger("done")})),m.on("partialdone",(function(){i.trigger("partialdone")})),m.on("reset",(function(){i.trigger("reset")})),m.on("endedtimeline",(function(){i.trigger("endedtimeline")})),this.flush=function(){m.flush()},this.partialFlush=function(){m.partialFlush()},this.reset=function(){m.reset()},this.endTimeline=function(){m.endTimeline()},p=function(i,l){var d,u=8,c=8;for(d=0;d<i;d++)0!==c&&(c=(u+l.readExpGolomb()+256)%256),u=0===c?u:c},c=function(i){for(var l,d,u=i.byteLength,c=[],h=1;h<u-2;)0===i[h]&&0===i[h+1]&&3===i[h+2]?(c.push(h+2),h+=2):h++;if(0===c.length)return i;l=u-c.length,d=new Uint8Array(l);var p=0;for(h=0;h<l;p++,h++)p===c[0]&&(p++,c.shift()),d[h]=i[p];return d},h=function(i){var l,d,u,c,h,m,g,y,_,v,b,T,S=0,E=0,k=0,w=0,C=[1,1];if(d=(l=new ExpGolomb(i)).readUnsignedByte(),c=l.readUnsignedByte(),u=l.readUnsignedByte(),l.skipUnsignedExpGolomb(),it[d]&&(3===(h=l.readUnsignedExpGolomb())&&l.skipBits(1),l.skipUnsignedExpGolomb(),l.skipUnsignedExpGolomb(),l.skipBits(1),l.readBoolean()))for(b=3!==h?8:12,T=0;T<b;T++)l.readBoolean()&&p(T<6?16:64,l);if(l.skipUnsignedExpGolomb(),0===(m=l.readUnsignedExpGolomb()))l.readUnsignedExpGolomb();else if(1===m)for(l.skipBits(1),l.skipExpGolomb(),l.skipExpGolomb(),g=l.readUnsignedExpGolomb(),T=0;T<g;T++)l.skipExpGolomb();if(l.skipUnsignedExpGolomb(),l.skipBits(1),y=l.readUnsignedExpGolomb(),_=l.readUnsignedExpGolomb(),0===(v=l.readBits(1))&&l.skipBits(1),l.skipBits(1),l.readBoolean()&&(S=l.readUnsignedExpGolomb(),E=l.readUnsignedExpGolomb(),k=l.readUnsignedExpGolomb(),w=l.readUnsignedExpGolomb()),l.readBoolean()&&l.readBoolean()){switch(l.readUnsignedByte()){case 1:C=[1,1];break;case 2:C=[12,11];break;case 3:C=[10,11];break;case 4:C=[16,11];break;case 5:C=[40,33];break;case 6:C=[24,11];break;case 7:C=[20,11];break;case 8:C=[32,11];break;case 9:C=[80,33];break;case 10:C=[18,11];break;case 11:C=[15,11];break;case 12:C=[64,33];break;case 13:C=[160,99];break;case 14:C=[4,3];break;case 15:C=[3,2];break;case 16:C=[2,1];break;case 255:C=[l.readUnsignedByte()<<8|l.readUnsignedByte(),l.readUnsignedByte()<<8|l.readUnsignedByte()]}C&&C[0]/C[1]}return{profileIdc:d,levelIdc:u,profileCompatibility:c,width:16*(y+1)-2*S-2*E,height:(2-v)*(_+1)*16-2*k-2*w,sarRatio:C}}},et.prototype=new st;var nt,at={H264Stream:et,NalByteStream:tt},ot=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],parseId3TagSize=function(i,l){var d=i[l+6]<<21|i[l+7]<<14|i[l+8]<<7|i[l+9];return d=d>=0?d:0,(16&i[l+5])>>4?d+20:d+10},getId3Offset=function(i,l){return i.length-l<10||i[l]!=="I".charCodeAt(0)||i[l+1]!=="D".charCodeAt(0)||i[l+2]!=="3".charCodeAt(0)?l:(l+=parseId3TagSize(i,l),getId3Offset(i,l))},parseSyncSafeInteger=function(i){return i[0]<<21|i[1]<<14|i[2]<<7|i[3]},lt={isLikelyAacData:function(i){var l=getId3Offset(i,0);return i.length>=l+2&&!(255&~i[l])&&!(240&~i[l+1])&&16==(22&i[l+1])},parseId3TagSize,parseAdtsSize:function(i,l){return 6144&i[l+3]|i[l+4]<<3|(224&i[l+5])>>5},parseType:function(i,l){return i[l]==="I".charCodeAt(0)&&i[l+1]==="D".charCodeAt(0)&&i[l+2]==="3".charCodeAt(0)?"timed-metadata":!0&i[l]&&!(240&~i[l+1])?"audio":null},parseSampleRate:function(i){for(var l=0;l+5<i.length;){if(255===i[l]&&240==(246&i[l+1]))return ot[(60&i[l+2])>>>2];l++}return null},parseAacTimestamp:function(i){var l,d,u;l=10,64&i[5]&&(l+=4,l+=parseSyncSafeInteger(i.subarray(10,14)));do{if((d=parseSyncSafeInteger(i.subarray(l+4,l+8)))<1)return null;if("PRIV"===String.fromCharCode(i[l],i[l+1],i[l+2],i[l+3])){u=i.subarray(l+10,l+d+10);for(var c=0;c<u.byteLength;c++)if(0===u[c]){var h=unescape(function(i,l,d){var u,c="";for(u=l;u<d;u++)c+="%"+("00"+i[u].toString(16)).slice(-2);return c}(u,0,c));if("com.apple.streaming.transportStreamTimestamp"===h){var p=u.subarray(c+1),m=(1&p[3])<<30|p[4]<<22|p[5]<<14|p[6]<<6|p[7]>>>2;return m*=4,m+=3&p[7]}break}}l+=10,l+=d}while(l<i.byteLength);return null}},dt=lt;(nt=function(){var i=new Uint8Array,l=0;nt.prototype.init.call(this),this.setTimestamp=function(i){l=i},this.push=function(d){var u,c,h,p=0,m=0;for(i.length?(h=i.length,(i=new Uint8Array(d.byteLength+h)).set(i.subarray(0,h)),i.set(d,h)):i=d;i.length-m>=3;)if(i[m]!=="I".charCodeAt(0)||i[m+1]!=="D".charCodeAt(0)||i[m+2]!=="3".charCodeAt(0))if(255&~i[m]||240&~i[m+1])m++;else{if(i.length-m<7)break;if(m+(p=dt.parseAdtsSize(i,m))>i.length)break;c={type:"audio",data:i.subarray(m,m+p),pts:l,dts:l},this.trigger("data",c),m+=p}else{if(i.length-m<10)break;if(m+(p=dt.parseId3TagSize(i,m))>i.length)break;u={type:"timed-metadata",data:i.subarray(m,m+p)},this.trigger("data",u),m+=p}i=i.length-m>0?i.subarray(m):new Uint8Array},this.reset=function(){i=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){i=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new ee;var ut,ct,ht,pt,mt=ee,ft=he,gt=pe,yt=ve,_t=Te,vt=Qe,bt=ye,Tt=rt,St=at.H264Stream,Et=nt,kt=lt.isLikelyAacData,wt=ye.ONE_SECOND_IN_TS,Ct=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],xt=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],retriggerForStream=function(i,l){l.stream=i,this.trigger("log",l)},addPipelineLogRetriggers=function(i,l){for(var d=Object.keys(l),u=0;u<d.length;u++){var c=d[u];"headOfPipeline"!==c&&l[c].on&&l[c].on("log",retriggerForStream.bind(i,c))}},arrayEquals=function(i,l){var d;if(i.length!==l.length)return!1;for(d=0;d<i.length;d++)if(i[d]!==l[d])return!1;return!0},generateSegmentTimingInfo=function(i,l,d,u,c,h){return{start:{dts:i,pts:i+(d-l)},end:{dts:i+(u-l),pts:i+(c-d)},prependedContentDuration:h,baseMediaDecodeTime:i}};ct=function(i,l){var d,u=[],c=0,h=0,p=1/0;d=(l=l||{}).firstSequenceNumber||0,ct.prototype.init.call(this),this.push=function(l){_t.collectDtsInfo(i,l),i&&Ct.forEach((function(d){i[d]=l[d]})),u.push(l)},this.setEarliestDts=function(i){c=i},this.setVideoBaseMediaDecodeTime=function(i){p=i},this.setAudioAppendStart=function(i){h=i},this.flush=function(){var m,g,y,_,v,b,T;if(0===u.length)return this.trigger("done","AudioSegmentStream"),void 0;m=yt.trimAdtsFramesByEarliestDts(u,i,c),i.baseMediaDecodeTime=_t.calculateTrackBaseMediaDecodeTime(i,l.keepOriginalTimestamps),T=yt.prefixWithSilence(i,m,h,p),i.samples=yt.generateSampleTable(m),y=ft.mdat(yt.concatenateFrameData(m)),u=[],g=ft.moof(d,[i]),_=new Uint8Array(g.byteLength+y.byteLength),d++,_.set(g),_.set(y,g.byteLength),_t.clearDtsInfo(i),v=Math.ceil(1024*wt/i.samplerate),m.length&&(b=m.length*v,this.trigger("segmentTimingInfo",generateSegmentTimingInfo(bt.audioTsToVideoTs(i.baseMediaDecodeTime,i.samplerate),m[0].dts,m[0].pts,m[0].dts+b,m[0].pts+b,T||0)),this.trigger("timingInfo",{start:m[0].pts,end:m[0].pts+b})),this.trigger("data",{track:i,boxes:_}),this.trigger("done","AudioSegmentStream")},this.reset=function(){_t.clearDtsInfo(i),u=[],this.trigger("reset")}},ct.prototype=new mt,ut=function(i,l){var d,u,c,h=[],p=[];d=(l=l||{}).firstSequenceNumber||0,ut.prototype.init.call(this),delete i.minPTS,this.gopCache_=[],this.push=function(l){_t.collectDtsInfo(i,l),"seq_parameter_set_rbsp"!==l.nalUnitType||u||(u=l.config,i.sps=[l.data],xt.forEach((function(l){i[l]=u[l]}),this)),"pic_parameter_set_rbsp"!==l.nalUnitType||c||(c=l.data,i.pps=[l.data]),h.push(l)},this.flush=function(){for(var u,c,m,g,y,_,v,b,T=0;h.length&&"access_unit_delimiter_rbsp"!==h[0].nalUnitType;)h.shift();if(0===h.length)return this.resetStream_(),this.trigger("done","VideoSegmentStream"),void 0;if(u=gt.groupNalsIntoFrames(h),(m=gt.groupFramesIntoGops(u))[0][0].keyFrame||((c=this.getGopForFusion_(h[0],i))?(T=c.duration,m.unshift(c),m.byteLength+=c.byteLength,m.nalCount+=c.nalCount,m.pts=c.pts,m.dts=c.dts,m.duration+=c.duration):m=gt.extendFirstKeyFrame(m)),p.length){var S;if(!(S=l.alignGopsAtEnd?this.alignGopsAtEnd_(m):this.alignGopsAtStart_(m)))return this.gopCache_.unshift({gop:m.pop(),pps:i.pps,sps:i.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),h=[],this.resetStream_(),this.trigger("done","VideoSegmentStream"),void 0;_t.clearDtsInfo(i),m=S}_t.collectDtsInfo(i,m),i.samples=gt.generateSampleTable(m),y=ft.mdat(gt.concatenateNalData(m)),i.baseMediaDecodeTime=_t.calculateTrackBaseMediaDecodeTime(i,l.keepOriginalTimestamps),this.trigger("processedGopsInfo",m.map((function(i){return{pts:i.pts,dts:i.dts,byteLength:i.byteLength}}))),this.trigger("segmentTimingInfo",generateSegmentTimingInfo(i.baseMediaDecodeTime,(v=m[0]).dts,v.pts,(b=m[m.length-1]).dts+b.duration,b.pts+b.duration,T)),this.trigger("timingInfo",{start:m[0].pts,end:m[m.length-1].pts+m[m.length-1].duration}),this.gopCache_.unshift({gop:m.pop(),pps:i.pps,sps:i.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),h=[],this.trigger("baseMediaDecodeTime",i.baseMediaDecodeTime),this.trigger("timelineStartInfo",i.timelineStartInfo),g=ft.moof(d,[i]),_=new Uint8Array(g.byteLength+y.byteLength),d++,_.set(g),_.set(y,g.byteLength),this.trigger("data",{track:i,boxes:_}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),h=[],this.gopCache_.length=0,p.length=0,this.trigger("reset")},this.resetStream_=function(){_t.clearDtsInfo(i),u=void 0,c=void 0},this.getGopForFusion_=function(l){var d,u,c,h,p,m=1/0;for(p=0;p<this.gopCache_.length;p++)c=(h=this.gopCache_[p]).gop,i.pps&&arrayEquals(i.pps[0],h.pps[0])&&i.sps&&arrayEquals(i.sps[0],h.sps[0])&&(c.dts<i.timelineStartInfo.dts||(d=l.dts-c.dts-c.duration)>=-1e4&&d<=45e3&&(!u||m>d)&&(u=h,m=d));return u?u.gop:null},this.alignGopsAtStart_=function(i){var l,d,u,c,h,m,g,y;for(h=i.byteLength,m=i.nalCount,g=i.duration,l=d=0;l<p.length&&d<i.length&&(u=p[l]).pts!==(c=i[d]).pts;)c.pts>u.pts?l++:(d++,h-=c.byteLength,m-=c.nalCount,g-=c.duration);return 0===d?i:d===i.length?null:((y=i.slice(d)).byteLength=h,y.duration=g,y.nalCount=m,y.pts=y[0].pts,y.dts=y[0].dts,y)},this.alignGopsAtEnd_=function(i){var l,d,u,c,h,m,g;for(l=p.length-1,d=i.length-1,h=null,m=!1;l>=0&&d>=0;){if((u=p[l]).pts===(c=i[d]).pts){m=!0;break}u.pts>c.pts?l--:(l===p.length-1&&(h=d),d--)}if(!m&&null===h)return null;if(0===(g=m?d:h))return i;var y=i.slice(g),_=y.reduce((function(i,l){return i.byteLength+=l.byteLength,i.duration+=l.duration,i.nalCount+=l.nalCount,i}),{byteLength:0,duration:0,nalCount:0});return y.byteLength=_.byteLength,y.duration=_.duration,y.nalCount=_.nalCount,y.pts=y[0].pts,y.dts=y[0].dts,y},this.alignGopsWith=function(i){p=i}},ut.prototype=new mt,pt=function(i,l){this.numberOfTracks=0,this.metadataStream=l,this.remuxTracks=void 0===(i=i||{}).remux||!!i.remux,this.keepOriginalTimestamps="boolean"==typeof i.keepOriginalTimestamps&&i.keepOriginalTimestamps,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,pt.prototype.init.call(this),this.push=function(i){return i.content||i.text?this.pendingCaptions.push(i):i.frames?this.pendingMetadata.push(i):(this.pendingTracks.push(i.track),this.pendingBytes+=i.boxes.byteLength,"video"===i.track.type&&(this.videoTrack=i.track,this.pendingBoxes.push(i.boxes)),"audio"===i.track.type&&(this.audioTrack=i.track,this.pendingBoxes.unshift(i.boxes)),void 0)}},pt.prototype=new mt,pt.prototype.flush=function(i){var l,d,u,c,h=0,p={captions:[],captionStreams:{},metadata:[],info:{}},m=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==i&&"AudioSegmentStream"!==i)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0),void 0}if(this.videoTrack?(m=this.videoTrack.timelineStartInfo.pts,xt.forEach((function(i){p.info[i]=this.videoTrack[i]}),this)):this.audioTrack&&(m=this.audioTrack.timelineStartInfo.pts,Ct.forEach((function(i){p.info[i]=this.audioTrack[i]}),this)),this.videoTrack||this.audioTrack){for(p.type=1===this.pendingTracks.length?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,u=ft.initSegment(this.pendingTracks),p.initSegment=new Uint8Array(u.byteLength),p.initSegment.set(u),p.data=new Uint8Array(this.pendingBytes),c=0;c<this.pendingBoxes.length;c++)p.data.set(this.pendingBoxes[c],h),h+=this.pendingBoxes[c].byteLength;for(c=0;c<this.pendingCaptions.length;c++)(l=this.pendingCaptions[c]).startTime=bt.metadataTsToSeconds(l.startPts,m,this.keepOriginalTimestamps),l.endTime=bt.metadataTsToSeconds(l.endPts,m,this.keepOriginalTimestamps),p.captionStreams[l.stream]=!0,p.captions.push(l);for(c=0;c<this.pendingMetadata.length;c++)(d=this.pendingMetadata[c]).cueTime=bt.metadataTsToSeconds(d.pts,m,this.keepOriginalTimestamps),p.metadata.push(d);for(p.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",p),c=0;c<p.captions.length;c++)this.trigger("caption",l=p.captions[c]);for(c=0;c<p.metadata.length;c++)this.trigger("id3Frame",d=p.metadata[c])}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},pt.prototype.setRemux=function(i){this.remuxTracks=i},(ht=function(i){var l,d,u=this,c=!0;ht.prototype.init.call(this),this.baseMediaDecodeTime=(i=i||{}).baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var c={};this.transmuxPipeline_=c,c.type="aac",c.metadataStream=new vt.MetadataStream,c.aacStream=new Et,c.audioTimestampRolloverStream=new vt.TimestampRolloverStream("audio"),c.timedMetadataTimestampRolloverStream=new vt.TimestampRolloverStream("timed-metadata"),c.adtsStream=new Tt,c.coalesceStream=new pt(i,c.metadataStream),c.headOfPipeline=c.aacStream,c.aacStream.pipe(c.audioTimestampRolloverStream).pipe(c.adtsStream),c.aacStream.pipe(c.timedMetadataTimestampRolloverStream).pipe(c.metadataStream).pipe(c.coalesceStream),c.metadataStream.on("timestamp",(function(i){c.aacStream.setTimestamp(i.timeStamp)})),c.aacStream.on("data",(function(h){"timed-metadata"!==h.type&&"audio"!==h.type||c.audioSegmentStream||(d=d||{timelineStartInfo:{baseMediaDecodeTime:u.baseMediaDecodeTime},codec:"adts",type:"audio"},c.coalesceStream.numberOfTracks++,c.audioSegmentStream=new ct(d,i),c.audioSegmentStream.on("log",u.getLogTrigger_("audioSegmentStream")),c.audioSegmentStream.on("timingInfo",u.trigger.bind(u,"audioTimingInfo")),c.adtsStream.pipe(c.audioSegmentStream).pipe(c.coalesceStream),u.trigger("trackinfo",{hasAudio:!!d,hasVideo:!!l}))})),c.coalesceStream.on("data",this.trigger.bind(this,"data")),c.coalesceStream.on("done",this.trigger.bind(this,"done")),addPipelineLogRetriggers(this,c)},this.setupTsPipeline=function(){var c={};this.transmuxPipeline_=c,c.type="ts",c.metadataStream=new vt.MetadataStream,c.packetStream=new vt.TransportPacketStream,c.parseStream=new vt.TransportParseStream,c.elementaryStream=new vt.ElementaryStream,c.timestampRolloverStream=new vt.TimestampRolloverStream,c.adtsStream=new Tt,c.h264Stream=new St,c.captionStream=new vt.CaptionStream(i),c.coalesceStream=new pt(i,c.metadataStream),c.headOfPipeline=c.packetStream,c.packetStream.pipe(c.parseStream).pipe(c.elementaryStream).pipe(c.timestampRolloverStream),c.timestampRolloverStream.pipe(c.h264Stream),c.timestampRolloverStream.pipe(c.adtsStream),c.timestampRolloverStream.pipe(c.metadataStream).pipe(c.coalesceStream),c.h264Stream.pipe(c.captionStream).pipe(c.coalesceStream),c.elementaryStream.on("data",(function(h){var p;if("metadata"===h.type){for(p=h.tracks.length;p--;)l||"video"!==h.tracks[p].type?d||"audio"!==h.tracks[p].type||((d=h.tracks[p]).timelineStartInfo.baseMediaDecodeTime=u.baseMediaDecodeTime):(l=h.tracks[p]).timelineStartInfo.baseMediaDecodeTime=u.baseMediaDecodeTime;l&&!c.videoSegmentStream&&(c.coalesceStream.numberOfTracks++,c.videoSegmentStream=new ut(l,i),c.videoSegmentStream.on("log",u.getLogTrigger_("videoSegmentStream")),c.videoSegmentStream.on("timelineStartInfo",(function(l){d&&!i.keepOriginalTimestamps&&(d.timelineStartInfo=l,c.audioSegmentStream.setEarliestDts(l.dts-u.baseMediaDecodeTime))})),c.videoSegmentStream.on("processedGopsInfo",u.trigger.bind(u,"gopInfo")),c.videoSegmentStream.on("segmentTimingInfo",u.trigger.bind(u,"videoSegmentTimingInfo")),c.videoSegmentStream.on("baseMediaDecodeTime",(function(i){d&&c.audioSegmentStream.setVideoBaseMediaDecodeTime(i)})),c.videoSegmentStream.on("timingInfo",u.trigger.bind(u,"videoTimingInfo")),c.h264Stream.pipe(c.videoSegmentStream).pipe(c.coalesceStream)),d&&!c.audioSegmentStream&&(c.coalesceStream.numberOfTracks++,c.audioSegmentStream=new ct(d,i),c.audioSegmentStream.on("log",u.getLogTrigger_("audioSegmentStream")),c.audioSegmentStream.on("timingInfo",u.trigger.bind(u,"audioTimingInfo")),c.audioSegmentStream.on("segmentTimingInfo",u.trigger.bind(u,"audioSegmentTimingInfo")),c.adtsStream.pipe(c.audioSegmentStream).pipe(c.coalesceStream)),u.trigger("trackinfo",{hasAudio:!!d,hasVideo:!!l})}})),c.coalesceStream.on("data",this.trigger.bind(this,"data")),c.coalesceStream.on("id3Frame",(function(i){i.dispatchType=c.metadataStream.dispatchType,u.trigger("id3Frame",i)})),c.coalesceStream.on("caption",this.trigger.bind(this,"caption")),c.coalesceStream.on("done",this.trigger.bind(this,"done")),addPipelineLogRetriggers(this,c)},this.setBaseMediaDecodeTime=function(u){var c=this.transmuxPipeline_;i.keepOriginalTimestamps||(this.baseMediaDecodeTime=u),d&&(d.timelineStartInfo.dts=void 0,d.timelineStartInfo.pts=void 0,_t.clearDtsInfo(d),c.audioTimestampRolloverStream&&c.audioTimestampRolloverStream.discontinuity()),l&&(c.videoSegmentStream&&(c.videoSegmentStream.gopCache_=[]),l.timelineStartInfo.dts=void 0,l.timelineStartInfo.pts=void 0,_t.clearDtsInfo(l),c.captionStream.reset()),c.timestampRolloverStream&&c.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(i){d&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(i)},this.setRemux=function(l){var d=this.transmuxPipeline_;i.remux=l,d&&d.coalesceStream&&d.coalesceStream.setRemux(l)},this.alignGopsWith=function(i){l&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(i)},this.getLogTrigger_=function(i){var l=this;return function(d){d.stream=i,l.trigger("log",d)}},this.push=function(i){if(c){var l=kt(i);l&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():l||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),c=!1}this.transmuxPipeline_.headOfPipeline.push(i)},this.flush=function(){c=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new mt;var At,Pt,It={Transmuxer:ht,VideoSegmentStream:ut,AudioSegmentStream:ct,AUDIO_PROPERTIES:Ct,VIDEO_PROPERTIES:xt,generateSegmentTimingInfo},bin_toUnsigned=function(i){return i>>>0},parseType_1=function(i){var l="";return l+=String.fromCharCode(i[0]),l+=String.fromCharCode(i[1]),l+=String.fromCharCode(i[2]),l+=String.fromCharCode(i[3])},Dt=bin_toUnsigned,Ot=parseType_1,findBox$5=function(i,l){var d,u,c,h,p,m=[];if(!l.length)return null;for(d=0;d<i.byteLength;)u=Dt(i[d]<<24|i[d+1]<<16|i[d+2]<<8|i[d+3]),c=Ot(i.subarray(d+4,d+8)),h=u>1?d+u:i.byteLength,c===l[0]&&(1===l.length?m.push(i.subarray(d+8,h)):(p=findBox$5(i.subarray(d+8,h),l.slice(1))).length&&(m=m.concat(p))),d=h;return m},Lt=findBox$5,Rt=bin_toUnsigned,Vt=ie.getUint64,parseTfdt$3=function(i){var l={version:i[0],flags:new Uint8Array(i.subarray(1,4))};return l.baseMediaDecodeTime=1===l.version?Vt(i.subarray(4)):Rt(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),l},parseTfhd$2=function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u={version:i[0],flags:new Uint8Array(i.subarray(1,4)),trackId:d.getUint32(4)},c=1&u.flags[2],h=2&u.flags[2],p=8&u.flags[2],m=16&u.flags[2],g=32&u.flags[2],y=65536&u.flags[0],_=131072&u.flags[0];return l=8,c&&(l+=4,u.baseDataOffset=d.getUint32(12),l+=4),h&&(u.sampleDescriptionIndex=d.getUint32(l),l+=4),p&&(u.defaultSampleDuration=d.getUint32(l),l+=4),m&&(u.defaultSampleSize=d.getUint32(l),l+=4),g&&(u.defaultSampleFlags=d.getUint32(l)),y&&(u.durationIsEmpty=!0),!c&&_&&(u.baseDataOffsetIsMoof=!0),u},Mt=ie.getUint64,parseSampleFlags=function(i){return{isLeading:(12&i[0])>>>2,dependsOn:3&i[0],isDependedOn:(192&i[1])>>>6,hasRedundancy:(48&i[1])>>>4,paddingValue:(14&i[1])>>>1,isNonSyncSample:1&i[1],degradationPriority:i[2]<<8|i[3]}},parseTrun$2=function(i){var l,d={version:i[0],flags:new Uint8Array(i.subarray(1,4)),samples:[]},u=new DataView(i.buffer,i.byteOffset,i.byteLength),c=1&d.flags[2],h=4&d.flags[2],p=1&d.flags[1],m=2&d.flags[1],g=4&d.flags[1],y=8&d.flags[1],_=u.getUint32(4),v=8;for(c&&(d.dataOffset=u.getInt32(v),v+=4),h&&_&&(l={flags:parseSampleFlags(i.subarray(v,v+4))},v+=4,p&&(l.duration=u.getUint32(v),v+=4),m&&(l.size=u.getUint32(v),v+=4),y&&(l.compositionTimeOffset=1===d.version?u.getInt32(v):u.getUint32(v),v+=4),d.samples.push(l),_--);_--;)l={},p&&(l.duration=u.getUint32(v),v+=4),m&&(l.size=u.getUint32(v),v+=4),g&&(l.flags=parseSampleFlags(i.subarray(v,v+4)),v+=4),y&&(l.compositionTimeOffset=1===d.version?u.getInt32(v):u.getUint32(v),v+=4),d.samples.push(l);return d},Nt=ie.getUint64,parseMp4Date=function(i){return new Date(1e3*i-20828448e5)},Ut=parseType_1,nalParse=function(i){var l,d,u=new DataView(i.buffer,i.byteOffset,i.byteLength),c=[];for(l=0;l+4<i.length;l+=d)if(d=u.getUint32(l),l+=4,d<=0)c.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&i[l]){case 1:c.push("slice_layer_without_partitioning_rbsp");break;case 5:c.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:c.push("sei_rbsp");break;case 7:c.push("seq_parameter_set_rbsp");break;case 8:c.push("pic_parameter_set_rbsp");break;case 9:c.push("access_unit_delimiter_rbsp");break;default:c.push("UNKNOWN NAL - "+i[l]&31)}return c},Bt={avc1:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength);return{dataReferenceIndex:l.getUint16(6),width:l.getUint16(24),height:l.getUint16(26),horizresolution:l.getUint16(28)+l.getUint16(30)/16,vertresolution:l.getUint16(32)+l.getUint16(34)/16,frameCount:l.getUint16(40),depth:l.getUint16(74),config:At(i.subarray(78,i.byteLength))}},avcC:function(i){var l,d,u,c,h=new DataView(i.buffer,i.byteOffset,i.byteLength),p={configurationVersion:i[0],avcProfileIndication:i[1],profileCompatibility:i[2],avcLevelIndication:i[3],lengthSizeMinusOne:3&i[4],sps:[],pps:[]},m=31&i[5];for(u=6,c=0;c<m;c++)d=h.getUint16(u),u+=2,p.sps.push(new Uint8Array(i.subarray(u,u+d))),u+=d;for(l=i[u],u++,c=0;c<l;c++)d=h.getUint16(u),u+=2,p.pps.push(new Uint8Array(i.subarray(u,u+d))),u+=d;return p},btrt:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength);return{bufferSizeDB:l.getUint32(0),maxBitrate:l.getUint32(4),avgBitrate:l.getUint32(8)}},edts:function edts(i){return{boxes:At(i)}},elst:function elst(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u={version:d.getUint8(0),flags:new Uint8Array(i.subarray(1,4)),edits:[]},c=d.getUint32(4);for(l=8;c;c--)0===u.version?(u.edits.push({segmentDuration:d.getUint32(l),mediaTime:d.getInt32(l+4),mediaRate:d.getUint16(l+8)+d.getUint16(l+10)/65536}),l+=12):(u.edits.push({segmentDuration:Nt(i.subarray(l)),mediaTime:Nt(i.subarray(l+8)),mediaRate:d.getUint16(l+16)+d.getUint16(l+18)/65536}),l+=20);return u},esds:function(i){return{version:i[0],flags:new Uint8Array(i.subarray(1,4)),esId:i[6]<<8|i[7],streamPriority:31&i[8],decoderConfig:{objectProfileIndication:i[11],streamType:i[12]>>>2&63,bufferSize:i[13]<<16|i[14]<<8|i[15],maxBitrate:i[16]<<24|i[17]<<16|i[18]<<8|i[19],avgBitrate:i[20]<<24|i[21]<<16|i[22]<<8|i[23],decoderConfigDescriptor:{tag:i[24],length:i[25],audioObjectType:i[26]>>>3&31,samplingFrequencyIndex:(7&i[26])<<1|i[27]>>>7&1,channelConfiguration:i[27]>>>3&15}}}},ftyp:function(i){for(var l=new DataView(i.buffer,i.byteOffset,i.byteLength),d={majorBrand:Ut(i.subarray(0,4)),minorVersion:l.getUint32(4),compatibleBrands:[]},u=8;u<i.byteLength;)d.compatibleBrands.push(Ut(i.subarray(u,u+4))),u+=4;return d},dinf:function(i){return{boxes:At(i)}},dref:function(i){return{version:i[0],flags:new Uint8Array(i.subarray(1,4)),dataReferences:At(i.subarray(8))}},hdlr:function(i){var l={version:new DataView(i.buffer,i.byteOffset,i.byteLength).getUint8(0),flags:new Uint8Array(i.subarray(1,4)),handlerType:Ut(i.subarray(8,12)),name:""},d=8;for(d=24;d<i.byteLength;d++){if(0===i[d]){d++;break}l.name+=String.fromCharCode(i[d])}return l.name=decodeURIComponent(escape(l.name)),l},mdat:function(i){return{byteLength:i.byteLength,nals:nalParse(i)}},mdhd:function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u=4,c={version:d.getUint8(0),flags:new Uint8Array(i.subarray(1,4)),language:""};return 1===c.version?(c.creationTime=parseMp4Date(d.getUint32(u+=4)),c.modificationTime=parseMp4Date(d.getUint32(u+=8)),c.timescale=d.getUint32(u+=4),c.duration=d.getUint32(u+=8)):(c.creationTime=parseMp4Date(d.getUint32(u)),c.modificationTime=parseMp4Date(d.getUint32(u+=4)),c.timescale=d.getUint32(u+=4),c.duration=d.getUint32(u+=4)),l=d.getUint16(u+=4),c.language+=String.fromCharCode(96+(l>>10)),c.language+=String.fromCharCode(96+((992&l)>>5)),c.language+=String.fromCharCode(96+(31&l)),c},mdia:function(i){return{boxes:At(i)}},mfhd:function(i){return{version:i[0],flags:new Uint8Array(i.subarray(1,4)),sequenceNumber:i[4]<<24|i[5]<<16|i[6]<<8|i[7]}},minf:function(i){return{boxes:At(i)}},mp4a:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength),d={dataReferenceIndex:l.getUint16(6),channelcount:l.getUint16(16),samplesize:l.getUint16(18),samplerate:l.getUint16(24)+l.getUint16(26)/65536};return i.byteLength>28&&(d.streamDescriptor=At(i.subarray(28))[0]),d},moof:function(i){return{boxes:At(i)}},moov:function(i){return{boxes:At(i)}},mvex:function(i){return{boxes:At(i)}},mvhd:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength),d=4,u={version:l.getUint8(0),flags:new Uint8Array(i.subarray(1,4))};return 1===u.version?(u.creationTime=parseMp4Date(l.getUint32(d+=4)),u.modificationTime=parseMp4Date(l.getUint32(d+=8)),u.timescale=l.getUint32(d+=4),u.duration=l.getUint32(d+=8)):(u.creationTime=parseMp4Date(l.getUint32(d)),u.modificationTime=parseMp4Date(l.getUint32(d+=4)),u.timescale=l.getUint32(d+=4),u.duration=l.getUint32(d+=4)),u.rate=l.getUint16(d+=4)+l.getUint16(d+2)/16,u.volume=l.getUint8(d+=4)+l.getUint8(d+1)/8,d+=2,d+=2,d+=8,u.matrix=new Uint32Array(i.subarray(d,d+36)),d+=36,u.nextTrackId=l.getUint32(d+=24),u},pdin:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength);return{version:l.getUint8(0),flags:new Uint8Array(i.subarray(1,4)),rate:l.getUint32(4),initialDelay:l.getUint32(8)}},sdtp:function(i){var l,d={version:i[0],flags:new Uint8Array(i.subarray(1,4)),samples:[]};for(l=4;l<i.byteLength;l++)d.samples.push({dependsOn:(48&i[l])>>4,isDependedOn:(12&i[l])>>2,hasRedundancy:3&i[l]});return d},sidx:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength),d={version:i[0],flags:new Uint8Array(i.subarray(1,4)),references:[],referenceId:l.getUint32(4),timescale:l.getUint32(8)},u=12;0===d.version?(d.earliestPresentationTime=l.getUint32(u),d.firstOffset=l.getUint32(u+4),u+=8):(d.earliestPresentationTime=Mt(i.subarray(u)),d.firstOffset=Mt(i.subarray(u+8)),u+=16);var c=l.getUint16(u+=2);for(u+=2;c>0;u+=12,c--)d.references.push({referenceType:(128&i[u])>>>7,referencedSize:2147483647&l.getUint32(u),subsegmentDuration:l.getUint32(u+4),startsWithSap:!!(128&i[u+8]),sapType:(112&i[u+8])>>>4,sapDeltaTime:268435455&l.getUint32(u+8)});return d},smhd:function(i){return{version:i[0],flags:new Uint8Array(i.subarray(1,4)),balance:i[4]+i[5]/256}},stbl:function(i){return{boxes:At(i)}},ctts:function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u={version:d.getUint8(0),flags:new Uint8Array(i.subarray(1,4)),compositionOffsets:[]},c=d.getUint32(4);for(l=8;c;l+=8,c--)u.compositionOffsets.push({sampleCount:d.getUint32(l),sampleOffset:d[0===u.version?"getUint32":"getInt32"](l+4)});return u},stss:function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u={version:d.getUint8(0),flags:new Uint8Array(i.subarray(1,4)),syncSamples:[]},c=d.getUint32(4);for(l=8;c;l+=4,c--)u.syncSamples.push(d.getUint32(l));return u},stco:function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u={version:i[0],flags:new Uint8Array(i.subarray(1,4)),chunkOffsets:[]},c=d.getUint32(4);for(l=8;c;l+=4,c--)u.chunkOffsets.push(d.getUint32(l));return u},stsc:function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u=d.getUint32(4),c={version:i[0],flags:new Uint8Array(i.subarray(1,4)),sampleToChunks:[]};for(l=8;u;l+=12,u--)c.sampleToChunks.push({firstChunk:d.getUint32(l),samplesPerChunk:d.getUint32(l+4),sampleDescriptionIndex:d.getUint32(l+8)});return c},stsd:function(i){return{version:i[0],flags:new Uint8Array(i.subarray(1,4)),sampleDescriptions:At(i.subarray(8))}},stsz:function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u={version:i[0],flags:new Uint8Array(i.subarray(1,4)),sampleSize:d.getUint32(4),entries:[]};for(l=12;l<i.byteLength;l+=4)u.entries.push(d.getUint32(l));return u},stts:function(i){var l,d=new DataView(i.buffer,i.byteOffset,i.byteLength),u={version:i[0],flags:new Uint8Array(i.subarray(1,4)),timeToSamples:[]},c=d.getUint32(4);for(l=8;c;l+=8,c--)u.timeToSamples.push({sampleCount:d.getUint32(l),sampleDelta:d.getUint32(l+4)});return u},styp:function(i){return Bt.ftyp(i)},tfdt:parseTfdt$3,tfhd:parseTfhd$2,tkhd:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength),d=4,u={version:l.getUint8(0),flags:new Uint8Array(i.subarray(1,4))};return 1===u.version?(u.creationTime=parseMp4Date(l.getUint32(d+=4)),u.modificationTime=parseMp4Date(l.getUint32(d+=8)),u.trackId=l.getUint32(d+=4),d+=4,u.duration=l.getUint32(d+=8)):(u.creationTime=parseMp4Date(l.getUint32(d)),u.modificationTime=parseMp4Date(l.getUint32(d+=4)),u.trackId=l.getUint32(d+=4),d+=4,u.duration=l.getUint32(d+=4)),d+=4,u.layer=l.getUint16(d+=8),u.alternateGroup=l.getUint16(d+=2),u.volume=l.getUint8(d+=2)+l.getUint8(d+1)/8,d+=2,d+=2,u.matrix=new Uint32Array(i.subarray(d,d+36)),u.width=l.getUint16(d+=36)+l.getUint16(d+2)/65536,u.height=l.getUint16(d+=4)+l.getUint16(d+2)/65536,u},traf:function(i){return{boxes:At(i)}},trak:function(i){return{boxes:At(i)}},trex:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength);return{version:i[0],flags:new Uint8Array(i.subarray(1,4)),trackId:l.getUint32(4),defaultSampleDescriptionIndex:l.getUint32(8),defaultSampleDuration:l.getUint32(12),defaultSampleSize:l.getUint32(16),sampleDependsOn:3&i[20],sampleIsDependedOn:(192&i[21])>>6,sampleHasRedundancy:(48&i[21])>>4,samplePaddingValue:(14&i[21])>>1,sampleIsDifferenceSample:!!(1&i[21]),sampleDegradationPriority:l.getUint16(22)}},trun:parseTrun$2,"url ":function(i){return{version:i[0],flags:new Uint8Array(i.subarray(1,4))}},vmhd:function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength);return{version:i[0],flags:new Uint8Array(i.subarray(1,4)),graphicsmode:l.getUint16(4),opcolor:new Uint16Array([l.getUint16(6),l.getUint16(8),l.getUint16(10)])}}};At=function(i){for(var l,d,u,c,h,p=0,m=[],g=new ArrayBuffer(i.length),y=new Uint8Array(g),_=0;_<i.length;++_)y[_]=i[_];for(l=new DataView(g);p<i.byteLength;)d=l.getUint32(p),u=Ut(i.subarray(p+4,p+8)),(h=(Bt[u]||function(i){return{data:i}})(i.subarray(p+8,c=d>1?p+d:i.byteLength))).size=d,h.type=u,m.push(h),p=c;return m},Pt=function(i,l){var d;return l=l||0,d=new Array(2*l+1).join(" "),i.map((function(i,u){return d+i.type+"\n"+Object.keys(i).filter((function(i){return"type"!==i&&"boxes"!==i})).map((function(l){var u=d+"  "+l+": ",c=i[l];if(c instanceof Uint8Array||c instanceof Uint32Array){var h=Array.prototype.slice.call(new Uint8Array(c.buffer,c.byteOffset,c.byteLength)).map((function(i){return" "+("00"+i.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);return h?1===h.length?u+"<"+h.join("").slice(1)+">":u+"<\n"+h.map((function(i){return d+"  "+i})).join("\n")+"\n"+d+"  >":u+"<>"}return u+JSON.stringify(c,null,2).split("\n").map((function(i,l){return 0===l?i:d+"  "+i})).join("\n")})).join("\n")+(i.boxes?"\n"+Pt(i.boxes,l+1):"")})).join("\n")};var Ft,jt,qt,Ht,$t,zt,Gt,Wt={inspect:At,textify:Pt,parseType:Ut,findBox:Lt,parseTraf:Bt.traf,parseTfdt:Bt.tfdt,parseHdlr:Bt.hdlr,parseTfhd:Bt.tfhd,parseTrun:Bt.trun,parseSidx:Bt.sidx},uint8ToCString=function(i){for(var l=0,d=String.fromCharCode(i[l]),u="";"\0"!==d;)u+=d,l++,d=String.fromCharCode(i[l]);return u+=d},Xt=ie.getUint64,isValidEmsgBox=function(i,l){var d="\0"!==l.scheme_id_uri,u=0===i&&isDefined(l.presentation_time_delta)&&d,c=1===i&&isDefined(l.presentation_time)&&d;return!(i>1)&&u||c},isDefined=function(i){return void 0!==i||null!==i},Kt={parseEmsgBox:function(i){var l,d,u,c,h,p,m,g=4,y=i[0];if(0===y)g+=(l=uint8ToCString(i.subarray(g))).length,g+=(d=uint8ToCString(i.subarray(g))).length,u=(_=new DataView(i.buffer)).getUint32(g),h=_.getUint32(g+=4),p=_.getUint32(g+=4),m=_.getUint32(g+=4),g+=4;else if(1===y){var _;u=(_=new DataView(i.buffer)).getUint32(g),c=Xt(i.subarray(g+=4)),p=_.getUint32(g+=8),m=_.getUint32(g+=4),g+=4,g+=(l=uint8ToCString(i.subarray(g))).length,g+=(d=uint8ToCString(i.subarray(g))).length}var v={scheme_id_uri:l,value:d,timescale:u||1,presentation_time:c,presentation_time_delta:h,event_duration:p,id:m,message_data:new Uint8Array(i.subarray(g,i.byteLength))};return isValidEmsgBox(y,v)?v:void 0},scaleTime:function(i,l,d,u){return i||0===i?i/l:u+d/l}},Yt="undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{},Qt=bin_toUnsigned,toHexString=function(i){return("00"+i.toString(16)).slice(-2)},Jt=Lt,Zt=parseType_1,ei=Kt,ti=parseTfhd$2,ii=parseTrun$2,ri=parseTfdt$3,si=ie.getUint64,ni=Yt,ai=Me.parseId3Frames;Ft=function(i){return Jt(i,["moov","trak"]).reduce((function(i,l){var d,u,c,h;return(d=Jt(l,["tkhd"])[0])?(c=Qt(d[u=0===d[0]?12:20]<<24|d[u+1]<<16|d[u+2]<<8|d[u+3]),(h=Jt(l,["mdia","mdhd"])[0])?(i[c]=Qt(h[u=0===h[0]?12:20]<<24|h[u+1]<<16|h[u+2]<<8|h[u+3]),i):null):null}),{})},jt=function(i,l){var d=Jt(l,["moof","traf"]).reduce((function(l,d){var u,c=Jt(d,["tfhd"])[0],h=Qt(c[4]<<24|c[5]<<16|c[6]<<8|c[7]),p=i[h]||9e4,m=Jt(d,["tfdt"])[0],g=new DataView(m.buffer,m.byteOffset,m.byteLength);let y;return"bigint"==typeof(u=1===m[0]?si(m.subarray(4,12)):g.getUint32(4))?y=u/ni.BigInt(p):"number"!=typeof u||isNaN(u)||(y=u/p),y<Number.MAX_SAFE_INTEGER&&(y=Number(y)),y<l&&(l=y),l}),1/0);return"bigint"==typeof d||isFinite(d)?d:0},qt=function(i,l){var d,u=Jt(l,["moof","traf"]),c=0,h=0;if(u&&u.length){var p=Jt(u[0],["tfhd"])[0],m=Jt(u[0],["trun"])[0],g=Jt(u[0],["tfdt"])[0];if(p)d=ti(p).trackId;if(g)c=ri(g).baseMediaDecodeTime;if(m){var y=ii(m);y.samples&&y.samples.length&&(h=y.samples[0].compositionTimeOffset||0)}}var _=i[d]||9e4;"bigint"==typeof c&&(h=ni.BigInt(h),_=ni.BigInt(_));var v=(c+h)/_;return"bigint"==typeof v&&v<Number.MAX_SAFE_INTEGER&&(v=Number(v)),v},Ht=function(i){var l=Jt(i,["moov","trak"]),d=[];return l.forEach((function(i){var l=Jt(i,["mdia","hdlr"]),u=Jt(i,["tkhd"]);l.forEach((function(i,l){var c,h,p,m=Zt(i.subarray(8,12)),g=u[l];"vide"===m&&(h=(c=new DataView(g.buffer,g.byteOffset,g.byteLength)).getUint8(0),p=c.getUint32(0===h?12:20),d.push(p))}))})),d},zt=function(i){var l=0===i[0]?12:20;return Qt(i[l]<<24|i[l+1]<<16|i[l+2]<<8|i[l+3])},$t=function(i){var l=Jt(i,["moov","trak"]),d=[];return l.forEach((function(i){var l,u,c={},h=Jt(i,["tkhd"])[0];h&&(u=(l=new DataView(h.buffer,h.byteOffset,h.byteLength)).getUint8(0),c.id=l.getUint32(0===u?12:20));var p=Jt(i,["mdia","hdlr"])[0];if(p){var m=Zt(p.subarray(8,12));c.type="vide"===m?"video":"soun"===m?"audio":m}var g=Jt(i,["mdia","minf","stbl","stsd"])[0];if(g){var y=g.subarray(8);c.codec=Zt(y.subarray(4,8));var _,v=Jt(y,[c.codec])[0];v&&(/^[asm]vc[1-9]$/i.test(c.codec)?(_=v.subarray(78),"avcC"===Zt(_.subarray(4,8))&&_.length>11?(c.codec+=".",c.codec+=toHexString(_[9]),c.codec+=toHexString(_[10]),c.codec+=toHexString(_[11])):c.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(c.codec)?(_=v.subarray(28),"esds"===Zt(_.subarray(4,8))&&_.length>20&&0!==_[19]?(c.codec+="."+toHexString(_[19]),c.codec+="."+toHexString(_[20]>>>2&63).replace(/^0/,"")):c.codec="mp4a.40.2"):c.codec=c.codec.toLowerCase())}var b=Jt(i,["mdia","mdhd"])[0];b&&(c.timescale=zt(b)),d.push(c)})),d},Gt=function(i,l=0){return Jt(i,["emsg"]).map((i=>{var d=ei.parseEmsgBox(new Uint8Array(i)),u=ai(d.message_data);return{cueTime:ei.scaleTime(d.presentation_time,d.timescale,d.presentation_time_delta,l),duration:ei.scaleTime(d.event_duration,d.timescale),frames:u}}))};var oi={findBox:Jt,parseType:Zt,timescale:Ft,startTime:jt,compositionStartTime:qt,videoTrackIds:Ht,tracks:$t,getTimescaleFromMediaHeader:zt,getEmsgID3:Gt};const{parseTrun:li}=Wt,{findBox:di}=oi;var ui=Yt,ci={getMdatTrafPairs:function(i){var l=di(i,["moof","traf"]),d=di(i,["mdat"]),u=[];return d.forEach((function(i,d){u.push({mdat:i,traf:l[d]})})),u},parseSamples:function(i,l,d){var u=l,c=d.defaultSampleDuration||0,h=d.defaultSampleSize||0,p=d.trackId,m=[];return i.forEach((function(i){var l=li(i).samples;l.forEach((function(i){void 0===i.duration&&(i.duration=c),void 0===i.size&&(i.size=h),i.trackId=p,i.dts=u,void 0===i.compositionTimeOffset&&(i.compositionTimeOffset=0),"bigint"==typeof u?(i.pts=u+ui.BigInt(i.compositionTimeOffset),u+=ui.BigInt(i.duration)):(i.pts=u+i.compositionTimeOffset,u+=i.duration)})),m=m.concat(l)})),m}},hi=Se.discardEmulationPreventionBytes,pi=Ae.CaptionStream,mi=Lt,fi=parseTfdt$3,gi=parseTfhd$2,{getMdatTrafPairs:yi,parseSamples:_i}=ci,mapToSample=function(i,l){for(var d=i,u=0;u<l.length;u++){var c=l[u];if(d<c.size)return c;d-=c.size}return null},parseCaptionNals=function(i,l){var d={};return yi(i).forEach((function(i){var u,c=i.mdat,h=i.traf,p=mi(h,["tfhd"]),m=gi(p[0]),g=m.trackId,y=mi(h,["tfdt"]),_=y.length>0?fi(y[0]).baseMediaDecodeTime:0,v=mi(h,["trun"]);l===g&&v.length>0&&(u=function(i,l,d){var u,c,h,p,m=new DataView(i.buffer,i.byteOffset,i.byteLength),g={logs:[],seiNals:[]};for(c=0;c+4<i.length;c+=h)if(h=m.getUint32(c),c+=4,!(h<=0))switch(31&i[c]){case 6:var y=i.subarray(c+1,c+1+h),_=mapToSample(c,l);if(u={nalUnitType:"sei_rbsp",size:h,data:y,escapedRBSP:hi(y),trackId:d},_)u.pts=_.pts,u.dts=_.dts,p=_;else{if(!p){g.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+c+" for trackId "+d+". See mux.js#223."});break}u.pts=p.pts,u.dts=p.dts}g.seiNals.push(u)}return g}(c,_i(v,_,m),g),d[g]||(d[g]={seiNals:[],logs:[]}),d[g].seiNals=d[g].seiNals.concat(u.seiNals),d[g].logs=d[g].logs.concat(u.logs))})),d},captionParser=function(){var i,l,d,u,c,h,p=!1;this.isInitialized=function(){return p},this.init=function(l){i=new pi,p=!0,h=!!l&&l.isPartial,i.on("data",(function(i){i.startTime=i.startPts/u,i.endTime=i.endPts/u,c.captions.push(i),c.captionStreams[i.stream]=!0})),i.on("log",(function(i){c.logs.push(i)}))},this.isNewInit=function(i,l){return!(i&&0===i.length||l&&"object"==typeof l&&0===Object.keys(l).length)&&(d!==i[0]||u!==l[d])},this.parse=function(i,h,p){var m;if(!this.isInitialized())return null;if(!h||!p)return null;if(this.isNewInit(h,p))u=p[d=h[0]];else if(null===d||!u)return l.push(i),null;for(;l.length>0;){var g=l.shift();this.parse(g,h,p)}return m=function(i,l,d){if(null===l)return null;var u=parseCaptionNals(i,l)[l]||{};return{seiNals:u.seiNals,logs:u.logs,timescale:d}}(i,d,u),m&&m.logs&&(c.logs=c.logs.concat(m.logs)),null!==m&&m.seiNals?(this.pushNals(m.seiNals),this.flushStream(),c):c.logs.length?{logs:c.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(l){if(!this.isInitialized()||!l||0===l.length)return null;l.forEach((function(l){i.push(l)}))},this.flushStream=function(){if(!this.isInitialized())return null;h?i.partialFlush():i.flush()},this.clearParsedCaptions=function(){c.captions=[],c.captionStreams={},c.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;i.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){l=[],d=null,u=null,c?this.clearParsedCaptions():c={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()};const{parseTfdt:vi}=Wt,bi=Lt,{getTimescaleFromMediaHeader:Ti}=oi,{parseSamples:Si,getMdatTrafPairs:Ei}=ci;var webvttParser=function(){let i=9e4;this.init=function(l){const d=bi(l,["moov","trak","mdia","mdhd"])[0];d&&(i=Ti(d))},this.parseSegment=function(l){const d=[],u=Ei(l);let c=0;return u.forEach((function(l){const u=l.mdat,h=l.traf,p=bi(h,["tfdt"])[0],m=bi(h,["tfhd"])[0],g=bi(h,["trun"]);if(p){const i=vi(p);c=i.baseMediaDecodeTime}if(g.length&&m){const l=Si(g,c,m);let h=0;l.forEach((function(l){const c=new TextDecoder("utf-8"),p=u.slice(h,h+l.size);if(bi(p,["vtte"])[0])return h+=l.size,void 0;bi(p,["vttc"]).forEach((function(u){const h=bi(u,["payl"])[0],p=bi(u,["sttg"])[0],m=l.pts/i,g=(l.pts+l.duration)/i;let y,_;if(h)try{y=c.decode(h)}catch(i){console.error(i)}if(p)try{_=c.decode(p)}catch(i){console.error(i)}l.duration&&y&&d.push({cueText:y,start:m,end:g,settings:_})})),h+=l.size}))}})),d}},ki=Pe,parsePid=function(i){var l=31&i[1];return l<<=8,l|=i[2]},parsePayloadUnitStartIndicator=function(i){return!!(64&i[1])},parseAdaptionField=function(i){var l=0;return(48&i[3])>>>4>1&&(l+=i[4]+1),l},parseNalUnitType=function(i){switch(i){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},wi=Pe,Ci=Oe.handleRollover,xi={};xi.ts={parseType:function(i,l){var d=parsePid(i);return 0===d?"pat":d===l?"pmt":l?"pes":null},parsePat:function(i){var l=parsePayloadUnitStartIndicator(i),d=4+parseAdaptionField(i);return l&&(d+=i[d]+1),(31&i[d+10])<<8|i[d+11]},parsePmt:function(i){var l={},d=parsePayloadUnitStartIndicator(i),u=4+parseAdaptionField(i);if(d&&(u+=i[u]+1),1&i[u+5]){var c;c=3+((15&i[u+1])<<8|i[u+2])-4;for(var h=12+((15&i[u+10])<<8|i[u+11]);h<c;){var p=u+h;l[(31&i[p+1])<<8|i[p+2]]=i[p],h+=5+((15&i[p+3])<<8|i[p+4])}return l}},parsePayloadUnitStartIndicator,parsePesType:function(i,l){switch(l[parsePid(i)]){case ki.H264_STREAM_TYPE:return"video";case ki.ADTS_STREAM_TYPE:return"audio";case ki.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(i){if(!parsePayloadUnitStartIndicator(i))return null;var l=4+parseAdaptionField(i);if(l>=i.byteLength)return null;var d,u=null;return 192&(d=i[l+7])&&((u={}).pts=(14&i[l+9])<<27|(255&i[l+10])<<20|(254&i[l+11])<<12|(255&i[l+12])<<5|(254&i[l+13])>>>3,u.pts*=4,u.pts+=(6&i[l+13])>>>1,u.dts=u.pts,64&d&&(u.dts=(14&i[l+14])<<27|(255&i[l+15])<<20|(254&i[l+16])<<12|(255&i[l+17])<<5|(254&i[l+18])>>>3,u.dts*=4,u.dts+=(6&i[l+18])>>>1)),u},videoPacketContainsKeyFrame:function(i){for(var l=4+parseAdaptionField(i),d=i.subarray(l),u=0,c=0,h=!1;c<d.byteLength-3;c++)if(1===d[c+2]){u=c+5;break}for(;u<d.byteLength;)switch(d[u]){case 0:if(0!==d[u-1]){u+=2;break}if(0!==d[u-2]){u++;break}c+3!==u-2&&"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&d[c+3])&&(h=!0);do{u++}while(1!==d[u]&&u<d.length);c=u-2,u+=3;break;case 1:if(0!==d[u-1]||0!==d[u-2]){u+=3;break}"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&d[c+3])&&(h=!0),c=u-2,u+=3;break;default:u+=3}return d=d.subarray(c),u-=c,c=0,d&&d.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&d[c+3])&&(h=!0),h}},xi.aac=lt;var Ai=ye.ONE_SECOND_IN_TS,Pi=188,Ii=71,parseAudioPes_=function(i,l,d){for(var u,c,h,p,m=0,g=Pi,y=!1;g<=i.byteLength;)if(i[m]!==Ii||i[g]!==Ii&&g!==i.byteLength)m++,g++;else{if(u=i.subarray(m,g),"pes"===xi.ts.parseType(u,l.pid))c=xi.ts.parsePesType(u,l.table),h=xi.ts.parsePayloadUnitStartIndicator(u),"audio"===c&&h&&(p=xi.ts.parsePesTime(u))&&(p.type="audio",d.audio.push(p),y=!0);if(y)break;m+=Pi,g+=Pi}for(m=(g=i.byteLength)-Pi,y=!1;m>=0;)if(i[m]!==Ii||i[g]!==Ii&&g!==i.byteLength)m--,g--;else{if(u=i.subarray(m,g),"pes"===xi.ts.parseType(u,l.pid))c=xi.ts.parsePesType(u,l.table),h=xi.ts.parsePayloadUnitStartIndicator(u),"audio"===c&&h&&(p=xi.ts.parsePesTime(u))&&(p.type="audio",d.audio.push(p),y=!0);if(y)break;m-=Pi,g-=Pi}},parseVideoPes_=function(i,l,d){for(var u,c,h,p,m,g,y,_=0,v=Pi,b=!1,T={data:[],size:0};v<i.byteLength;)if(i[_]!==Ii||i[v]!==Ii)_++,v++;else{if(u=i.subarray(_,v),"pes"===xi.ts.parseType(u,l.pid))if(c=xi.ts.parsePesType(u,l.table),h=xi.ts.parsePayloadUnitStartIndicator(u),"video"===c&&(h&&!b&&(p=xi.ts.parsePesTime(u))&&(p.type="video",d.video.push(p),b=!0),!d.firstKeyFrame)){if(h&&0!==T.size){for(m=new Uint8Array(T.size),g=0;T.data.length;)y=T.data.shift(),m.set(y,g),g+=y.byteLength;if(xi.ts.videoPacketContainsKeyFrame(m)){var S=xi.ts.parsePesTime(m);S?(d.firstKeyFrame=S,d.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}T.size=0}T.data.push(u),T.size+=u.byteLength}if(b&&d.firstKeyFrame)break;_+=Pi,v+=Pi}for(_=(v=i.byteLength)-Pi,b=!1;_>=0;)if(i[_]!==Ii||i[v]!==Ii)_--,v--;else{if(u=i.subarray(_,v),"pes"===xi.ts.parseType(u,l.pid))c=xi.ts.parsePesType(u,l.table),h=xi.ts.parsePayloadUnitStartIndicator(u),"video"===c&&h&&(p=xi.ts.parsePesTime(u))&&(p.type="video",d.video.push(p),b=!0);if(b)break;_-=Pi,v-=Pi}},inspectTs_=function(i){var l={pid:null,table:null},d={};for(var u in!function(i,l){for(var d,u=0,c=Pi;c<i.byteLength;)if(i[u]!==Ii||i[c]!==Ii)u++,c++;else{switch(d=i.subarray(u,c),xi.ts.parseType(d,l.pid)){case"pat":l.pid=xi.ts.parsePat(d);break;case"pmt":var h=xi.ts.parsePmt(d);l.table=l.table||{},Object.keys(h).forEach((function(i){l.table[i]=h[i]}))}u+=Pi,c+=Pi}}(i,l),l.table){if(l.table.hasOwnProperty(u))switch(l.table[u]){case wi.H264_STREAM_TYPE:d.video=[],parseVideoPes_(i,l,d),0===d.video.length&&delete d.video;break;case wi.ADTS_STREAM_TYPE:d.audio=[],parseAudioPes_(i,l,d),0===d.audio.length&&delete d.audio}}return d},tsInspector_inspect=function(i,l){var d;return d=xi.aac.isLikelyAacData(i)?function(i){for(var l,d=!1,u=0,c=null,h=null,p=0,m=0;i.length-m>=3;){switch(xi.aac.parseType(i,m)){case"timed-metadata":if(i.length-m<10){d=!0;break}if((p=xi.aac.parseId3TagSize(i,m))>i.length){d=!0;break}null===h&&(l=i.subarray(m,m+p),h=xi.aac.parseAacTimestamp(l)),m+=p;break;case"audio":if(i.length-m<7){d=!0;break}if((p=xi.aac.parseAdtsSize(i,m))>i.length){d=!0;break}null===c&&(l=i.subarray(m,m+p),c=xi.aac.parseSampleRate(l)),u++,m+=p;break;default:m++}if(d)return null}if(null===c||null===h)return null;var g=Ai/c;return{audio:[{type:"audio",dts:h,pts:h},{type:"audio",dts:h+1024*u*g,pts:h+1024*u*g}]}}(i):inspectTs_(i),d&&(d.audio||d.video)?(!function(i,l){if(i.audio&&i.audio.length){var d=l;(void 0===d||isNaN(d))&&(d=i.audio[0].dts),i.audio.forEach((function(i){i.dts=Ci(i.dts,d),i.pts=Ci(i.pts,d),i.dtsTime=i.dts/Ai,i.ptsTime=i.pts/Ai}))}if(i.video&&i.video.length){var u=l;if((void 0===u||isNaN(u))&&(u=i.video[0].dts),i.video.forEach((function(i){i.dts=Ci(i.dts,u),i.pts=Ci(i.pts,u),i.dtsTime=i.dts/Ai,i.ptsTime=i.pts/Ai})),i.firstKeyFrame){var c=i.firstKeyFrame;c.dts=Ci(c.dts,u),c.pts=Ci(c.pts,u),c.dtsTime=c.dts/Ai,c.ptsTime=c.pts/Ai}}}(d,l),d):null};class MessageHandlers{constructor(i,l){this.options=l||{},this.self=i,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new It.Transmuxer(this.options),function(i,l){l.on("data",(function(l){const d=l.initSegment;l.initSegment={data:d.buffer,byteOffset:d.byteOffset,byteLength:d.byteLength};const u=l.data;l.data=u.buffer,i.postMessage({action:"data",segment:l,byteOffset:u.byteOffset,byteLength:u.byteLength},[l.data])})),l.on("done",(function(l){i.postMessage({action:"done"})})),l.on("gopInfo",(function(l){i.postMessage({action:"gopInfo",gopInfo:l})})),l.on("videoSegmentTimingInfo",(function(l){const d={start:{decode:ye.videoTsToSeconds(l.start.dts),presentation:ye.videoTsToSeconds(l.start.pts)},end:{decode:ye.videoTsToSeconds(l.end.dts),presentation:ye.videoTsToSeconds(l.end.pts)},baseMediaDecodeTime:ye.videoTsToSeconds(l.baseMediaDecodeTime)};l.prependedContentDuration&&(d.prependedContentDuration=ye.videoTsToSeconds(l.prependedContentDuration)),i.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:d})})),l.on("audioSegmentTimingInfo",(function(l){const d={start:{decode:ye.videoTsToSeconds(l.start.dts),presentation:ye.videoTsToSeconds(l.start.pts)},end:{decode:ye.videoTsToSeconds(l.end.dts),presentation:ye.videoTsToSeconds(l.end.pts)},baseMediaDecodeTime:ye.videoTsToSeconds(l.baseMediaDecodeTime)};l.prependedContentDuration&&(d.prependedContentDuration=ye.videoTsToSeconds(l.prependedContentDuration)),i.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:d})})),l.on("id3Frame",(function(l){i.postMessage({action:"id3Frame",id3Frame:l})})),l.on("caption",(function(l){i.postMessage({action:"caption",caption:l})})),l.on("trackinfo",(function(l){i.postMessage({action:"trackinfo",trackInfo:l})})),l.on("audioTimingInfo",(function(l){i.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:ye.videoTsToSeconds(l.start),end:ye.videoTsToSeconds(l.end)}})})),l.on("videoTimingInfo",(function(l){i.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:ye.videoTsToSeconds(l.start),end:ye.videoTsToSeconds(l.end)}})})),l.on("log",(function(l){i.postMessage({action:"log",log:l})}))}(this.self,this.transmuxer)}pushMp4Captions(i){this.captionParser||(this.captionParser=new captionParser,this.captionParser.init());const l=new Uint8Array(i.data,i.byteOffset,i.byteLength),d=this.captionParser.parse(l,i.trackIds,i.timescales);this.self.postMessage({action:"mp4Captions",captions:d&&d.captions||[],logs:d&&d.logs||[],data:l.buffer},[l.buffer])}initMp4WebVttParser(i){this.webVttParser||(this.webVttParser=new webvttParser);const l=new Uint8Array(i.data,i.byteOffset,i.byteLength);this.webVttParser.init(l)}getMp4WebVttText(i){this.webVttParser||(this.webVttParser=new webvttParser);const l=new Uint8Array(i.data,i.byteOffset,i.byteLength),d=this.webVttParser.parseSegment(l);this.self.postMessage({action:"getMp4WebVttText",mp4VttCues:d||[],data:l.buffer},[l.buffer])}probeMp4StartTime({timescales:i,data:l}){const d=oi.startTime(i,l);this.self.postMessage({action:"probeMp4StartTime",startTime:d,data:l},[l.buffer])}probeMp4Tracks({data:i}){const l=oi.tracks(i);this.self.postMessage({action:"probeMp4Tracks",tracks:l,data:i},[i.buffer])}probeEmsgID3({data:i,offset:l}){const d=oi.getEmsgID3(i,l);this.self.postMessage({action:"probeEmsgID3",id3Frames:d,emsgData:i},[i.buffer])}probeTs({data:i,baseStartTime:l}){const d="number"!=typeof l||isNaN(l)?void 0:l*ye.ONE_SECOND_IN_TS,u=tsInspector_inspect(i,d);let c=null;u&&(c={hasVideo:u.video&&2===u.video.length||!1,hasAudio:u.audio&&2===u.audio.length||!1},c.hasVideo&&(c.videoStart=u.video[0].ptsTime),c.hasAudio&&(c.audioStart=u.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:c,data:i},[i.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(i){const l=new Uint8Array(i.data,i.byteOffset,i.byteLength);this.transmuxer.push(l)}reset(){this.transmuxer.reset()}setTimestampOffset(i){this.transmuxer.setBaseMediaDecodeTime(Math.round(ye.secondsToVideoTs(i.timestampOffset||0)))}setAudioAppendStart(i){this.transmuxer.setAudioAppendStart(Math.ceil(ye.secondsToVideoTs(i.appendStart)))}setRemux(i){this.transmuxer.setRemux(i.remux)}flush(i){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(i){this.transmuxer.alignGopsWith(i.gopsToAlignWith.slice())}}self.onmessage=function(i){if("init"===i.data.action&&i.data.options)return this.messageHandlers=new MessageHandlers(self,i.data.options),void 0;this.messageHandlers||(this.messageHandlers=new MessageHandlers(self)),i.data&&i.data.action&&"init"!==i.data.action&&this.messageHandlers[i.data.action]&&this.messageHandlers[i.data.action](i.data)}})));var qi=factory(ji);const processTransmux=i=>{const{transmuxer:l,bytes:d,audioAppendStart:u,gopsToAlignWith:c,remux:h,onData:p,onTrackInfo:m,onAudioTimingInfo:g,onVideoTimingInfo:y,onVideoSegmentTimingInfo:_,onAudioSegmentTimingInfo:v,onId3:b,onCaptions:T,onDone:S,onEndedTimeline:E,onTransmuxerLog:k,isEndOfTimeline:w,segment:C,triggerSegmentEventFn:x}=i,A={buffer:[]};let P=w;if(l.onmessage=d=>{l.currentTransmux===i&&("data"===d.data.action&&((i,l,d)=>{const{type:u,initSegment:c,captions:h,captionStreams:p,metadata:m,videoFrameDtsTime:g,videoFramePtsTime:y}=i.data.segment;l.buffer.push({captions:h,captionStreams:p,metadata:m});const _=i.data.segment.boxes||{data:i.data.segment.data},v={type:u,data:new Uint8Array(_.data,_.data.byteOffset,_.data.byteLength),initSegment:new Uint8Array(c.data,c.byteOffset,c.byteLength)};void 0!==g&&(v.videoFrameDtsTime=g),void 0!==y&&(v.videoFramePtsTime=y),d(v)})(d,A,p),"trackinfo"===d.data.action&&m(d.data.trackInfo),"gopInfo"===d.data.action&&((i,l)=>{l.gopInfo=i.data.gopInfo})(d,A),"audioTimingInfo"===d.data.action&&g(d.data.audioTimingInfo),"videoTimingInfo"===d.data.action&&y(d.data.videoTimingInfo),"videoSegmentTimingInfo"===d.data.action&&_(d.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===d.data.action&&v(d.data.audioSegmentTimingInfo),"id3Frame"===d.data.action&&b([d.data.id3Frame],d.data.id3Frame.dispatchType),"caption"===d.data.action&&T(d.data.caption),"endedtimeline"===d.data.action&&(P=!1,E()),"log"===d.data.action&&k(d.data.log),"transmuxed"===d.data.type&&(P||(l.onmessage=null,(({transmuxedData:i,callback:l})=>{i.buffer=[],l(i)})({transmuxedData:A,callback:S}),dequeue(l))))},l.onerror=()=>{const i={message:"Received an error message from the transmuxer worker",metadata:{errorType:videojs.Error.StreamingFailedToTransmuxSegment,segmentInfo:segmentInfoPayload({segment:C})}};S(null,i)},u&&l.postMessage({action:"setAudioAppendStart",appendStart:u}),Array.isArray(c)&&l.postMessage({action:"alignGopsWith",gopsToAlignWith:c}),void 0!==h&&l.postMessage({action:"setRemux",remux:h}),d.byteLength){const i=d instanceof ArrayBuffer?d:d.buffer,u=d instanceof ArrayBuffer?0:d.byteOffset;x({type:"segmenttransmuxingstart",segment:C}),l.postMessage({action:"push",data:i,byteOffset:u,byteLength:d.byteLength},[i])}w&&l.postMessage({action:"endTimeline"}),l.postMessage({action:"flush"})},dequeue=i=>{i.currentTransmux=null,i.transmuxQueue.length&&(i.currentTransmux=i.transmuxQueue.shift(),"function"==typeof i.currentTransmux?i.currentTransmux():processTransmux(i.currentTransmux))},processAction=(i,l)=>{i.postMessage({action:l}),dequeue(i)},enqueueAction=(i,l)=>{if(!l.currentTransmux)return l.currentTransmux=i,processAction(l,i),void 0;l.transmuxQueue.push(processAction.bind(null,l,i))},transmux=i=>{if(!i.transmuxer.currentTransmux)return i.transmuxer.currentTransmux=i,processTransmux(i),void 0;i.transmuxer.transmuxQueue.push(i)};var segmentTransmuxer_reset=i=>{enqueueAction("reset",i)},segmentTransmuxer_createTransmuxer=i=>{const l=new qi;l.currentTransmux=null,l.transmuxQueue=[];const d=l.terminate;return l.terminate=()=>(l.currentTransmux=null,l.transmuxQueue.length=0,d.call(l)),l.postMessage({action:"init",options:i}),l};const workerCallback=function(i){const l=i.transmuxer,d=i.endAction||i.action,u=i.callback,c=_extends({},i,{endAction:null,transmuxer:null,callback:null}),listenForEndEvent=c=>{c.data.action===d&&(l.removeEventListener("message",listenForEndEvent),c.data.data&&(c.data.data=new Uint8Array(c.data.data,i.byteOffset||0,i.byteLength||c.data.data.byteLength),i.data&&(i.data=c.data.data)),u(c.data))};if(l.addEventListener("message",listenForEndEvent),i.data){const d=i.data instanceof ArrayBuffer;c.byteOffset=d?0:i.data.byteOffset,c.byteLength=i.data.byteLength;l.postMessage(c,[d?i.data:i.data.buffer])}else l.postMessage(c)},Hi=2,$i=-101,zi=-102,Gi="wvtt",abortAll=i=>{i.forEach((i=>{i.abort()}))},handleErrors=(i,l)=>{const{requestType:d}=l,u=getStreamingNetworkErrorMetadata({requestType:d,request:l,error:i});return l.timedout?{status:l.status,message:"HLS request timed-out at URL: "+l.uri,code:$i,xhr:l,metadata:u}:l.aborted?{status:l.status,message:"HLS request aborted at URL: "+l.uri,code:zi,xhr:l,metadata:u}:i?{status:l.status,message:"HLS request errored at URL: "+l.uri,code:Hi,xhr:l,metadata:u}:"arraybuffer"===l.responseType&&0===l.response.byteLength?{status:l.status,message:"Empty HLS response at URL: "+l.uri,code:Hi,xhr:l,metadata:u}:null},handleKeyResponse=(i,l,d,u)=>(c,h)=>{const p=h.response,m=handleErrors(c,h);if(m)return d(m,i);if(16!==p.byteLength)return d({status:h.status,message:"Invalid HLS key at URL: "+h.uri,code:Hi,xhr:h},i);const g=new DataView(p),y=new Uint32Array([g.getUint32(0),g.getUint32(4),g.getUint32(8),g.getUint32(12)]);for(let i=0;i<l.length;i++)l[i].bytes=y;return u({type:"segmentkeyloadcomplete",segment:i,keyInfo:{uri:h.uri}}),d(null,i)},parseInitSegment=(i,l)=>{const d=Ve(i.map.bytes);if("mp4"!==d){const u=d||"unknown";return l({internal:!0,message:`Found unsupported ${u} container for initialization segment at URL: ${i.map.resolvedUri||i.map.uri}`,code:Hi,metadata:{mediaType:u}})}workerCallback({action:"probeMp4Tracks",data:i.map.bytes,transmuxer:i.transmuxer,callback:({tracks:d,data:u})=>(i.map.bytes=u,d.forEach((function(l){i.map.tracks=i.map.tracks||{},i.map.tracks[l.type]||(i.map.tracks[l.type]=l,"number"==typeof l.id&&l.timescale&&(i.map.timescales=i.map.timescales||{},i.map.timescales[l.id]=l.timescale),"text"===l.type&&((i,l)=>{l===Gi&&i.transmuxer.postMessage({action:"initMp4WebVttParser",data:i.map.bytes})})(i,l.codec))})),l(null))})},handleSegmentResponse=({segment:i,finishProcessingFn:l,responseType:d,triggerSegmentEventFn:u})=>(c,h)=>{const p=handleErrors(c,h);if(p)return l(p,i);u({type:"segmentloaded",segment:i});const m="arraybuffer"!==d&&h.responseText?(i=>{const l=new Uint8Array(new ArrayBuffer(i.length));for(let d=0;d<i.length;d++)l[d]=i.charCodeAt(d);return l.buffer})(h.responseText.substring(i.lastReachedChar||0)):h.response;return i.stats=(i=>({bandwidth:i.bandwidth,bytesReceived:i.bytesReceived||0,roundTripTime:i.roundTripTime||0}))(h),i.key?i.encryptedBytes=new Uint8Array(m):i.bytes=new Uint8Array(m),l(null,i)},transmuxAndNotify=({segment:i,bytes:l,trackInfoFn:d,timingInfoFn:u,videoSegmentTimingInfoFn:c,audioSegmentTimingInfoFn:h,id3Fn:p,captionsFn:m,isEndOfTimeline:g,endedTimelineFn:y,dataFn:_,doneFn:v,onTransmuxerLog:b,triggerSegmentEventFn:T})=>{const S=i.map&&i.map.tracks||{},E=Boolean(S.audio&&S.video);let k=u.bind(null,i,"audio","start");const w=u.bind(null,i,"audio","end");let C=u.bind(null,i,"video","start");const x=u.bind(null,i,"video","end");workerCallback({action:"probeTs",transmuxer:i.transmuxer,data:l,baseStartTime:i.baseStartTime,callback:u=>{i.bytes=l=u.data;const S=u.result;S&&(d(i,{hasAudio:S.hasAudio,hasVideo:S.hasVideo,isMuxed:E}),d=null),transmux({bytes:l,transmuxer:i.transmuxer,audioAppendStart:i.audioAppendStart,gopsToAlignWith:i.gopsToAlignWith,remux:E,onData:l=>{l.type="combined"===l.type?"video":l.type,_(i,l)},onTrackInfo:l=>{d&&(E&&(l.isMuxed=!0),d(i,l))},onAudioTimingInfo:i=>{k&&void 0!==i.start&&(k(i.start),k=null),w&&void 0!==i.end&&w(i.end)},onVideoTimingInfo:i=>{C&&void 0!==i.start&&(C(i.start),C=null),x&&void 0!==i.end&&x(i.end)},onVideoSegmentTimingInfo:l=>{T({type:"segmenttransmuxingtiminginfoavailable",segment:i,timingInfo:{pts:{start:l.start.presentation,end:l.end.presentation},dts:{start:l.start.decode,end:l.end.decode}}}),c(l)},onAudioSegmentTimingInfo:l=>{T({type:"segmenttransmuxingtiminginfoavailable",segment:i,timingInfo:{pts:{start:l.start.pts,end:l.end.pts},dts:{start:l.start.dts,end:l.end.dts}}}),h(l)},onId3:(l,d)=>{p(i,l,d)},onCaptions:l=>{m(i,[l])},isEndOfTimeline:g,onEndedTimeline:()=>{y()},onTransmuxerLog:b,onDone:(l,d)=>{v&&(l.type="combined"===l.type?"video":l.type,T({type:"segmenttransmuxingcomplete",segment:i}),v(d,i,l))},segment:i,triggerSegmentEventFn:T})}})},handleSegmentBytes=({segment:i,bytes:l,trackInfoFn:d,timingInfoFn:u,videoSegmentTimingInfoFn:c,audioSegmentTimingInfoFn:h,id3Fn:p,captionsFn:m,isEndOfTimeline:g,endedTimelineFn:y,dataFn:_,doneFn:v,onTransmuxerLog:b,triggerSegmentEventFn:T})=>{let S=new Uint8Array(l);if(function isLikelyFmp4MediaSegment(i){return ve(i,["moof"]).length>0}(S)){i.isFmp4=!0;const{tracks:c}=i.map;if(c.text&&(!c.audio||!c.video))return _(i,{data:S,type:"text"}),((i,l,d)=>{l===Gi&&workerCallback({action:"getMp4WebVttText",data:i.bytes,transmuxer:i.transmuxer,callback:({data:l,mp4VttCues:u})=>{i.bytes=l,d(null,i,{mp4VttCues:u})}})})(i,c.text.codec,v),void 0;const h={isFmp4:!0,hasVideo:!!c.video,hasAudio:!!c.audio};c.audio&&c.audio.codec&&"enca"!==c.audio.codec&&(h.audioCodec=c.audio.codec),c.video&&c.video.codec&&"encv"!==c.video.codec&&(h.videoCodec=c.video.codec),c.video&&c.audio&&(h.isMuxed=!0),d(i,h);const finishLoading=(l,d)=>{_(i,{data:S,type:h.hasAudio&&!h.isMuxed?"audio":"video"}),d&&d.length&&p(i,d),l&&l.length&&m(i,l),v(null,i,{})};return workerCallback({action:"probeMp4StartTime",timescales:i.map.timescales,data:S,transmuxer:i.transmuxer,callback:({data:d,startTime:p})=>{l=d.buffer,i.bytes=S=d,h.hasAudio&&!h.isMuxed&&u(i,"audio","start",p),h.hasVideo&&u(i,"video","start",p),workerCallback({action:"probeEmsgID3",data:S,transmuxer:i.transmuxer,offset:p,callback:({emsgData:d,id3Frames:u})=>{if(l=d.buffer,i.bytes=S=d,!c.video||!d.byteLength||!i.transmuxer)return finishLoading(void 0,u),void 0;workerCallback({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:i.transmuxer,data:S,timescales:i.map.timescales,trackIds:[c.video.id],callback:d=>{l=d.data.buffer,i.bytes=S=d.data,d.logs.forEach((function(i){b(video_es_merge(i,{stream:"mp4CaptionParser"}))})),finishLoading(d.captions,u)}})}})}}),void 0}return i.transmuxer?(void 0===i.container&&(i.container=Ve(S)),"ts"!==i.container&&"aac"!==i.container?(d(i,{hasAudio:!1,hasVideo:!1}),v(null,i,{}),void 0):(transmuxAndNotify({segment:i,bytes:l,trackInfoFn:d,timingInfoFn:u,videoSegmentTimingInfoFn:c,audioSegmentTimingInfoFn:h,id3Fn:p,captionsFn:m,isEndOfTimeline:g,endedTimelineFn:y,dataFn:_,doneFn:v,onTransmuxerLog:b,triggerSegmentEventFn:T}),void 0)):(v(null,i,{}),void 0)},decrypt=function({id:i,key:l,encryptedBytes:d,decryptionWorker:u,segment:c,doneFn:h},p){const decryptionHandler=l=>{if(l.data.source===i){u.removeEventListener("message",decryptionHandler);const i=l.data.decrypted;p(new Uint8Array(i.bytes,i.byteOffset,i.byteLength))}};let m;u.onerror=()=>{const i="An error occurred in the decryption worker",l=segmentInfoPayload({segment:c}),d={message:i,metadata:{error:new Error(i),errorType:videojs.Error.StreamingFailedToDecryptSegment,segmentInfo:l,keyInfo:{uri:c.key.resolvedUri||c.map.key.resolvedUri}}};h(d,c)},u.addEventListener("message",decryptionHandler),m=l.bytes.slice?l.bytes.slice():new Uint32Array(Array.prototype.slice.call(l.bytes)),u.postMessage(createTransferableMessage({source:i,encrypted:d,key:m,iv:l.iv}),[d.buffer,m.buffer])},waitForCompletion=({activeXhrs:i,decryptionWorker:l,trackInfoFn:d,timingInfoFn:u,videoSegmentTimingInfoFn:c,audioSegmentTimingInfoFn:h,id3Fn:p,captionsFn:m,isEndOfTimeline:g,endedTimelineFn:y,dataFn:_,doneFn:v,onTransmuxerLog:b,triggerSegmentEventFn:T})=>{let S=0,E=!1;return(k,w)=>{if(!E){if(k)return E=!0,abortAll(i),v(k,w);if(S+=1,S===i.length){const segmentFinish=function(){if(w.encryptedBytes)return(({decryptionWorker:i,segment:l,trackInfoFn:d,timingInfoFn:u,videoSegmentTimingInfoFn:c,audioSegmentTimingInfoFn:h,id3Fn:p,captionsFn:m,isEndOfTimeline:g,endedTimelineFn:y,dataFn:_,doneFn:v,onTransmuxerLog:b,triggerSegmentEventFn:T})=>{T({type:"segmentdecryptionstart"}),decrypt({id:l.requestId,key:l.key,encryptedBytes:l.encryptedBytes,decryptionWorker:i,segment:l,doneFn:v},(i=>{l.bytes=i,T({type:"segmentdecryptioncomplete",segment:l}),handleSegmentBytes({segment:l,bytes:l.bytes,trackInfoFn:d,timingInfoFn:u,videoSegmentTimingInfoFn:c,audioSegmentTimingInfoFn:h,id3Fn:p,captionsFn:m,isEndOfTimeline:g,endedTimelineFn:y,dataFn:_,doneFn:v,onTransmuxerLog:b,triggerSegmentEventFn:T})}))})({decryptionWorker:l,segment:w,trackInfoFn:d,timingInfoFn:u,videoSegmentTimingInfoFn:c,audioSegmentTimingInfoFn:h,id3Fn:p,captionsFn:m,isEndOfTimeline:g,endedTimelineFn:y,dataFn:_,doneFn:v,onTransmuxerLog:b,triggerSegmentEventFn:T});handleSegmentBytes({segment:w,bytes:w.bytes,trackInfoFn:d,timingInfoFn:u,videoSegmentTimingInfoFn:c,audioSegmentTimingInfoFn:h,id3Fn:p,captionsFn:m,isEndOfTimeline:g,endedTimelineFn:y,dataFn:_,doneFn:v,onTransmuxerLog:b,triggerSegmentEventFn:T})};if(w.endOfAllRequests=Date.now(),w.map&&w.map.encryptedBytes&&!w.map.bytes)return T({type:"segmentdecryptionstart",segment:w}),decrypt({decryptionWorker:l,id:w.requestId+"-init",encryptedBytes:w.map.encryptedBytes,key:w.map.key,segment:w,doneFn:v},(l=>{w.map.bytes=l,T({type:"segmentdecryptioncomplete",segment:w}),parseInitSegment(w,(l=>{if(l)return abortAll(i),v(l,w);segmentFinish()}))}));segmentFinish()}}}},handleProgress=({segment:i,progressFn:l})=>d=>{if(!d.target.aborted)return i.stats=video_es_merge(i.stats,(i=>{const l=i.target,d={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-l.requestTime||0};return d.bytesReceived=i.loaded,d.bandwidth=Math.floor(d.bytesReceived/d.roundTripTime*8*1e3),d})(d)),!i.stats.firstBytesReceivedAt&&i.stats.bytesReceived&&(i.stats.firstBytesReceivedAt=Date.now()),l(d,i)},mediaSegmentRequest=({xhr:i,xhrOptions:l,decryptionWorker:d,segment:u,abortFn:c,progressFn:h,trackInfoFn:p,timingInfoFn:m,videoSegmentTimingInfoFn:g,audioSegmentTimingInfoFn:y,id3Fn:_,captionsFn:v,isEndOfTimeline:b,endedTimelineFn:T,dataFn:S,doneFn:E,onTransmuxerLog:k,triggerSegmentEventFn:w})=>{const C=[],x=waitForCompletion({activeXhrs:C,decryptionWorker:d,trackInfoFn:p,timingInfoFn:m,videoSegmentTimingInfoFn:g,audioSegmentTimingInfoFn:y,id3Fn:_,captionsFn:v,isEndOfTimeline:b,endedTimelineFn:T,dataFn:S,doneFn:E,onTransmuxerLog:k,triggerSegmentEventFn:w});if(u.key&&!u.key.bytes){const d=[u.key];u.map&&!u.map.bytes&&u.map.key&&u.map.key.resolvedUri===u.key.resolvedUri&&d.push(u.map.key);const c=video_es_merge(l,{uri:u.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),h=handleKeyResponse(u,d,x,w);w({type:"segmentkeyloadstart",segment:u,keyInfo:{uri:u.key.resolvedUri}});const p=i(c,h);C.push(p)}if(u.map&&!u.map.bytes){if(u.map.key&&(!u.key||u.key.resolvedUri!==u.map.key.resolvedUri)){const d=video_es_merge(l,{uri:u.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),c=handleKeyResponse(u,[u.map.key],x,w);w({type:"segmentkeyloadstart",segment:u,keyInfo:{uri:u.map.key.resolvedUri}});const h=i(d,c);C.push(h)}const d=video_es_merge(l,{uri:u.map.resolvedUri,responseType:"arraybuffer",headers:segmentXhrHeaders(u.map),requestType:"segment-media-initialization"}),c=(({segment:i,finishProcessingFn:l,triggerSegmentEventFn:d})=>(u,c)=>{const h=handleErrors(u,c);if(h)return l(h,i);const p=new Uint8Array(c.response);if(d({type:"segmentloaded",segment:i}),i.map.key)return i.map.encryptedBytes=p,l(null,i);i.map.bytes=p,parseInitSegment(i,(function(d){if(d)return d.xhr=c,d.status=c.status,l(d,i);l(null,i)}))})({segment:u,finishProcessingFn:x,triggerSegmentEventFn:w});w({type:"segmentloadstart",segment:u});const h=i(d,c);C.push(h)}const A=video_es_merge(l,{uri:u.part&&u.part.resolvedUri||u.resolvedUri,responseType:"arraybuffer",headers:segmentXhrHeaders(u),requestType:"segment"}),P=handleSegmentResponse({segment:u,finishProcessingFn:x,responseType:A.responseType,triggerSegmentEventFn:w});w({type:"segmentloadstart",segment:u});const I=i(A,P);I.addEventListener("progress",handleProgress({segment:u,progressFn:h,trackInfoFn:p,timingInfoFn:m,videoSegmentTimingInfoFn:g,audioSegmentTimingInfoFn:y,id3Fn:_,captionsFn:v,isEndOfTimeline:b,endedTimelineFn:T,dataFn:S})),C.push(I);const D={};return C.forEach((i=>{i.addEventListener("loadend",(({loadendState:i,abortFn:l})=>d=>{d.target.aborted&&l&&!i.calledAbortFn&&(l(),i.calledAbortFn=!0)})({loadendState:D,abortFn:c}))})),()=>abortAll(C)},Wi=logger("CodecUtils"),isMaat=(i,l)=>{const d=l.attributes||{};return i&&i.mediaGroups&&i.mediaGroups.AUDIO&&d.AUDIO&&i.mediaGroups.AUDIO[d.AUDIO]},unwrapCodecList=function(i){const l={};return i.forEach((({mediaType:i,type:d,details:u})=>{l[i]=l[i]||[],l[i].push(I(`${d}${u}`))})),Object.keys(l).forEach((function(i){if(l[i].length>1)return Wi(`multiple ${i} codecs found as attributes: ${l[i].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),l[i]=null,void 0;l[i]=l[i][0]})),l},codecCount=function(i){let l=0;return i.audio&&l++,i.video&&l++,l},codecsForPlaylist=function(i,l){const d=l.attributes||{},u=unwrapCodecList(function(i){const l=i.attributes||{};if(l.CODECS)return D(l.CODECS)}(l)||[]);if(isMaat(i,l)&&!u.audio&&!((i,l)=>{if(!isMaat(i,l))return!0;const d=i.mediaGroups.AUDIO[(l.attributes||{}).AUDIO];for(const i in d)if(!d[i].uri&&!d[i].playlists)return!0;return!1})(i,l)){const l=unwrapCodecList(function codecsFromDefault(i,l){if(!i.mediaGroups.AUDIO||!l)return null;var d=i.mediaGroups.AUDIO[l];if(!d)return null;for(var u in d){var c=d[u];if(c.default&&c.playlists)return D(c.playlists[0].attributes.CODECS)}return null}(i,d.AUDIO)||[]);l.audio&&(u.audio=l.audio)}return u},Xi=logger("PlaylistSelector"),representationToString=function(i){if(!i||!i.playlist)return;const l=i.playlist;return JSON.stringify({id:l.id,bandwidth:i.bandwidth,width:i.width,height:i.height,codecs:l.attributes&&l.attributes.CODECS||""})},safeGetComputedStyle=function(i,l){if(!i)return"";const d=p().getComputedStyle(i);return d?d[l]:""},stableSort=function(i,l){const d=i.slice();i.sort((function(i,u){const c=l(i,u);return 0===c?d.indexOf(i)-d.indexOf(u):c}))},comparePlaylistBandwidth=function(i,l){let d,u;return i.attributes.BANDWIDTH&&(d=i.attributes.BANDWIDTH),d=d||p().Number.MAX_VALUE,l.attributes.BANDWIDTH&&(u=l.attributes.BANDWIDTH),u=u||p().Number.MAX_VALUE,d-u};let simpleSelector=function(i,l,d,u,c,h){if(!i)return;const m={bandwidth:l,width:d,height:u,limitRenditionByPlayerDimensions:c};let g=i.playlists;Vi.isAudioOnly(i)&&(g=h.getAudioTrackPlaylists_(),m.audioOnly=!0);let y=g.map((i=>{let l;const d=i.attributes&&i.attributes.RESOLUTION&&i.attributes.RESOLUTION.width,u=i.attributes&&i.attributes.RESOLUTION&&i.attributes.RESOLUTION.height;return l=i.attributes&&i.attributes.BANDWIDTH,l=l||p().Number.MAX_VALUE,{bandwidth:l,width:d,height:u,playlist:i}}));stableSort(y,((i,l)=>i.bandwidth-l.bandwidth)),y=y.filter((i=>!Vi.isIncompatible(i.playlist)));let _=y.filter((i=>Vi.isEnabled(i.playlist)));_.length||(_=y.filter((i=>!Vi.isDisabled(i.playlist))));const v=_.filter((i=>i.bandwidth*Fi.BANDWIDTH_VARIANCE<l));let b=v[v.length-1];const T=v.filter((i=>i.bandwidth===b.bandwidth))[0];if(!1===c){const i=T||_[0]||y[0];if(i&&i.playlist){let l="sortedPlaylistReps";return T&&(l="bandwidthBestRep"),_[0]&&(l="enabledPlaylistReps"),Xi(`choosing ${representationToString(i)} using ${l} with options`,m),i.playlist}return Xi("could not choose a playlist with options",m),null}const S=v.filter((i=>i.width&&i.height));stableSort(S,((i,l)=>i.width-l.width));const E=S.filter((i=>i.width===d&&i.height===u));b=E[E.length-1];const k=E.filter((i=>i.bandwidth===b.bandwidth))[0];let w,C,x,A;if(k||(w=S.filter((i=>i.width>d||i.height>u)),C=w.filter((i=>i.width===w[0].width&&i.height===w[0].height)),b=C[C.length-1],x=C.filter((i=>i.bandwidth===b.bandwidth))[0]),h.leastPixelDiffSelector){const i=S.map((i=>(i.pixelDiff=Math.abs(i.width-d)+Math.abs(i.height-u),i)));stableSort(i,((i,l)=>i.pixelDiff===l.pixelDiff?l.bandwidth-i.bandwidth:i.pixelDiff-l.pixelDiff)),A=i[0]}const P=A||x||k||T||_[0]||y[0];if(P&&P.playlist){let i="sortedPlaylistReps";return A?i="leastPixelDiffRep":x?i="resolutionPlusOneRep":k?i="resolutionBestRep":T?i="bandwidthBestRep":_[0]&&(i="enabledPlaylistReps"),Xi(`choosing ${representationToString(P)} using ${i} with options`,m),P.playlist}return Xi("could not choose a playlist with options",m),null};const lastBandwidthSelector=function(){let i=this.useDevicePixelRatio&&p().devicePixelRatio||1;return isNaN(this.customPixelRatio)||(i=this.customPixelRatio),simpleSelector(this.playlists.main,this.systemBandwidth,parseInt(safeGetComputedStyle(this.tech_.el(),"width"),10)*i,parseInt(safeGetComputedStyle(this.tech_.el(),"height"),10)*i,this.limitRenditionByPlayerDimensions,this.playlistController_)};function compactSegmentUrlDescription(i){try{return new URL(i).pathname.split("/").slice(-2).join("/")}catch(i){return""}}const addMetadata=({inbandTextTracks:i,metadataArray:l,timestampOffset:d,videoDuration:u})=>{if(!l)return;const c=p().WebKitDataCue||p().VTTCue,h=i.metadataTrack_;if(!h)return;if(l.forEach((i=>{const l=i.cueTime+d;!("number"!=typeof l||p().isNaN(l)||l<0)&&l<1/0&&i.frames&&i.frames.length&&i.frames.forEach((i=>{const d=new c(l,l,i.value||i.url||i.data||"");d.frame=i,d.value=i,function(i){Object.defineProperties(i.frame,{id:{get:()=>(videojs.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),i.value.key)},value:{get:()=>(videojs.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),i.value.data)},privateData:{get:()=>(videojs.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),i.value.data)}})}(d),h.addCue(d)}))})),!h.cues||!h.cues.length)return;const m=h.cues,g=[];for(let i=0;i<m.length;i++)m[i]&&g.push(m[i]);const y=g.reduce(((i,l)=>{const d=i[l.startTime]||[];return d.push(l),i[l.startTime]=d,i}),{}),_=Object.keys(y).sort(((i,l)=>Number(i)-Number(l)));_.forEach(((i,l)=>{const d=y[i],c=isFinite(u)?u:i,h=Number(_[l+1])||c;d.forEach((i=>{i.endTime=h}))}))},Ki={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},Yi=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),createMetadataTrackIfNotExists=(i,l,d)=>{i.metadataTrack_||(i.metadataTrack_=d.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,videojs.browser.IS_ANY_SAFARI||(i.metadataTrack_.inBandMetadataTrackDispatchType=l))},removeCuesFromTrack=function(i,l,d){let u,c;if(d&&d.cues)for(u=d.cues.length;u--;)c=d.cues[u],c.startTime>=i&&c.endTime<=l&&d.removeCue(c)},finite=i=>"number"==typeof i&&isFinite(i),Qi=1/60,segmentInfoString=i=>{const{startOfSegment:l,duration:d,segment:u,part:c,playlist:{mediaSequence:h,id:p,segments:m=[]},mediaIndex:g,partIndex:y,timeline:_}=i,v=m.length-1;let b="mediaIndex/partIndex increment";i.getMediaInfoForTime?b=`getMediaInfoForTime (${i.getMediaInfoForTime})`:i.isSyncRequest&&(b="getSyncSegmentCandidate (isSyncRequest)"),i.independent&&(b+=` with independent ${i.independent}`);const T="number"==typeof y,S=i.segment.uri?"segment":"pre-segment",E=T?getKnownPartCount({preloadSegment:u})-1:0;return`${S} [${h+g}/${h+v}]`+(T?` part [${y}/${E}]`:"")+` segment start/end [${u.start} => ${u.end}]`+(T?` part start/end [${c.start} => ${c.end}]`:"")+` startOfSegment [${l}]`+` duration [${d}]`+` timeline [${_}]`+` selected by [${b}]`+` playlist [${p}]`},timingInfoPropertyForMedia=i=>`${i}TimingInfo`,shouldWaitForTimelineChange=({timelineChangeController:i,currentTimeline:l,segmentTimeline:d,loaderType:u,audioDisabled:c})=>{if(l===d)return!1;if("audio"===u){const l=i.lastTimelineChange({type:"main"});return!l||l.to!==d}if("main"===u&&c){const l=i.pendingTimelineChange({type:"audio"});return!l||l.to!==d}return!1},checkAndFixTimelines=i=>{const l=i.pendingSegment_;if(!l)return;if(shouldWaitForTimelineChange({timelineChangeController:i.timelineChangeController_,currentTimeline:i.currentTimeline_,segmentTimeline:l.timeline,loaderType:i.loaderType_,audioDisabled:i.audioDisabled_})&&(i=>{if(!i)return!1;const l=i.pendingTimelineChange({type:"audio"}),d=i.pendingTimelineChange({type:"main"}),u=l&&d;return!(!u||-1===l.from||-1===d.from||!u||l.to===d.to)})(i.timelineChangeController_)){if((i=>{const l=i.timelineChangeController_.pendingTimelineChange({type:"audio"}),d=i.timelineChangeController_.pendingTimelineChange({type:"main"});return l&&d&&l.to<d.to})(i))return i.timelineChangeController_.trigger("audioTimelineBehind"),void 0;i.timelineChangeController_.trigger("fixBadTimelineChange")}},segmentTooLong=({segmentDuration:i,maxDuration:l})=>!!i&&Math.round(i)>l+Li,getTroublesomeSegmentDurationMessage=(i,l)=>{if("hls"!==l)return null;const d=(i=>{let l=0;return["video","audio"].forEach((function(d){const u=i[`${d}TimingInfo`];if(!u)return;const{start:c,end:h}=u;let m;"bigint"==typeof c||"bigint"==typeof h?m=p().BigInt(h)-p().BigInt(c):"number"==typeof c&&"number"==typeof h&&(m=h-c),void 0!==m&&m>l&&(l=m)})),"bigint"==typeof l&&l<Number.MAX_SAFE_INTEGER&&(l=Number(l)),l})({audioTimingInfo:i.audioTimingInfo,videoTimingInfo:i.videoTimingInfo});if(!d)return null;const u=i.playlist.targetDuration,c=segmentTooLong({segmentDuration:d,maxDuration:2*u}),h=segmentTooLong({segmentDuration:d,maxDuration:u});return c||h?{severity:c?"warn":"info",message:`Segment with index ${i.mediaIndex} from playlist ${i.playlist.id} has a duration of ${d} when the reported duration is ${i.duration} and the target duration is ${u}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`}:null},segmentInfoPayload=({type:i,segment:l})=>{if(!l)return;const d=Boolean(l.key||l.map&&l.map.ke),u=Boolean(l.map&&!l.map.bytes);return{type:i||l.type,uri:l.resolvedUri||l.uri,start:void 0===l.startOfSegment?l.start:l.startOfSegment,duration:l.duration,isEncrypted:d,isMediaInitialization:u}};class SegmentLoader extends videojs.EventTarget{constructor(i,l={}){if(super(),!i)throw new TypeError("Initialization settings are required");if("function"!=typeof i.currentTime)throw new TypeError("No currentTime getter specified");if(!i.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=i.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=i.hasPlayed,this.currentTime_=i.currentTime,this.seekable_=i.seekable,this.seeking_=i.seeking,this.duration_=i.duration,this.mediaSource_=i.mediaSource,this.vhs_=i.vhs,this.loaderType_=i.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=i.segmentMetadataTrack,this.goalBufferLength_=i.goalBufferLength,this.sourceType_=i.sourceType,this.sourceUpdater_=i.sourceUpdater,this.inbandTextTracks_=i.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=i.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=i.parse708captions,this.useDtsForTimestampOffset_=i.useDtsForTimestampOffset,this.captionServices_=i.captionServices,this.exactManifestTimings=i.exactManifestTimings,this.addMetadataToTextTrack=i.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=i.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=i.decrypter,this.syncController_=i.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",(()=>{this.isEndOfStream_()||(this.ended_=!1)})),this.fetchAtBuffer_=!1,this.logger_=logger(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(i){i!==this.state_&&(this.logger_(`${this.state_} -> ${i}`),this.state_=i,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",(()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():checkAndFixTimelines(this)})),this.sourceUpdater_.on("codecschange",(i=>{this.trigger(_extends({type:"codecschange"},i))})),"main"===this.loaderType_&&this.timelineChangeController_.on("pendingtimelinechange",(()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():checkAndFixTimelines(this)})),"audio"===this.loaderType_&&this.timelineChangeController_.on("timelinechange",(i=>{this.trigger(_extends({type:"timelinechange"},i)),this.hasEnoughInfoToLoad_()?this.processLoadQueue_():checkAndFixTimelines(this),this.hasEnoughInfoToAppend_()?this.processCallQueue_():checkAndFixTimelines(this)}))}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return segmentTransmuxer_createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&p().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(i){this.audioDisabled_=!i,i?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if("WAITING"!==this.state)return this.pendingSegment_&&(this.pendingSegment_=null),this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),void 0;this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,p().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(i){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==i:(this.state="READY",!0)}error(i){return void 0!==i&&(this.logger_("error occurred:",i),this.error_=i),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&segmentTransmuxer_reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const i=this.getMediaInfo_();if(!this.sourceUpdater_||!i)return createTimeRanges();if("main"===this.loaderType_){const{hasAudio:l,hasVideo:d,isMuxed:u}=i;if(d&&l&&!this.audioDisabled_&&!u)return this.sourceUpdater_.buffered();if(d)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(i,l=!1){if(!i)return null;const d=initSegmentId(i);let u=this.initSegments_[d];return l&&!u&&i.bytes&&(this.initSegments_[d]=u={resolvedUri:i.resolvedUri,byterange:i.byterange,bytes:i.bytes,tracks:i.tracks,timescales:i.timescales}),u||i}segmentKey(i,l=!1){if(!i)return null;const d=segmentKeyId(i);let u=this.keyCache_[d];this.cacheEncryptionKeys_&&l&&!u&&i.bytes&&(this.keyCache_[d]=u={resolvedUri:i.resolvedUri,bytes:i.bytes});const c={resolvedUri:(u||i).resolvedUri};return u&&(c.bytes=u.bytes),c}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),this.playlist_)return"INIT"===this.state&&this.couldBeginLoading_()?this.init_():(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY"),void 0)}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(i,l={}){if(!i)return;if(this.playlist_&&this.playlist_.endList&&i.endList&&this.playlist_.uri===i.uri)return;const d=this.playlist_,u=this.pendingSegment_;this.playlist_=i,this.xhrOptions_=l,"INIT"===this.state&&(i.syncInfo={mediaSequence:i.mediaSequence,time:0},"main"===this.loaderType_&&this.syncController_.setDateTimeMappingForStart(i));let c=null;if(d&&(d.id?c=d.id:d.uri&&(c=d.uri)),this.logger_(`playlist update [${c} => ${i.id||i.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(i,this.currentTime_()),this.logger_(`Playlist update:\ncurrentTime: ${this.currentTime_()}\nbufferedEnd: ${lastBufferedEnd(this.buffered_())}\n`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!d||d.uri!==i.uri){if(null!==this.mediaIndex){!i.endList&&"number"==typeof i.partTargetDuration?this.resetLoader():this.resyncLoader()}return this.currentMediaInfo_=void 0,this.trigger("playlistupdate"),void 0}const h=i.mediaSequence-d.mediaSequence;if(this.logger_(`live window shift [${h}]`),null!==this.mediaIndex)if(this.mediaIndex-=h,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const i=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!i.parts||!i.parts.length||!i.parts[this.partIndex])){const i=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=i}}u&&(u.mediaIndex-=h,u.mediaIndex<0?(u.mediaIndex=null,u.partIndex=null):(u.mediaIndex>=0&&(u.segment=i.segments[u.mediaIndex]),u.partIndex>=0&&u.segment.parts&&(u.part=u.segment.parts[u.partIndex]))),this.syncController_.saveExpiredSegmentInfo(d,i)}pause(){this.checkBufferTimeout_&&(p().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return null===this.checkBufferTimeout_}resetEverything(i){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,i),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&segmentTransmuxer_reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;"hls"===this.sourceType_&&!(this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4)&&(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(i,l,d=()=>{},u=!1){if(l===1/0&&(l=this.duration_()),l<=i)return this.logger_("skipping remove because end ${end} is <= start ${start}"),void 0;if(!this.sourceUpdater_||!this.getMediaInfo_())return this.logger_("skipping remove because no source updater or starting media info"),void 0;let c=1;const removeFinished=()=>{c--,0===c&&d()};!u&&this.audioDisabled_||(c++,this.sourceUpdater_.removeAudio(i,l,removeFinished)),(u||"main"===this.loaderType_)&&(this.gopBuffer_=((i,l,d,u)=>{const c=Math.ceil((l-u)*Me.ONE_SECOND_IN_TS),h=Math.ceil((d-u)*Me.ONE_SECOND_IN_TS),p=i.slice();let m=i.length;for(;m--&&!(i[m].pts<=h););if(-1===m)return p;let g=m+1;for(;g--&&!(i[g].pts<=c););return g=Math.max(g,0),p.splice(g,m-g+1),p})(this.gopBuffer_,i,l,this.timeMapping_),c++,this.sourceUpdater_.removeVideo(i,l,removeFinished));for(const d in this.inbandTextTracks_)removeCuesFromTrack(i,l,this.inbandTextTracks_[d]);removeCuesFromTrack(i,l,this.segmentMetadataTrack_),removeFinished()}monitorBuffer_(){this.checkBufferTimeout_&&p().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=p().setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&p().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=p().setTimeout(this.monitorBufferTick_.bind(this),500)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const i=this.chooseNextRequest_();if(!i)return;const l={segmentInfo:segmentInfoPayload({type:this.loaderType_,segment:i})};this.trigger({type:"segmentselected",metadata:l}),"number"==typeof i.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:i.timeline})),this.loadSegment_(i)}isEndOfStream_(i=this.mediaIndex,l=this.playlist_,d=this.partIndex){if(!l||!this.mediaSource_)return!1;const u="number"==typeof i&&l.segments[i];return l.endList&&"open"===this.mediaSource_.readyState&&i+1===l.segments.length&&(!u||!u.parts||d+1===u.parts.length)}chooseNextRequest_(){const i=this.buffered_(),l=lastBufferedEnd(i)||0,d=timeAheadOf(i,this.currentTime_()),u=!this.hasPlayed_()&&d>=1,c=d>=this.goalBufferLength_(),h=this.playlist_.segments;if(!h.length||u||c)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const p={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(p.isSyncRequest)p.mediaIndex=function(i,l,d){l=l||[];const u=[];let c=0;for(let h=0;h<l.length;h++){const p=l[h];if(i===p.timeline&&(u.push(h),c+=p.duration,c>d))return h}return 0===u.length?0:u[u.length-1]}(this.currentTimeline_,h,l),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${p.mediaIndex}`);else if(null!==this.mediaIndex){const i=h[this.mediaIndex],d="number"==typeof this.partIndex?this.partIndex:-1;p.startOfSegment=i.end?i.end:l,i.parts&&i.parts[d+1]?(p.mediaIndex=this.mediaIndex,p.partIndex=d+1):p.mediaIndex=this.mediaIndex+1}else{let i,d,u;const c=this.fetchAtBuffer_?l:this.currentTime_();if(this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:\nFor TargetTime: ${c}.\nCurrentTime: ${this.currentTime_()}\nBufferedEnd: ${l}\nFetch At Buffer: ${this.fetchAtBuffer_}\n`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){const l=this.getSyncInfoFromMediaSequenceSync_(c);if(!l){const i="No sync info found while using media sequence sync";return this.error({message:i,metadata:{errorType:videojs.Error.StreamingFailedToSelectNextSegment,error:new Error(i)}}),this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null}this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${l.start} --\x3e ${l.end})`),i=l.segmentIndex,d=l.partIndex,u=l.start}else{this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint.");const l=Vi.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:c,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});i=l.segmentIndex,d=l.partIndex,u=l.startTime}p.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${c}`:`currentTime ${c}`,p.mediaIndex=i,p.startOfSegment=u,p.partIndex=d,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${p.mediaIndex} `)}const m=h[p.mediaIndex];let g=m&&"number"==typeof p.partIndex&&m.parts&&m.parts[p.partIndex];if(!m||"number"==typeof p.partIndex&&!g)return null;"number"!=typeof p.partIndex&&m.parts&&(p.partIndex=0,g=m.parts[0]);if(!d&&g&&!(this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments)&&!g.independent)if(0===p.partIndex){const i=h[p.mediaIndex-1],l=i.parts&&i.parts.length&&i.parts[i.parts.length-1];l&&l.independent&&(p.mediaIndex-=1,p.partIndex=i.parts.length-1,p.independent="previous segment")}else m.parts[p.partIndex-1].independent&&(p.partIndex-=1,p.independent="previous part");return p.mediaIndex>=h.length-1&&(this.mediaSource_&&"ended"===this.mediaSource_.readyState)&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,p.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(p))}getSyncInfoFromMediaSequenceSync_(i){if(!this.mediaSequenceSync_)return null;const l=Math.max(i,this.mediaSequenceSync_.start);i!==l&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${i} to ${l}`);const d=this.mediaSequenceSync_.getSyncInfoForTime(l);if(!d)return null;if(!d.isAppended)return d;const u=this.mediaSequenceSync_.getSyncInfoForTime(d.end);return u?(u.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),u):null}generateSegmentInfo_(i){const{independent:l,playlist:d,mediaIndex:u,startOfSegment:c,isSyncRequest:h,partIndex:p,forceTimestampOffset:m,getMediaInfoForTime:g}=i,y=d.segments[u],_="number"==typeof p&&y.parts[p],v={requestId:"segment-loader-"+Math.random(),uri:_&&_.resolvedUri||y.resolvedUri,mediaIndex:u,partIndex:_?p:null,isSyncRequest:h,startOfSegment:c,playlist:d,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:y.timeline,duration:_&&_.duration||y.duration,segment:y,part:_,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:g,independent:l},b=void 0!==m?m:this.isPendingTimestampOffset_;v.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:y.timeline,currentTimeline:this.currentTimeline_,startOfSegment:c,buffered:this.buffered_(),overrideCheck:b});const T=lastBufferedEnd(this.sourceUpdater_.audioBuffered());return"number"==typeof T&&(v.audioAppendStart=T-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(v.gopsToAlignWith=((i,l,d)=>{if(null==l||!i.length)return[];const u=Math.ceil((l-d+3)*Me.ONE_SECOND_IN_TS);let c;for(c=0;c<i.length&&!(i[c].pts>u);c++);return i.slice(c)})(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),v}timestampOffsetForSegment_(i){return(({segmentTimeline:i,currentTimeline:l,startOfSegment:d,buffered:u,overrideCheck:c})=>c||i!==l?i<l?d:u.length?u.end(u.length-1):d:null)(i)}earlyAbortWhenNeeded_(i){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return;if(Date.now()-(i.firstBytesReceivedAt||Date.now())<1e3)return;const l=this.currentTime_(),d=i.bandwidth,u=this.pendingSegment_.duration,c=Vi.estimateSegmentRequestTime(u,d,this.playlist_,i.bytesReceived),h=function(i,l,d=1){return((i.length?i.end(i.length-1):0)-l)/d}(this.buffered_(),l,this.vhs_.tech_.playbackRate())-1;if(c<=h)return;const p=function(i){const{main:l,currentTime:d,bandwidth:u,duration:c,segmentDuration:h,timeUntilRebuffer:p,currentTimeline:m,syncController:g}=i,y=l.playlists.filter((i=>!Vi.isIncompatible(i)));let _=y.filter(Vi.isEnabled);_.length||(_=y.filter((i=>!Vi.isDisabled(i))));const v=_.filter(Vi.hasAttribute.bind(null,"BANDWIDTH")).map((i=>{const l=g.getSyncPoint(i,c,m,d)?1:2;return{playlist:i,rebufferingImpact:Vi.estimateSegmentRequestTime(h,u,i)*l-p}})),b=v.filter((i=>i.rebufferingImpact<=0));return stableSort(b,((i,l)=>comparePlaylistBandwidth(l.playlist,i.playlist))),b.length?b[0]:(stableSort(v,((i,l)=>i.rebufferingImpact-l.rebufferingImpact)),v[0]||null)}({main:this.vhs_.playlists.main,currentTime:l,bandwidth:d,duration:this.duration_(),segmentDuration:u,timeUntilRebuffer:h,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!p)return;let m=.5;h<=Li&&(m=1),!p.playlist||p.playlist.uri===this.playlist_.uri||c-h-p.rebufferingImpact<m||(this.bandwidth=p.playlist.attributes.BANDWIDTH*Fi.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(i){this.logger_(`Aborting ${segmentInfoString(i)}`),this.mediaRequestsAborted+=1}handleProgress_(i,l){this.earlyAbortWhenNeeded_(l.stats),this.checkForAbort_(l.requestId)||this.trigger("progress")}handleTrackInfo_(i,l){const{hasAudio:d,hasVideo:u}=l,c={segmentInfo:segmentInfoPayload({type:this.loaderType_,segment:i}),trackInfo:{hasAudio:d,hasVideo:u}};this.trigger({type:"segmenttransmuxingtrackinfoavailable",metadata:c}),this.earlyAbortWhenNeeded_(i.stats),this.checkForAbort_(i.requestId)||this.checkForIllegalMediaSwitch(l)||(function(i,l){if(!i&&!l||!i&&l||i&&!l)return!1;if(i===l)return!0;const d=Object.keys(i).sort(),u=Object.keys(l).sort();if(d.length!==u.length)return!1;for(let c=0;c<d.length;c++){const h=d[c];if(h!==u[c])return!1;if(i[h]!==l[h])return!1}return!0}(this.currentMediaInfo_,l=l||{})||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=l,this.currentMediaInfo_=l,this.logger_("trackinfo update",l),this.trigger("trackinfo")),this.checkForAbort_(i.requestId)||(this.pendingSegment_.trackInfo=l,this.hasEnoughInfoToAppend_()?this.processCallQueue_():checkAndFixTimelines(this)))}handleTimingInfo_(i,l,d,u){if(this.earlyAbortWhenNeeded_(i.stats),this.checkForAbort_(i.requestId))return;const c=this.pendingSegment_,h=timingInfoPropertyForMedia(l);c[h]=c[h]||{},c[h][d]=u,this.logger_(`timinginfo: ${l} - ${d} - ${u}`),this.hasEnoughInfoToAppend_()?this.processCallQueue_():checkAndFixTimelines(this)}handleCaptions_(i,l){if(this.earlyAbortWhenNeeded_(i.stats),this.checkForAbort_(i.requestId))return;if(0===l.length)return this.logger_("SegmentLoader received no captions from a caption event"),void 0;if(!this.pendingSegment_.hasAppendedData_)return this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,i,l)),void 0;const d=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),u={};l.forEach((i=>{u[i.stream]=u[i.stream]||{startTime:1/0,captions:[],endTime:0};const l=u[i.stream];l.startTime=Math.min(l.startTime,i.startTime+d),l.endTime=Math.max(l.endTime,i.endTime+d),l.captions.push(i)})),Object.keys(u).forEach((i=>{const{startTime:l,endTime:c,captions:h}=u[i],m=this.inbandTextTracks_;this.logger_(`adding cues from ${l} -> ${c} for ${i}`),function(i,l,d){if(!i[d]){l.trigger({type:"usage",name:"vhs-608"});let u=d;/^cc708_/.test(d)&&(u="SERVICE"+d.split("_")[1]);const c=l.textTracks().getTrackById(u);if(c)i[d]=c;else{let c=d,h=d,p=!1;const m=(l.options_.vhs&&l.options_.vhs.captionServices||{})[u];m&&(c=m.label,h=m.language,p=m.default),i[d]=l.addRemoteTextTrack({kind:"captions",id:u,default:p,label:c,language:h},!1).track}}}(m,this.vhs_.tech_,i),removeCuesFromTrack(l,c,m[i]),function({inbandTextTracks:i,captionArray:l,timestampOffset:d}){if(!l)return;const u=p().WebKitDataCue||p().VTTCue;l.forEach((l=>{const c=l.stream;l.content?l.content.forEach((h=>{const p=new u(l.startTime+d,l.endTime+d,h.text);p.line=h.line,p.align="left",p.position=h.position,p.positionAlign="line-left",i[c].addCue(p)})):i[c].addCue(new u(l.startTime+d,l.endTime+d,l.text))}))}({captionArray:h,inbandTextTracks:m,timestampOffset:d})})),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(i,l,d){if(this.earlyAbortWhenNeeded_(i.stats),this.checkForAbort_(i.requestId))return;if(!this.pendingSegment_.hasAppendedData_)return this.metadataQueue_.id3.push(this.handleId3_.bind(this,i,l,d)),void 0;this.addMetadataToTextTrack(d,l,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach((i=>i())),this.metadataQueue_.caption.forEach((i=>i())),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const i=this.callQueue_;this.callQueue_=[],i.forEach((i=>i()))}processLoadQueue_(){const i=this.loadQueue_;this.loadQueue_=[],i.forEach((i=>i()))}hasEnoughInfoToLoad_(){if("audio"!==this.loaderType_)return!0;const i=this.pendingSegment_;return!!i&&(!this.getCurrentMediaInfo_()||!shouldWaitForTimelineChange({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:i.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}getCurrentMediaInfo_(i=this.pendingSegment_){return i&&i.trackInfo||this.currentMediaInfo_}getMediaInfo_(i=this.pendingSegment_){return this.getCurrentMediaInfo_(i)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready())return!1;if(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const i=this.pendingSegment_,l=this.getCurrentMediaInfo_();if(!i||!l)return!1;const{hasAudio:d,hasVideo:u,isMuxed:c}=l;return!(u&&!i.videoTimingInfo)&&(!(d&&!this.audioDisabled_&&!c&&!i.audioTimingInfo)&&!shouldWaitForTimelineChange({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:i.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(i,l){if(this.earlyAbortWhenNeeded_(i.stats),this.checkForAbort_(i.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_())return checkAndFixTimelines(this),this.callQueue_.push(this.handleData_.bind(this,i,l)),void 0;const d=this.pendingSegment_;if(this.setTimeMapping_(d.timeline),this.updateMediaSecondsLoaded_(d.part||d.segment),"closed"!==this.mediaSource_.readyState){if(i.map&&(i.map=this.initSegmentForMap(i.map,!0),d.segment.map=i.map),i.key&&this.segmentKey(i.key,!0),d.isFmp4=i.isFmp4,d.timingInfo=d.timingInfo||{},d.isFmp4)this.trigger("fmp4"),d.timingInfo.start=d[timingInfoPropertyForMedia(l.type)].start;else{const i=this.getCurrentMediaInfo_(),l="main"===this.loaderType_&&i&&i.hasVideo;let u;l&&(u=d.videoTimingInfo.start),d.timingInfo.start=this.trueSegmentStart_({currentStart:d.timingInfo.start,playlist:d.playlist,mediaIndex:d.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:l,firstVideoFrameTimeForData:u,videoTimingInfo:d.videoTimingInfo,audioTimingInfo:d.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(d,l.type),this.updateSourceBufferTimestampOffset_(d),d.isSyncRequest){this.updateTimingInfoEnd_(d),this.syncController_.saveSegmentTimingInfo({segmentInfo:d,shouldSaveTimelineMapping:"main"===this.loaderType_});const i=this.chooseNextRequest_();if(i.mediaIndex!==d.mediaIndex||i.partIndex!==d.partIndex)return this.logger_("sync segment was incorrect, not appending"),void 0;this.logger_("sync segment was correct, appending")}d.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(d,l)}}updateAppendInitSegmentStatus(i,l){"main"!==this.loaderType_||"number"!=typeof i.timestampOffset||i.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[l]!==i.playlist&&(this.appendInitSegment_[l]=!0)}getInitSegmentAndUpdateState_({type:i,initSegment:l,map:d,playlist:u}){if(d){const i=initSegmentId(d);if(this.activeInitSegmentId_===i)return null;l=this.initSegmentForMap(d,!0).bytes,this.activeInitSegmentId_=i}return l&&this.appendInitSegment_[i]?(this.playlistOfLastInitSegment_[i]=u,this.appendInitSegment_[i]=!1,this.activeInitSegmentId_=null,l):null}handleQuotaExceededError_({segmentInfo:i,type:l,bytes:d},u){const c=this.sourceUpdater_.audioBuffered(),h=this.sourceUpdater_.videoBuffered();c.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+timeRangesToArray(c).join(", ")),h.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+timeRangesToArray(h).join(", "));const m=c.length?c.start(0):0,g=c.length?c.end(c.length-1):0,y=h.length?h.start(0):0,_=h.length?h.end(h.length-1):0;if(g-m<=1&&_-y<=1)return this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${d.byteLength}, audio buffer: ${timeRangesToArray(c).join(", ")}, video buffer: ${timeRangesToArray(h).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error"),void 0;this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:i,type:l,bytes:d}));const v=this.currentTime_()-1;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${v}`),this.remove(0,v,(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=p().setTimeout((()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()}),1e3)}),!0)}handleAppendError_({segmentInfo:i,type:l,bytes:d},u){if(u){if(22===u.code)return this.handleQuotaExceededError_({segmentInfo:i,type:l,bytes:d}),void 0;this.logger_("Received non QUOTA_EXCEEDED_ERR on append",u),this.error({message:`${l} append of ${d.length}b failed for segment #${i.mediaIndex} in playlist ${i.playlist.id}`,metadata:{errorType:videojs.Error.StreamingFailedToAppendSegment}}),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:i,type:l,initSegment:d,data:u,bytes:c}){if(!c){const i=[u];let l=u.byteLength;d&&(i.unshift(d),l+=d.byteLength),c=(i=>{let l,d=0;return i.bytes&&(l=new Uint8Array(i.bytes),i.segments.forEach((i=>{l.set(i,d),d+=i.byteLength}))),l})({bytes:l,segments:i})}const h={segmentInfo:segmentInfoPayload({type:this.loaderType_,segment:i})};this.trigger({type:"segmentappendstart",metadata:h}),this.sourceUpdater_.appendBuffer({segmentInfo:i,type:l,bytes:c},this.handleAppendError_.bind(this,{segmentInfo:i,type:l,bytes:c}))}handleSegmentTimingInfo_(i,l,d){if(!this.pendingSegment_||l!==this.pendingSegment_.requestId)return;const u=this.pendingSegment_.segment,c=`${i}TimingInfo`;u[c]||(u[c]={}),u[c].transmuxerPrependedSeconds=d.prependedContentDuration||0,u[c].transmuxedPresentationStart=d.start.presentation,u[c].transmuxedDecodeStart=d.start.decode,u[c].transmuxedPresentationEnd=d.end.presentation,u[c].transmuxedDecodeEnd=d.end.decode,u[c].baseMediaDecodeTime=d.baseMediaDecodeTime}appendData_(i,l){const{type:d,data:u}=l;if(!u||!u.byteLength)return;if("audio"===d&&this.audioDisabled_)return;const c=this.getInitSegmentAndUpdateState_({type:d,initSegment:l.initSegment,playlist:i.playlist,map:i.isFmp4?i.segment.map:null});this.appendToSourceBuffer_({segmentInfo:i,type:d,initSegment:c,data:u})}loadSegment_(i){if(this.state="WAITING",this.pendingSegment_=i,this.trimBackBuffer_(i),"number"==typeof i.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_())return checkAndFixTimelines(this),this.loadQueue_.push((()=>{const l=_extends({},i,{forceTimestampOffset:!0});_extends(i,this.generateSegmentInfo_(l)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(i)})),void 0;this.updateTransmuxerAndRequestSegment_(i)}updateTransmuxerAndRequestSegment_(i){this.shouldUpdateTransmuxerTimestampOffset_(i.timestampOffset)&&(this.gopBuffer_.length=0,i.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:i.timestampOffset}));const l=this.createSimplifiedSegmentObj_(i),d=this.isEndOfStream_(i.mediaIndex,i.playlist,i.partIndex)||null!==this.mediaIndex&&(i.timeline!==this.currentTimeline_&&i.timeline>0);this.logger_(`Requesting\n${compactSegmentUrlDescription(i.uri)}\n${segmentInfoString(i)}`),l.map&&!l.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),i.abortRequests=mediaSegmentRequest({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:l,abortFn:this.handleAbort_.bind(this,i),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",i.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",i.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:d,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:l,level:d,stream:u})=>{this.logger_(`${segmentInfoString(i)} logged from transmuxer stream ${u} as a ${d}: ${l}`)},triggerSegmentEventFn:({type:i,segment:l,keyInfo:d,trackInfo:u,timingInfo:c})=>{const h={segmentInfo:segmentInfoPayload({segment:l})};d&&(h.keyInfo=d),u&&(h.trackInfo=u),c&&(h.timingInfo=c),this.trigger({type:i,metadata:h})}})}trimBackBuffer_(i){const l=((i,l,d)=>{let u=l-Fi.BACK_BUFFER_LENGTH;return i.length&&(u=Math.max(u,i.start(0))),Math.min(l-d,u)})(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);l>0&&this.remove(0,l)}createSimplifiedSegmentObj_(i){const l=i.segment,d=i.part,u={resolvedUri:d?d.resolvedUri:l.resolvedUri,byterange:d?d.byterange:l.byterange,requestId:i.requestId,transmuxer:i.transmuxer,audioAppendStart:i.audioAppendStart,gopsToAlignWith:i.gopsToAlignWith,part:i.part,type:this.loaderType_,start:i.startOfSegment,duration:i.duration,isEncrypted:i.segment.key||i.segment.map&&i.segment.map.key,isMediaInitialization:i.segment.map&&!i.segment.map.bytes},c=i.playlist.segments[i.mediaIndex-1];if(c&&c.timeline===l.timeline&&(c.videoTimingInfo?u.baseStartTime=c.videoTimingInfo.transmuxedDecodeEnd:c.audioTimingInfo&&(u.baseStartTime=c.audioTimingInfo.transmuxedDecodeEnd)),l.key){const d=l.key.iv||new Uint32Array([0,0,0,i.mediaIndex+i.playlist.mediaSequence]);u.key=this.segmentKey(l.key),u.key.iv=d}return l.map&&(u.map=this.initSegmentForMap(l.map)),u}saveTransferStats_(i){this.mediaRequests+=1,i&&(this.mediaBytesTransferred+=i.bytesReceived,this.mediaTransferDuration+=i.roundTripTime)}saveBandwidthRelatedStats_(i,l){if(this.pendingSegment_.byteLength=l.bytesReceived,i<Qi)return this.logger_(`Ignoring segment's bandwidth because its duration of ${i} is less than the min to record 0.016666666666666666`),void 0;this.trigger({type:"bandwidthupdated",metadata:{bandwidthInfo:{from:this.bandwidth,to:l.bandwidth}}}),this.bandwidth=l.bandwidth,this.roundTrip=l.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(i,l,d){if(this.callQueue_.length)return this.callQueue_.push(this.segmentRequestFinished_.bind(this,i,l,d)),void 0;if(this.saveTransferStats_(l.stats),!this.pendingSegment_)return;if(l.requestId!==this.pendingSegment_.requestId)return;if(i){if(this.pendingSegment_=null,this.state="READY",i.code===zi)return;return this.pause(),i.code===$i?(this.handleTimeout_(),void 0):(this.mediaRequestsErrored+=1,this.error(i),this.trigger("error"),void 0)}const u=this.pendingSegment_;this.saveBandwidthRelatedStats_(u.duration,l.stats),u.endOfAllRequests=l.endOfAllRequests,d.gopInfo&&(this.gopBuffer_=((i,l,d)=>{if(!l.length)return i;if(d)return l.slice();const u=l[0].pts;let c=0;for(c;c<i.length&&!(i[c].pts>=u);c++);return i.slice(0,c).concat(l)})(this.gopBuffer_,d.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(u)}setTimeMapping_(i){const l=this.syncController_.mappingForTimeline(i);null!==l&&(this.timeMapping_=l)}updateMediaSecondsLoaded_(i){this.mediaSecondsLoaded+="number"==typeof i.start&&"number"==typeof i.end?i.end-i.start:i.duration}shouldUpdateTransmuxerTimestampOffset_(i){return null!==i&&("main"===this.loaderType_&&i!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&i!==this.sourceUpdater_.audioTimestampOffset())}trueSegmentStart_({currentStart:i,playlist:l,mediaIndex:d,firstVideoFrameTimeForData:u,currentVideoTimestampOffset:c,useVideoTimingInfo:h,videoTimingInfo:p,audioTimingInfo:m}){if(void 0!==i)return i;if(!h)return m.start;const g=l.segments[d-1];return 0!==d&&g&&void 0!==g.start&&g.end===u+c?p.start:u}waitForAppendsToComplete_(i){const l=this.getCurrentMediaInfo_(i);if(!l)return this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error"),void 0;const{hasAudio:d,hasVideo:u,isMuxed:c}=l,h="main"===this.loaderType_&&u,p=!this.audioDisabled_&&d&&!c;if(i.waitingOnAppends=0,!i.hasAppendedData_)return i.timingInfo||"number"!=typeof i.timestampOffset||(this.isPendingTimestampOffset_=!0),i.timingInfo={start:0},i.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(i),this.processMetadataQueue_()),this.checkAppendsDone_(i),void 0;h&&i.waitingOnAppends++,p&&i.waitingOnAppends++,h&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,i)),p&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,i))}checkAppendsDone_(i){this.checkForAbort_(i.requestId)||(i.waitingOnAppends--,0===i.waitingOnAppends&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(i){const l=((i,l,d)=>"main"===i&&l&&d?d.hasAudio||d.hasVideo?l.hasVideo&&!d.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!l.hasVideo&&d.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null)(this.loaderType_,this.getCurrentMediaInfo_(),i);return!!l&&(this.error({message:l,playlistExclusionDuration:1/0}),this.trigger("error"),!0)}updateSourceBufferTimestampOffset_(i){if(null===i.timestampOffset||"number"!=typeof i.timingInfo.start||i.changedTimestampOffset||"main"!==this.loaderType_)return;let l=!1;i.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:i.segment.videoTimingInfo,audioTimingInfo:i.segment.audioTimingInfo,timingInfo:i.timingInfo}),i.changedTimestampOffset=!0,i.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(i.timestampOffset),l=!0),i.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(i.timestampOffset),l=!0),l&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:i,audioTimingInfo:l,timingInfo:d}){return this.useDtsForTimestampOffset_?i&&"number"==typeof i.transmuxedDecodeStart?i.transmuxedDecodeStart:l&&"number"==typeof l.transmuxedDecodeStart?l.transmuxedDecodeStart:d.start:d.start}updateTimingInfoEnd_(i){i.timingInfo=i.timingInfo||{};const l=this.getMediaInfo_(),d="main"===this.loaderType_&&l&&l.hasVideo&&i.videoTimingInfo?i.videoTimingInfo:i.audioTimingInfo;d&&(i.timingInfo.end="number"==typeof d.end?d.end:d.start+i.duration)}handleAppendsDone_(){if(this.pendingSegment_){const i={segmentInfo:segmentInfoPayload({type:this.loaderType_,segment:this.pendingSegment_})};this.trigger({type:"appendsdone",metadata:i})}if(!this.pendingSegment_)return this.state="READY",this.paused()||this.monitorBuffer_(),void 0;const i=this.pendingSegment_;i.part&&i.part.syncInfo?i.part.syncInfo.markAppended():i.segment.syncInfo&&i.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(i),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:"main"===this.loaderType_});const l=getTroublesomeSegmentDurationMessage(i,this.sourceType_);if(l&&("warn"===l.severity?videojs.log.warn(l.message):this.logger_(l.message)),this.recordThroughput_(i),this.pendingSegment_=null,this.state="READY",i.isSyncRequest&&(this.trigger("syncinfoupdate"),!i.hasAppendedData_))return this.logger_(`Throwing away un-appended sync request ${segmentInfoString(i)}`),void 0;this.logger_(`Appended ${segmentInfoString(i)}`),this.addSegmentMetadataCue_(i),this.fetchAtBuffer_=!0,this.currentTimeline_!==i.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:i.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:i.timeline})),this.currentTimeline_=i.timeline,this.trigger("syncinfoupdate");const d=i.segment,u=i.part,c=d.end&&this.currentTime_()-d.end>3*i.playlist.targetDuration,h=u&&u.end&&this.currentTime_()-u.end>3*i.playlist.partTargetDuration;if(c||h)return this.logger_(`bad ${c?"segment":"part"} ${segmentInfoString(i)}`),this.resetEverything(),void 0;null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=i.mediaIndex,this.partIndex=i.partIndex,this.isEndOfStream_(i.mediaIndex,i.playlist,i.partIndex)&&this.endOfStream(),this.trigger("appended"),i.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(i){if(i.duration<Qi)return this.logger_(`Ignoring segment's throughput because its duration of ${i.duration} is less than the min to record 0.016666666666666666`),void 0;const l=this.throughput.rate,d=Date.now()-i.endOfAllRequests+1,u=Math.floor(i.byteLength/d*8*1e3);this.throughput.rate+=(u-l)/++this.throughput.count}addSegmentMetadataCue_(i){if(!this.segmentMetadataTrack_)return;const l=i.segment,d=l.start,u=l.end;if(!finite(d)||!finite(u))return;removeCuesFromTrack(d,u,this.segmentMetadataTrack_);const c=p().WebKitDataCue||p().VTTCue,h={custom:l.custom,dateTimeObject:l.dateTimeObject,dateTimeString:l.dateTimeString,programDateTime:l.programDateTime,bandwidth:i.playlist.attributes.BANDWIDTH,resolution:i.playlist.attributes.RESOLUTION,codecs:i.playlist.attributes.CODECS,byteLength:i.byteLength,uri:i.uri,timeline:i.timeline,playlist:i.playlist.id,start:d,end:u},m=new c(d,u,JSON.stringify(h));m.value=h,this.segmentMetadataTrack_.addCue(m)}}function noop(){}const toTitleCase=function(i){return"string"!=typeof i?i:i.replace(/./,(i=>i.toUpperCase()))},Ji=["video","audio"],updating=(i,l)=>{const d=l[`${i}Buffer`];return d&&d.updating||l.queuePending[i]},shiftQueue=(i,l)=>{if(0===l.queue.length)return;let d=0,u=l.queue[d];if("mediaSource"===u.type)return l.updating()||"closed"===l.mediaSource.readyState||(l.queue.shift(),u.action(l),u.doneFn&&u.doneFn(),shiftQueue("audio",l),shiftQueue("video",l)),void 0;if("mediaSource"!==i&&l.ready()&&"closed"!==l.mediaSource.readyState&&!updating(i,l)){if(u.type!==i){if(d=((i,l)=>{for(let d=0;d<l.length;d++){const u=l[d];if("mediaSource"===u.type)return null;if(u.type===i)return d}return null})(i,l.queue),null===d)return;u=l.queue[d]}return l.queue.splice(d,1),l.queuePending[i]=u,u.action(i,l),u.doneFn||(l.queuePending[i]=null,shiftQueue(i,l)),void 0}},cleanupBuffer=(i,l)=>{const d=l[`${i}Buffer`],u=toTitleCase(i);d&&(d.removeEventListener("updateend",l[`on${u}UpdateEnd_`]),d.removeEventListener("error",l[`on${u}Error_`]),l.codecs[i]=null,l[`${i}Buffer`]=null)},inSourceBuffers=(i,l)=>i&&l&&-1!==Array.prototype.indexOf.call(i.sourceBuffers,l),actions_appendBuffer=(i,l,d)=>(u,c)=>{const h=c[`${u}Buffer`];if(inSourceBuffers(c.mediaSource,h)){c.logger_(`Appending segment ${l.mediaIndex}'s ${i.length} bytes to ${u}Buffer`);try{h.appendBuffer(i)}catch(i){c.logger_(`Error with code ${i.code} `+(22===i.code?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${l.mediaIndex} to ${u}Buffer`),c.queuePending[u]=null,d(i)}}},actions_remove=(i,l)=>(d,u)=>{const c=u[`${d}Buffer`];if(inSourceBuffers(u.mediaSource,c)){u.logger_(`Removing ${i} to ${l} from ${d}Buffer`);try{c.remove(i,l)}catch(c){u.logger_(`Remove ${i} to ${l} from ${d}Buffer failed`)}}},actions_timestampOffset=i=>(l,d)=>{const u=d[`${l}Buffer`];inSourceBuffers(d.mediaSource,u)&&(d.logger_(`Setting ${l}timestampOffset to ${i}`),u.timestampOffset=i)},actions_callback=i=>(l,d)=>{i()},actions_endOfStream=i=>l=>{if("open"===l.mediaSource.readyState){l.logger_(`Calling mediaSource endOfStream(${i||""})`);try{l.mediaSource.endOfStream(i)}catch(i){videojs.log.warn("Failed to call media source endOfStream",i)}}},actions_duration=i=>l=>{l.logger_(`Setting mediaSource duration to ${i}`);try{l.mediaSource.duration=i}catch(i){videojs.log.warn("Failed to set media source duration",i)}},actions_abort=()=>(i,l)=>{if("open"!==l.mediaSource.readyState)return;const d=l[`${i}Buffer`];if(inSourceBuffers(l.mediaSource,d)){l.logger_(`calling abort on ${i}Buffer`);try{d.abort()}catch(l){videojs.log.warn(`Failed to abort on ${i}Buffer`,l)}}},actions_addSourceBuffer=(i,l)=>d=>{const u=toTitleCase(i),c=L(l);d.logger_(`Adding ${i}Buffer with codec ${l} to mediaSource`);const h=d.mediaSource.addSourceBuffer(c);h.addEventListener("updateend",d[`on${u}UpdateEnd_`]),h.addEventListener("error",d[`on${u}Error_`]),d.codecs[i]=l,d[`${i}Buffer`]=h},actions_removeSourceBuffer=i=>l=>{const d=l[`${i}Buffer`];if(cleanupBuffer(i,l),inSourceBuffers(l.mediaSource,d)){l.logger_(`Removing ${i}Buffer with codec ${l.codecs[i]} from mediaSource`);try{l.mediaSource.removeSourceBuffer(d)}catch(l){videojs.log.warn(`Failed to removeSourceBuffer ${i}Buffer`,l)}}},actions_changeType=i=>(l,d)=>{const u=d[`${l}Buffer`],c=L(i);if(!inSourceBuffers(d.mediaSource,u))return;const h=i.substring(0,i.indexOf(".")),p=d.codecs[l];if(p.substring(0,p.indexOf("."))===h)return;const m={codecsChangeInfo:{from:p,to:i}};d.trigger({type:"codecschange",metadata:m}),d.logger_(`changing ${l}Buffer codec from ${p} to ${i}`);try{u.changeType(c),d.codecs[l]=i}catch(i){m.errorType=videojs.Error.StreamingCodecsChangeError,m.error=i,i.metadata=m,d.error_=i,d.trigger("error"),videojs.log.warn(`Failed to changeType on ${l}Buffer`,i)}},pushQueue=({type:i,sourceUpdater:l,action:d,doneFn:u,name:c})=>{l.queue.push({type:i,action:d,doneFn:u,name:c}),shiftQueue(i,l)},onUpdateend=(i,l)=>d=>{const u=function bufferedRangesToString(i){if(0===i.length)return"Buffered Ranges are empty";let l="Buffered Ranges: \n";for(let d=0;d<i.length;d++){const u=i.start(d),c=i.end(d);l+=`${u} --\x3e ${c}. Duration (${c-u})\n`}return l}(l[`${i}Buffered`]());if(l.logger_(`received "updateend" event for ${i} Source Buffer: `,u),l.queuePending[i]){const d=l.queuePending[i].doneFn;l.queuePending[i]=null,d&&d(l[`${i}Error_`])}shiftQueue(i,l)};class SourceUpdater extends videojs.EventTarget{constructor(i){super(),this.mediaSource=i,this.sourceopenListener_=()=>shiftQueue("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=logger("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=onUpdateend("video",this),this.onAudioUpdateEnd_=onUpdateend("audio",this),this.onVideoError_=i=>{this.videoError_=i},this.onAudioError_=i=>{this.audioError_=i},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(i){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(i),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(i,l){pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_addSourceBuffer(i,l),name:"addSourceBuffer"})}abort(i){pushQueue({type:i,sourceUpdater:this,action:actions_abort(i),name:"abort"})}removeSourceBuffer(i){if(!this.canRemoveSourceBuffer())return videojs.log.error("removeSourceBuffer is not supported!"),void 0;pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_removeSourceBuffer(i),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!videojs.browser.IS_FIREFOX&&p().MediaSource&&p().MediaSource.prototype&&"function"==typeof p().MediaSource.prototype.removeSourceBuffer}static canChangeType(){return p().SourceBuffer&&p().SourceBuffer.prototype&&"function"==typeof p().SourceBuffer.prototype.changeType}canChangeType(){return this.constructor.canChangeType()}changeType(i,l){if(!this.canChangeType())return videojs.log.error("changeType is not supported!"),void 0;pushQueue({type:i,sourceUpdater:this,action:actions_changeType(l),name:"changeType"})}addOrChangeSourceBuffers(i){if(!i||"object"!=typeof i||0===Object.keys(i).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(i).forEach((l=>{const d=i[l];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(l,d);this.canChangeType()&&this.changeType(l,d)}))}appendBuffer(i,l){const{segmentInfo:d,type:u,bytes:c}=i;if(this.processedAppend_=!0,"audio"===u&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([i,l]),this.logger_(`delayed audio append of ${c.length} until video append`),void 0;if(pushQueue({type:u,sourceUpdater:this,action:actions_appendBuffer(c,d||{mediaIndex:-1},l),doneFn:l,name:"appendBuffer"}),"video"===u){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const i=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${i.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,i.forEach((i=>{this.appendBuffer.apply(this,i)}))}}audioBuffered(){return inSourceBuffers(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:createTimeRanges()}videoBuffered(){return inSourceBuffers(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:createTimeRanges()}buffered(){const i=inSourceBuffers(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,l=inSourceBuffers(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return l&&!i?this.audioBuffered():i&&!l?this.videoBuffered():function(i,l){let d=null,u=null,c=0;const h=[],p=[];if(!(i&&i.length&&l&&l.length))return createTimeRanges();let m=i.length;for(;m--;)h.push({time:i.start(m),type:"start"}),h.push({time:i.end(m),type:"end"});for(m=l.length;m--;)h.push({time:l.start(m),type:"start"}),h.push({time:l.end(m),type:"end"});for(h.sort((function(i,l){return i.time-l.time})),m=0;m<h.length;m++)"start"===h[m].type?(c++,2===c&&(d=h[m].time)):"end"===h[m].type&&(c--,1===c&&(u=h[m].time)),null!==d&&null!==u&&(p.push([d,u]),d=null,u=null);return createTimeRanges(p)}(this.audioBuffered(),this.videoBuffered())}setDuration(i,l=noop){pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_duration(i),name:"duration",doneFn:l})}endOfStream(i=null,l=noop){"string"!=typeof i&&(i=void 0),pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_endOfStream(i),name:"endOfStream",doneFn:l})}removeAudio(i,l,d=noop){if(!this.audioBuffered().length||0===this.audioBuffered().end(0))return d(),void 0;pushQueue({type:"audio",sourceUpdater:this,action:actions_remove(i,l),doneFn:d,name:"remove"})}removeVideo(i,l,d=noop){if(!this.videoBuffered().length||0===this.videoBuffered().end(0))return d(),void 0;pushQueue({type:"video",sourceUpdater:this,action:actions_remove(i,l),doneFn:d,name:"remove"})}updating(){return!(!updating("audio",this)&&!updating("video",this))}audioTimestampOffset(i){return void 0!==i&&this.audioBuffer&&this.audioTimestampOffset_!==i&&(pushQueue({type:"audio",sourceUpdater:this,action:actions_timestampOffset(i),name:"timestampOffset"}),this.audioTimestampOffset_=i),this.audioTimestampOffset_}videoTimestampOffset(i){return void 0!==i&&this.videoBuffer&&this.videoTimestampOffset_!==i&&(pushQueue({type:"video",sourceUpdater:this,action:actions_timestampOffset(i),name:"timestampOffset"}),this.videoTimestampOffset_=i),this.videoTimestampOffset_}audioQueueCallback(i){this.audioBuffer&&pushQueue({type:"audio",sourceUpdater:this,action:actions_callback(i),name:"callback"})}videoQueueCallback(i){this.videoBuffer&&pushQueue({type:"video",sourceUpdater:this,action:actions_callback(i),name:"callback"})}dispose(){this.trigger("dispose"),Ji.forEach((i=>{this.abort(i),this.canRemoveSourceBuffer()?this.removeSourceBuffer(i):this[`${i}QueueCallback`]((()=>cleanupBuffer(i,this)))})),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const uint8ToUtf8=i=>decodeURIComponent(escape(String.fromCharCode.apply(null,i))),Zi=new Uint8Array("\n\n".split("").map((i=>i.charCodeAt(0))));class NoVttJsError extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class VTTSegmentLoader extends SegmentLoader{constructor(i,l={}){super(i,l),this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=i.featuresNativeTextTracks,this.loadVttJs=i.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return createTimeRanges();const i=this.subtitlesTrack_.cues;return createTimeRanges([[i[0].startTime,i[i.length-1].startTime]])}initSegmentForMap(i,l=!1){if(!i)return null;const d=initSegmentId(i);let u=this.initSegments_[d];if(l&&!u&&i.bytes){const l=new Uint8Array(Zi.byteLength+i.bytes.byteLength);l.set(i.bytes),l.set(Zi,i.bytes.byteLength),this.initSegments_[d]=u={resolvedUri:i.resolvedUri,byterange:i.byterange,bytes:l}}return u||i}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(i){return void 0===i||(this.subtitlesTrack_=i,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}remove(i,l){removeCuesFromTrack(i,l,this.subtitlesTrack_)}fillBuffer_(){const i=this.chooseNextRequest_();if(i){if(null===this.syncController_.timestampOffsetForTimeline(i.timeline)){return this.syncController_.one("timestampoffset",(()=>{this.state="READY",this.paused()||this.monitorBuffer_()})),this.state="WAITING_ON_TIMELINE",void 0}this.loadSegment_(i)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(i){for(;i&&i.segment.empty;){if(i.mediaIndex+1>=i.playlist.segments.length){i=null;break}i=this.generateSegmentInfo_({playlist:i.playlist,mediaIndex:i.mediaIndex+1,startOfSegment:i.startOfSegment+i.duration,isSyncRequest:i.isSyncRequest})}return i}stopForError(i){this.error(i),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(i,l,d){if(!this.subtitlesTrack_)return this.state="READY",void 0;if(this.saveTransferStats_(l.stats),!this.pendingSegment_)return this.state="READY",this.mediaRequestsAborted+=1,void 0;if(i)return i.code===$i&&this.handleTimeout_(),i.code===zi?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(i),void 0;const u=this.pendingSegment_,c=d.mp4VttCues&&d.mp4VttCues.length;c&&(u.mp4VttCues=d.mp4VttCues),this.saveBandwidthRelatedStats_(u.duration,l.stats),l.key&&this.segmentKey(l.key,!0),this.state="APPENDING",this.trigger("appending");const h=u.segment;if(h.map&&(h.map.bytes=l.map.bytes),u.bytes=l.bytes,"function"!=typeof p().WebVTT&&"function"==typeof this.loadVttJs)return this.state="WAITING_ON_VTTJS",this.loadVttJs().then((()=>this.segmentRequestFinished_(i,l,d)),(()=>this.stopForError({message:"Error loading vtt.js"}))),void 0;h.requested=!0;try{this.parseVTTCues_(u)}catch(i){return this.stopForError({message:i.message,metadata:{errorType:videojs.Error.StreamingVttParserError,error:i}}),void 0}if(c||this.updateTimeMapping_(u,this.syncController_.timelines[u.timeline],this.playlist_),u.timingInfo=u.cues.length?{start:u.cues[0].startTime,end:u.cues[u.cues.length-1].endTime}:{start:u.startOfSegment,end:u.startOfSegment+u.duration},u.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY",void 0;u.byteLength=u.bytes.byteLength,this.mediaSecondsLoaded+=h.duration,u.cues.forEach((i=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new(p().VTTCue)(i.startTime,i.endTime,i.text):i)})),function(i){const l=i.cues;if(!l)return;const d={};for(let u=l.length-1;u>=0;u--){const c=l[u],h=`${c.startTime}-${c.endTime}-${c.text}`;d[h]?i.removeCue(c):d[h]=c}}(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(i,l){i&&"vtt"===i.type&&(l&&"text"===l.type)&&super.handleData_(i,l)}updateTimingInfoEnd_(){}parseMp4VttCues_(i){const l=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();i.mp4VttCues.forEach((d=>{const u=d.start+l,c=d.end+l,h=new(p().VTTCue)(u,c,d.cueText);d.settings&&d.settings.split(" ").forEach((i=>{const l=i.split(":"),d=l[1];h[l[0]]=isNaN(d)?d:Number(d)})),i.cues.push(h)}))}parseVTTCues_(i){let l,d=!1;if("function"!=typeof p().WebVTT)throw new NoVttJsError;if(i.cues=[],i.timestampmap={MPEGTS:0,LOCAL:0},i.mp4VttCues)return this.parseMp4VttCues_(i),void 0;"function"==typeof p().TextDecoder?l=new(p().TextDecoder)("utf8"):(l=p().WebVTT.StringDecoder(),d=!0);const u=new(p().WebVTT.Parser)(p(),p().vttjs,l);if(u.oncue=i.cues.push.bind(i.cues),u.ontimestampmap=l=>{i.timestampmap=l},u.onparsingerror=i=>{videojs.log.warn("Error encountered when parsing cues: "+i.message)},i.segment.map){let l=i.segment.map.bytes;d&&(l=uint8ToUtf8(l)),u.parse(l)}let c=i.bytes;d&&(c=uint8ToUtf8(c)),u.parse(c),u.flush()}updateTimeMapping_(i,l,d){const u=i.segment;if(!l)return;if(!i.cues.length)return u.empty=!0,void 0;const{MPEGTS:c,LOCAL:h}=i.timestampmap,p=c/Me.ONE_SECOND_IN_TS-h+l.mapping;if(i.cues.forEach((i=>{const d=i.endTime-i.startTime,u=this.handleRollover_(i.startTime+p,l.time);i.startTime=Math.max(u,0),i.endTime=Math.max(u+d,0)})),!d.syncInfo){d.syncInfo={mediaSequence:d.mediaSequence+i.mediaIndex,time:Math.min(i.cues[0].startTime,i.cues[i.cues.length-1].startTime-u.duration)}}}handleRollover_(i,l){if(null===l)return i;let d=i*Me.ONE_SECOND_IN_TS;const u=l*Me.ONE_SECOND_IN_TS;let c;for(c=u<d?-8589934592:8589934592;Math.abs(d-u)>4294967296;)d+=c;return d/Me.ONE_SECOND_IN_TS}}const findAdCue=function(i,l){const d=i.cues;for(let i=0;i<d.length;i++){const u=d[i];if(l>=u.adStartTime&&l<=u.adEndTime)return u}return null};class SyncInfo{constructor({start:i,end:l,segmentIndex:d,partIndex:u=null,appended:c=!1}){this.start_=i,this.end_=l,this.segmentIndex_=d,this.partIndex_=u,this.appended_=c}isInRange(i){return i>=this.start&&i<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class SyncInfoData{constructor(i,l=[]){this.segmentSyncInfo_=i,this.partsSyncInfo_=l}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return this.partsSyncInfo_.length>0}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach((i=>i.resetAppendedStatus()))}}class MediaSequenceSync{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-1/0,this.end_=1/0}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach((i=>i.resetAppendStatus()))}update(i,l){const{mediaSequence:d,segments:u}=i;if(this.isReliable_=this.isReliablePlaylist_(d,u),this.isReliable_)return this.updateStorage_(u,d,this.calculateBaseTime_(d,u,l))}getSyncInfoForTime(i){for(const{segmentSyncInfo:l,partsSyncInfo:d}of this.storage_.values())if(d.length){for(const l of d)if(l.isInRange(i))return l}else if(l.isInRange(i))return l;return null}getSyncInfoForMediaSequence(i){return this.storage_.get(i)}updateStorage_(i,l,d){const u=new Map;let c="\n",h=d,p=l;this.start_=h,i.forEach(((i,l)=>{const d=this.storage_.get(p),m=h,g=m+i.duration,y=Boolean(d&&d.segmentSyncInfo&&d.segmentSyncInfo.isAppended),_=new SyncInfo({start:m,end:g,appended:y,segmentIndex:l});i.syncInfo=_;let v=h;const b=(i.parts||[]).map(((i,u)=>{const h=v,m=v+i.duration,g=Boolean(d&&d.partsSyncInfo&&d.partsSyncInfo[u]&&d.partsSyncInfo[u].isAppended),y=new SyncInfo({start:h,end:m,appended:g,segmentIndex:l,partIndex:u});return v=m,c+=`Media Sequence: ${p}.${u} | Range: ${h} --\x3e ${m} | Appended: ${g}\n`,i.syncInfo=y,y}));u.set(p,new SyncInfoData(_,b)),c+=`${compactSegmentUrlDescription(i.resolvedUri)} | Media Sequence: ${p} | Range: ${m} --\x3e ${g} | Appended: ${y}\n`,p++,h=g})),this.end_=h,this.storage_=u,this.diagnostics_=c}calculateBaseTime_(i,l,d){if(!this.storage_.size)return 0;if(this.storage_.has(i))return this.storage_.get(i).segmentSyncInfo.start;const u=Math.min(...this.storage_.keys());if(i<u){const d=u-i;let c=this.storage_.get(u).segmentSyncInfo.start;for(let i=0;i<d;i++){c-=l[i].duration}return c}return d}isReliablePlaylist_(i,l){return null!=i&&Array.isArray(l)&&l.length}}class DependantMediaSequenceSync extends MediaSequenceSync{constructor(i){super(),this.parent_=i}calculateBaseTime_(i,l,d){if(!this.storage_.size){const l=this.parent_.getSyncInfoForMediaSequence(i);return l?l.segmentSyncInfo.start:0}return super.calculateBaseTime_(i,l,d)}}const er=[{name:"VOD",run:(i,l,d,u,c)=>{if(d!==1/0){return{time:0,segmentIndex:0,partIndex:null}}return null}},{name:"MediaSequence",run:(i,l,d,u,c,h)=>{const p=i.getMediaSequenceSync(h);if(!p)return null;if(!p.isReliable)return null;const m=p.getSyncInfoForTime(c);return m?{time:m.start,partIndex:m.partIndex,segmentIndex:m.segmentIndex}:null}},{name:"ProgramDateTime",run:(i,l,d,u,c)=>{if(!Object.keys(i.timelineToDatetimeMappings).length)return null;let h=null,p=null;const m=getPartsAndSegments(l);c=c||0;for(let d=0;d<m.length;d++){const u=m[l.endList||0===c?d:m.length-(d+1)],g=u.segment,y=i.timelineToDatetimeMappings[g.timeline];if(!y||!g.dateTimeObject)continue;let _=g.dateTimeObject.getTime()/1e3+y;if(g.parts&&"number"==typeof u.partIndex)for(let i=0;i<u.partIndex;i++)_+=g.parts[i].duration;const v=Math.abs(c-_);if(null!==p&&(0===v||p<v))break;p=v,h={time:_,segmentIndex:u.segmentIndex,partIndex:u.partIndex}}return h}},{name:"Segment",run:(i,l,d,u,c)=>{let h=null,p=null;c=c||0;const m=getPartsAndSegments(l);for(let i=0;i<m.length;i++){const d=m[l.endList||0===c?i:m.length-(i+1)],g=d.segment,y=d.part&&d.part.start||g&&g.start;if(g.timeline===u&&void 0!==y){const i=Math.abs(c-y);if(null!==p&&p<i)break;(!h||null===p||p>=i)&&(p=i,h={time:y,segmentIndex:d.segmentIndex,partIndex:d.partIndex})}}return h}},{name:"Discontinuity",run:(i,l,d,u,c)=>{let h=null;if(c=c||0,l.discontinuityStarts&&l.discontinuityStarts.length){let d=null;for(let u=0;u<l.discontinuityStarts.length;u++){const p=l.discontinuityStarts[u],m=i.discontinuities[l.discontinuitySequence+u+1];if(m){const i=Math.abs(c-m.time);if(null!==d&&d<i)break;(!h||null===d||d>=i)&&(d=i,h={time:m.time,segmentIndex:p,partIndex:null})}}}return h}},{name:"Playlist",run:(i,l,d,u,c)=>{if(l.syncInfo){return{time:l.syncInfo.time,segmentIndex:l.syncInfo.mediaSequence-l.mediaSequence,partIndex:null}}return null}}];class SyncController extends videojs.EventTarget{constructor(i={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={};const l=new MediaSequenceSync,d=new DependantMediaSequenceSync(l),u=new DependantMediaSequenceSync(l);this.mediaSequenceStorage_={main:l,audio:d,vtt:u},this.logger_=logger("SyncController")}getMediaSequenceSync(i){return this.mediaSequenceStorage_[i]||null}getSyncPoint(i,l,d,u,c){if(l!==1/0){return er.find((({name:i})=>"VOD"===i)).run(this,i,l)}const h=this.runStrategies_(i,l,d,u,c);if(!h.length)return null;for(const l of h){const{syncPoint:d,strategy:c}=l,{segmentIndex:h,time:p}=d;if(h<0)continue;const m=p,g=m+i.segments[h].duration;if(this.logger_(`Strategy: ${c}. Current time: ${u}. selected segment: ${h}. Time: [${m} -> ${g}]}`),u>=m&&u<g)return this.logger_("Found sync point with exact match: ",d),d}return this.selectSyncPoint_(h,{key:"time",value:u})}getExpiredTime(i,l){if(!i||!i.segments)return null;const d=this.runStrategies_(i,l,i.discontinuitySequence,0);if(!d.length)return null;const u=this.selectSyncPoint_(d,{key:"segmentIndex",value:0});return u.segmentIndex>0&&(u.time*=-1),Math.abs(u.time+sumDurations({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:u.segmentIndex,endIndex:0}))}runStrategies_(i,l,d,u,c){const h=[];for(let p=0;p<er.length;p++){const m=er[p],g=m.run(this,i,l,d,u,c);g&&(g.strategy=m.name,h.push({strategy:m.name,syncPoint:g}))}return h}selectSyncPoint_(i,l){let d=i[0].syncPoint,u=Math.abs(i[0].syncPoint[l.key]-l.value),c=i[0].strategy;for(let h=1;h<i.length;h++){const p=Math.abs(i[h].syncPoint[l.key]-l.value);p<u&&(u=p,d=i[h].syncPoint,c=i[h].strategy)}return this.logger_(`syncPoint for [${l.key}: ${l.value}] chosen with strategy [${c}]: [time:${d.time}, segmentIndex:${d.segmentIndex}`+("number"==typeof d.partIndex?`,partIndex:${d.partIndex}`:"")+"]"),d}saveExpiredSegmentInfo(i,l){const d=l.mediaSequence-i.mediaSequence;if(d>86400)return videojs.log.warn(`Not saving expired segment info. Media sequence gap ${d} is too large.`),void 0;for(let u=d-1;u>=0;u--){const d=i.segments[u];if(d&&void 0!==d.start){l.syncInfo={mediaSequence:i.mediaSequence+u,time:d.start},this.logger_(`playlist refresh sync: [time:${l.syncInfo.time}, mediaSequence: ${l.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(i){if(this.timelineToDatetimeMappings={},i.segments&&i.segments.length&&i.segments[0].dateTimeObject){const l=i.segments[0],d=l.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[l.timeline]=-d}}saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:l}){const d=this.calculateSegmentTimeMapping_(i,i.timingInfo,l),u=i.segment;d&&(this.saveDiscontinuitySyncInfo_(i),i.playlist.syncInfo||(i.playlist.syncInfo={mediaSequence:i.playlist.mediaSequence+i.mediaIndex,time:u.start}));const c=u.dateTimeObject;u.discontinuity&&l&&c&&(this.timelineToDatetimeMappings[u.timeline]=-c.getTime()/1e3)}timestampOffsetForTimeline(i){return void 0===this.timelines[i]?null:this.timelines[i].time}mappingForTimeline(i){return void 0===this.timelines[i]?null:this.timelines[i].mapping}calculateSegmentTimeMapping_(i,l,d){const u=i.segment,c=i.part;let h,p,m=this.timelines[i.timeline];if("number"==typeof i.timestampOffset)m={time:i.startOfSegment,mapping:i.startOfSegment-l.start},d&&(this.timelines[i.timeline]=m,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${i.timeline}: [time: ${m.time}] [mapping: ${m.mapping}]`)),h=i.startOfSegment,p=l.end+m.mapping;else{if(!m)return!1;h=l.start+m.mapping,p=l.end+m.mapping}return c&&(c.start=h,c.end=p),(!u.start||h<u.start)&&(u.start=h),u.end=p,!0}saveDiscontinuitySyncInfo_(i){const l=i.playlist,d=i.segment;if(d.discontinuity)this.discontinuities[d.timeline]={time:d.start,accuracy:0};else if(l.discontinuityStarts&&l.discontinuityStarts.length)for(let u=0;u<l.discontinuityStarts.length;u++){const c=l.discontinuityStarts[u],h=l.discontinuitySequence+u+1,p=c-i.mediaIndex,m=Math.abs(p);if(!this.discontinuities[h]||this.discontinuities[h].accuracy>m){let u;u=p<0?d.start-sumDurations({defaultDuration:l.targetDuration,durationList:l.segments,startIndex:i.mediaIndex,endIndex:c}):d.end+sumDurations({defaultDuration:l.targetDuration,durationList:l.segments,startIndex:i.mediaIndex+1,endIndex:c}),this.discontinuities[h]={time:u,accuracy:m}}}}dispose(){this.trigger("dispose"),this.off()}}class TimelineChangeController extends videojs.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(i){this.pendingTimelineChanges_[i]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:i,from:l,to:d}){return"number"==typeof l&&"number"==typeof d&&(this.pendingTimelineChanges_[i]={type:i,from:l,to:d},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[i]}lastTimelineChange({type:i,from:l,to:d}){if("number"==typeof l&&"number"==typeof d){this.lastTimelineChanges_[i]={type:i,from:l,to:d},delete this.pendingTimelineChanges_[i];this.trigger({type:"timelinechange",metadata:{timelineChangeInfo:{from:l,to:d}}})}return this.lastTimelineChanges_[i]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const tr=transform(getWorkerString((function(){var i=function(){function Stream(){this.listeners={}}var i=Stream.prototype;return i.on=function on(i,l){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(l)},i.off=function off(i,l){if(!this.listeners[i])return!1;var d=this.listeners[i].indexOf(l);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(d,1),d>-1},i.trigger=function trigger(i){var l=this.listeners[i];if(l)if(2===arguments.length)for(var d=l.length,u=0;u<d;++u)l[u].call(this,arguments[1]);else for(var c=Array.prototype.slice.call(arguments,1),h=l.length,p=0;p<h;++p)l[p].apply(this,c)},i.dispose=function dispose(){this.listeners={}},i.pipe=function pipe(i){this.on("data",(function(l){i.push(l)}))},Stream}();let l=null;class AES{constructor(i){let d,u,c;l||(l=function(){const i=[[[],[],[],[],[]],[[],[],[],[],[]]],l=i[0],d=i[1],u=l[4],c=d[4];let h,p,m;const g=[],y=[];let _,v,b,T,S,E;for(h=0;h<256;h++)y[(g[h]=h<<1^283*(h>>7))^h]=h;for(p=m=0;!u[p];p^=_||1,m=y[m]||1)for(T=m^m<<1^m<<2^m<<3^m<<4,T=T>>8^255&T^99,u[p]=T,c[T]=p,b=g[v=g[_=g[p]]],E=16843009*b^65537*v^257*_^16843008*p,S=257*g[T]^16843008*T,h=0;h<4;h++)l[h][p]=S=S<<24^S>>>8,d[h][T]=E=E<<24^E>>>8;for(h=0;h<5;h++)l[h]=l[h].slice(0),d[h]=d[h].slice(0);return i}()),this._tables=[[l[0][0].slice(),l[0][1].slice(),l[0][2].slice(),l[0][3].slice(),l[0][4].slice()],[l[1][0].slice(),l[1][1].slice(),l[1][2].slice(),l[1][3].slice(),l[1][4].slice()]];const h=this._tables[0][4],p=this._tables[1],m=i.length;let g=1;if(4!==m&&6!==m&&8!==m)throw new Error("Invalid aes key size");const y=i.slice(0),_=[];for(this._key=[y,_],d=m;d<4*m+28;d++)c=y[d-1],(d%m==0||8===m&&d%m==4)&&(c=h[c>>>24]<<24^h[c>>16&255]<<16^h[c>>8&255]<<8^h[255&c],d%m==0&&(c=c<<8^c>>>24^g<<24,g=g<<1^283*(g>>7))),y[d]=y[d-m]^c;for(u=0;d;u++,d--)c=y[3&u?d:d-4],_[u]=d<=4||u<4?c:p[0][h[c>>>24]]^p[1][h[c>>16&255]]^p[2][h[c>>8&255]]^p[3][h[255&c]]}decrypt(i,l,d,u,c,h){const p=this._key[1];let m,g,y,_=i^p[0],v=u^p[1],b=d^p[2],T=l^p[3];const S=p.length/4-2;let E,k=4;const w=this._tables[1],C=w[0],x=w[1],A=w[2],P=w[3],I=w[4];for(E=0;E<S;E++)m=C[_>>>24]^x[v>>16&255]^A[b>>8&255]^P[255&T]^p[k],g=C[v>>>24]^x[b>>16&255]^A[T>>8&255]^P[255&_]^p[k+1],y=C[b>>>24]^x[T>>16&255]^A[_>>8&255]^P[255&v]^p[k+2],T=C[T>>>24]^x[_>>16&255]^A[v>>8&255]^P[255&b]^p[k+3],k+=4,_=m,v=g,b=y;for(E=0;E<4;E++)c[(3&-E)+h]=I[_>>>24]<<24^I[v>>16&255]<<16^I[b>>8&255]<<8^I[255&T]^p[k++],m=_,_=v,v=b,b=T,T=m}}class AsyncStream extends i{constructor(){super(i),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null}push(i){this.jobs.push(i),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const ntoh=function(i){return i<<24|(65280&i)<<8|(16711680&i)>>8|i>>>24};class Decrypter{constructor(i,l,d,u){const c=Decrypter.STEP,h=new Int32Array(i.buffer),p=new Uint8Array(i.byteLength);let m=0;for(this.asyncStream_=new AsyncStream,this.asyncStream_.push(this.decryptChunk_(h.subarray(m,m+c),l,d,p)),m=c;m<h.length;m+=c)d=new Uint32Array([ntoh(h[m-4]),ntoh(h[m-3]),ntoh(h[m-2]),ntoh(h[m-1])]),this.asyncStream_.push(this.decryptChunk_(h.subarray(m,m+c),l,d,p));this.asyncStream_.push((function(){u(null,function unpad(i){return i.subarray(0,i.byteLength-i[i.byteLength-1])}(p))}))}static get STEP(){return 32e3}decryptChunk_(i,l,d,u){return function(){const c=function(i,l,d){const u=new Int32Array(i.buffer,i.byteOffset,i.byteLength>>2),c=new AES(Array.prototype.slice.call(l)),h=new Uint8Array(i.byteLength),p=new Int32Array(h.buffer);let m,g,y,_,v,b,T,S,E;for(m=d[0],g=d[1],y=d[2],_=d[3],E=0;E<u.length;E+=4)v=ntoh(u[E]),b=ntoh(u[E+1]),T=ntoh(u[E+2]),S=ntoh(u[E+3]),c.decrypt(v,b,T,S,p,E),p[E]=ntoh(p[E]^m),p[E+1]=ntoh(p[E+1]^g),p[E+2]=ntoh(p[E+2]^y),p[E+3]=ntoh(p[E+3]^_),m=v,g=b,y=T,_=S;return h}(i,l,d);u.set(c,i.byteOffset)}}}var d,u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};d="undefined"!=typeof window?window:void 0!==u?u:"undefined"!=typeof self?self:{};var c=d.BigInt||Number;[c("0x1"),c("0x100"),c("0x10000"),c("0x1000000"),c("0x100000000"),c("0x10000000000"),c("0x1000000000000"),c("0x100000000000000"),c("0x10000000000000000")],function(){var i=new Uint16Array([65484]),l=new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}();const createTransferableMessage=function(i){const l={};return Object.keys(i).forEach((d=>{const u=i[d];l[d]=function isArrayBufferView(i){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer}(u)?{bytes:u.buffer,byteOffset:u.byteOffset,byteLength:u.byteLength}:u})),l};self.onmessage=function(i){const l=i.data,d=new Uint8Array(l.encrypted.bytes,l.encrypted.byteOffset,l.encrypted.byteLength),u=new Uint32Array(l.key.bytes,l.key.byteOffset,l.key.byteLength/4),c=new Uint32Array(l.iv.bytes,l.iv.byteOffset,l.iv.byteLength/4);new Decrypter(d,u,c,(function(i,d){self.postMessage(createTransferableMessage({source:l.source,decrypted:d}),[d.buffer])}))}})));var ir=factory(tr);const audioTrackKind_=i=>{let l=i.default?"main":"alternative";return i.characteristics&&i.characteristics.indexOf("public.accessibility.describes-video")>=0&&(l="main-desc"),l},stopLoaders=(i,l)=>{i.abort(),i.pause(),l&&l.activePlaylistLoader&&(l.activePlaylistLoader.pause(),l.activePlaylistLoader=null)},startLoaders=(i,l)=>{l.activePlaylistLoader=i,i.load()},rr={AUDIO:(i,l)=>()=>{const{mediaTypes:{[i]:d},excludePlaylist:u}=l,c=d.activeTrack(),h=d.activeGroup(),p=(h.filter((i=>i.default))[0]||h[0]).id,m=d.tracks[p];if(c===m)return u({error:{message:"Problem encountered loading the default audio track."}}),void 0;videojs.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const i in d.tracks)d.tracks[i].enabled=d.tracks[i]===m;d.onTrackChanged()},SUBTITLES:(i,l)=>()=>{const{mediaTypes:{[i]:d}}=l;videojs.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const u=d.activeTrack();u&&(u.mode="disabled"),d.onTrackChanged()}},sr={AUDIO:(i,l,d)=>{if(!l)return;const{tech:u,requestOptions:c,segmentLoaders:{[i]:h}}=d;l.on("loadedmetadata",(()=>{const i=l.media();h.playlist(i,c),(!u.paused()||i.endList&&"none"!==u.preload())&&h.load()})),l.on("loadedplaylist",(()=>{h.playlist(l.media(),c),u.paused()||h.load()})),l.on("error",rr[i](i,d))},SUBTITLES:(i,l,d)=>{const{tech:u,requestOptions:c,segmentLoaders:{[i]:h},mediaTypes:{[i]:p}}=d;l.on("loadedmetadata",(()=>{const i=l.media();h.playlist(i,c),h.track(p.activeTrack()),(!u.paused()||i.endList&&"none"!==u.preload())&&h.load()})),l.on("loadedplaylist",(()=>{h.playlist(l.media(),c),u.paused()||h.load()})),l.on("error",rr[i](i,d))}},nr={AUDIO:(i,l)=>{const{vhs:d,sourceType:u,segmentLoaders:{[i]:c},requestOptions:h,main:{mediaGroups:p},mediaTypes:{[i]:{groups:m,tracks:g,logger_:y}},mainPlaylistLoader:_}=l,v=isAudioOnly(_.main);p[i]&&0!==Object.keys(p[i]).length||(p[i]={main:{default:{default:!0}}},v&&(p[i].main.default.playlists=_.main.playlists));for(const c in p[i]){m[c]||(m[c]=[]);for(const b in p[i][c]){let T,S=p[i][c][b];if(v?(y(`AUDIO group '${c}' label '${b}' is a main playlist`),S.isMainPlaylist=!0,T=null):T="vhs-json"===u&&S.playlists?new PlaylistLoader(S.playlists[0],d,h):S.resolvedUri?new PlaylistLoader(S.resolvedUri,d,h):S.playlists&&"dash"===u?new DashPlaylistLoader(S.playlists[0],d,h,_):null,S=video_es_merge({id:b,playlistLoader:T},S),sr[i](i,S.playlistLoader,l),m[c].push(S),void 0===g[b]){const i=new videojs.AudioTrack({id:b,kind:audioTrackKind_(S),enabled:!1,language:S.language,default:S.default,label:b});g[b]=i}}}c.on("error",rr[i](i,l))},SUBTITLES:(i,l)=>{const{tech:d,vhs:u,sourceType:c,segmentLoaders:{[i]:h},requestOptions:p,main:{mediaGroups:m},mediaTypes:{[i]:{groups:g,tracks:y}},mainPlaylistLoader:_}=l;for(const h in m[i]){g[h]||(g[h]=[]);for(const v in m[i][h]){if(!u.options_.useForcedSubtitles&&m[i][h][v].forced)continue;let b,T=m[i][h][v];if("hls"===c)b=new PlaylistLoader(T.resolvedUri,u,p);else if("dash"===c){if(!T.playlists.filter((i=>i.excludeUntil!==1/0)).length)return;b=new DashPlaylistLoader(T.playlists[0],u,p,_)}else"vhs-json"===c&&(b=new PlaylistLoader(T.playlists?T.playlists[0]:T.resolvedUri,u,p));if(T=video_es_merge({id:v,playlistLoader:b},T),sr[i](i,T.playlistLoader,l),g[h].push(T),void 0===y[v]){const i=d.addRemoteTextTrack({id:v,kind:"subtitles",default:T.default&&T.autoselect,language:T.language,label:v},!1).track;y[v]=i}}}h.on("error",rr[i](i,l))},"CLOSED-CAPTIONS":(i,l)=>{const{tech:d,main:{mediaGroups:u},mediaTypes:{[i]:{groups:c,tracks:h}}}=l;for(const l in u[i]){c[l]||(c[l]=[]);for(const p in u[i][l]){const m=u[i][l][p];if(!/^(?:CC|SERVICE)/.test(m.instreamId))continue;const g=d.options_.vhs&&d.options_.vhs.captionServices||{};let y={label:p,language:m.language,instreamId:m.instreamId,default:m.default&&m.autoselect};if(g[y.instreamId]&&(y=video_es_merge(y,g[y.instreamId])),void 0===y.default&&delete y.default,c[l].push(video_es_merge({id:p},m)),void 0===h[p]){const i=d.addRemoteTextTrack({id:y.instreamId,kind:"captions",default:y.default,language:y.language,label:y.label},!1).track;h[p]=i}}}}},groupMatch=(i,l)=>{for(let d=0;d<i.length;d++){if(playlistMatch(l,i[d]))return!0;if(i[d].playlists&&groupMatch(i[d].playlists,l))return!0}return!1},ar={AUDIO:(i,l)=>()=>{const{mediaTypes:{[i]:{tracks:d}}}=l;for(const i in d)if(d[i].enabled)return d[i];return null},SUBTITLES:(i,l)=>()=>{const{mediaTypes:{[i]:{tracks:d}}}=l;for(const i in d)if("showing"===d[i].mode||"hidden"===d[i].mode)return d[i];return null}},setupMediaGroups=i=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((l=>{nr[l](l,i)}));const{mediaTypes:l,mainPlaylistLoader:d,tech:u,vhs:c,segmentLoaders:{AUDIO:h,main:p}}=i;["AUDIO","SUBTITLES"].forEach((d=>{l[d].activeGroup=((i,l)=>d=>{const{mainPlaylistLoader:u,mediaTypes:{[i]:{groups:c}}}=l,h=u.media();if(!h)return null;let p=null;h.attributes[i]&&(p=c[h.attributes[i]]);const m=Object.keys(c);if(!p)if("AUDIO"===i&&m.length>1&&isAudioOnly(l.main))for(let i=0;i<m.length;i++){const l=c[m[i]];if(groupMatch(l,h)){p=l;break}}else c.main?p=c.main:1===m.length&&(p=c[m[0]]);return void 0===d?p:null!==d&&p&&p.filter((i=>i.id===d.id))[0]||null})(d,i),l[d].activeTrack=ar[d](d,i),l[d].onGroupChanged=((i,l)=>()=>{const{segmentLoaders:{[i]:d,main:u},mediaTypes:{[i]:c}}=l,h=c.activeTrack(),p=c.getActiveGroup(),m=c.activePlaylistLoader,g=c.lastGroup_;if((!p||!g||p.id!==g.id)&&(c.lastGroup_=p,c.lastTrack_=h,stopLoaders(d,c),p&&!p.isMainPlaylist)){if(!p.playlistLoader)return m&&u.resetEverything(),void 0;d.resyncLoader(),startLoaders(p.playlistLoader,c)}})(d,i),l[d].onGroupChanging=((i,l)=>()=>{const{segmentLoaders:{[i]:d},mediaTypes:{[i]:u}}=l;u.lastGroup_=null,d.abort(),d.pause()})(d,i),l[d].onTrackChanged=((i,l)=>()=>{const{mainPlaylistLoader:d,segmentLoaders:{[i]:u,main:c},mediaTypes:{[i]:h}}=l,p=h.activeTrack(),m=h.getActiveGroup(),g=h.activePlaylistLoader,y=h.lastTrack_;if((!y||!p||y.id!==p.id)&&(h.lastGroup_=m,h.lastTrack_=p,stopLoaders(u,h),m)){if(m.isMainPlaylist){if(!p||!y||p.id===y.id)return;const i=l.vhs.playlistController_,u=i.selectPlaylist();if(i.media()===u)return;return h.logger_(`track change. Switching main audio from ${y.id} to ${p.id}`),d.pause(),c.resetEverything(),i.fastQualityChange_(u),void 0}if("AUDIO"===i){if(!m.playlistLoader)return c.setAudio(!0),c.resetEverything(),void 0;u.setAudio(!0),c.setAudio(!1)}if(g===m.playlistLoader)return startLoaders(m.playlistLoader,h),void 0;u.track&&u.track(p),u.resetEverything(),startLoaders(m.playlistLoader,h)}})(d,i),l[d].getActiveGroup=((i,{mediaTypes:l})=>()=>{const d=l[i].activeTrack();return d?l[i].activeGroup(d):null})(d,i)}));const m=l.AUDIO.activeGroup();if(m){const i=(m.filter((i=>i.default))[0]||m[0]).id;l.AUDIO.tracks[i].enabled=!0,l.AUDIO.onGroupChanged(),l.AUDIO.onTrackChanged();l.AUDIO.getActiveGroup().playlistLoader?(p.setAudio(!1),h.setAudio(!0)):p.setAudio(!0)}d.on("mediachange",(()=>{["AUDIO","SUBTITLES"].forEach((i=>l[i].onGroupChanged()))})),d.on("mediachanging",(()=>{["AUDIO","SUBTITLES"].forEach((i=>l[i].onGroupChanging()))}));const onAudioTrackChanged=()=>{l.AUDIO.onTrackChanged(),u.trigger({type:"usage",name:"vhs-audio-change"})};u.audioTracks().addEventListener("change",onAudioTrackChanged),u.remoteTextTracks().addEventListener("change",l.SUBTITLES.onTrackChanged),c.on("dispose",(()=>{u.audioTracks().removeEventListener("change",onAudioTrackChanged),u.remoteTextTracks().removeEventListener("change",l.SUBTITLES.onTrackChanged)})),u.clearTracks("audio");for(const i in l.AUDIO.tracks)u.audioTracks().addTrack(l.AUDIO.tracks[i])};class SteeringManifest{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(i){1===i&&(this.version_=i)}set ttl(i){this.ttl_=i||300}set reloadUri(i){i&&(this.reloadUri_=Oi(this.reloadUri_,i))}set priority(i){i&&i.length&&(this.priority_=i)}set pathwayClones(i){i&&i.length&&(this.pathwayClones_=new Map(i.map((i=>[i.ID,i]))))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class ContentSteeringController extends videojs.EventTarget{constructor(i,l){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new SteeringManifest,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=logger("Content Steering"),this.xhr_=i,this.getBandwidth_=l}assignTagProperties(i,l){this.manifestType_=l.serverUri?"HLS":"DASH";const d=l.serverUri||l.serverURL;return d?d.startsWith("data:")?(this.decodeDataUriManifest_(d.substring(d.indexOf(",")+1)),void 0):(this.steeringManifest.reloadUri=Oi(i,d),this.defaultPathway=l.pathwayId||l.defaultServiceLocation,this.queryBeforeStart=l.queryBeforeStart,this.proxyServerUrl_=l.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering"),void 0):(this.logger_(`steering manifest URL is ${d}, cannot request steering manifest.`),this.trigger("error"),void 0)}requestSteeringManifest(i){const l=this.steeringManifest.reloadUri;if(!l)return;const d=i?l:this.getRequestURI(l);if(!d)return this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose(),void 0;const u={contentSteeringInfo:{uri:d}};this.trigger({type:"contentsteeringloadstart",metadata:u}),this.request_=this.xhr_({uri:d,requestType:"content-steering-manifest"},((i,l)=>{if(i){if(410===l.status)return this.logger_(`manifest request 410 ${i}.`),this.logger_(`There will be no more content steering requests to ${d} this session.`),this.excludedSteeringManifestURLs.add(d),void 0;if(429===l.status){const d=l.responseHeaders["retry-after"];return this.logger_(`manifest request 429 ${i}.`),this.logger_(`content steering will retry in ${d} seconds.`),this.startTTLTimeout_(parseInt(d,10)),void 0}return this.logger_(`manifest failed to load ${i}.`),this.startTTLTimeout_(),void 0}let c;this.trigger({type:"contentsteeringloadcomplete",metadata:u});try{c=JSON.parse(this.request_.responseText)}catch(i){this.trigger({type:"error",metadata:{errorType:videojs.Error.StreamingContentSteeringParserError,error:i}})}this.assignSteeringProperties_(c);this.trigger({type:"contentsteeringparsed",metadata:{contentSteeringInfo:u.contentSteeringInfo,contentSteeringManifest:{version:this.steeringManifest.version,reloadUri:this.steeringManifest.reloadUri,priority:this.steeringManifest.priority}}}),this.startTTLTimeout_()}))}setProxyServerUrl_(i){const l=new(p().URL)(i),d=new(p().URL)(this.proxyServerUrl_);return d.searchParams.set("url",encodeURI(l.toString())),this.setSteeringParams_(d.toString())}decodeDataUriManifest_(i){const l=JSON.parse(p().atob(i));this.assignSteeringProperties_(l)}setSteeringParams_(i){const l=new(p().URL)(i),d=this.getPathway(),u=this.getBandwidth_();if(d){l.searchParams.set(`_${this.manifestType_}_pathway`,d)}if(u){l.searchParams.set(`_${this.manifestType_}_throughput`,u)}return l.toString()}assignSteeringProperties_(i){if(this.steeringManifest.version=i.VERSION,!this.steeringManifest.version)return this.logger_(`manifest version is ${i.VERSION}, which is not supported.`),this.trigger("error"),void 0;this.steeringManifest.ttl=i.TTL,this.steeringManifest.reloadUri=i["RELOAD-URI"],this.steeringManifest.priority=i["PATHWAY-PRIORITY"]||i["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=i["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const l=(i=>{for(const l of i)if(this.availablePathways_.has(l))return l;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==l&&(this.currentPathway=l,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(i){if(!i)return null;const isExcluded=i=>this.excludedSteeringManifestURLs.has(i);if(this.proxyServerUrl_){const l=this.setProxyServerUrl_(i);if(!isExcluded(l))return l}const l=this.setSteeringParams_(i);return isExcluded(l)?null:l}startTTLTimeout_(i=this.steeringManifest.ttl){const l=1e3*i;this.ttlTimeout_=p().setTimeout((()=>{this.requestSteeringManifest()}),l)}clearTTLTimeout_(){p().clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new SteeringManifest}addAvailablePathway(i){i&&this.availablePathways_.add(i)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(i){return this.availablePathways_.delete(i)}didDASHTagChange(i,l){return!l&&this.steeringManifest.reloadUri||l&&(Oi(i,l.serverURL)!==this.steeringManifest.reloadUri||l.defaultServiceLocation!==this.defaultPathway||l.queryBeforeStart!==this.queryBeforeStart||l.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}let or;const lr=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],sumLoaderStat=function(i){return this.audioSegmentLoader_[i]+this.mainSegmentLoader_[i]};class PlaylistController extends videojs.EventTarget{constructor(i){super(),this.fastQualityChange_=((i,l)=>{let d=null;return(...u)=>{clearTimeout(d),d=setTimeout((()=>{i.apply(null,u)}),l)}})(this.fastQualityChange_.bind(this),100);const{src:l,withCredentials:d,tech:u,bandwidth:c,externVhs:h,useCueTags:m,playlistExclusionDuration:g,enableLowInitialPlaylist:y,sourceType:_,cacheEncryptionKeys:v,bufferBasedABR:b,leastPixelDiffSelector:T,captionServices:S,experimentalUseMMS:E}=i;if(!l)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:k}=i;null==k&&(k=1/0),or=h,this.bufferBasedABR=Boolean(b),this.leastPixelDiffSelector=Boolean(T),this.withCredentials=d,this.tech_=u,this.vhs_=u.vhs,this.player_=i.player_,this.sourceType_=_,this.useCueTags_=m,this.playlistExclusionDuration=g,this.maxPlaylistRetries=k,this.enableLowInitialPlaylist=y,this.usingManagedMediaSource_=!1,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:d,maxPlaylistRetries:k,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=(()=>{const i={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((l=>{i[l]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:noop,activeTrack:noop,getActiveGroup:noop,onGroupChanged:noop,onTrackChanged:noop,lastTrack_:null,logger_:logger(`MediaGroups[${l}]`)}})),i})(),E&&p().ManagedMediaSource?(this.tech_.el_.disableRemotePlayback=!0,this.mediaSource=new(p().ManagedMediaSource),this.usingManagedMediaSource_=!0,videojs.log("Using ManagedMediaSource")):p().MediaSource&&(this.mediaSource=new(p().MediaSource)),this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.load=this.load.bind(this),this.pause=this.pause.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.mediaSource.addEventListener("startstreaming",this.load),this.mediaSource.addEventListener("endstreaming",this.pause),this.seekable_=createTimeRanges(),this.hasPlayed_=!1,this.syncController_=new SyncController(i),this.segmentMetadataTrack_=u.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new ir,this.sourceUpdater_=new SourceUpdater(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new TimelineChangeController,this.keyStatusMap_=new Map;const w={vhs:this.vhs_,parse708captions:i.parse708captions,useDtsForTimestampOffset:i.useDtsForTimestampOffset,captionServices:S,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:c,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:v,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:i.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_="dash"===this.sourceType_?new DashPlaylistLoader(l,this.vhs_,video_es_merge(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new PlaylistLoader(l,this.vhs_,video_es_merge(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new SegmentLoader(video_es_merge(w,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),i),this.audioSegmentLoader_=new SegmentLoader(video_es_merge(w,{loaderType:"audio"}),i),this.subtitleSegmentLoader_=new VTTSegmentLoader(video_es_merge(w,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise(((i,l)=>{function onLoad(){u.off("vttjserror",onError),i()}function onError(){u.off("vttjsloaded",onLoad),l()}u.one("vttjsloaded",onLoad),u.one("vttjserror",onError),u.addWebVttScript_()}))}),i);this.contentSteeringController_=new ContentSteeringController(this.vhs_.xhr,(()=>this.mainSegmentLoader_.bandwidth)),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",(()=>this.startABRTimer_())),this.tech_.on("pause",(()=>this.stopABRTimer_())),this.tech_.on("play",(()=>this.startABRTimer_()))),lr.forEach((i=>{this[i+"_"]=sumLoaderStat.bind(this,i)})),this.logger_=logger("pc"),this.triggeredFmp4Usage=!1,"none"===this.tech_.preload()?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const C="none"===this.tech_.preload()?"play":"loadstart";this.tech_.one(C,(()=>{const i=Date.now();this.tech_.one("loadeddata",(()=>{this.timeToLoadedData__=Date.now()-i,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends}))}))}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const i=this.mainAppendsToLoadedData_(),l=this.audioAppendsToLoadedData_();return-1===i||-1===l?-1:i+l}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(i="abr"){const l=this.selectPlaylist();l&&this.shouldSwitchToMedia_(l)&&this.switchMedia_(l,i)}switchMedia_(i,l,d){const u=this.media(),c=u&&(u.id||u.uri),h=i&&(i.id||i.uri);if(c&&c!==h){this.logger_(`switch media ${c} -> ${h} from ${l}`);this.trigger({type:"renditionselected",metadata:{renditionInfo:{id:h,bandwidth:i.attributes.BANDWIDTH,resolution:i.attributes.RESOLUTION,codecs:i.attributes.CODECS},cause:l}}),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${l}`})}this.mainPlaylistLoader_.media(i,d)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((i=>{const l=this.mediaTypes_[i],d=l?l.activeGroup():null,u=this.contentSteeringController_.getPathway();if(d&&u){const l=(d.length?d[0].playlists:d.playlists).filter((i=>i.attributes.serviceLocation===u));l.length&&this.mediaTypes_[i].activePlaylistLoader.media(l[0])}}))}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=p().setInterval((()=>this.checkABR_()),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(p().clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const i=this.main(),l=i&&i.playlists||[];if(!i||!i.mediaGroups||!i.mediaGroups.AUDIO)return l;const d=i.mediaGroups.AUDIO,u=Object.keys(d);let c;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)c=this.mediaTypes_.AUDIO.activeTrack();else{const i=d.main||u.length&&d[u[0]];for(const l in i)if(i[l].default){c={label:l};break}}if(!c)return l;const h=[];for(const l in d)if(d[l][c.label]){const u=d[l][c.label];if(u.playlists&&u.playlists.length)h.push.apply(h,u.playlists);else if(u.uri)h.push(u);else if(i.playlists.length)for(let d=0;d<i.playlists.length;d++){const u=i.playlists[d];u.attributes&&u.attributes.AUDIO&&u.attributes.AUDIO===l&&h.push(u)}}return h.length?h:l}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",(()=>{const i=this.mainPlaylistLoader_.media(),l=1.5*i.targetDuration*1e3;this.requestOptions_.timeout=isLowestEnabledRendition(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?0:l,i.endList&&"none"!==this.tech_.preload()&&(this.mainSegmentLoader_.playlist(i,this.requestOptions_),this.mainSegmentLoader_.load()),setupMediaGroups({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),i),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(()=>{this.trigger("selectedinitialmedia")}))})),this.mainPlaylistLoader_.on("loadedplaylist",(()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let i=this.mainPlaylistLoader_.media();if(!i){let l;if(this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_(),this.enableLowInitialPlaylist&&(l=this.selectInitialPlaylist()),l||(l=this.selectPlaylist()),!l||!this.shouldSwitchToMedia_(l))return;this.initialMedia_=l,this.switchMedia_(this.initialMedia_,"initial");if(!("vhs-json"===this.sourceType_&&this.initialMedia_.segments))return;i=this.initialMedia_}this.handleUpdatedMediaPlaylist(i)})),this.mainPlaylistLoader_.on("error",(()=>{const i=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:i.playlist,error:i})})),this.mainPlaylistLoader_.on("mediachanging",(()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()})),this.mainPlaylistLoader_.on("mediachange",(()=>{const i=this.mainPlaylistLoader_.media(),l=1.5*i.targetDuration*1e3;this.requestOptions_.timeout=isLowestEnabledRendition(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?0:l,"dash"===this.sourceType_&&this.mainPlaylistLoader_.isPaused&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(i,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})})),this.mainPlaylistLoader_.on("playlistunchanged",(()=>{const i=this.mainPlaylistLoader_.media();if("playlist-unchanged"===i.lastExcludeReason_)return;this.stuckAtPlaylistEnd_(i)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))})),this.mainPlaylistLoader_.on("renditiondisabled",(()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})})),this.mainPlaylistLoader_.on("renditionenabled",(()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}));["manifestrequeststart","manifestrequestcomplete","manifestparsestart","manifestparsecomplete","playlistrequeststart","playlistrequestcomplete","playlistparsestart","playlistparsecomplete","renditiondisabled","renditionenabled"].forEach((i=>{this.mainPlaylistLoader_.on(i,(i=>{this.player_.trigger(_extends({},i))}))}))}handleUpdatedMediaPlaylist(i){this.useCueTags_&&this.updateAdCues_(i),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(i,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!i.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(i,l){const d=i.mediaGroups||{};let u=!0;const c=Object.keys(d.AUDIO);for(const i in d.AUDIO)for(const l in d.AUDIO[i]){d.AUDIO[i][l].uri||(u=!1)}u&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(d.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),or.Playlist.isAes(l)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),c.length&&Object.keys(d.AUDIO[c[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(i){const l=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,d=this.tech_.currentTime(),u=this.bufferLowWaterLine(),c=this.bufferHighWaterLine();return function({currentPlaylist:i,buffered:l,currentTime:d,nextPlaylist:u,bufferLowWaterLine:c,bufferHighWaterLine:h,duration:p,bufferBasedABR:m,log:g}){if(!u)return videojs.log.warn("We received no playlist to switch to. Please check your stream."),!1;const y=`allowing switch ${i&&i.id||"null"} -> ${u.id}`;if(!i)return g(`${y} as current playlist is not set`),!0;if(u.id===i.id)return!1;const _=Boolean(findRange(l,d).length);if(!i.endList)return _||"number"!=typeof i.partTargetDuration?(g(`${y} as current playlist is live`),!0):(g(`not ${y} as current playlist is live llhls, but currentTime isn't in buffered.`),!1);const v=timeAheadOf(l,d),b=m?Fi.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Fi.MAX_BUFFER_LOW_WATER_LINE;if(p<b)return g(`${y} as duration < max low water line (${p} < ${b})`),!0;const T=u.attributes.BANDWIDTH,S=i.attributes.BANDWIDTH;if(T<S&&(!m||v<h)){let i=`${y} as next bandwidth < current bandwidth (${T} < ${S})`;return m&&(i+=` and forwardBuffer < bufferHighWaterLine (${v} < ${h})`),g(i),!0}if((!m||T>S)&&v>=c){let i=`${y} as forwardBuffer >= bufferLowWaterLine (${v} >= ${c})`;return m&&(i+=` and next bandwidth > current bandwidth (${T} > ${S})`),g(i),!0}return g(`not ${y} as no switching criteria met`),!1}({buffered:this.tech_.buffered(),currentTime:d,currentPlaylist:l,nextPlaylist:i,bufferLowWaterLine:u,bufferHighWaterLine:c,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",(()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("timeout",(()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()})),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",(()=>{this.trigger("progress")})),this.mainSegmentLoader_.on("error",(()=>{const i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})})),this.mainSegmentLoader_.on("appenderror",(()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")})),this.mainSegmentLoader_.on("syncinfoupdate",(()=>{this.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(()=>{this.onSyncInfoUpdate_()})),this.audioSegmentLoader_.on("appenderror",(()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")})),this.mainSegmentLoader_.on("ended",(()=>{this.logger_("main segment loader ended"),this.onEndOfStream()})),this.timelineChangeController_.on("audioTimelineBehind",(()=>{const i=this.audioSegmentLoader_.pendingSegment_;if(!i||!i.segment||!i.segment.syncInfo)return;this.tech_.setCurrentTime(i.segment.syncInfo.end+.01)})),this.timelineChangeController_.on("fixBadTimelineChange",(()=>{this.logger_("Fix bad timeline change. Restarting al segment loaders..."),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()})),this.mainSegmentLoader_.on("earlyabort",(i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:10}))}));const updateCodecs=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const i=this.getCodecsOrExclude_();i&&this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",updateCodecs),this.audioSegmentLoader_.on("trackinfo",updateCodecs),this.mainSegmentLoader_.on("fmp4",(()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("fmp4",(()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("ended",(()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}));["segmentselected","segmentloadstart","segmentloaded","segmentkeyloadstart","segmentkeyloadcomplete","segmentdecryptionstart","segmentdecryptioncomplete","segmenttransmuxingstart","segmenttransmuxingcomplete","segmenttransmuxingtrackinfoavailable","segmenttransmuxingtiminginfoavailable","segmentappendstart","appendsdone","bandwidthupdated","timelinechange","codecschange"].forEach((i=>{this.mainSegmentLoader_.on(i,(i=>{this.player_.trigger(_extends({},i))})),this.audioSegmentLoader_.on(i,(i=>{this.player_.trigger(_extends({},i))})),this.subtitleSegmentLoader_.on(i,(i=>{this.player_.trigger(_extends({},i))}))}))}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}pause(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}fastQualityChange_(i=this.selectPlaylist()){if(i&&i===this.mainPlaylistLoader_.media())return this.logger_("skipping fastQualityChange because new media is same as old"),void 0;this.switchMedia_(i,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const i=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<i.start(0)?this.tech_.setCurrentTime(i.end(i.length-1)):void 0}setupFirstPlay(){const i=this.mainPlaylistLoader_.media();if(!i||this.tech_.paused()||this.hasPlayed_)return!1;if(!i.endList||i.start){const l=this.seekable();if(!l.length)return!1;const d=l.end(0);let u=d;if(i.start){const c=i.start.timeOffset;u=c<0?Math.max(d+c,l.start(0)):Math.min(d,c)}this.trigger("firstplay"),this.tech_.setCurrentTime(u)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const i=this.tech_.play();void 0!==i&&"function"==typeof i.then&&i.then(null,(i=>{}))}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const i=this.inbandTextTracks_.metadataTrack_.cues;if(!i||!i.length)return;const l=this.duration();i[i.length-1].endTime=isNaN(l)||Math.abs(l)===1/0?Number.MAX_VALUE:l}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let i=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const l=this.mainSegmentLoader_.getCurrentMediaInfo_();i=!l||l.hasVideo?i&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_}i&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(i){if(!this.seekable().length)return!1;const l=this.syncController_.getExpiredTime(i,this.duration());if(null===l)return!1;const d=or.Playlist.playlistEnd(i,l),u=this.tech_.currentTime(),c=this.tech_.buffered();if(!c.length)return d-u<=Ri;const h=c.end(c.length-1);return h-u<=Ri&&d-h<=Ri}excludePlaylist({playlistToExclude:i=this.mainPlaylistLoader_.media(),error:l={},playlistExclusionDuration:d}){if(i=i||this.mainPlaylistLoader_.media(),d=d||l.playlistExclusionDuration||this.playlistExclusionDuration,!i)return this.error=l,"open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"),void 0;i.playlistErrors_++;const u=this.mainPlaylistLoader_.main.playlists,c=u.filter(isEnabled),h=1===c.length&&c[0]===i;if(1===u.length&&d!==1/0)return videojs.log.warn(`Problem encountered with playlist ${i.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(h);if(h){if(this.main().contentSteering){const l=this.pathwayAttribute_(i),d=1e3*this.contentSteeringController_.steeringManifest.ttl;return this.contentSteeringController_.excludePathway(l),this.excludeThenChangePathway_(),setTimeout((()=>{this.contentSteeringController_.addAvailablePathway(l)}),d),void 0}let l=!1;u.forEach((d=>{if(d===i)return;const u=d.excludeUntil;void 0!==u&&u!==1/0&&(l=!0,delete d.excludeUntil)})),l&&(videojs.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let p;p=i.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*d,i.excludeUntil=p,l.reason&&(i.lastExcludeReason_=l.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const m=this.selectPlaylist();if(!m)return this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error"),void 0;(l.internal?this.logger_:videojs.log.warn)(`${l.internal?"Internal problem":"Problem"} encountered with playlist ${i.id}.${l.message?" "+l.message:""} Switching to playlist ${m.id}.`),m.attributes.AUDIO!==i.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),m.attributes.SUBTITLES!==i.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const g=m.targetDuration/2*1e3||5e3,y="number"==typeof m.lastRequest&&Date.now()-m.lastRequest<=g;return this.switchMedia_(m,"exclude",h||y)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(i,l){const d=[],u="all"===i;(u||"main"===i)&&d.push(this.mainPlaylistLoader_);const c=[];(u||"audio"===i)&&c.push("AUDIO"),(u||"subtitle"===i)&&(c.push("CLOSED-CAPTIONS"),c.push("SUBTITLES")),c.forEach((i=>{const l=this.mediaTypes_[i]&&this.mediaTypes_[i].activePlaylistLoader;l&&d.push(l)})),["main","audio","subtitle"].forEach((l=>{const u=this[`${l}SegmentLoader_`];!u||i!==l&&"all"!==i||d.push(u)})),d.forEach((i=>l.forEach((l=>{"function"==typeof i[l]&&i[l]()}))))}setCurrentTime(i){const l=findRange(this.tech_.buffered(),i);return this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media()&&this.mainPlaylistLoader_.media().segments?l&&l.length?i:(this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load(),void 0):0}duration(){if(!this.mainPlaylistLoader_)return 0;const i=this.mainPlaylistLoader_.media();return i?i.endList?this.mediaSource?this.mediaSource.duration:or.Playlist.duration(i):1/0:0}seekable(){return this.seekable_}getSeekableRange_(i,l){const d=i.media();if(!d)return null;const u=this.syncController_.getMediaSequenceSync(l);if(u&&u.isReliable){const i=u.start,l=u.end;if(!isFinite(i)||!isFinite(l))return null;const c=or.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,d),h=Math.max(0,l-c);return h<i?null:createTimeRanges([[i,h]])}const c=this.syncController_.getExpiredTime(d,this.duration());if(null===c)return null;const h=or.Playlist.seekable(d,c,or.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,d));return h.length?h:null}computeFinalSeekable_(i,l){if(!l)return i;const d=i.start(0),u=i.end(0),c=l.start(0),h=l.end(0);return c>u||d>h?i:createTimeRanges([[Math.max(d,c),Math.min(u,h)]])}onSyncInfoUpdate_(){if(!this.mainPlaylistLoader_)return;const i=this.getSeekableRange_(this.mainPlaylistLoader_,"main");if(!i)return;let l;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(l=this.getSeekableRange_(this.mediaTypes_.AUDIO.activePlaylistLoader,"audio"),!l))return;const d=this.seekable_;if(this.seekable_=this.computeFinalSeekable_(i,l),!this.seekable_)return;if(d&&d.length&&this.seekable_.length&&d.start(0)===this.seekable_.start(0)&&d.end(0)===this.seekable_.end(0))return;this.logger_(`seekable updated [${printableRange(this.seekable_)}]`);this.trigger({type:"seekablerangeschanged",metadata:{seekableRanges:this.seekable_}}),this.tech_.trigger("seekablechanged")}updateDuration(i){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,i),this.mediaSource.addEventListener("sourceopen",this.updateDuration_),void 0;if(i){const i=this.seekable();if(!i.length)return;return(isNaN(this.mediaSource.duration)||this.mediaSource.duration<i.end(i.length-1))&&this.sourceUpdater_.setDuration(i.end(i.length-1)),void 0}const l=this.tech_.buffered();let d=or.Playlist.duration(this.mainPlaylistLoader_.media());l.length>0&&(d=Math.max(d,l.end(l.length-1))),this.mediaSource.duration!==d&&this.sourceUpdater_.setDuration(d)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach((i=>{const l=this.mediaTypes_[i].groups;for(const i in l)l[i].forEach((i=>{i.playlistLoader&&i.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const i=!!this.mediaTypes_.AUDIO.activePlaylistLoader,l=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),d=!i||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return!(!l||!d)}getCodecsOrExclude_(){const i={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},l=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();i.video=i.main;const d=codecsForPlaylist(this.main(),l),u={},c=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(i.main.hasVideo&&(u.video=d.video||i.main.videoCodec||"avc1.4d400d"),i.main.isMuxed&&(u.video+=`,${d.audio||i.main.audioCodec||M}`),(i.main.hasAudio&&!i.main.isMuxed||i.audio.hasAudio||c)&&(u.audio=d.audio||i.main.audioCodec||i.audio.audioCodec||M,i.audio.isFmp4=i.main.hasAudio&&!i.main.isMuxed?i.main.isFmp4:i.audio.isFmp4),!u.audio&&!u.video)return this.excludePlaylist({playlistToExclude:l,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0}),void 0;const supportFunction=(i,l)=>i?R(l,this.usingManagedMediaSource_):V(l),h={};let p;if(["video","audio"].forEach((function(l){if(u.hasOwnProperty(l)&&!supportFunction(i[l].isFmp4,u[l])){const d=i[l].isFmp4?"browser":"muxer";h[d]=h[d]||[],h[d].push(u[l]),"audio"===l&&(p=d)}})),c&&p&&l.attributes.AUDIO){const i=l.attributes.AUDIO;this.main().playlists.forEach((d=>{(d.attributes&&d.attributes.AUDIO)===i&&d!==l&&(d.excludeUntil=1/0)})),this.logger_(`excluding audio group ${i} as ${p} does not support codec(s): "${u.audio}"`)}if(Object.keys(h).length){const i=Object.keys(h).reduce(((i,l)=>(i&&(i+=", "),i+=`${l} does not support codec(s): "${h[l].join(",")}"`)),"")+".";return this.excludePlaylist({playlistToExclude:l,error:{internal:!0,message:i},playlistExclusionDuration:1/0}),void 0}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const i=[];if(["video","audio"].forEach((l=>{const d=(D(this.sourceUpdater_.codecs[l]||"")[0]||{}).type,c=(D(u[l]||"")[0]||{}).type;d&&c&&d.toLowerCase()!==c.toLowerCase()&&i.push(`"${this.sourceUpdater_.codecs[l]}" -> "${u[l]}"`)})),i.length)return this.excludePlaylist({playlistToExclude:l,error:{message:`Codec switching not supported: ${i.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0}),void 0}return u}tryToCreateSourceBuffers_(){if("open"!==this.mediaSource.readyState||this.sourceUpdater_.hasCreatedSourceBuffers())return;if(!this.areMediaTypesKnown_())return;const i=this.getCodecsOrExclude_();if(!i)return;this.sourceUpdater_.createSourceBuffers(i);const l=[i.video,i.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(l)}excludeUnsupportedVariants_(){const i=this.main().playlists,l=[];Object.keys(i).forEach((d=>{const u=i[d];if(-1!==l.indexOf(u.id))return;l.push(u.id);const c=codecsForPlaylist(this.main,u),h=[];!c.audio||V(c.audio)||R(c.audio,this.usingManagedMediaSource_)||h.push(`audio codec ${c.audio}`),!c.video||V(c.video)||R(c.video,this.usingManagedMediaSource_)||h.push(`video codec ${c.video}`),c.text&&"stpp.ttml.im1t"===c.text&&h.push(`text codec ${c.text}`),h.length&&(u.excludeUntil=1/0,this.logger_(`excluding ${u.id} for unsupported: ${h.join(", ")}`))}))}excludeIncompatibleVariants_(i){const l=[],d=this.main().playlists,u=unwrapCodecList(D(i)),c=codecCount(u),h=u.video&&D(u.video)[0]||null,p=u.audio&&D(u.audio)[0]||null;Object.keys(d).forEach((i=>{const u=d[i];if(-1!==l.indexOf(u.id)||u.excludeUntil===1/0)return;l.push(u.id);const m=[],g=codecsForPlaylist(this.mainPlaylistLoader_.main,u),y=codecCount(g);if(g.audio||g.video){if(y!==c&&m.push(`codec count "${y}" !== "${c}"`),!this.sourceUpdater_.canChangeType()){const i=g.video&&D(g.video)[0]||null,l=g.audio&&D(g.audio)[0]||null;i&&h&&i.type.toLowerCase()!==h.type.toLowerCase()&&m.push(`video codec "${i.type}" !== "${h.type}"`),l&&p&&l.type.toLowerCase()!==p.type.toLowerCase()&&m.push(`audio codec "${l.type}" !== "${p.type}"`)}m.length&&(u.excludeUntil=1/0,this.logger_(`excluding ${u.id}: ${m.join(" && ")}`))}}))}updateAdCues_(i){let l=0;const d=this.seekable();d.length&&(l=d.start(0)),function(i,l,d=0){if(!i.segments)return;let u,c=d;for(let d=0;d<i.segments.length;d++){const h=i.segments[d];if(u||(u=findAdCue(l,c+h.duration/2)),u){if("cueIn"in h){u.endTime=c,u.adEndTime=c,c+=h.duration,u=null;continue}if(c<u.endTime){c+=h.duration;continue}u.endTime+=h.duration}else if("cueOut"in h&&(u=new(p().VTTCue)(c,c+h.duration,h.cueOut),u.adStartTime=c,u.adEndTime=c+parseFloat(h.cueOut),l.addCue(u)),"cueOutCont"in h){const[i,d]=h.cueOutCont.split("/").map(parseFloat);u=new(p().VTTCue)(c,c+h.duration,""),u.adStartTime=c-i,u.adEndTime=u.adStartTime+d,l.addCue(u)}c+=h.duration}}(i,this.cueTagsTrack_,l)}goalBufferLength(){const i=this.tech_.currentTime(),l=Fi.GOAL_BUFFER_LENGTH,d=Fi.GOAL_BUFFER_LENGTH_RATE,u=Math.max(l,Fi.MAX_GOAL_BUFFER_LENGTH);return Math.min(l+i*d,u)}bufferLowWaterLine(){const i=this.tech_.currentTime(),l=Fi.BUFFER_LOW_WATER_LINE,d=Fi.BUFFER_LOW_WATER_LINE_RATE,u=Math.max(l,Fi.MAX_BUFFER_LOW_WATER_LINE),c=Math.max(l,Fi.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(l+i*d,this.bufferBasedABR?c:u)}bufferHighWaterLine(){return Fi.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(i){createMetadataTrackIfNotExists(this.inbandTextTracks_,"com.apple.streaming",this.tech_),(({inbandTextTracks:i,dateRanges:l})=>{const d=i.metadataTrack_;if(!d)return;const u=p().WebKitDataCue||p().VTTCue;l.forEach((i=>{for(const l of Object.keys(i)){if(Yi.has(l))continue;const c=new u(i.startTime,i.endTime,"");c.id=i.id,c.type="com.apple.quicktime.HLS",c.value={key:Ki[l],data:i[l]},"scte35Out"!==l&&"scte35In"!==l||(c.value.data=new Uint8Array(c.value.data.match(/[\da-f]{2}/gi)).buffer),d.addCue(c)}i.processDateRange()}))})({inbandTextTracks:this.inbandTextTracks_,dateRanges:i})}addMetadataToTextTrack(i,l,d){const u=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();createMetadataTrackIfNotExists(this.inbandTextTracks_,i,this.tech_),addMetadata({inbandTextTracks:this.inbandTextTracks_,metadataArray:l,timestampOffset:u,videoDuration:d})}pathwayAttribute_(i){return i.attributes["PATHWAY-ID"]||i.attributes.serviceLocation}initContentSteeringController_(){const i=this.main();if(i.contentSteering){for(const l of i.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(l));if(this.contentSteeringController_.assignTagProperties(i.uri,i.contentSteering),this.contentSteeringController_.queryBeforeStart)return this.contentSteeringController_.requestSteeringManifest(!0),void 0;this.tech_.one("canplay",(()=>{this.contentSteeringController_.requestSteeringManifest()}))}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this));["contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach((i=>{this.contentSteeringController_.on(i,(i=>{this.trigger(_extends({},i))}))})),"dash"===this.sourceType_&&this.mainPlaylistLoader_.on("loadedplaylist",(()=>{const i=this.main();(this.contentSteeringController_.didDASHTagChange(i.uri,i.contentSteering)||(()=>{const l=this.contentSteeringController_.getAvailablePathways(),d=[];for(const u of i.playlists){const i=u.attributes.serviceLocation;if(i&&(d.push(i),!l.has(i)))return!0}return!(d.length||!l.size)})())&&this.resetContentSteeringController_()}))}excludeThenChangePathway_(){const i=this.contentSteeringController_.getPathway();if(!i)return;this.handlePathwayClones_();const l=this.main().playlists,d=new Set;let u=!1;Object.keys(l).forEach((c=>{const h=l[c],p=this.pathwayAttribute_(h),m=p&&i!==p;h.excludeUntil===1/0&&"content-steering"===h.lastExcludeReason_&&!m&&(delete h.excludeUntil,delete h.lastExcludeReason_,u=!0);const g=!h.excludeUntil&&h.excludeUntil!==1/0;!d.has(h.id)&&m&&g&&(d.add(h.id),h.excludeUntil=1/0,h.lastExcludeReason_="content-steering",this.logger_(`excluding ${h.id} for ${h.lastExcludeReason_}`))})),"DASH"===this.contentSteeringController_.manifestType_&&Object.keys(this.mediaTypes_).forEach((l=>{const d=this.mediaTypes_[l];if(d.activePlaylistLoader){const l=d.activePlaylistLoader.media_;l&&l.attributes.serviceLocation!==i&&(u=!0)}})),u&&this.changeSegmentPathway_()}handlePathwayClones_(){const i=this.main().playlists,l=this.contentSteeringController_.currentPathwayClones,d=this.contentSteeringController_.nextPathwayClones;if(l&&l.size||d&&d.size){for(const[i,u]of l.entries()){d.get(i)||(this.mainPlaylistLoader_.updateOrDeleteClone(u),this.contentSteeringController_.excludePathway(i))}for(const[u,c]of d.entries()){const d=l.get(u);if(d)this.equalPathwayClones_(d,c)||(this.mainPlaylistLoader_.updateOrDeleteClone(c,!0),this.contentSteeringController_.addAvailablePathway(u));else{i.filter((i=>i.attributes["PATHWAY-ID"]===c["BASE-ID"])).forEach((i=>{this.mainPlaylistLoader_.addClonePathway(c,i)})),this.contentSteeringController_.addAvailablePathway(u)}}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...d])))}}equalPathwayClones_(i,l){if(i["BASE-ID"]!==l["BASE-ID"]||i.ID!==l.ID||i["URI-REPLACEMENT"].HOST!==l["URI-REPLACEMENT"].HOST)return!1;const d=i["URI-REPLACEMENT"].PARAMS,u=l["URI-REPLACEMENT"].PARAMS;for(const i in d)if(d[i]!==u[i])return!1;for(const i in u)if(d[i]!==u[i])return!1;return!0}changeSegmentPathway_(){const i=this.selectPlaylist();this.pauseLoading(),"DASH"===this.contentSteeringController_.manifestType_&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(i,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let i=0;const l="non-usable";this.mainPlaylistLoader_.main.playlists.forEach((d=>{const u=this.mainPlaylistLoader_.getKeyIdSet(d);u&&u.size&&u.forEach((u=>{const c="usable",h=this.keyStatusMap_.has(u)&&this.keyStatusMap_.get(u)===c;h?h&&(d.lastExcludeReason_===l&&d.excludeUntil===1/0)&&(delete d.excludeUntil,delete d.lastExcludeReason_,this.logger_(`enabling playlist ${d.id} because key ID ${u} is ${c}`)):(d.excludeUntil!==1/0&&d.lastExcludeReason_!==l&&(d.excludeUntil=1/0,d.lastExcludeReason_=l,this.logger_(`excluding playlist ${d.id} because the key ID ${u} doesn't exist in the keyStatusMap or is not ${c}`)),i++)}))})),i>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach((i=>{i&&i.attributes&&i.attributes.RESOLUTION&&i.attributes.RESOLUTION.height<720&&(i.excludeUntil===1/0&&i.lastExcludeReason_===l)&&(delete i.excludeUntil,videojs.log.warn(`enabling non-HD playlist ${i.id} because all playlists were excluded due to ${l} key IDs`))}))}addKeyStatus_(i,l){const d=("string"==typeof i?i:(i=>{const l=new Uint8Array(i);return Array.from(l).map((i=>i.toString(16).padStart(2,"0"))).join("")})(i)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${l}' with key ID ${d} added to the keyStatusMap`),this.keyStatusMap_.set(d,l)}updatePlaylistByKeyStatus(i,l){this.addKeyStatus_(i,l),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}class Representation{constructor(i,l,d){const{playlistController_:u}=i,c=u.fastQualityChange_.bind(u);if(l.attributes){const i=l.attributes.RESOLUTION;this.width=i&&i.width,this.height=i&&i.height,this.bandwidth=l.attributes.BANDWIDTH,this.frameRate=l.attributes["FRAME-RATE"]}var h,p,m;this.codecs=codecsForPlaylist(u.main(),l),this.playlist=l,this.id=d,this.enabled=(h=i.playlists,p=l.id,m=c,i=>{const l=h.main.playlists[p],d=isIncompatible(l),u=isEnabled(l);if(void 0===i)return u;i?delete l.disabled:l.disabled=!0;const c={renditionInfo:{id:p,bandwidth:l.attributes.BANDWIDTH,resolution:l.attributes.RESOLUTION,codecs:l.attributes.CODECS},cause:"fast-quality"};return i===u||d||(i?(m(l),h.trigger({type:"renditionenabled",metadata:c})):h.trigger({type:"renditiondisabled",metadata:c})),i})}}const dr=["seeking","seeked","pause","playing","error"];class PlaybackWatcher extends videojs.EventTarget{constructor(i){super(),this.playlistController_=i.playlistController,this.tech_=i.tech,this.seekable=i.seekable,this.allowSeeksWithinUnsafeLiveWindow=i.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=i.liveRangeSafeTimeDelta,this.media=i.media,this.playedRanges_=[],this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=logger("PlaybackWatcher"),this.logger_("initialize");const playHandler=()=>this.monitorCurrentTime_(),canPlayHandler=()=>this.monitorCurrentTime_(),waitingHandler=()=>this.techWaiting_(),cancelTimerHandler=()=>this.resetTimeUpdate_(),l=this.playlistController_,d=["main","subtitle","audio"],u={};d.forEach((i=>{u[i]={reset:()=>this.resetSegmentDownloads_(i),updateend:()=>this.checkSegmentDownloads_(i)},l[`${i}SegmentLoader_`].on("appendsdone",u[i].updateend),l[`${i}SegmentLoader_`].on("playlistupdate",u[i].reset),this.tech_.on(["seeked","seeking"],u[i].reset)}));const setSeekingHandlers=i=>{["main","audio"].forEach((d=>{l[`${d}SegmentLoader_`][i]("appended",this.seekingAppendCheck_)}))};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),setSeekingHandlers("off"))},this.clearSeekingAppendCheck_=()=>setSeekingHandlers("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),setSeekingHandlers("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",waitingHandler),this.tech_.on(dr,cancelTimerHandler),this.tech_.on("canplay",canPlayHandler),this.tech_.one("play",playHandler),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",waitingHandler),this.tech_.off(dr,cancelTimerHandler),this.tech_.off("canplay",canPlayHandler),this.tech_.off("play",playHandler),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),d.forEach((i=>{l[`${i}SegmentLoader_`].off("appendsdone",u[i].updateend),l[`${i}SegmentLoader_`].off("playlistupdate",u[i].reset),this.tech_.off(["seeked","seeking"],u[i].reset)})),this.checkCurrentTimeTimeout_&&p().clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&p().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=p().setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(i){const l=this.playlistController_[`${i}SegmentLoader_`];this[`${i}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${i} loader`),this[`${i}StalledDownloads_`]=0,this[`${i}Buffered_`]=l.buffered_()}checkSegmentDownloads_(i){const l=this.playlistController_,d=l[`${i}SegmentLoader_`],u=d.buffered_(),c=function(i,l){if(i===l)return!1;if(!i&&l||!l&&i)return!0;if(i.length!==l.length)return!0;for(let d=0;d<i.length;d++)if(i.start(d)!==l.start(d)||i.end(d)!==l.end(d))return!0;return!1}(this[`${i}Buffered_`],u);if(this[`${i}Buffered_`]=u,c){return l.trigger({type:"bufferedrangeschanged",metadata:{bufferedRanges:u}}),this.resetSegmentDownloads_(i),void 0}this[`${i}StalledDownloads_`]++,this.logger_(`found #${this[`${i}StalledDownloads_`]} ${i} appends that did not increase buffer (possible stalled download)`,{playlistId:d.playlist_&&d.playlist_.id,buffered:timeRangesToArray(u)}),this[`${i}StalledDownloads_`]<10||(this.logger_(`${i} loader stalled download exclusion`),this.resetSegmentDownloads_(i),this.tech_.trigger({type:"usage",name:`vhs-${i}-download-exclusion`}),"subtitle"!==i&&l.excludePlaylist({error:{message:`Excessive ${i} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const i=this.tech_.currentTime(),l=this.tech_.buffered();if(this.lastRecordedTime===i&&(!l.length||i+Ri>=l.end(l.length-1)))return this.techWaiting_();if(this.consecutiveUpdates>=5&&i===this.lastRecordedTime)this.consecutiveUpdates++,this.waiting_();else if(i===this.lastRecordedTime)this.consecutiveUpdates++;else{this.playedRanges_.push(createTimeRanges([this.lastRecordedTime,i]));this.playlistController_.trigger({type:"playedrangeschanged",metadata:{playedRanges:this.playedRanges_}}),this.consecutiveUpdates=0,this.lastRecordedTime=i}}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const i=this.seekable(),l=this.tech_.currentTime();let d;if(this.afterSeekableWindow_(i,l,this.media(),this.allowSeeksWithinUnsafeLiveWindow)){d=i.end(i.length-1)}if(this.beforeSeekableWindow_(i,l)){const l=i.start(0);d=l+(l===i.end(0)?0:Ri)}if(void 0!==d)return this.logger_(`Trying to seek outside of seekable at time ${l} with seekable range ${printableRange(i)}. Seeking to ${d}.`),this.tech_.setCurrentTime(d),!0;const u=this.playlistController_.sourceUpdater_,c=this.tech_.buffered(),h=u.audioBuffer?u.audioBuffered():null,p=u.videoBuffer?u.videoBuffered():null,m=this.media(),g=m.partTargetDuration?m.partTargetDuration:2*(m.targetDuration-Li),y=[h,p];for(let i=0;i<y.length;i++){if(!y[i])continue;if(timeAheadOf(y[i],l)<g)return!1}const _=findNextRange(c,l);return 0!==_.length&&(d=_.start(0)+Ri,this.logger_(`Buffered region starts (${_.start(0)})  just beyond seek point (${l}). Seeking to ${d}.`),this.tech_.setCurrentTime(d),!0)}waiting_(){if(this.techWaiting_())return;const i=this.tech_.currentTime(),l=this.tech_.buffered(),d=findRange(l,i);return d.length&&i+3<=d.end(0)?(this.resetTimeUpdate_(),this.tech_.setCurrentTime(i),this.logger_(`Stopped at ${i} while inside a buffered region [${d.start(0)} -> ${d.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),void 0):void 0}techWaiting_(){const i=this.seekable(),l=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(i,l)){const d=i.end(i.length-1);return this.logger_(`Fell out of live window at time ${l}. Seeking to live point (seekable end) ${d}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(d),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const d=this.tech_.vhs.playlistController_.sourceUpdater_,u=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:d.audioBuffered(),videoBuffered:d.videoBuffered(),currentTime:l}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(l),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const c=findNextRange(u,l);return c.length>0&&(this.logger_(`Stopped at ${l} and seeking to ${c.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(l),!0)}afterSeekableWindow_(i,l,d,u=!1){if(!i.length)return!1;let c=i.end(i.length-1)+Ri;return!d.endList&&("number"==typeof d.partTargetDuration||u)&&(c=i.end(i.length-1)+3*d.targetDuration),l>c}beforeSeekableWindow_(i,l){return!!(i.length&&i.start(0)>0&&l<i.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:i,audioBuffered:l,currentTime:d}){if(!i)return;let u;if(i.length&&l.length){const c=findRange(i,d-3),h=findRange(i,d),p=findRange(l,d);p.length&&!h.length&&c.length&&(u={start:c.end(0),end:p.end(0)})}else{findNextRange(i,d).length||(u=this.gapFromVideoUnderflow_(i,d))}return!!u&&(this.logger_(`Encountered a gap in video from ${u.start} to ${u.end}. Seeking to current time ${d}`),!0)}skipTheGap_(i){const l=this.tech_.buffered(),d=this.tech_.currentTime(),u=findNextRange(l,d);if(this.resetTimeUpdate_(),0===u.length||d!==i)return;this.logger_("skipTheGap_:","currentTime:",d,"scheduled currentTime:",i,"nextRange start:",u.start(0)),this.tech_.setCurrentTime(u.start(0)+Li);const c={gapInfo:{from:d,to:u.start(0)}};this.playlistController_.trigger({type:"gapjumped",metadata:c}),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"})}gapFromVideoUnderflow_(i,l){const d=function(i){if(i.length<2)return createTimeRanges();const l=[];for(let d=1;d<i.length;d++){const u=i.end(d-1),c=i.start(d);l.push([u,c])}return createTimeRanges(l)}(i);for(let i=0;i<d.length;i++){const u=d.start(i),c=d.end(i);if(l-u<4&&l-u>2)return{start:u,end:c}}return null}}const ur={errorInterval:30,getSource(i){return i(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},initPlugin=function(i,l){let d=0,u=0;const c=video_es_merge(ur,l);i.ready((()=>{i.trigger({type:"usage",name:"vhs-error-reload-initialized"})}));const loadedMetadataHandler=function(){u&&i.currentTime(u)},setSource=function(l){null!=l&&(u=i.duration()!==1/0&&i.currentTime()||0,i.one("loadedmetadata",loadedMetadataHandler),i.src(l),i.trigger({type:"usage",name:"vhs-error-reload"}),i.play())},errorHandler=function(){return Date.now()-d<1e3*c.errorInterval?(i.trigger({type:"usage",name:"vhs-error-reload-canceled"}),void 0):c.getSource&&"function"==typeof c.getSource?(d=Date.now(),c.getSource.call(i,setSource)):(videojs.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!"),void 0)},cleanupEvents=function(){i.off("loadedmetadata",loadedMetadataHandler),i.off("error",errorHandler),i.off("dispose",cleanupEvents)};i.on("error",errorHandler),i.on("dispose",cleanupEvents),i.reloadSourceOnError=function(l){cleanupEvents(),initPlugin(i,l)}},reloadSourceOnError=function(i){initPlugin(this,i)};var cr="3.16.2";const hr={PlaylistLoader,Playlist:Vi,utils:Ui,STANDARD_PLAYLIST_SELECTOR:lastBandwidthSelector,INITIAL_PLAYLIST_SELECTOR:function(){const i=this.playlists.main.playlists.filter(Vi.isEnabled);stableSort(i,((i,l)=>comparePlaylistBandwidth(i,l)));return i.filter((i=>!!codecsForPlaylist(this.playlists.main,i).video))[0]||null},lastBandwidthSelector,movingAverageBandwidthSelector:function(i){let l=-1,d=-1;if(i<0||i>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let u=this.useDevicePixelRatio&&p().devicePixelRatio||1;return isNaN(this.customPixelRatio)||(u=this.customPixelRatio),l<0&&(l=this.systemBandwidth,d=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==d&&(l=i*this.systemBandwidth+(1-i)*l,d=this.systemBandwidth),simpleSelector(this.playlists.main,l,parseInt(safeGetComputedStyle(this.tech_.el(),"width"),10)*u,parseInt(safeGetComputedStyle(this.tech_.el(),"height"),10)*u,this.limitRenditionByPlayerDimensions,this.playlistController_)}},comparePlaylistBandwidth,comparePlaylistResolution:function(i,l){let d,u;return i.attributes.RESOLUTION&&i.attributes.RESOLUTION.width&&(d=i.attributes.RESOLUTION.width),d=d||p().Number.MAX_VALUE,l.attributes.RESOLUTION&&l.attributes.RESOLUTION.width&&(u=l.attributes.RESOLUTION.width),u=u||p().Number.MAX_VALUE,d===u&&i.attributes.BANDWIDTH&&l.attributes.BANDWIDTH?i.attributes.BANDWIDTH-l.attributes.BANDWIDTH:d-u},xhr:xhrFactory()};Object.keys(Fi).forEach((i=>{Object.defineProperty(hr,i,{get:()=>(videojs.log.warn(`using Vhs.${i} is UNSAFE be sure you know what you are doing`),Fi[i]),set(l){if(videojs.log.warn(`using Vhs.${i} is UNSAFE be sure you know what you are doing`),"number"!=typeof l||l<0)return videojs.log.warn(`value of Vhs.${i} must be greater than or equal to 0`),void 0;Fi[i]=l}})}));const pr="videojs-vhs",handleVhsMediaChange=function(i,l){const d=l.media();let u=-1;for(let l=0;l<i.length;l++)if(i[l].id===d.id){u=l;break}i.selectedIndex_=u,i.trigger({selectedIndex:u,type:"change"})};hr.canPlaySource=function(){return videojs.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const waitForKeySessionCreation=({player:i,sourceKeySystems:l,audioMedia:d,mainPlaylists:u})=>{if(!i.eme.initializeMediaKeys)return Promise.resolve();const c=((i,l)=>i.reduce(((i,d)=>{if(!d.contentProtection)return i;const u=l.reduce(((i,l)=>{const u=d.contentProtection[l];return u&&u.pssh&&(i[l]={pssh:u.pssh}),i}),{});return Object.keys(u).length&&i.push(u),i}),[]))(d?u.concat([d]):u,Object.keys(l)),h=[],p=[];return c.forEach((l=>{p.push(new Promise(((l,d)=>{i.tech_.one("keysessioncreated",l)}))),h.push(new Promise(((d,u)=>{i.eme.initializeMediaKeys({keySystems:l},(i=>{if(i)return u(i),void 0;d()}))})))})),Promise.race([Promise.all(h),Promise.race(p)])},setupEmeOptions=({player:i,sourceKeySystems:l,media:d,audioMedia:u})=>{const c=((i,l,d)=>{if(!i)return i;let u={};l&&l.attributes&&l.attributes.CODECS&&(u=unwrapCodecList(D(l.attributes.CODECS))),d&&d.attributes&&d.attributes.CODECS&&(u.audio=d.attributes.CODECS);const c=L(u.video),h=L(u.audio),p={};for(const d in i)p[d]={},h&&(p[d].audioContentType=h),c&&(p[d].videoContentType=c),l.contentProtection&&l.contentProtection[d]&&l.contentProtection[d].pssh&&(p[d].pssh=l.contentProtection[d].pssh),"string"==typeof i[d]&&(p[d].url=i[d]);return video_es_merge(i,p)})(l,d,u);return!!c&&(i.currentSource().keySystems=c,!(c&&!i.eme)||(videojs.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1))},getVhsLocalStorage=()=>{if(!p().localStorage)return null;const i=p().localStorage.getItem(pr);if(!i)return null;try{return JSON.parse(i)}catch(i){return null}},addOnRequestHook=(i,l)=>{i._requestCallbackSet||(i._requestCallbackSet=new Set),i._requestCallbackSet.add(l)},addOnResponseHook=(i,l)=>{i._responseCallbackSet||(i._responseCallbackSet=new Set),i._responseCallbackSet.add(l)},removeOnRequestHook=(i,l)=>{i._requestCallbackSet&&(i._requestCallbackSet.delete(l),i._requestCallbackSet.size||delete i._requestCallbackSet)},removeOnResponseHook=(i,l)=>{i._responseCallbackSet&&(i._responseCallbackSet.delete(l),i._responseCallbackSet.size||delete i._responseCallbackSet)};hr.supportsNativeHls=function(){if(!g()||!g().createElement)return!1;const i=g().createElement("video");if(!videojs.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some((function(l){return/maybe|probably/i.test(i.canPlayType(l))}))}(),hr.supportsNativeDash=!!(g()&&g().createElement&&videojs.getTech("Html5").isSupported())&&/maybe|probably/i.test(g().createElement("video").canPlayType("application/dash+xml")),hr.supportsTypeNatively=i=>"hls"===i?hr.supportsNativeHls:"dash"===i&&hr.supportsNativeDash,hr.isSupported=function(){return videojs.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},hr.xhr.onRequest=function(i){addOnRequestHook(hr.xhr,i)},hr.xhr.onResponse=function(i){addOnResponseHook(hr.xhr,i)},hr.xhr.offRequest=function(i){removeOnRequestHook(hr.xhr,i)},hr.xhr.offResponse=function(i){removeOnResponseHook(hr.xhr,i)};const mr=videojs.getComponent("Component");class VhsHandler extends mr{constructor(i,l,d){if(super(l,d.vhs),"number"==typeof d.initialBandwidth&&(this.options_.bandwidth=d.initialBandwidth),this.logger_=logger("VhsHandler"),l.options_&&l.options_.playerId){const i=videojs.getPlayer(l.options_.playerId);this.player_=i}if(this.tech_=l,this.source_=i,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&l.overrideNativeAudioTracks&&l.overrideNativeVideoTracks)l.overrideNativeAudioTracks(!0),l.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(l.featuresNativeVideoTracks||l.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(g(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(i=>{const l=g().fullscreenElement||g().webkitFullscreenElement||g().mozFullScreenElement||g().msFullscreenElement;l&&l.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()})),this.on(this.tech_,"seeking",(function(){if(this.ignoreNextSeekingEvent_)return this.ignoreNextSeekingEvent_=!1,void 0;this.setCurrentTime(this.tech_.currentTime())})),this.on(this.tech_,"error",(function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()})),this.on(this.tech_,"play",this.play)}setOptions_(i={}){if(this.options_=video_es_merge(this.options_,i),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=!1!==this.options_.llhls,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,"number"!=typeof this.options_.playlistExclusionDuration&&(this.options_.playlistExclusionDuration=60),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){const i=getVhsLocalStorage();i&&i.bandwidth&&(this.options_.bandwidth=i.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),i&&i.throughput&&(this.options_.throughput=i.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Fi.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Fi.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach((i=>{void 0!==this.source_[i]&&(this.options_[i]=this.source_[i])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio;const l=this.options_.customPixelRatio;"number"==typeof l&&l>=0&&(this.customPixelRatio=l)}setOptions(i={}){this.setOptions_(i)}src(i,l){if(!i)return;var d;this.setOptions_(),this.options_.src=0===(d=this.source_.src).toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(d.substring(d.indexOf(",")+1)):d,this.options_.tech=this.tech_,this.options_.externVhs=hr,this.options_.sourceType=j(l),this.options_.seekTo=i=>{this.tech_.setCurrentTime(i)},this.options_.player_=this.player_,this.playlistController_=new PlaylistController(this.options_);const u=video_es_merge({liveRangeSafeTimeDelta:Ri},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new PlaybackWatcher(u),this.attachStreamingEventListeners_(),this.playlistController_.on("error",(()=>{const i=videojs.players[this.tech_.options_.playerId];let l=this.playlistController_.error;"object"!=typeof l||l.code?"string"==typeof l&&(l={message:l,code:3}):l.code=3,i.error(l)}));const c=this.options_.bufferBasedABR?hr.movingAverageBandwidthSelector(.55):hr.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):c.bind(this),this.playlistController_.selectInitialPlaylist=hr.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(i){this.playlistController_.selectPlaylist=i.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(i){this.playlistController_.mainSegmentLoader_.throughput.rate=i,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let i=this.playlistController_.mainSegmentLoader_.bandwidth;const l=p().navigator.connection||p().navigator.mozConnection||p().navigator.webkitConnection,d=1e7;if(this.options_.useNetworkInformationApi&&l){const u=1e3*l.downlink*1e3;i=u>=d&&i>=d?Math.max(i,u):u}return i},set(i){this.playlistController_.mainSegmentLoader_.bandwidth=i,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){let i;i=this.throughput>0?1/this.throughput:0;return Math.floor(1/(1/(this.bandwidth||1)+i))},set(){videojs.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>timeRangesToArray(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>timeRangesToArray(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",(()=>{this.options_.useBandwidthFromLocalStorage&&(i=>{if(!p().localStorage)return!1;let l=getVhsLocalStorage();l=l?video_es_merge(l,i):i;try{p().localStorage.setItem(pr,JSON.stringify(l))}catch(i){return!1}return l})({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})})),this.playlistController_.on("selectedinitialmedia",(()=>{var i;void((i=this).representations=()=>{const l=i.playlistController_.main(),d=isAudioOnly(l)?i.playlistController_.getAudioTrackPlaylists_():l.playlists;return d?d.filter((i=>!isIncompatible(i))).map(((l,d)=>new Representation(i,l,l.id))):[]})})),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",(()=>{this.setupEme_()})),this.on(this.playlistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.playlistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=p().URL.createObjectURL(this.playlistController_.mediaSource),(videojs.browser.IS_ANY_SAFARI||videojs.browser.IS_IOS)&&this.options_.overrideNative&&"hls"===this.options_.sourceType&&"function"==typeof this.tech_.addSourceElement?(this.tech_.addSourceElement(this.mediaSourceUrl_),this.tech_.addSourceElement(this.source_.src)):this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const i=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),waitForKeySessionCreation({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:i&&i.media(),mainPlaylists:this.playlists.main.playlists}).then((()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()})).catch((i=>{this.logger_("error while creating EME key session",i),this.player_.error({message:"Failed to initialize media keys for EME",code:3})}))}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const i=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,l=setupEmeOptions({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:i&&i.media()});if(this.player_.tech_.on("keystatuschange",(i=>{this.playlistController_.updatePlaylistByKeyStatus(i.keyId,i.status)})),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!l)return this.playlistController_.sourceUpdater_.initializedEme(),void 0;this.createKeySessions_()}setupQualityLevels_(){const i=videojs.players[this.tech_.options_.playerId];i&&i.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=i.qualityLevels(),this.playlistController_.on("selectedinitialmedia",(()=>{!function(i,l){l.representations().forEach((l=>{i.addQualityLevel(l)})),handleVhsMediaChange(i,l.playlists)}(this.qualityLevels_,this)})),this.playlists.on("mediachange",(()=>{handleVhsMediaChange(this.qualityLevels_,this.playlists)})))}static version(){return{"@videojs/http-streaming":cr,"mux.js":"7.1.0","mpd-parser":"1.3.1","m3u8-parser":"7.2.0","aes-decrypter":"4.0.2"}}version(){return this.constructor.version()}canChangeType(){return SourceUpdater.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(i){this.playlistController_.setCurrentTime(i)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&p().URL.revokeObjectURL&&(p().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(i,l){return getProgramTime({playlist:this.playlistController_.media(),time:i,callback:l})}seekToProgramTime(i,l,d=!0,u=2){return seekToProgramTime({programTime:i,playlist:this.playlistController_.media(),retryCount:u,pauseAfterSeek:d,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:l})}setupXhrHooks_(){this.xhr.onRequest=i=>{addOnRequestHook(this.xhr,i)},this.xhr.onResponse=i=>{addOnResponseHook(this.xhr,i)},this.xhr.offRequest=i=>{removeOnRequestHook(this.xhr,i)},this.xhr.offResponse=i=>{removeOnResponseHook(this.xhr,i)},this.player_.trigger("xhr-hooks-ready")}attachStreamingEventListeners_(){["seekablerangeschanged","bufferedrangeschanged","contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach((i=>{this.playlistController_.on(i,(i=>{this.player_.trigger(_extends({},i))}))})),["gapjumped","playedrangeschanged"].forEach((i=>{this.playbackWatcher_.on(i,(i=>{this.player_.trigger(_extends({},i))}))}))}}const fr={name:"videojs-http-streaming",VERSION:cr,canHandleSource(i,l={}){const d=video_es_merge(videojs.options,l);return!(!d.vhs.experimentalUseMMS&&!R("avc1.4d400d,mp4a.40.2",!1))&&fr.canPlayType(i.type,d)},handleSource(i,l,d={}){const u=video_es_merge(videojs.options,d);return l.vhs=new VhsHandler(i,l,u),l.vhs.xhr=xhrFactory(),l.vhs.setupXhrHooks_(),l.vhs.src(i.src,i.type),l.vhs},canPlayType(i,l){const d=j(i);if(!d)return"";const u=fr.getOverrideNative(l);return!hr.supportsTypeNatively(d)||u?"maybe":""},getOverrideNative(i={}){const{vhs:l={}}=i,d=!(videojs.browser.IS_ANY_SAFARI||videojs.browser.IS_IOS),{overrideNative:u=d}=l;return u}};R("avc1.4d400d,mp4a.40.2",!0)&&videojs.getTech("Html5").registerSourceHandler(fr,0),videojs.VhsHandler=VhsHandler,videojs.VhsSourceHandler=fr,videojs.Vhs=hr,videojs.use||videojs.registerComponent("Vhs",hr),videojs.options.vhs=videojs.options.vhs||{},videojs.getPlugin&&videojs.getPlugin("reloadSourceOnError")||videojs.registerPlugin("reloadSourceOnError",reloadSourceOnError);const gr=videojs.getComponent("Tech");let yr=(()=>{class VideoJSOgvJS extends gr{constructor(i,l){var d,c;super(i,l),this.parentElement=null,this.placeholderElement=document.createElement("div"),this.el_.src=i.src||(null===(d=i.source)||void 0===d?void 0:d.src)||(null===(c=i.sources)||void 0===c||null===(c=c[0])||void 0===c?void 0:c.src)||this.el_.src,VideoJSOgvJS.setIfAvailable(this.el_,"autoplay",i.autoplay),VideoJSOgvJS.setIfAvailable(this.el_,"loop",i.loop),VideoJSOgvJS.setIfAvailable(this.el_,"poster",i.poster),VideoJSOgvJS.setIfAvailable(this.el_,"preload",i.preload),this.playerId=i.playerId,this.on("loadedmetadata",(()=>{if(u.CorePlatform.isIPhone()){const i=this.el_.getElementsByTagName("canvas")[0];i.style.removeProperty("width"),i.style.removeProperty("margin")}this.triggerReady()}))}static setIfAvailable(i,l,d){i.hasOwnProperty(l)&&(i[l]=d)}static isSupported(){return c.OGVCompat.supported("OGVPlayer")}static canPlayType(i){return-1!==i.indexOf("/ogg")||i.indexOf("/webm")?"maybe":""}static canPlaySource(i){return VideoJSOgvJS.canPlayType(i.type)}static canControlVolume(){if(u.CorePlatform.isIPhone()||u.CorePlatform.isIPad())return!1;return(new c.OGVPlayer).hasOwnProperty("volume")}static canMuteVolume(){return!0}static canControlPlaybackRate(){return!0}static supportsNativeTextTracks(){return!1}static supportsFullscreenResize(){return!0}static supportsProgressEvents(){return!0}static supportsTimeupdateEvents(){return!0}createEl(){const i=this.options_;if(i.base)c.OGVLoader.base=i.base;else if(!c.OGVLoader.base)throw new Error("Please specify the base for the ogv.js library");const l=new c.OGVPlayer(i);return l.className+=" vjs-tech",i.tag=l,l}play(){this.ended()&&this.el_.stop(),this.el_.play()}playbackRate(){return this.el_.playbackRate||1}setPlaybackRate(i){this.el_.hasOwnProperty("playbackRate")&&(this.el_.playbackRate=i)}played(){return this.el_.played}pause(){this.el_.pause()}paused(){return this.el_.paused}currentTime(){return this.el_.currentTime}setCurrentTime(i){try{this.el_.currentTime=i}catch(i){videojs.log(i,"Media is not ready. (Video.JS)")}}duration(){return this.el_.duration&&this.el_.duration!==1/0?this.el_.duration:0}buffered(){return this.el_.buffered}volume(){return this.el_.hasOwnProperty("volume")?this.el_.volume:1}setVolume(i){u.CorePlatform.isIPhone()||u.CorePlatform.isIPad()||!this.el_.hasOwnProperty("volume")||(this.el_.volume=i)}muted(){return this.el_.muted}setMuted(i){this.el_.muted=!!i}defaultMuted(){return this.el_.defaultMuted||!1}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}videoWidth(){var i;return null!==(i=this.el_.videoWidth)&&void 0!==i?i:0}videoHeight(){var i;return null!==(i=this.el_.videoHeight)&&void 0!==i?i:0}src(i){if(void 0===i)return this.el_.src;this.el_.src=i}load(){this.el_.load()}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}poster(){return"poster"in this.el_?this.el_.poster:""}setPoster(i){this.el_.poster=i}preload(){return this.el_.preload||"none"}setPreload(i){this.el_.hasOwnProperty("preload")&&(this.el_.preload=i)}autoplay(){return this.el_.autoplay||!1}setAutoplay(i){this.el_.hasOwnProperty("autoplay")&&(this.el_.autoplay=!!i)}controls(){return this.el_.controls||!1}setControls(i){this.el_.hasOwnProperty("controls")&&(this.el_.controls=!!i)}loop(){return this.el_.loop||!1}setLoop(i){this.el_.hasOwnProperty("loop")&&(this.el_.loop=!!i)}seekable(){return this.el_.seekable}seeking(){return this.el_.seeking}ended(){return this.el_.ended}networkState(){return this.el_.networkState}readyState(){return this.el_.readyState}supportsFullScreen(){return!!this.playerId}error(){return this.el_.error}enterFullScreen(){var i;const l=videojs.getPlayer(null!==(i=this.playerId)&&void 0!==i?i:"");if(!l)return;const d=l.el();this.parentElement=d.parentElement,this.parentElement&&(this.parentElement.replaceChild(this.placeholderElement,d),document.body.appendChild(d),d.classList.add("vjs-ios-moodleapp-fs"),l.isFullscreen(!0))}exitFullScreen(){var i;if(!this.parentElement)return;const l=videojs.getPlayer(null!==(i=this.playerId)&&void 0!==i?i:"");if(!l)return;const d=l.el();this.parentElement.replaceChild(d,this.placeholderElement),d.classList.remove("vjs-ios-moodleapp-fs"),l.isFullscreen(!1)}}return VideoJSOgvJS.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],VideoJSOgvJS})();function initializeVideoJSOgvJS(){c.OGVLoader.base="assets/lib/ogv",videojs.getComponent("Tech").registerTech("OgvJS",yr)}[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresFullscreenResize","supportsFullscreenResize"],["featuresProgressEvents","supportsProgressEvents"],["featuresTimeupdateEvents","supportsTimeupdateEvents"]].forEach((([i,l])=>{((i,l,d,u=!0)=>{const set=d=>{Object.defineProperty(i,l,{value:d,enumerable:!0,writable:!0})},c={configurable:!0,enumerable:!0,get(){const i=d();return set(i),i}};return u&&(c.set=set),Object.defineProperty(i,l,c)})(yr.prototype,i,(()=>yr[l]()),!0)}))},1452:(i,l,d)=>{"use strict";var u=d(12843);i.exports=function httpResponseHandler(i,l){return void 0===l&&(l=!1),function(d,c,h){if(d)return i(d),void 0;if(c.statusCode>=400&&c.statusCode<=599){var p=h;if(l)if(u.TextDecoder){var m=function getCharset(i){void 0===i&&(i="");return i.toLowerCase().split(";").reduce((function(i,l){var d=l.split("="),u=d[1];return"charset"===d[0].trim()?u.trim():i}),"utf-8")}(c.headers&&c.headers["content-type"]);try{p=new TextDecoder(m).decode(h)}catch(i){}}else p=String.fromCharCode.apply(null,new Uint8Array(h));return i({cause:p}),void 0}i(null,h)}}},17621:(i,l,d)=>{"use strict";var u=d(12843),c=d(94634),h=d(59819),p=d(36081),m=d(98515);createXHR.httpHandler=d(1452),createXHR.requestInterceptorsStorage=new p,createXHR.responseInterceptorsStorage=new p,createXHR.retryManager=new m;var g=function parseHeaders(i){var l={};return i?(i.trim().split("\n").forEach((function(i){var d=i.indexOf(":"),u=i.slice(0,d).trim().toLowerCase(),c=i.slice(d+1).trim();void 0===l[u]?l[u]=c:Array.isArray(l[u])?l[u].push(c):l[u]=[l[u],c]})),l):l};function initParams(i,l,d){var u=i;return h(l)?(d=l,"string"==typeof i&&(u={uri:i})):u=c({},l,{uri:i}),u.callback=d,u}function createXHR(i,l,d){return _createXHR(l=initParams(i,l,d))}function _createXHR(i){if(void 0===i.callback)throw new Error("callback argument missing");if(i.requestType&&createXHR.requestInterceptorsStorage.getIsEnabled()){var l=createXHR.requestInterceptorsStorage.execute(i.requestType,{uri:i.uri||i.url,headers:i.headers||{},body:i.body,metadata:i.metadata||{},retry:i.retry,timeout:i.timeout});i.uri=l.uri,i.headers=l.headers,i.body=l.body,i.metadata=l.metadata,i.retry=l.retry,i.timeout=l.timeout}var d=!1,u=function cbOnce(l,u,c){d||(d=!0,i.callback(l,u,c))};function getBody(){var i=void 0;if(i=p.response?p.response:p.responseText||function getXml(i){try{if("document"===i.responseType)return i.responseXML;if(""===i.responseType&&!(i.responseXML&&"parsererror"===i.responseXML.documentElement.nodeName))return i.responseXML}catch(i){}return null}(p),S)try{i=JSON.parse(i)}catch(i){}return i}function errorFunc(l){if(clearTimeout(m),clearTimeout(i.retryTimeout),l instanceof Error||(l=new Error(""+(l||"Unknown XMLHttpRequest Error"))),l.statusCode=0,!h&&createXHR.retryManager.getIsEnabled()&&i.retry&&i.retry.shouldRetry())return i.retryTimeout=setTimeout((function(){i.retry.moveToNextAttempt(),i.xhr=p,_createXHR(i)}),i.retry.getCurrentFuzzedDelay()),void 0;if(i.requestType&&createXHR.responseInterceptorsStorage.getIsEnabled()){var d=createXHR.responseInterceptorsStorage.execute(i.requestType,{headers:E.headers||{},body:E.body,responseUrl:p.responseURL,responseType:p.responseType});E.body=d.body,E.headers=d.headers}return u(l,E)}function loadFunc(){if(!h){var l;clearTimeout(m),clearTimeout(i.retryTimeout);var d=E,c=null;if(0!==(l=i.useXDR&&void 0===p.status?200:1223===p.status?204:p.status)?(d={body:getBody(),statusCode:l,method:_,headers:{},url:y,rawRequest:p},p.getAllResponseHeaders&&(d.headers=g(p.getAllResponseHeaders()))):c=new Error("Internal XMLHttpRequest Error"),i.requestType&&createXHR.responseInterceptorsStorage.getIsEnabled()){var v=createXHR.responseInterceptorsStorage.execute(i.requestType,{headers:d.headers||{},body:d.body,responseUrl:p.responseURL,responseType:p.responseType});d.body=v.body,d.headers=v.headers}return u(c,d,d.body)}}var c,h,p=i.xhr||null;p||(p=i.cors||i.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var m,y=p.url=i.uri||i.url,_=p.method=i.method||"GET",v=i.body||i.data,b=p.headers=i.headers||{},T=!!i.sync,S=!1,E={body:void 0,headers:{},statusCode:0,method:_,url:y,rawRequest:p};if("json"in i&&!1!==i.json&&(S=!0,b.accept||b.Accept||(b.Accept="application/json"),"GET"!==_&&"HEAD"!==_&&(b["content-type"]||b["Content-Type"]||(b["Content-Type"]="application/json"),v=JSON.stringify(!0===i.json?v:i.json))),p.onreadystatechange=function readystatechange(){4!==p.readyState||createXHR.responseInterceptorsStorage.getIsEnabled()||setTimeout(loadFunc,0)},p.onload=loadFunc,p.onerror=errorFunc,p.onprogress=function(){},p.onabort=function(){h=!0,clearTimeout(i.retryTimeout)},p.ontimeout=errorFunc,p.open(_,y,!T,i.username,i.password),T||(p.withCredentials=!!i.withCredentials),!T&&i.timeout>0&&(m=setTimeout((function(){if(!h){h=!0,p.abort("timeout");var i=new Error("XMLHttpRequest timeout");i.code="ETIMEDOUT",errorFunc(i)}}),i.timeout)),p.setRequestHeader)for(c in b)b.hasOwnProperty(c)&&p.setRequestHeader(c,b[c]);else if(i.headers&&!function isEmpty(i){for(var l in i)if(i.hasOwnProperty(l))return!1;return!0}(i.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in i&&(p.responseType=i.responseType),"beforeSend"in i&&"function"==typeof i.beforeSend&&i.beforeSend(p),p.send(v||null),p}i.exports=createXHR,i.exports.default=createXHR,createXHR.XMLHttpRequest=u.XMLHttpRequest||function noop(){},createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:u.XDomainRequest,function forEachArray(i,l){for(var d=0;d<i.length;d++)l(i[d])}(["get","put","post","patch","head","delete"],(function(i){createXHR["delete"===i?"del":i]=function(l,d,u){return(d=initParams(l,d,u)).method=i.toUpperCase(),_createXHR(d)}}))},36081:i=>{"use strict";function _createForOfIteratorHelperLoose(i,l){var d="undefined"!=typeof Symbol&&i[Symbol.iterator]||i["@@iterator"];if(d)return(d=d.call(i)).next.bind(d);if(Array.isArray(i)||(d=function _unsupportedIterableToArray(i,l){if(!i)return;if("string"==typeof i)return _arrayLikeToArray(i,l);var d=Object.prototype.toString.call(i).slice(8,-1);"Object"===d&&i.constructor&&(d=i.constructor.name);if("Map"===d||"Set"===d)return Array.from(i);if("Arguments"===d||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d))return _arrayLikeToArray(i,l)}(i))||l&&i&&"number"==typeof i.length){d&&(i=d);var u=0;return function(){return u>=i.length?{done:!0}:{done:!1,value:i[u++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _arrayLikeToArray(i,l){(null==l||l>i.length)&&(l=i.length);for(var d=0,u=new Array(l);d<l;d++)u[d]=i[d];return u}var l=function(){function InterceptorsStorage(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1}var i=InterceptorsStorage.prototype;return i.getIsEnabled=function getIsEnabled(){return this.enabled_},i.enable=function enable(){this.enabled_=!0},i.disable=function disable(){this.enabled_=!1},i.reset=function reset(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1},i.addInterceptor=function addInterceptor(i,l){this.typeToInterceptorsMap_.has(i)||this.typeToInterceptorsMap_.set(i,new Set);var d=this.typeToInterceptorsMap_.get(i);return!d.has(l)&&(d.add(l),!0)},i.removeInterceptor=function removeInterceptor(i,l){var d=this.typeToInterceptorsMap_.get(i);return!(!d||!d.has(l))&&(d.delete(l),!0)},i.clearInterceptorsByType=function clearInterceptorsByType(i){return!!this.typeToInterceptorsMap_.get(i)&&(this.typeToInterceptorsMap_.delete(i),this.typeToInterceptorsMap_.set(i,new Set),!0)},i.clear=function clear(){return!!this.typeToInterceptorsMap_.size&&(this.typeToInterceptorsMap_=new Map,!0)},i.getForType=function getForType(i){return this.typeToInterceptorsMap_.get(i)||new Set},i.execute=function execute(i,l){for(var d,u=_createForOfIteratorHelperLoose(this.getForType(i));!(d=u()).done;){var c=d.value;try{l=c(l)}catch(i){}}return l},InterceptorsStorage}();i.exports=l},98515:i=>{"use strict";var l=function(){function RetryManager(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1}var i=RetryManager.prototype;return i.getIsEnabled=function getIsEnabled(){return this.enabled_},i.enable=function enable(){this.enabled_=!0},i.disable=function disable(){this.enabled_=!1},i.reset=function reset(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1},i.getMaxAttempts=function getMaxAttempts(){return this.maxAttempts_},i.setMaxAttempts=function setMaxAttempts(i){this.maxAttempts_=i},i.getDelayFactor=function getDelayFactor(){return this.delayFactor_},i.setDelayFactor=function setDelayFactor(i){this.delayFactor_=i},i.getFuzzFactor=function getFuzzFactor(){return this.fuzzFactor_},i.setFuzzFactor=function setFuzzFactor(i){this.fuzzFactor_=i},i.getInitialDelay=function getInitialDelay(){return this.initialDelay_},i.setInitialDelay=function setInitialDelay(i){this.initialDelay_=i},i.createRetry=function createRetry(i){var l=void 0===i?{}:i;return new d({maxAttempts:l.maxAttempts||this.maxAttempts_,delayFactor:l.delayFactor||this.delayFactor_,fuzzFactor:l.fuzzFactor||this.fuzzFactor_,initialDelay:l.initialDelay||this.initialDelay_})},RetryManager}(),d=function(){function Retry(i){this.maxAttempts_=i.maxAttempts,this.delayFactor_=i.delayFactor,this.fuzzFactor_=i.fuzzFactor,this.currentDelay_=i.initialDelay,this.currentAttempt_=1}var i=Retry.prototype;return i.moveToNextAttempt=function moveToNextAttempt(){this.currentAttempt_++,this.currentDelay_=this.currentDelay_+this.currentDelay_*this.delayFactor_},i.shouldRetry=function shouldRetry(){return this.currentAttempt_<this.maxAttempts_},i.getCurrentDelay=function getCurrentDelay(){return this.currentDelay_},i.getCurrentMinPossibleDelay=function getCurrentMinPossibleDelay(){return(1-this.fuzzFactor_)*this.currentDelay_},i.getCurrentMaxPossibleDelay=function getCurrentMaxPossibleDelay(){return(1+this.fuzzFactor_)*this.currentDelay_},i.getCurrentFuzzedDelay=function getCurrentFuzzedDelay(){var i=this.getCurrentMinPossibleDelay(),l=this.getCurrentMaxPossibleDelay();return i+Math.random()*(l-i)},Retry}();i.exports=l},55880:(i,l)=>{"use strict";function freeze(i,l){return void 0===l&&(l=Object),l&&"function"==typeof l.freeze?l.freeze(i):i}var d=freeze({HTML:"text/html",isHTML:function(i){return i===d.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),u=freeze({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(i){return i===u.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});l.assign=function assign(i,l){if(null===i||"object"!=typeof i)throw new TypeError("target is not an object");for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(i[d]=l[d]);return i},l.find=function find(i,l,d){if(void 0===d&&(d=Array.prototype),i&&"function"==typeof d.find)return d.find.call(i,l);for(var u=0;u<i.length;u++)if(Object.prototype.hasOwnProperty.call(i,u)){var c=i[u];if(l.call(void 0,c,u,i))return c}},l.freeze=freeze,l.MIME_TYPE=d,l.NAMESPACE=u},22219:(i,l,d)=>{var u=d(55880),c=d(57315),h=d(31032),p=d(51495),m=c.DOMImplementation,g=u.NAMESPACE,y=p.ParseError,_=p.XMLReader;function normalizeLineEndings(i){return i.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function DOMParser(i){this.options=i||{locator:{}}}function DOMHandler(){this.cdata=!1}function position(i,l){l.lineNumber=i.lineNumber,l.columnNumber=i.columnNumber}function _locator(i){if(i)return"\n@"+(i.systemId||"")+"#[line:"+i.lineNumber+",col:"+i.columnNumber+"]"}function _toString(i,l,d){return"string"==typeof i?i.substr(l,d):i.length>=l+d||l?new java.lang.String(i,l,d)+"":i}function appendElement(i,l){i.currentElement?i.currentElement.appendChild(l):i.doc.appendChild(l)}DOMParser.prototype.parseFromString=function(i,l){var d=this.options,u=new _,c=d.domBuilder||new DOMHandler,p=d.errorHandler,m=d.locator,y=d.xmlns||{},v=/\/x?html?$/.test(l),b=v?h.HTML_ENTITIES:h.XML_ENTITIES;return m&&c.setDocumentLocator(m),u.errorHandler=function buildErrorHandler(i,l,d){if(!i){if(l instanceof DOMHandler)return l;i=l}var u={},c=i instanceof Function;function build(l){var h=i[l];!h&&c&&(h=2==i.length?function(d){i(l,d)}:i),u[l]=h&&function(i){h("[xmldom "+l+"]\t"+i+_locator(d))}||function(){}}return d=d||{},build("warning"),build("error"),build("fatalError"),u}(p,c,m),u.domBuilder=d.domBuilder||c,v&&(y[""]=g.HTML),y.xml=y.xml||g.XML,i&&"string"==typeof i?u.parse((d.normalizeLineEndings||normalizeLineEndings)(i),y,b):u.errorHandler.error("invalid doc source"),c.doc},DOMHandler.prototype={startDocument:function(){this.doc=(new m).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(i,l,d,u){var c=this.doc,h=c.createElementNS(i,d||l),p=u.length;appendElement(this,h),this.currentElement=h,this.locator&&position(this.locator,h);for(var m=0;m<p;m++){i=u.getURI(m);var g=u.getValue(m),y=(d=u.getQName(m),c.createAttributeNS(i,d));this.locator&&position(u.getLocator(m),y),y.value=y.nodeValue=g,h.setAttributeNode(y)}},endElement:function(i,l,d){var u=this.currentElement;this.currentElement=u.parentNode},startPrefixMapping:function(i,l){},endPrefixMapping:function(i){},processingInstruction:function(i,l){var d=this.doc.createProcessingInstruction(i,l);this.locator&&position(this.locator,d),appendElement(this,d)},ignorableWhitespace:function(i,l,d){},characters:function(i,l,d){if(i=_toString.apply(this,arguments)){if(this.cdata)var u=this.doc.createCDATASection(i);else u=this.doc.createTextNode(i);this.currentElement?this.currentElement.appendChild(u):/^\s*$/.test(i)&&this.doc.appendChild(u),this.locator&&position(this.locator,u)}},skippedEntity:function(i){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(i){(this.locator=i)&&(i.lineNumber=0)},comment:function(i,l,d){i=_toString.apply(this,arguments);var u=this.doc.createComment(i);this.locator&&position(this.locator,u),appendElement(this,u)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(i,l,d){var u=this.doc.implementation;if(u&&u.createDocumentType){var c=u.createDocumentType(i,l,d);this.locator&&position(this.locator,c),appendElement(this,c),this.doc.doctype=c}},warning:function(i){console.warn("[xmldom warning]\t"+i,_locator(this.locator))},error:function(i){console.error("[xmldom error]\t"+i,_locator(this.locator))},fatalError:function(i){throw new y(i,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(i){DOMHandler.prototype[i]=function(){return null}})),l.DOMParser=DOMParser},57315:(i,l,d)=>{var u=d(55880),c=u.find,h=u.NAMESPACE;function notEmptyString(i){return""!==i}function orderedSetReducer(i,l){return i.hasOwnProperty(l)||(i[l]=!0),i}function toOrderedSet(i){if(!i)return[];var l=function splitOnASCIIWhitespace(i){return i?i.split(/[\t\n\f\r ]+/).filter(notEmptyString):[]}(i);return Object.keys(l.reduce(orderedSetReducer,{}))}function copy(i,l){for(var d in i)Object.prototype.hasOwnProperty.call(i,d)&&(l[d]=i[d])}function _extends(i,l){var d=i.prototype;if(!(d instanceof l)){function t(){}t.prototype=l.prototype,copy(d,t=new t),i.prototype=d=t}d.constructor!=i&&("function"!=typeof i&&console.error("unknown Class:"+i),d.constructor=i)}var p={},m=p.ELEMENT_NODE=1,g=p.ATTRIBUTE_NODE=2,y=p.TEXT_NODE=3,_=p.CDATA_SECTION_NODE=4,v=p.ENTITY_REFERENCE_NODE=5,b=p.ENTITY_NODE=6,T=p.PROCESSING_INSTRUCTION_NODE=7,S=p.COMMENT_NODE=8,E=p.DOCUMENT_NODE=9,k=p.DOCUMENT_TYPE_NODE=10,w=p.DOCUMENT_FRAGMENT_NODE=11,C=p.NOTATION_NODE=12,x={},A={},P=(x.INDEX_SIZE_ERR=(A[1]="Index size error",1),x.DOMSTRING_SIZE_ERR=(A[2]="DOMString size error",2),x.HIERARCHY_REQUEST_ERR=(A[3]="Hierarchy request error",3)),I=(x.WRONG_DOCUMENT_ERR=(A[4]="Wrong document",4),x.INVALID_CHARACTER_ERR=(A[5]="Invalid character",5),x.NO_DATA_ALLOWED_ERR=(A[6]="No data allowed",6),x.NO_MODIFICATION_ALLOWED_ERR=(A[7]="No modification allowed",7),x.NOT_FOUND_ERR=(A[8]="Not found",8)),D=(x.NOT_SUPPORTED_ERR=(A[9]="Not supported",9),x.INUSE_ATTRIBUTE_ERR=(A[10]="Attribute in use",10));x.INVALID_STATE_ERR=(A[11]="Invalid state",11),x.SYNTAX_ERR=(A[12]="Syntax error",12),x.INVALID_MODIFICATION_ERR=(A[13]="Invalid modification",13),x.NAMESPACE_ERR=(A[14]="Invalid namespace",14),x.INVALID_ACCESS_ERR=(A[15]="Invalid access",15);function DOMException(i,l){if(l instanceof Error)var d=l;else d=this,Error.call(this,A[i]),this.message=A[i],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return d.code=i,l&&(this.message=this.message+": "+l),d}function NodeList(){}function LiveNodeList(i,l){this._node=i,this._refresh=l,_updateLiveList(this)}function _updateLiveList(i){var l=i._node._inc||i._node.ownerDocument._inc;if(i._inc!==l){var d=i._refresh(i._node);if(__set__(i,"length",d.length),!i.$$length||d.length<i.$$length)for(var u=d.length;u in i;u++)Object.prototype.hasOwnProperty.call(i,u)&&delete i[u];copy(d,i),i._inc=l}}function NamedNodeMap(){}function _findNodeIndex(i,l){for(var d=i.length;d--;)if(i[d]===l)return d}function _addNamedNode(i,l,d,u){if(u?l[_findNodeIndex(l,u)]=d:l[l.length++]=d,i){d.ownerElement=i;var c=i.ownerDocument;c&&(u&&_onRemoveAttribute(c,i,u),function _onAddAttribute(i,l,d){i&&i._inc++;var u=d.namespaceURI;u===h.XMLNS&&(l._nsMap[d.prefix?d.localName:""]=d.value)}(c,i,d))}}function _removeNamedNode(i,l,d){var u=_findNodeIndex(l,d);if(!(u>=0))throw new DOMException(I,new Error(i.tagName+"@"+d));for(var c=l.length-1;u<c;)l[u]=l[++u];if(l.length=c,i){var h=i.ownerDocument;h&&(_onRemoveAttribute(h,i,d),d.ownerElement=null)}}function DOMImplementation(){}function Node(){}function _xmlEncoder(i){return("<"==i?"&lt;":">"==i&&"&gt;")||"&"==i&&"&amp;"||'"'==i&&"&quot;"||"&#"+i.charCodeAt()+";"}function _visitNode(i,l){if(l(i))return!0;if(i=i.firstChild)do{if(_visitNode(i,l))return!0}while(i=i.nextSibling)}function Document(){this.ownerDocument=this}function _onRemoveAttribute(i,l,d,u){i&&i._inc++,d.namespaceURI===h.XMLNS&&delete l._nsMap[d.prefix?d.localName:""]}function _onUpdateChild(i,l,d){if(i&&i._inc){i._inc++;var u=l.childNodes;if(d)u[u.length++]=d;else{for(var c=l.firstChild,h=0;c;)u[h++]=c,c=c.nextSibling;u.length=h,delete u[u.length]}}}function _removeChild(i,l){var d=l.previousSibling,u=l.nextSibling;return d?d.nextSibling=u:i.firstChild=u,u?u.previousSibling=d:i.lastChild=d,l.parentNode=null,l.previousSibling=null,l.nextSibling=null,_onUpdateChild(i.ownerDocument,i),l}function isDocTypeNode(i){return i&&i.nodeType===Node.DOCUMENT_TYPE_NODE}function isElementNode(i){return i&&i.nodeType===Node.ELEMENT_NODE}function isTextNode(i){return i&&i.nodeType===Node.TEXT_NODE}function isElementInsertionPossible(i,l){var d=i.childNodes||[];if(c(d,isElementNode)||isDocTypeNode(l))return!1;var u=c(d,isDocTypeNode);return!(l&&u&&d.indexOf(u)>d.indexOf(l))}function isElementReplacementPossible(i,l){var d=i.childNodes||[];if(c(d,(function hasElementChildThatIsNotChild(i){return isElementNode(i)&&i!==l})))return!1;var u=c(d,isDocTypeNode);return!(l&&u&&d.indexOf(u)>d.indexOf(l))}function assertPreInsertionValidity1to5(i,l,d){if(!function hasValidParentNodeType(i){return i&&(i.nodeType===Node.DOCUMENT_NODE||i.nodeType===Node.DOCUMENT_FRAGMENT_NODE||i.nodeType===Node.ELEMENT_NODE)}(i))throw new DOMException(P,"Unexpected parent node type "+i.nodeType);if(d&&d.parentNode!==i)throw new DOMException(I,"child not in parent");if(!function hasInsertableNodeType(i){return i&&(isElementNode(i)||isTextNode(i)||isDocTypeNode(i)||i.nodeType===Node.DOCUMENT_FRAGMENT_NODE||i.nodeType===Node.COMMENT_NODE||i.nodeType===Node.PROCESSING_INSTRUCTION_NODE)}(l)||isDocTypeNode(l)&&i.nodeType!==Node.DOCUMENT_NODE)throw new DOMException(P,"Unexpected node type "+l.nodeType+" for parent node type "+i.nodeType)}function assertPreInsertionValidityInDocument(i,l,d){var u=i.childNodes||[],h=l.childNodes||[];if(l.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var p=h.filter(isElementNode);if(p.length>1||c(h,isTextNode))throw new DOMException(P,"More than one element or text in fragment");if(1===p.length&&!isElementInsertionPossible(i,d))throw new DOMException(P,"Element in fragment can not be inserted before doctype")}if(isElementNode(l)&&!isElementInsertionPossible(i,d))throw new DOMException(P,"Only one element can be added and only after doctype");if(isDocTypeNode(l)){if(c(u,isDocTypeNode))throw new DOMException(P,"Only one doctype is allowed");var m=c(u,isElementNode);if(d&&u.indexOf(m)<u.indexOf(d))throw new DOMException(P,"Doctype can only be inserted before an element");if(!d&&m)throw new DOMException(P,"Doctype can not be appended since element is present")}}function assertPreReplacementValidityInDocument(i,l,d){var u=i.childNodes||[],h=l.childNodes||[];if(l.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var p=h.filter(isElementNode);if(p.length>1||c(h,isTextNode))throw new DOMException(P,"More than one element or text in fragment");if(1===p.length&&!isElementReplacementPossible(i,d))throw new DOMException(P,"Element in fragment can not be inserted before doctype")}if(isElementNode(l)&&!isElementReplacementPossible(i,d))throw new DOMException(P,"Only one element can be added and only after doctype");if(isDocTypeNode(l)){if(c(u,(function hasDoctypeChildThatIsNotChild(i){return isDocTypeNode(i)&&i!==d})))throw new DOMException(P,"Only one doctype is allowed");var m=c(u,isElementNode);if(d&&u.indexOf(m)<u.indexOf(d))throw new DOMException(P,"Doctype can only be inserted before an element")}}function _insertBefore(i,l,d,u){assertPreInsertionValidity1to5(i,l,d),i.nodeType===Node.DOCUMENT_NODE&&(u||assertPreInsertionValidityInDocument)(i,l,d);var c=l.parentNode;if(c&&c.removeChild(l),l.nodeType===w){var h=l.firstChild;if(null==h)return l;var p=l.lastChild}else h=p=l;var m=d?d.previousSibling:i.lastChild;h.previousSibling=m,p.nextSibling=d,m?m.nextSibling=h:i.firstChild=h,null==d?i.lastChild=p:d.previousSibling=p;do{h.parentNode=i}while(h!==p&&(h=h.nextSibling));return _onUpdateChild(i.ownerDocument||i,i),l.nodeType==w&&(l.firstChild=l.lastChild=null),l}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function nodeSerializeToString(i,l){var d=[],u=9==this.nodeType&&this.documentElement||this,c=u.prefix,h=u.namespaceURI;if(h&&null==c&&null==(c=u.lookupPrefix(h)))var p=[{namespace:h,prefix:null}];return serializeToString(this,d,i,l,p),d.join("")}function needNamespaceDefine(i,l,d){var u=i.prefix||"",c=i.namespaceURI;if(!c)return!1;if("xml"===u&&c===h.XML||c===h.XMLNS)return!1;for(var p=d.length;p--;){var m=d[p];if(m.prefix===u)return m.namespace!==c}return!0}function addSerializedAttribute(i,l,d){i.push(" ",l,'="',d.replace(/[<>&"\t\n\r]/g,_xmlEncoder),'"')}function serializeToString(i,l,d,u,c){if(c||(c=[]),u){if(!(i=u(i)))return;if("string"==typeof i)return l.push(i),void 0}switch(i.nodeType){case m:var p=i.attributes,b=p.length,C=i.firstChild,x=i.tagName,A=x;if(!(d=h.isHTML(i.namespaceURI)||d)&&!i.prefix&&i.namespaceURI){for(var P,I=0;I<p.length;I++)if("xmlns"===p.item(I).name){P=p.item(I).value;break}if(!P)for(var D=c.length-1;D>=0;D--){if(""===(O=c[D]).prefix&&O.namespace===i.namespaceURI){P=O.namespace;break}}if(P!==i.namespaceURI)for(D=c.length-1;D>=0;D--){var O;if((O=c[D]).namespace===i.namespaceURI){O.prefix&&(A=O.prefix+":"+x);break}}}l.push("<",A);for(var L=0;L<b;L++){"xmlns"==(R=p.item(L)).prefix?c.push({prefix:R.localName,namespace:R.value}):"xmlns"==R.nodeName&&c.push({prefix:"",namespace:R.value})}for(L=0;L<b;L++){var R,V,M;if(needNamespaceDefine(R=p.item(L),0,c))addSerializedAttribute(l,(V=R.prefix||"")?"xmlns:"+V:"xmlns",M=R.namespaceURI),c.push({prefix:V,namespace:M});serializeToString(R,l,d,u,c)}if(x===A&&needNamespaceDefine(i,0,c))addSerializedAttribute(l,(V=i.prefix||"")?"xmlns:"+V:"xmlns",M=i.namespaceURI),c.push({prefix:V,namespace:M});if(C||d&&!/^(?:meta|link|img|br|hr|input)$/i.test(x)){if(l.push(">"),d&&/^script$/i.test(x))for(;C;)C.data?l.push(C.data):serializeToString(C,l,d,u,c.slice()),C=C.nextSibling;else for(;C;)serializeToString(C,l,d,u,c.slice()),C=C.nextSibling;l.push("</",A,">")}else l.push("/>");return;case E:case w:for(C=i.firstChild;C;)serializeToString(C,l,d,u,c.slice()),C=C.nextSibling;return;case g:return addSerializedAttribute(l,i.name,i.value);case y:return l.push(i.data.replace(/[<&>]/g,_xmlEncoder));case _:return l.push("<![CDATA[",i.data,"]]>");case S:return l.push("\x3c!--",i.data,"--\x3e");case k:var N=i.publicId,B=i.systemId;if(l.push("<!DOCTYPE ",i.name),N)l.push(" PUBLIC ",N),B&&"."!=B&&l.push(" ",B),l.push(">");else if(B&&"."!=B)l.push(" SYSTEM ",B,">");else{var j=i.internalSubset;j&&l.push(" [",j,"]"),l.push(">")}return;case T:return l.push("<?",i.target," ",i.data,"?>");case v:return l.push("&",i.nodeName,";");default:l.push("??",i.nodeName)}}function importNode(i,l,d){var u;switch(l.nodeType){case m:(u=l.cloneNode(!1)).ownerDocument=i;case w:break;case g:d=!0}if(u||(u=l.cloneNode(!1)),u.ownerDocument=i,u.parentNode=null,d)for(var c=l.firstChild;c;)u.appendChild(importNode(i,c,d)),c=c.nextSibling;return u}function cloneNode(i,l,d){var u=new l.constructor;for(var c in l)if(Object.prototype.hasOwnProperty.call(l,c)){var h=l[c];"object"!=typeof h&&h!=u[c]&&(u[c]=h)}switch(l.childNodes&&(u.childNodes=new NodeList),u.ownerDocument=i,u.nodeType){case m:var p=l.attributes,y=u.attributes=new NamedNodeMap,_=p.length;y._ownerElement=u;for(var v=0;v<_;v++)u.setAttributeNode(cloneNode(i,p.item(v),!0));break;case g:d=!0}if(d)for(var b=l.firstChild;b;)u.appendChild(cloneNode(i,b,d)),b=b.nextSibling;return u}function __set__(i,l,d){i[l]=d}DOMException.prototype=Error.prototype,copy(x,DOMException),NodeList.prototype={length:0,item:function(i){return i>=0&&i<this.length?this[i]:null},toString:function(i,l){for(var d=[],u=0;u<this.length;u++)serializeToString(this[u],d,i,l);return d.join("")},filter:function(i){return Array.prototype.filter.call(this,i)},indexOf:function(i){return Array.prototype.indexOf.call(this,i)}},LiveNodeList.prototype.item=function(i){return _updateLiveList(this),this[i]||null},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(i){for(var l=this.length;l--;){var d=this[l];if(d.nodeName==i)return d}},setNamedItem:function(i){var l=i.ownerElement;if(l&&l!=this._ownerElement)throw new DOMException(D);var d=this.getNamedItem(i.nodeName);return _addNamedNode(this._ownerElement,this,i,d),d},setNamedItemNS:function(i){var l,d=i.ownerElement;if(d&&d!=this._ownerElement)throw new DOMException(D);return l=this.getNamedItemNS(i.namespaceURI,i.localName),_addNamedNode(this._ownerElement,this,i,l),l},removeNamedItem:function(i){var l=this.getNamedItem(i);return _removeNamedNode(this._ownerElement,this,l),l},removeNamedItemNS:function(i,l){var d=this.getNamedItemNS(i,l);return _removeNamedNode(this._ownerElement,this,d),d},getNamedItemNS:function(i,l){for(var d=this.length;d--;){var u=this[d];if(u.localName==l&&u.namespaceURI==i)return u}return null}},DOMImplementation.prototype={hasFeature:function(i,l){return!0},createDocument:function(i,l,d){var u=new Document;if(u.implementation=this,u.childNodes=new NodeList,u.doctype=d||null,d&&u.appendChild(d),l){var c=u.createElementNS(i,l);u.appendChild(c)}return u},createDocumentType:function(i,l,d){var u=new DocumentType;return u.name=i,u.nodeName=i,u.publicId=l||"",u.systemId=d||"",u}},Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(i,l){return _insertBefore(this,i,l)},replaceChild:function(i,l){_insertBefore(this,i,l,assertPreReplacementValidityInDocument),l&&this.removeChild(l)},removeChild:function(i){return _removeChild(this,i)},appendChild:function(i){return this.insertBefore(i,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(i){return cloneNode(this.ownerDocument||this,this,i)},normalize:function(){for(var i=this.firstChild;i;){var l=i.nextSibling;l&&l.nodeType==y&&i.nodeType==y?(this.removeChild(l),i.appendData(l.data)):(i.normalize(),i=l)}},isSupported:function(i,l){return this.ownerDocument.implementation.hasFeature(i,l)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(i){for(var l=this;l;){var d=l._nsMap;if(d)for(var u in d)if(Object.prototype.hasOwnProperty.call(d,u)&&d[u]===i)return u;l=l.nodeType==g?l.ownerDocument:l.parentNode}return null},lookupNamespaceURI:function(i){for(var l=this;l;){var d=l._nsMap;if(d&&Object.prototype.hasOwnProperty.call(d,i))return d[i];l=l.nodeType==g?l.ownerDocument:l.parentNode}return null},isDefaultNamespace:function(i){return null==this.lookupPrefix(i)}},copy(p,Node),copy(p,Node.prototype),Document.prototype={nodeName:"#document",nodeType:E,doctype:null,documentElement:null,_inc:1,insertBefore:function(i,l){if(i.nodeType==w){for(var d=i.firstChild;d;){var u=d.nextSibling;this.insertBefore(d,l),d=u}return i}return _insertBefore(this,i,l),i.ownerDocument=this,null===this.documentElement&&i.nodeType===m&&(this.documentElement=i),i},removeChild:function(i){return this.documentElement==i&&(this.documentElement=null),_removeChild(this,i)},replaceChild:function(i,l){_insertBefore(this,i,l,assertPreReplacementValidityInDocument),i.ownerDocument=this,l&&this.removeChild(l),isElementNode(i)&&(this.documentElement=i)},importNode:function(i,l){return importNode(this,i,l)},getElementById:function(i){var l=null;return _visitNode(this.documentElement,(function(d){if(d.nodeType==m&&d.getAttribute("id")==i)return l=d,!0})),l},getElementsByClassName:function(i){var l=toOrderedSet(i);return new LiveNodeList(this,(function(d){var u=[];return l.length>0&&_visitNode(d.documentElement,(function(c){if(c!==d&&c.nodeType===m){var h=c.getAttribute("class");if(h){var p=i===h;if(!p){var g=toOrderedSet(h);p=l.every(function arrayIncludes(i){return function(l){return i&&-1!==i.indexOf(l)}}(g))}p&&u.push(c)}}})),u}))},createElement:function(i){var l=new Element;return l.ownerDocument=this,l.nodeName=i,l.tagName=i,l.localName=i,l.childNodes=new NodeList,(l.attributes=new NamedNodeMap)._ownerElement=l,l},createDocumentFragment:function(){var i=new DocumentFragment;return i.ownerDocument=this,i.childNodes=new NodeList,i},createTextNode:function(i){var l=new Text;return l.ownerDocument=this,l.appendData(i),l},createComment:function(i){var l=new Comment;return l.ownerDocument=this,l.appendData(i),l},createCDATASection:function(i){var l=new CDATASection;return l.ownerDocument=this,l.appendData(i),l},createProcessingInstruction:function(i,l){var d=new ProcessingInstruction;return d.ownerDocument=this,d.tagName=d.nodeName=d.target=i,d.nodeValue=d.data=l,d},createAttribute:function(i){var l=new Attr;return l.ownerDocument=this,l.name=i,l.nodeName=i,l.localName=i,l.specified=!0,l},createEntityReference:function(i){var l=new EntityReference;return l.ownerDocument=this,l.nodeName=i,l},createElementNS:function(i,l){var d=new Element,u=l.split(":"),c=d.attributes=new NamedNodeMap;return d.childNodes=new NodeList,d.ownerDocument=this,d.nodeName=l,d.tagName=l,d.namespaceURI=i,2==u.length?(d.prefix=u[0],d.localName=u[1]):d.localName=l,c._ownerElement=d,d},createAttributeNS:function(i,l){var d=new Attr,u=l.split(":");return d.ownerDocument=this,d.nodeName=l,d.name=l,d.namespaceURI=i,d.specified=!0,2==u.length?(d.prefix=u[0],d.localName=u[1]):d.localName=l,d}},_extends(Document,Node),Document.prototype.getElementsByTagName=(Element.prototype={nodeType:m,hasAttribute:function(i){return null!=this.getAttributeNode(i)},getAttribute:function(i){var l=this.getAttributeNode(i);return l&&l.value||""},getAttributeNode:function(i){return this.attributes.getNamedItem(i)},setAttribute:function(i,l){var d=this.ownerDocument.createAttribute(i);d.value=d.nodeValue=""+l,this.setAttributeNode(d)},removeAttribute:function(i){var l=this.getAttributeNode(i);l&&this.removeAttributeNode(l)},appendChild:function(i){return i.nodeType===w?this.insertBefore(i,null):function _appendSingleChild(i,l){return l.parentNode&&l.parentNode.removeChild(l),l.parentNode=i,l.previousSibling=i.lastChild,l.nextSibling=null,l.previousSibling?l.previousSibling.nextSibling=l:i.firstChild=l,i.lastChild=l,_onUpdateChild(i.ownerDocument,i,l),l}(this,i)},setAttributeNode:function(i){return this.attributes.setNamedItem(i)},setAttributeNodeNS:function(i){return this.attributes.setNamedItemNS(i)},removeAttributeNode:function(i){return this.attributes.removeNamedItem(i.nodeName)},removeAttributeNS:function(i,l){var d=this.getAttributeNodeNS(i,l);d&&this.removeAttributeNode(d)},hasAttributeNS:function(i,l){return null!=this.getAttributeNodeNS(i,l)},getAttributeNS:function(i,l){var d=this.getAttributeNodeNS(i,l);return d&&d.value||""},setAttributeNS:function(i,l,d){var u=this.ownerDocument.createAttributeNS(i,l);u.value=u.nodeValue=""+d,this.setAttributeNode(u)},getAttributeNodeNS:function(i,l){return this.attributes.getNamedItemNS(i,l)},getElementsByTagName:function(i){return new LiveNodeList(this,(function(l){var d=[];return _visitNode(l,(function(u){u===l||u.nodeType!=m||"*"!==i&&u.tagName!=i||d.push(u)})),d}))},getElementsByTagNameNS:function(i,l){return new LiveNodeList(this,(function(d){var u=[];return _visitNode(d,(function(c){c===d||c.nodeType!==m||"*"!==i&&c.namespaceURI!==i||"*"!==l&&c.localName!=l||u.push(c)})),u}))}}).getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=g,_extends(Attr,Node),CharacterData.prototype={data:"",substringData:function(i,l){return this.data.substring(i,i+l)},appendData:function(i){this.nodeValue=this.data=i=this.data+i,this.length=i.length},insertData:function(i,l){this.replaceData(i,0,l)},appendChild:function(i){throw new Error(A[P])},deleteData:function(i,l){this.replaceData(i,l,"")},replaceData:function(i,l,d){var u=this.data.substring(0,i),c=this.data.substring(i+l);this.nodeValue=this.data=d=u+d+c,this.length=d.length}},_extends(CharacterData,Node),Text.prototype={nodeName:"#text",nodeType:y,splitText:function(i){var l=this.data,d=l.substring(i);l=l.substring(0,i),this.data=this.nodeValue=l,this.length=l.length;var u=this.ownerDocument.createTextNode(d);return this.parentNode&&this.parentNode.insertBefore(u,this.nextSibling),u}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:S},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:_},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=k,_extends(DocumentType,Node),Notation.prototype.nodeType=C,_extends(Notation,Node),Entity.prototype.nodeType=b,_extends(Entity,Node),EntityReference.prototype.nodeType=v,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=w,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=T,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(i,l,d){return nodeSerializeToString.call(i,l,d)},Node.prototype.toString=nodeSerializeToString;try{if(Object.defineProperty){function getTextContent(i){switch(i.nodeType){case m:case w:var l=[];for(i=i.firstChild;i;)7!==i.nodeType&&8!==i.nodeType&&l.push(getTextContent(i)),i=i.nextSibling;return l.join("");default:return i.nodeValue}}Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(i){switch(this.nodeType){case m:case w:for(;this.firstChild;)this.removeChild(this.firstChild);(i||String(i))&&this.appendChild(this.ownerDocument.createTextNode(i));break;default:this.data=i,this.value=i,this.nodeValue=i}}}),__set__=function(i,l,d){i["$$"+l]=d}}}catch(O){}l.DocumentType=DocumentType,l.DOMException=DOMException,l.DOMImplementation=DOMImplementation,l.Element=Element,l.Node=Node,l.NodeList=NodeList,l.XMLSerializer=XMLSerializer},31032:(i,l,d)=>{"use strict";var u=d(55880).freeze;l.XML_ENTITIES=u({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),l.HTML_ENTITIES=u({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),l.entityMap=l.HTML_ENTITIES},32419:(i,l,d)=>{var u=d(57315);l.DOMParser=d(22219).DOMParser},51495:(i,l,d)=>{var u=d(55880).NAMESPACE,c=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,h=new RegExp("[\\-\\.0-9"+c.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),p=new RegExp("^"+c.source+h.source+"*(?::"+c.source+h.source+"*)?$");function ParseError(i,l){this.message=i,this.locator=l,Error.captureStackTrace&&Error.captureStackTrace(this,ParseError)}function XMLReader(){}function copyLocator(i,l){return l.lineNumber=i.lineNumber,l.columnNumber=i.columnNumber,l}function parseElementStartPart(i,l,d,c,h,p){function addAttribute(i,l,u){d.attributeNames.hasOwnProperty(i)&&p.fatalError("Attribute "+i+" redefined"),d.addValue(i,l.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,h),u)}for(var m,g=++l,y=0;;){var _=i.charAt(g);switch(_){case"=":if(1===y)m=i.slice(l,g),y=3;else{if(2!==y)throw new Error("attribute equal must after attrName");y=3}break;case"'":case'"':if(3===y||1===y){if(1===y&&(p.warning('attribute value must after "="'),m=i.slice(l,g)),!((g=i.indexOf(_,l=g+1))>0))throw new Error("attribute value no end '"+_+"' match");addAttribute(m,v=i.slice(l,g),l-1),y=5}else{if(4!=y)throw new Error('attribute value must after "="');addAttribute(m,v=i.slice(l,g),l),p.warning('attribute "'+m+'" missed start quot('+_+")!!"),l=g+1,y=5}break;case"/":switch(y){case 0:d.setTagName(i.slice(l,g));case 5:case 6:case 7:y=7,d.closed=!0;case 4:case 1:break;case 2:d.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return p.error("unexpected end of input"),0==y&&d.setTagName(i.slice(l,g)),g;case">":switch(y){case 0:d.setTagName(i.slice(l,g));case 5:case 6:case 7:break;case 4:case 1:"/"===(v=i.slice(l,g)).slice(-1)&&(d.closed=!0,v=v.slice(0,-1));case 2:2===y&&(v=m),4==y?(p.warning('attribute "'+v+'" missed quot(")!'),addAttribute(m,v,l)):(u.isHTML(c[""])&&v.match(/^(?:disabled|checked|selected)$/i)||p.warning('attribute "'+v+'" missed value!! "'+v+'" instead!!'),addAttribute(v,v,l));break;case 3:throw new Error("attribute value missed!!")}return g;case"":_=" ";default:if(_<=" ")switch(y){case 0:d.setTagName(i.slice(l,g)),y=6;break;case 1:m=i.slice(l,g),y=2;break;case 4:var v=i.slice(l,g);p.warning('attribute "'+v+'" missed quot(")!!'),addAttribute(m,v,l);case 5:y=6}else switch(y){case 2:u.isHTML(c[""])&&m.match(/^(?:disabled|checked|selected)$/i)||p.warning('attribute "'+m+'" missed value!! "'+m+'" instead2!!'),addAttribute(m,m,l),l=g,y=1;break;case 5:p.warning('attribute space is required"'+m+'"!!');case 6:y=1,l=g;break;case 3:y=4,l=g;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}g++}}function appendElement(i,l,d){for(var c=i.tagName,h=null,p=i.length;p--;){var m=i[p],g=m.qName,y=m.value;if((T=g.indexOf(":"))>0)var _=m.prefix=g.slice(0,T),v=g.slice(T+1),b="xmlns"===_&&v;else v=g,_=null,b="xmlns"===g&&"";m.localName=v,!1!==b&&(null==h&&(h={},_copy(d,d={})),d[b]=h[b]=y,m.uri=u.XMLNS,l.startPrefixMapping(b,y))}for(p=i.length;p--;){(_=(m=i[p]).prefix)&&("xml"===_&&(m.uri=u.XML),"xmlns"!==_&&(m.uri=d[_||""]))}var T;(T=c.indexOf(":"))>0?(_=i.prefix=c.slice(0,T),v=i.localName=c.slice(T+1)):(_=null,v=i.localName=c);var S=i.uri=d[_||""];if(l.startElement(S,v,c,i),!i.closed)return i.currentNSMap=d,i.localNSMap=h,!0;if(l.endElement(S,v,c),h)for(_ in h)Object.prototype.hasOwnProperty.call(h,_)&&l.endPrefixMapping(_)}function parseHtmlSpecialContent(i,l,d,u,c){if(/^(?:script|textarea)$/i.test(d)){var h=i.indexOf("</"+d+">",l),p=i.substring(l+1,h);if(/[&<]/.test(p))return/^script$/i.test(d)?(c.characters(p,0,p.length),h):(p=p.replace(/&#?\w+;/g,u),c.characters(p,0,p.length),h)}return l+1}function fixSelfClosed(i,l,d,u){var c=u[d];return null==c&&((c=i.lastIndexOf("</"+d+">"))<l&&(c=i.lastIndexOf("</"+d)),u[d]=c),c<l}function _copy(i,l){for(var d in i)Object.prototype.hasOwnProperty.call(i,d)&&(l[d]=i[d])}function parseDCC(i,l,d,u){if("-"===i.charAt(l+2))return"-"===i.charAt(l+3)?(c=i.indexOf("--\x3e",l+4))>l?(d.comment(i,l+4,c-l-4),c+3):(u.error("Unclosed comment"),-1):-1;if("CDATA["==i.substr(l+3,6)){var c=i.indexOf("]]>",l+9);return d.startCDATA(),d.characters(i,l+9,c-l-9),d.endCDATA(),c+3}var h=function split(i,l){var d,u=[],c=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;c.lastIndex=l,c.exec(i);for(;d=c.exec(i);)if(u.push(d),d[1])return u}(i,l),p=h.length;if(p>1&&/!doctype/i.test(h[0][0])){var m=h[1][0],g=!1,y=!1;p>3&&(/^public$/i.test(h[2][0])?(g=h[3][0],y=p>4&&h[4][0]):/^system$/i.test(h[2][0])&&(y=h[3][0]));var _=h[p-1];return d.startDTD(m,g,y),d.endDTD(),_.index+_[0].length}return-1}function parseInstruction(i,l,d){var u=i.indexOf("?>",l);if(u){var c=i.substring(l,u).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(c){return d.processingInstruction(c[1],c[2]),u+2}return-1}return-1}function ElementAttributes(){this.attributeNames={}}(ParseError.prototype=new Error).name=ParseError.name,XMLReader.prototype={parse:function(i,l,d){var c=this.domBuilder;c.startDocument(),_copy(l,l={}),function parse(i,l,d,c,h){function fixedFromCharCode(i){return i>65535?(i-=65536,String.fromCharCode(55296+(i>>10),56320+(1023&i))):String.fromCharCode(i)}function entityReplacer(i){var l=i.slice(1,-1);return Object.hasOwnProperty.call(d,l)?d[l]:"#"===l.charAt(0)?fixedFromCharCode(parseInt(l.substr(1).replace("x","0x"))):(h.error("entity not found:"+i),i)}function appendText(l){if(l>b){var d=i.substring(b,l).replace(/&#?\w+;/g,entityReplacer);y&&position(b),c.characters(d,0,l-b),b=l}}function position(l,d){for(;l>=m&&(d=g.exec(i));)m=(p=d.index)+d[0].length,y.lineNumber++;y.columnNumber=l-p+1}var p=0,m=0,g=/.*(?:\r\n?|\n)|.*$/g,y=c.locator,_=[{currentNSMap:l}],v={},b=0;for(;;){try{var T=i.indexOf("<",b);if(T<0){if(!i.substr(b).match(/^\s*$/)){var S=c.doc,E=S.createTextNode(i.substr(b));S.appendChild(E),c.currentElement=E}return}switch(T>b&&appendText(T),i.charAt(T+1)){case"/":var k=i.indexOf(">",T+3),w=i.substring(T+2,k).replace(/[ \t\n\r]+$/g,""),C=_.pop();k<0?(w=i.substring(T+2).replace(/[\s<].*/,""),h.error("end tag name: "+w+" is not complete:"+C.tagName),k=T+1+w.length):w.match(/\s</)&&(w=w.replace(/[\s<].*/,""),h.error("end tag name: "+w+" maybe not complete"),k=T+1+w.length);var x=C.localNSMap,A=C.tagName==w;if(A||C.tagName&&C.tagName.toLowerCase()==w.toLowerCase()){if(c.endElement(C.uri,C.localName,w),x)for(var P in x)Object.prototype.hasOwnProperty.call(x,P)&&c.endPrefixMapping(P);A||h.fatalError("end tag name: "+w+" is not match the current start tagName:"+C.tagName)}else _.push(C);k++;break;case"?":y&&position(T),k=parseInstruction(i,T,c);break;case"!":y&&position(T),k=parseDCC(i,T,c,h);break;default:y&&position(T);var I=new ElementAttributes,D=_[_.length-1].currentNSMap,O=(k=parseElementStartPart(i,T,I,D,entityReplacer,h),I.length);if(!I.closed&&fixSelfClosed(i,k,I.tagName,v)&&(I.closed=!0,d.nbsp||h.warning("unclosed xml attribute")),y&&O){for(var L=copyLocator(y,{}),R=0;R<O;R++){var V=I[R];position(V.offset),V.locator=copyLocator(y,{})}c.locator=L,appendElement(I,c,D)&&_.push(I),c.locator=y}else appendElement(I,c,D)&&_.push(I);u.isHTML(I.uri)&&!I.closed?k=parseHtmlSpecialContent(i,k,I.tagName,entityReplacer,c):k++}}catch(i){if(i instanceof ParseError)throw i;h.error("element parse error: "+i),k=-1}k>b?b=k:appendText(Math.max(T,b)+1)}}(i,l,d,c,this.errorHandler),c.endDocument()}},ElementAttributes.prototype={setTagName:function(i){if(!p.test(i))throw new Error("invalid tagName:"+i);this.tagName=i},addValue:function(i,l,d){if(!p.test(i))throw new Error("invalid attribute:"+i);this.attributeNames[i]=this.length,this[this.length++]={qName:i,value:l,offset:d}},length:0,getLocalName:function(i){return this[i].localName},getLocator:function(i){return this[i].locator},getQName:function(i){return this[i].qName},getURI:function(i){return this[i].uri},getValue:function(i){return this[i].value}},l.XMLReader=XMLReader,l.ParseError=ParseError},90410:(i,l,d)=>{var u,c="undefined"!=typeof global?global:"undefined"!=typeof window?window:{},h=d(80542);"undefined"!=typeof document?u=document:(u=c["__GLOBAL_DOCUMENT_CACHE@4"])||(u=c["__GLOBAL_DOCUMENT_CACHE@4"]=h),i.exports=u},12843:i=>{var l;l="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i.exports=l},59819:i=>{i.exports=function isFunction(i){if(!i)return!1;var d=l.call(i);return"[object Function]"===d||"function"==typeof i&&"[object RegExp]"!==d||"undefined"!=typeof window&&(i===window.setTimeout||i===window.alert||i===window.confirm||i===window.prompt)};var l=Object.prototype.toString},41089:(i,l,d)=>{var u=d(93627).getUint64;i.exports=function(i){var l=new DataView(i.buffer,i.byteOffset,i.byteLength),d={version:i[0],flags:new Uint8Array(i.subarray(1,4)),references:[],referenceId:l.getUint32(4),timescale:l.getUint32(8)},c=12;0===d.version?(d.earliestPresentationTime=l.getUint32(c),d.firstOffset=l.getUint32(c+4),c+=8):(d.earliestPresentationTime=u(i.subarray(c)),d.firstOffset=u(i.subarray(c+8)),c+=16);var h=l.getUint16(c+=2);for(c+=2;h>0;c+=12,h--)d.references.push({referenceType:(128&i[c])>>>7,referencedSize:2147483647&l.getUint32(c),subsegmentDuration:l.getUint32(c+4),startsWithSap:!!(128&i[c+8]),sapType:(112&i[c+8])>>>4,sapDeltaTime:268435455&l.getUint32(c+8)});return d}},12915:i=>{var l,d,u,c,h,p,m,g=9e4;h=function(i,d){return l(c(i,d))},p=function(i,l){return d(u(i),l)},m=function(i,l,d){return u(d?i:i-l)},i.exports={ONE_SECOND_IN_TS:g,secondsToVideoTs:l=function(i){return i*g},secondsToAudioTs:d=function(i,l){return i*l},videoTsToSeconds:u=function(i){return i/g},audioTsToSeconds:c=function(i,l){return i/l},audioTsToVideoTs:h,videoTsToAudioTs:p,metadataTsToSeconds:m}},93627:i=>{var l=Math.pow(2,32);i.exports={getUint64:function(i){var d,u=new DataView(i.buffer,i.byteOffset,i.byteLength);return u.getBigUint64?(d=u.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(d):d:u.getUint32(0)*l+u.getUint32(4)},MAX_UINT32:l}},89997:i=>{!function webpackUniversalModuleDefinition(l,d){i.exports=d()}(globalThis,(function(){return(()=>{var i={506:i=>{i.exports=function _assertThisInitialized(i){if(void 0===i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i},i.exports.__esModule=!0,i.exports.default=i.exports},575:i=>{i.exports=function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")},i.exports.__esModule=!0,i.exports.default=i.exports},913:i=>{function _defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}i.exports=function _createClass(i,l,d){return l&&_defineProperties(i.prototype,l),d&&_defineProperties(i,d),Object.defineProperty(i,"prototype",{writable:!1}),i},i.exports.__esModule=!0,i.exports.default=i.exports},525:(i,l,d)=>{var u=d(331);function _get(){return"undefined"!=typeof Reflect&&Reflect.get?(i.exports=_get=Reflect.get,i.exports.__esModule=!0,i.exports.default=i.exports):(i.exports=_get=function _get(i,l,d){var c=u(i,l);if(c){var h=Object.getOwnPropertyDescriptor(c,l);return h.get?h.get.call(arguments.length<3?i:d):h.value}},i.exports.__esModule=!0,i.exports.default=i.exports),_get.apply(this,arguments)}i.exports=_get,i.exports.__esModule=!0,i.exports.default=i.exports},754:i=>{function _getPrototypeOf(l){return i.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(i){return i.__proto__||Object.getPrototypeOf(i)},i.exports.__esModule=!0,i.exports.default=i.exports,_getPrototypeOf(l)}i.exports=_getPrototypeOf,i.exports.__esModule=!0,i.exports.default=i.exports},205:(i,l,d)=>{var u=d(489);i.exports=function _inherits(i,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(l&&l.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),l&&u(i,l)},i.exports.__esModule=!0,i.exports.default=i.exports},318:i=>{i.exports=function _interopRequireDefault(i){return i&&i.__esModule?i:{default:i}},i.exports.__esModule=!0,i.exports.default=i.exports},585:(i,l,d)=>{var u=d(8).default,c=d(506);i.exports=function _possibleConstructorReturn(i,l){if(l&&("object"===u(l)||"function"==typeof l))return l;if(void 0!==l)throw new TypeError("Derived constructors may only return object or undefined");return c(i)},i.exports.__esModule=!0,i.exports.default=i.exports},489:i=>{function _setPrototypeOf(l,d){return i.exports=_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(i,l){return i.__proto__=l,i},i.exports.__esModule=!0,i.exports.default=i.exports,_setPrototypeOf(l,d)}i.exports=_setPrototypeOf,i.exports.__esModule=!0,i.exports.default=i.exports},331:(i,l,d)=>{var u=d(754);i.exports=function _superPropBase(i,l){for(;!Object.prototype.hasOwnProperty.call(i,l)&&null!==(i=u(i)););return i},i.exports.__esModule=!0,i.exports.default=i.exports},8:i=>{function _typeof(l){return i.exports=_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},i.exports.__esModule=!0,i.exports.default=i.exports,_typeof(l)}i.exports=_typeof,i.exports.__esModule=!0,i.exports.default=i.exports},848:i=>{window,i.exports=function(i){var l={};function r(d){if(l[d])return l[d].exports;var u=l[d]={i:d,l:!1,exports:{}};return i[d].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=i,r.c=l,r.d=function(i,l,d){r.o(i,l)||Object.defineProperty(i,l,{enumerable:!0,get:d})},r.r=function(i){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r.t=function(i,l){if(1&l&&(i=r(i)),8&l)return i;if(4&l&&"object"==typeof i&&i&&i.__esModule)return i;var d=Object.create(null);if(r.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:i}),2&l&&"string"!=typeof i)for(var u in i)r.d(d,u,function(l){return i[l]}.bind(null,u));return d},r.n=function(i){var l=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(l,"a",l),l},r.o=function(i,l){return Object.prototype.hasOwnProperty.call(i,l)},r.p="",r(r.s=1)}([function(i,l){function r(i,l){if(i<1||i!==Math.round(i))throw"Invalid channel count for BufferQueue";this.channels=i,this.bufferSize=l,this.flush()}r.prototype.flush=function(){this._buffers=[],this._pendingBuffer=this.createBuffer(this.bufferSize),this._pendingPos=0},r.prototype.sampleCount=function(){var i=0;return this._buffers.forEach((function(l){i+=l[0].length})),i},r.prototype.createBuffer=function(i){for(var l=[],d=0;d<this.channels;d++)l[d]=new Float32Array(i);return l},r.prototype.validate=function(i){if(i.length!==this.channels)return!1;for(var l,d=0;d<i.length;d++){var u=i[d];if(!(u instanceof Float32Array))return!1;if(0==d)l=u.length;else if(u.length!==l)return!1}return!0},r.prototype.appendBuffer=function(i){if(!this.validate(i))throw"Invalid audio buffer passed to BufferQueue.appendBuffer";for(var l=i[0].length,d=this.channels,u=this._pendingPos,c=this._pendingBuffer,h=this.bufferSize,p=0;p<l;p++){for(var m=0;m<d;m++)c[m][u]=i[m][p];++u==h&&(this._buffers.push(c),u=this._pendingPos=0,c=this._pendingBuffer=this.createBuffer(h))}this._pendingPos=u},r.prototype.prependBuffer=function(i){if(!this.validate(i))throw"Invalid audio buffer passed to BufferQueue.prependBuffer";var l=this._buffers.slice(0);l.push(this.trimBuffer(this._pendingBuffer,0,this._pendingPos)),this.flush(),this.appendBuffer(i);for(var d=0;d<l.length;d++)this.appendBuffer(l[d])},r.prototype.nextBuffer=function(){if(this._buffers.length)return this._buffers.shift();var i=this.trimBuffer(this._pendingBuffer,0,this._pendingPos);return this._pendingBuffer=this.createBuffer(this.bufferSize),this._pendingPos=0,i},r.prototype.trimBuffer=function(i,l,d){var u=i[0].length,c=l+Math.min(d,u);if(0==l&&c>=u)return i;for(var h=[],p=0;p<this.channels;p++)h[p]=i[p].subarray(l,c);return h},i.exports=r},function(i,l,d){!function(){d(0);var l=d(2),u=d(4);function n(i){this._options=i||{},this._backend=null,this._resampleFractional=0,this._resampleLastSampleData=void 0,this._tempoChanger=null}n.prototype.rate=0,n.prototype.targetRate=0,n.prototype.channels=0,n.prototype.bufferSize=0,Object.defineProperty(n.prototype,"bufferDuration",{get:function(){return this.targetRate?this.bufferSize/this.targetRate:0}}),Object.defineProperty(n.prototype,"bufferThreshold",{get:function(){return this._backend?this._backend.bufferThreshold/this.targetRate:0},set:function(i){if(!this._backend)throw"Invalid state: AudioFeeder cannot set bufferThreshold before init";this._backend.bufferThreshold=Math.round(i*this.targetRate)}}),Object.defineProperty(n.prototype,"playbackPosition",{get:function(){return this._backend?this.getPlaybackState().playbackPosition:0}}),Object.defineProperty(n.prototype,"outputPlaybackPosition",{get:function(){return this._backend?this.getPlaybackState().outputPlaybackPosition:0}}),Object.defineProperty(n.prototype,"durationBuffered",{get:function(){return this._backend?this.getPlaybackState().samplesQueued/this.targetRate:0}}),Object.defineProperty(n.prototype,"muted",{get:function(){if(this._backend)return this._backend.muted;throw"Invalid state: cannot get mute before init"},set:function(i){if(!this._backend)throw"Invalid state: cannot set mute before init";this._backend.muted=i}}),n.prototype.mute=function(){this.muted=!0},n.prototype.unmute=function(){this.muted=!1},Object.defineProperty(n.prototype,"volume",{get:function(){if(this._backend)return this._backend.volume;throw"Invalid state: cannot get volume before init"},set:function(i){if(!this._backend)throw"Invalid state: cannot set volume before init";this._backend.volume=i}}),Object.defineProperty(n.prototype,"tempo",{get:function(){if(this._tempoChanger)return this._tempoChanger.getTempo();throw"Invalid state: cannot get tempo before init"},set:function(i){if(!this._tempoChanger)throw"Invalid state: cannot set tempo before init";this._tempoChanger.setTempo(i)}}),n.prototype.init=function(i,d){if(this.channels=i,this.rate=d,this._options.backendFactory)this._backend=this._options.backendFactory(i,d,this._options);else{if(!l.isSupported())throw"No supported backend";this._backend=new l(i,d,this._options)}this.targetRate=this._backend.rate,this.bufferSize=this._backend.bufferSize,this._tempoChanger=u({sampleRate:this.targetRate,numChannels:i,tempo:1}),this._backend.onstarved=function(){this.onstarved&&this.onstarved()}.bind(this),this._backend.onbufferlow=function(){this.onbufferlow&&this.onbufferlow()}.bind(this)},n.prototype._resample=function(i){var l=this.rate,d=this.channels,u=this._backend.rate,c=this._backend.channels;if(l==u&&d==c)return i;var h,p=[],m=this._resampleFractional,g=i[0].length*u/l+m,y=Math.floor(g),_=g-y;h=l<u?function(i,d,c,h){for(var a=function(l){return l<0?c&&c.length+l>0?c[c.length+l]:i[0]:i[l]},p=0;p<d.length;p++){var g,y=(p+1-m)*l/u-1,_=Math.floor(y),v=Math.ceil(y);g=_==v?a(_):a(_)*(v-y)+a(v)*(y-_),d[p]=h*g}}:function(i,l,d,u){for(var c=0;c<l.length;c++)l[c]=u*i[c*i.length/l.length|0]};var v=1;c>d&&(v=Math.SQRT1_2);for(var b=0;b<c;b++){var T=b;b>=d&&(T=0);var S=i[T],E=new Float32Array(y);h(S,E,this._resampleLastSampleData?this._resampleLastSampleData[T]:void 0,v),p.push(E)}return this._resampleFractional=_,this._resampleLastSampleData=i,p},n.prototype.bufferData=function(i){if(!this._backend)throw"Invalid state: AudioFeeder cannot bufferData before init";var l=this._resample(i);l=this._tempoChanger.process(l),this._backend.appendBuffer(l)},n.prototype.getPlaybackState=function(){if(this._backend){var i=this._backend.getPlaybackState();return i.outputPlaybackPosition=i.playbackPosition,i.playbackPosition=this._tempoChanger.mapOutputToInputTime(i.outputPlaybackPosition),i}throw"Invalid state: AudioFeeder cannot getPlaybackState before init"},n.prototype.waitUntilReady=function(i){if(!this._backend)throw"Invalid state: AudioFeeder cannot waitUntilReady before init";this._backend.waitUntilReady(i)},n.prototype.start=function(){if(!this._backend)throw"Invalid state: AudioFeeder cannot start before init";this._backend.start()},n.prototype.stop=function(){if(!this._backend)throw"Invalid state: AudioFeeder cannot stop before init";this._backend.stop()},n.prototype.flush=function(){if(this._resampleFractional=0,this._resampleLastSampleData=void 0,!this._backend)throw"Invalid state: AudioFeeder cannot flush before init";this._tempoChanger.flush(this.durationBuffered),this._backend.flush()},n.prototype.close=function(){this._backend&&(this._backend.close(),this._backend=null)},n.prototype.onstarved=null,n.prototype.onbufferlow=null,n.isSupported=function(){return!!Float32Array&&l.isSupported()},n.initSharedAudioContext=function(){return l.isSupported()?l.initSharedAudioContext():null},i.exports=n}()},function(i,l,d){!function(){var l=window.AudioContext||window.webkitAudioContext,u=d(0),c=d(3);function o(i,l,d){var c=d.audioContext||o.initSharedAudioContext();if(this._context=c,this.output=d.output||c.destination,this.rate=c.sampleRate,this.channels=2,d.bufferSize&&(this.bufferSize=0|d.bufferSize),this.bufferThreshold=2*this.bufferSize,this._bufferQueue=new u(this.channels,this.bufferSize),this._playbackTimeAtBufferTail=c.currentTime,this._queuedTime=0,this._delayedTime=0,this._dropped=0,this._liveBuffer=this._bufferQueue.createBuffer(this.bufferSize),c.createScriptProcessor)this._node=c.createScriptProcessor(this.bufferSize,0,this.channels);else{if(!c.createJavaScriptNode)throw new Error("Bad version of web audio API?");this._node=c.createJavaScriptNode(this.bufferSize,0,this.channels)}}o.prototype.bufferSize=4096,o.prototype.bufferThreshold=8192,o.prototype._volume=1,Object.defineProperty(o.prototype,"volume",{get:function(){return this._volume},set:function(i){this._volume=+i}}),o.prototype._muted=!1,Object.defineProperty(o.prototype,"muted",{get:function(){return this._muted},set:function(i){this._muted=!!i}}),o.prototype._audioProcess=function(i){var l,d,u,h,p,m=this._playbackTimeAtBufferTail;if(m<(p="number"==typeof i.playbackTime?i.playbackTime:this._context.currentTime+this.bufferSize/this.rate)&&(this._delayedTime+=p-m),this._bufferQueue.sampleCount()<this.bufferSize&&this.onstarved&&this.onstarved(),this._bufferQueue.sampleCount()<this.bufferSize){for(l=0;l<this.channels;l++)for(u=i.outputBuffer.getChannelData(l),h=0;h<this.bufferSize;h++)u[h]=0;this._dropped++}else{var g=this.muted?0:this.volume,y=this._bufferQueue.nextBuffer();if(y[0].length<this.bufferSize)throw"Audio buffer not expected length.";for(l=0;l<this.channels;l++)for(d=y[l],this._liveBuffer[l].set(y[l]),u=i.outputBuffer.getChannelData(l),h=0;h<d.length;h++)u[h]=d[h]*g;this._queuedTime+=this.bufferSize/this.rate,this._playbackTimeAtBufferTail=p+this.bufferSize/this.rate,this._bufferQueue.sampleCount()<Math.max(this.bufferSize,this.bufferThreshold)&&this.onbufferlow&&c(this.onbufferlow.bind(this))}},o.prototype._samplesQueued=function(){return this._bufferQueue.sampleCount()+Math.floor(this._timeAwaitingPlayback()*this.rate)},o.prototype._timeAwaitingPlayback=function(){return Math.max(0,this._playbackTimeAtBufferTail-this._context.currentTime)},o.prototype.getPlaybackState=function(){return{playbackPosition:this._queuedTime-this._timeAwaitingPlayback(),samplesQueued:this._samplesQueued(),dropped:this._dropped,delayed:this._delayedTime}},o.prototype.waitUntilReady=function(i){i()},o.prototype.appendBuffer=function(i){this._bufferQueue.appendBuffer(i)},o.prototype.start=function(){this._node.onaudioprocess=this._audioProcess.bind(this),this._node.connect(this.output),this._playbackTimeAtBufferTail=this._context.currentTime},o.prototype.stop=function(){if(this._node){var i=this._timeAwaitingPlayback();if(i>0){var l=Math.round(i*this.rate),d=this._liveBuffer?this._liveBuffer[0].length:0;l>d?(this._bufferQueue.prependBuffer(this._liveBuffer),this._bufferQueue.prependBuffer(this._bufferQueue.createBuffer(l-d))):this._bufferQueue.prependBuffer(this._bufferQueue.trimBuffer(this._liveBuffer,d-l,l)),this._playbackTimeAtBufferTail-=i}this._node.onaudioprocess=null,this._node.disconnect()}},o.prototype.flush=function(){this._bufferQueue.flush()},o.prototype.close=function(){this.stop(),this._context=null},o.prototype.onstarved=null,o.prototype.onbufferlow=null,o.isSupported=function(){return!!l},o.sharedAudioContext=null,o.initSharedAudioContext=function(){if(!o.sharedAudioContext&&o.isSupported()){var i,d=new l;if(d.createScriptProcessor)i=d.createScriptProcessor(1024,0,2);else{if(!d.createJavaScriptNode)throw new Error("Bad version of web audio API?");i=d.createJavaScriptNode(1024,0,2)}i.connect(d.destination),i.disconnect(),o.sharedAudioContext=d}return o.sharedAudioContext},i.exports=o}()},function(i,l){i.exports=function(){if(void 0!==window.setImmediate)return window.setImmediate;if(window&&window.postMessage){var i=[];return window.addEventListener("message",(function(l){if(l.source===window){var d=l.data;if("object"==typeof d&&d.nextTickBrowserPingMessage){var u=i.pop();u&&u()}}})),function(l){i.push(l),window.postMessage({nextTickBrowserPingMessage:!0},document.location.toString())}}return function(i){setTimeout(i,0)}}()},function(i,l,d){var u;window,u=function(){return function(i){var l={};function r(d){if(l[d])return l[d].exports;var u=l[d]={i:d,l:!1,exports:{}};return i[d].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=i,r.c=l,r.d=function(i,l,d){r.o(i,l)||Object.defineProperty(i,l,{enumerable:!0,get:d})},r.r=function(i){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r.t=function(i,l){if(1&l&&(i=r(i)),8&l)return i;if(4&l&&"object"==typeof i&&i&&i.__esModule)return i;var d=Object.create(null);if(r.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:i}),2&l&&"string"!=typeof i)for(var u in i)r.d(d,u,function(l){return i[l]}.bind(null,u));return d},r.n=function(i){var l=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(l,"a",l),l},r.o=function(i,l){return Object.prototype.hasOwnProperty.call(i,l)},r.p="",r(r.s=1)}([function(i,l){var d={float_array:function(i){return new Float32Array(i)},blit:function(i,l,d,u,c){d.set(i.subarray(l,l+c),u)}};i.exports=d},function(i,l,d){var u,c;u=d(0),c=d(2),i.exports=function(i){for(var l=(i=i||{}).sampleRate||44100,d=i.wsizeLog||11,h=i.tempo||1,p=(i.numChannels,Math.pow(2,50/1200)-1),m=1<<d,g=c(d),y=1<<d-2,_=u.float_array(m+(y-=y%100)+5),v=u.float_array(m+y+5),b=y,T=y,S=u.float_array(m),E=0;E<m;E++)S[E]=.5*(1-Math.cos(2*Math.PI*E/m));var k=1+(m>>1),w=u.float_array(k),C=u.float_array(k),x=u.float_array(k),A=u.float_array(k),P=u.float_array(k),I=u.float_array(k),D=1+(k>>1),O=[0,0],L=[],R=[],V=[],M=[];for(E=0;E<2;E++)L.push(u.float_array(D)),R.push(u.float_array(D)),V.push(u.float_array(D)),M.push(u.float_array(k));var N=u.float_array(D),B=u.float_array(D),j=0,H=0,$=[{in_time:0,out_time:0,tempo:h}],z=0,W=0,X=1,K=0,Y=0,Q=0,Z=0,ee={mapOutputToInputTime:function(i){for(var l=$.length-1;i<$[l].out_time&&l>0;)l--;var d=$[l];return d.in_time+d.tempo*(i-d.out_time)},flush:function(i){K=0,O=[0,0],W=0,Z=0,Q=0;for(var l=0;l<2;l++)for(var d=0;d<k;d++)M[l][d]=0;for(l=0;l<_.length;l++)_[l]=0;for(l=0;l<v.length;l++)v[l]=0;if(i){H=Math.max(0,H-i),j=ee.mapOutputToInputTime(H);for(var u=$.length-1;H<=$[u].out_time&&u>=0;)$.pop(),u--;$.push({in_time:j,out_time:H,tempo:h})}},getTempo:function(){return h},setTempo:function(i){b=T=y,i>=1?T=Math.round(b/i):b=Math.round(T*i),Y=(1/i-1*T/b)*b,X=function(i,l){for(var d=i.length/l|0,u=0,c=0;c<d;c++)u+=i[c*l];return.9/u}(S,T),h=i;var l=$[$.length-1];l.out_time==H?l.tempo=i:$.push({in_time:j,out_time:H,tempo:i})}};ee.flush(0),ee.setTempo(h);var J=function(i,l,d){var u=Math.floor(d),c=u%2==1?-1:1;return Math.atan2(c*(l[u]-l[u+1]),c*(i[u]-i[u+1]))},U=function(i,l,d,u,c){var h=2*Math.PI/m*.5*(u+l)*b;return(function(i){return i-2*Math.PI*Math.round(i/(2*Math.PI))}(i-d-h)+h)*c},q=function(i,l,d,u,c,h){for(var g=i%2,y=1-g,_=M[y],v=O[y],b=L[y],T=R[y],S=V[y],E=M[g],k=1;k<E.length;k++)E[k]=l[k]*l[k]+d[k]*d[k];var w=L[g],C=O[g]=function(i,l){for(var d=0,u=0;u<i.length;u++)i[u]>d&&(d=i[u]);var c=1e-8*d,h=1,m=1;for(l[0]=1,u=2;u<i.length;u++){if(i[u]>c&&i[u]>i[u-1]&&i[u]>=i[u+1]){var g=u+(i[u-1]-i[u+1])/(2*(i[u-1]-2*i[u]+i[u+1]));g-l[h-1]>u*p?(l[h++]=g,m=u):i[u]>i[m]&&(l[h-1]=g,m=u)}}return h}(E,w),x=R[g],A=V[g];if(0!=i&&0!=C){var P=0;for(Y=0;Y<C;Y++){for(Q=w[Y];w[Y]>b[P]&&P!=v;)++P;var I=P;P>0&&Q-b[P-1]<b[P]-Q&&(I=P-1);var D=Q*p;if(Math.abs(b[I]-Q)<D&&_[Math.round(b[I])]>.1*E[Math.round(Q)]){var j=J(l,d,Q),H=T[I]+S[I]+U(j,Q,T[I],b[I],h)-j;x[Y]=j,A[Y]=H,N[Y]=Math.cos(H),B[Y]=Math.sin(H)}else x[Y]=J(l,d,Q),A[Y]=0,N[Y]=1,B[Y]=0}w[C]=2*m;var $=w[I=0],z=w[I+1],W=N[I],X=B[I];for(k=1;k<l.length-1;k++){k>=$&&k-$>z-k&&($=w[++I],z=w[I+1],W=N[I],X=B[I]);var K=l[k]*X+d[k]*W;l[k]=l[k]*W-d[k]*X,d[k]=K}}else for(var Y=0;Y<C;Y++){var Q=w[Y];T[Y]=S[Y]=J(l,d,Q)}},G=function(){var i=0|(K+=2*Y);K-=i;for(var l=0;l<m;l++)g.m_re[l]=S[l]*_[l],g.m_im[l]=S[l]*_[b+l];u.blit(_,2*b,_,0,m-b),g.inplace(!1),g.unpack(w,C,x,A),q(z,w,C,0,0,1*T/b),q(z+1,x,A,0,0,1*(T+i)/b),u.blit(x,0,P,0,k),u.blit(A,0,I,0,k),g.repack(w,C,x,A),g.inplace(!0);var d=v.length;for(u.blit(v,W,v,0,d-W),l=d-W;l<d;l++)v[l]=0;var c=0,h=X;for(l=0;l<T;l++)Math.abs(2*g.m_re[l])>c&&(c=Math.abs(2*g.m_re[l]));for(l=0;l<m-T;l++)Math.abs(g.m_re[l+T+i]+g.m_im[l])>c&&(c=Math.abs(g.m_re[l+T+i]+g.m_im[l]));for(l=m-T;l<m;l++)Math.abs(2*g.m_im[l])>c&&(c=Math.abs(2*g.m_im[l]));var p=1/Math.floor(1*m/(2*T));for(h*c>p&&(h=p/c),l=0;l<m;l++)v[l]+=h*g.m_re[l],v[l+T+i]+=h*g.m_im[l];return z+=2,W=2*T+i};return ee.process=function(i){var d=i[0].length,c=i[0];if(i.length>1){c=u.float_array(i[0].length);for(var p=1/i.length,g=0;g<i.length;g++)for(var y=0;y<d;y++)c[y]+=p*i[g][y]}if(1==h){if(Z+Q>0){var S=Z+Q+d,E=[];for(g=0;g<i.length;g++){var k=u.float_array(S);u.blit(v,0,k,0,Z),u.blit(_,0,k,Z,Q),u.blit(i[g],0,k,Z+Q,d),E.push(k)}ee.flush(0),d=S,i=E}return j+=d/l,H+=d/l,i}var w=2*Math.floor(Math.max(0,Q+d-(m-b))/(2*b)),C=Z+T*w+Math.floor(K+Y*w);Z>C&&(C=Z);var x=u.float_array(C);u.blit(v,0,x,0,Z);for(var A=0,P=Z,I=0,D=0;;){var O=m+b-Q;if(A+O>d){u.blit(c,A,_,Q,d-A),Q+=d-A,A=d;break}O<=0?Q-=2*b:(u.blit(c,A,_,Q,O),A+=O,Q=m-b),D=G(),j+=2*b/l,H+=D/l,(I=P+D-C)<0&&(I=0),u.blit(v,0,x,P,D-I),P+=D}u.blit(v,D-I,v,0,I),Z=I;var L=[];for(g=0;g<i.length;g++)L.push(x);return L},ee}},function(i,l,d){"use strict";var u=d(0);i.exports=function(i){for(var l=1<<i,d={m_logN:i,m_N:l,m_invN:1/l,m_re:u.float_array(l),m_im:u.float_array(l),m_revTgt:new Array(l)},c=0;c<l;c++){for(var h=c,p=0,m=0;m<i;m++)p<<=1,p|=1&h,h>>=1;d.m_revTgt[c]=p}d.twiddleRe=u.float_array(d.m_logN),d.twiddleIm=u.float_array(d.m_logN);for(var g=1,y=0;y<d.m_logN;y++){var _=2*g*Math.PI*d.m_invN;d.twiddleRe[y]=Math.cos(_),d.twiddleIm[y]=Math.sin(_),g<<=1}d.inplace=function(i){var l=d.m_re,u=d.m_im,c=d.m_N,h=d.m_logN,p=c>>1,m=c>>1,g=c;if(i)for(var y=1/c,_=0;_<c;_++)l[_]*=y,u[_]*=y;for(var v=0;v<h;v++){var b=d.twiddleRe[v],T=d.twiddleIm[v];i||(T*=-1);for(var S=0;S<c;){for(var E=S,k=S+m,w=1,C=0,x=0;x<p;x++){var A=l[E],P=u[E],I=l[k],D=u[k];l[E]=A+I,u[E]=P+D,l[k]=(I=A-I)*w-(D=P-D)*C,u[k]=I*C+D*w,E++,k++;var O=w;w=w*b-C*T,C=O*T+C*b}S+=g}p>>=1,m>>=1,g>>=1}for(var L,R,V=d.m_revTgt,M=0;M<c;M++)V[M]>M&&(R=l[L=V[M]],l[L]=l[M],l[M]=R,R=u[L],u[L]=u[M],u[M]=R)};var v=l>>1;return d.unpack=function(i,u,c,h){i[0]=d.m_re[0],c[0]=d.m_im[0],u[0]=h[0]=0,i[v]=d.m_re[v],c[v]=d.m_im[v],u[v]=h[v]=0;for(var p=1;p<v;p++)i[p]=(d.m_re[p]+d.m_re[l-p])/2,u[p]=(d.m_im[p]-d.m_im[l-p])/2,c[p]=(d.m_im[p]+d.m_im[l-p])/2,h[p]=(-d.m_re[p]+d.m_re[l-p])/2},d.repack=function(i,u,c,h){d.m_re[0]=i[0],d.m_im[0]=c[0],d.m_re[v]=i[v],d.m_im[v]=c[v];for(var p=1;p<v;p++)d.m_re[p]=i[p]-h[p],d.m_im[p]=u[p]+c[p],d.m_re[l-p]=i[p]+h[p],d.m_im[l-p]=-u[p]+c[p]},d}}])},i.exports=u()}])},893:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=function(){function Bisector(i){(0,c.default)(this,Bisector),this.lower=i.start,this.upper=i.end,this.onprocess=i.process,this.position=0,this.n=0}return(0,h.default)(Bisector,[{key:"iterate",value:function iterate(){return this.n++,this.position=Math.floor((this.lower+this.upper)/2),this.onprocess(this.lower,this.upper,this.position)}},{key:"start",value:function start(){return this.iterate(),this}},{key:"left",value:function left(){return this.upper=this.position,this.iterate()}},{key:"right",value:function right(){return this.lower=this.position,this.iterate()}}]),Bisector}();l.default=p},523:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=new(function(){function _class(){(0,c.default)(this,_class)}return(0,h.default)(_class,[{key:"hasTypedArrays",value:function hasTypedArrays(){return!!window.Uint32Array}},{key:"hasWebAssembly",value:function hasWebAssembly(){return!!window.WebAssembly}},{key:"hasWebAudio",value:function hasWebAudio(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"hasFlash",value:function hasFlash(){return!1}},{key:"hasAudio",value:function hasAudio(){return this.hasWebAudio()}},{key:"isBlacklisted",value:function isBlacklisted(i){return!1}},{key:"isSlow",value:function isSlow(){return!1}},{key:"isTooSlow",value:function isTooSlow(){return!1}},{key:"supported",value:function supported(i){return"OGVDecoder"===i?this.hasWebAssembly():"OGVPlayer"===i&&this.supported("OGVDecoder")&&this.hasAudio()}}]),_class}());l.default=p},408:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=u(d(205)),m=u(d(585)),g=u(d(754));var y=function(i){(0,p.default)(OGVDecoderAudioProxy,i);var l=function _createSuper(i){var l=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(i){return!1}}();return function _createSuperInternal(){var d,u=(0,g.default)(i);if(l){var c=(0,g.default)(this).constructor;d=Reflect.construct(u,arguments,c)}else d=u.apply(this,arguments);return(0,m.default)(this,d)}}(OGVDecoderAudioProxy);function OGVDecoderAudioProxy(){return(0,c.default)(this,OGVDecoderAudioProxy),l.apply(this,arguments)}return(0,h.default)(OGVDecoderAudioProxy,[{key:"init",value:function init(i){this.proxy("init",[],i)}},{key:"processHeader",value:function processHeader(i,l){this.proxy("processHeader",[i],l,[i])}},{key:"processAudio",value:function processAudio(i,l){this.proxy("processAudio",[i],l,[i])}},{key:"close",value:function close(){this.terminate()}}]),OGVDecoderAudioProxy}((0,u(d(580)).default)({loadedMetadata:!1,audioFormat:null,audioBuffer:null,cpuTime:0}));l.default=y},319:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=u(d(205)),m=u(d(585)),g=u(d(754));var y=function(i){(0,p.default)(OGVDecoderVideoProxy,i);var l=function _createSuper(i){var l=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(i){return!1}}();return function _createSuperInternal(){var d,u=(0,g.default)(i);if(l){var c=(0,g.default)(this).constructor;d=Reflect.construct(u,arguments,c)}else d=u.apply(this,arguments);return(0,m.default)(this,d)}}(OGVDecoderVideoProxy);function OGVDecoderVideoProxy(){return(0,c.default)(this,OGVDecoderVideoProxy),l.apply(this,arguments)}return(0,h.default)(OGVDecoderVideoProxy,[{key:"init",value:function init(i){this.proxy("init",[],i)}},{key:"processHeader",value:function processHeader(i,l){this.proxy("processHeader",[i],l,[i])}},{key:"processFrame",value:function processFrame(i,l){this.proxy("processFrame",[i],l,[i])}},{key:"close",value:function close(){this.terminate()}},{key:"sync",value:function sync(){this.proxy("sync",[],(function(){}))}},{key:"recycleFrame",value:function recycleFrame(i){this.proxy("recycleFrame",[i],(function(){}),[i.y.bytes.buffer,i.u.bytes.buffer,i.v.bytes.buffer])}}]),OGVDecoderVideoProxy}((0,u(d(580)).default)({loadedMetadata:!1,videoFormat:null,frameBuffer:null,cpuTime:0}));l.default=y},445:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=u(d(539)),m="1.9.0-20240423190513-22f6924",g={OGVDemuxerOggW:"ogv-demuxer-ogg-wasm.js",OGVDemuxerWebMW:"ogv-demuxer-webm-wasm.js",OGVDecoderAudioOpusW:"ogv-decoder-audio-opus-wasm.js",OGVDecoderAudioVorbisW:"ogv-decoder-audio-vorbis-wasm.js",OGVDecoderVideoTheoraW:"ogv-decoder-video-theora-wasm.js",OGVDecoderVideoVP8W:"ogv-decoder-video-vp8-wasm.js",OGVDecoderVideoVP8MTW:"ogv-decoder-video-vp8-mt-wasm.js",OGVDecoderVideoVP9W:"ogv-decoder-video-vp9-wasm.js",OGVDecoderVideoVP9SIMDW:"ogv-decoder-video-vp9-simd-wasm.js",OGVDecoderVideoVP9MTW:"ogv-decoder-video-vp9-mt-wasm.js",OGVDecoderVideoVP9SIMDMTW:"ogv-decoder-video-vp9-simd-mt-wasm.js",OGVDecoderVideoAV1W:"ogv-decoder-video-av1-wasm.js",OGVDecoderVideoAV1SIMDW:"ogv-decoder-video-av1-simd-wasm.js",OGVDecoderVideoAV1MTW:"ogv-decoder-video-av1-mt-wasm.js",OGVDecoderVideoAV1SIMDMTW:"ogv-decoder-video-av1-simd-mt-wasm.js"},y=function(){function OGVLoaderBase(){(0,c.default)(this,OGVLoaderBase),this.base=this.defaultBase()}return(0,h.default)(OGVLoaderBase,[{key:"defaultBase",value:function defaultBase(){}},{key:"wasmSupported",value:function wasmSupported(){return p.default.wasmSupported()}},{key:"scriptForClass",value:function scriptForClass(i){return g[i]}},{key:"urlForClass",value:function urlForClass(i){var l=this.scriptForClass(i);if(l)return this.urlForScript(l);throw new Error("asked for URL for unknown class "+i)}},{key:"urlForScript",value:function urlForScript(i){if(i){var l=this.base;return void 0===l?l="":l+="/",l+i+"?version="+encodeURIComponent(m)}throw new Error("asked for URL for unknown script "+i)}},{key:"loadClass",value:function loadClass(i,l,d){var u=this;d=d||{};var c=this.getGlobal(),h=this.urlForClass(i),p=function classWrapper(l){return(l=l||{}).locateFile=function(i){return"data:"===i.slice(0,5)?i:u.urlForScript(i)},l.mainScriptUrlOrBlob=u.scriptForClass(i)+"?version="+encodeURIComponent(m),c[i](l)};"function"==typeof c[i]?l(p):this.loadScript(h,(function(){l(p)}))}}]),OGVLoaderBase}();l.default=y},964:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=u(d(525)),m=u(d(205)),g=u(d(585)),y=u(d(754)),_=u(d(408)),v=u(d(319)),b=u(d(445));var T={audio:{proxy:_.default,worker:"ogv-worker-audio.js"},video:{proxy:v.default,worker:"ogv-worker-video.js"}},S={OGVDecoderAudioOpusW:"audio",OGVDecoderAudioVorbisW:"audio",OGVDecoderVideoTheoraW:"video",OGVDecoderVideoVP8W:"video",OGVDecoderVideoVP9W:"video",OGVDecoderVideoVP9SIMDW:"video",OGVDecoderVideoAV1W:"video",OGVDecoderVideoAV1SIMDW:"video"},E=new(function(i){(0,m.default)(OGVLoaderWeb,i);var l=function _createSuper(i){var l=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(i){return!1}}();return function _createSuperInternal(){var d,u=(0,y.default)(i);if(l){var c=(0,y.default)(this).constructor;d=Reflect.construct(u,arguments,c)}else d=u.apply(this,arguments);return(0,g.default)(this,d)}}(OGVLoaderWeb);function OGVLoaderWeb(){var i;return(0,c.default)(this,OGVLoaderWeb),(i=l.call(this)).scriptStatus={},i.scriptCallbacks={},i}return(0,h.default)(OGVLoaderWeb,[{key:"getGlobal",value:function getGlobal(){return window}},{key:"defaultBase",value:function defaultBase(){for(var i,l,d=document.querySelectorAll("script"),u=/^(?:|(.*)\/)ogv(?:-support|-es2017)?\.js(?:\?|#|$)/,c=0;c<d.length;c++)if((i=d[c].getAttribute("src"))&&(l=i.match(u)))return l[1]}},{key:"loadClass",value:function loadClass(i,l,d){(d=d||{}).worker?this.workerProxy(i,l):(0,p.default)((0,y.default)(OGVLoaderWeb.prototype),"loadClass",this).call(this,i,l,d)}},{key:"loadScript",value:function loadScript(i,l){var d=this;if("done"==this.scriptStatus[i])l();else if("loading"==this.scriptStatus[i])this.scriptCallbacks[i].push(l);else{this.scriptStatus[i]="loading",this.scriptCallbacks[i]=[l];var u=document.createElement("script"),c=function done(l){var u=d.scriptCallbacks[i];delete d.scriptCallbacks[i],d.scriptStatus[i]="done",u.forEach((function(i){i()}))};u.addEventListener("load",c),u.addEventListener("error",c),u.src=i,document.querySelector("head").appendChild(u)}}},{key:"workerProxy",value:function workerProxy(i,l){var d=T[S[i]];if(!d)throw new Error("Requested worker for class with no proxy: "+i);var u,c=d.proxy,h=d.worker,p=this.urlForScript(this.scriptForClass(i)),m=this.urlForScript(h),g=function construct(l){return new c(u,i,l)};if(m.match(/^https?:|\/\//i)){var y,_,v,b,k,w=function completionCheck(){if(1==C&&1==x){var i=v+" "+b+"\nOGVLoader.base = "+JSON.stringify(E.base);try{k=new Blob([i],{type:"application/javascript"})}catch(l){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,(k=new BlobBuilder).append(i),k=k.getBlob()}u=new Worker(URL.createObjectURL(k)),l((function(i){return Promise.resolve(new g(i))}))}},C=!1,x=!1;(y=new XMLHttpRequest).open("GET",p,!0),y.onreadystatechange=function(){4==y.readyState&&200==y.status&&(v=y.responseText,C=!0,w())},y.send(),(_=new XMLHttpRequest).open("GET",m,!0),_.onreadystatechange=function(){4==_.readyState&&200==_.status&&(b=_.responseText,x=!0,w())},_.send()}else u=new Worker(m),l((function(i){return Promise.resolve(new g(i))}))}}]),OGVLoaderWeb}(b.default));l.default=E},759:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(913)),h=u(d(575)),p=u(d(309)),m={MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4},g=(0,c.default)((function OGVMediaError(i,l){(0,h.default)(this,OGVMediaError),this.code=i,this.message=l}));(0,p.default)(g,m),(0,p.default)(g.prototype,m),l.default=g},278:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(913)),h=u(d(575));function split(i,l,d){var u=i.split(l,d).map((function(i){return function trim(i){return i.replace(/^\s+/,"").replace(/\s+$/,"")}(i)}));if("number"==typeof d)for(;u.length<d;)u.push(null);return u}var p=(0,c.default)((function OGVMediaType(i){(0,h.default)(this,OGVMediaType),i=String(i),this.major=null,this.minor=null,this.codecs=null;var l=split(i,";");if(l.length){var d=l.shift();if(d){var u=split(d,"/",2);this.major=u[0],this.minor=u[1]}for(var c in l){var p=l[c].match(/^codecs\s*=\s*"(.*?)"$/);if(p){this.codecs=split(p[1],",");break}}}}));l.default=p},869:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=u(d(506)),m=u(d(205)),g=u(d(585)),y=u(d(754)),_=u(d(8)),v=u(d(731)),b=u(d(936)),T=u(d(848)),S=u(d(964)),E=u(d(893)),k=u(d(309)),w=u(d(759)),C=u(d(278)),x=u(d(168)),A=u(d(625)),P=u(d(302));var I,D=function(){if("function"==typeof setImmediate)return setImmediate;var i=new MessageChannel,l=[];return i.port1.onmessage=function(i){l.shift()()},function nextTick(d){l.push(d),i.port2.postMessage({})}}(),O={NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3,HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},L="INITIAL",R="SEEKING_END",V="LOADED",M="PRELOAD",N="READY",B="PLAYING",j="SEEKING",H="ERROR",$="NOT_SEEKING",z="BISECT_TO_TARGET",W="BISECT_TO_KEYPOINT",X="LINEAR_TO_TARGET",K="fast";function OGVJSElement(){var i=document.createElement("ogvjs");return Object.setPrototypeOf?Object.setPrototypeOf(i,Object.getPrototypeOf(this)):i.__proto__=this.__proto__,i}I="undefined"==typeof performance||void 0===(0,_.default)(performance.now)?Date.now:performance.now.bind(performance),OGVJSElement.prototype=Object.create(HTMLElement.prototype,{});var Y=function(i){(0,m.default)(OGVPlayer,i);var l=function _createSuper(i){var l=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(i){return!1}}();return function _createSuperInternal(){var d,u=(0,y.default)(i);if(l){var c=(0,y.default)(this).constructor;d=Reflect.construct(u,arguments,c)}else d=u.apply(this,arguments);return(0,g.default)(this,d)}}(OGVPlayer);function OGVPlayer(i){var d;if((0,c.default)(this,OGVPlayer),d=l.call(this),(i=i||{}).base=i.base||S.default.base,d._options=i,d._instanceId="ogvjs"+ ++OGVPlayer.instanceCount,d._enableWorker=void 0!==i.worker?!!i.worker:!!window.Worker,!S.default.wasmSupported())throw new Error("WebAssembly not supported");return d._enableThreading=!!i.threading,d._enableSIMD=!!i.simd,d._state=L,d._seekState=$,d._detectedType=null,d._canvas=document.createElement("canvas"),d._frameSink=null,d.className=d._instanceId,(0,k.default)((0,p.default)(d),O),d._view=d._canvas,d._view.style.position="absolute",d._view.style.top="0",d._view.style.left="0",d._view.style.width="100%",d._view.style.height="100%",d._view.style.objectFit="contain",d.appendChild(d._view),d._startTime=I(),d._codec=null,d._audioInfo=null,d._videoInfo=null,d._actionQueue=[],d._audioFeeder=null,d._muted=!1,d._initialPlaybackPosition=0,d._initialPlaybackOffset=0,d._prebufferingAudio=!1,d._initialSeekTime=0,d._currentSrc="",d._crossOrigin=null,d._streamEnded=!1,d._mediaError=null,d._dataEnded=!1,d._byteLength=0,d._duration=null,d._lastSeenTimestamp=null,d._nextProcessingTimer,d._nextFrameTimer=null,d._loading=!1,d._started=!1,d._paused=!0,d._ended=!1,d._startedPlaybackInDocument=!1,d._stream=void 0,d._framesProcessed=0,d._targetPerFrameTime=1e3/60,d._actualPerFrameTime=0,d._totalFrameTime=0,d._totalFrameCount=0,d._playTime=0,d._bufferTime=0,d._drawingTime=0,d._proxyTime=0,d._totalJitter=0,d._droppedAudio=0,d._delayedAudio=0,d._lateFrames=0,d._poster="",d._thumbnail=null,d._frameEndTimestamp=0,d._audioEndTimestamp=0,d._decodedFrames=[],d._pendingFrames=[],d._lastFrameDecodeTime=0,d._lastFrameVideoCpuTime=0,d._lastFrameAudioCpuTime=0,d._lastFrameDemuxerCpuTime=0,d._lastFrameDrawingTime=0,d._lastFrameBufferTime=0,d._lastFrameProxyTime=0,d._lastVideoCpuTime=0,d._lastAudioCpuTime=0,d._lastDemuxerCpuTime=0,d._lastBufferTime=0,d._lastProxyTime=0,d._lastDrawingTime=0,d._lastFrameTimestamp=0,d._currentVideoCpuTime=0,d._lastTimeUpdate=0,d._timeUpdateInterval=250,d._seekTargetTime=0,d._bisectTargetTime=0,d._seekMode=null,d._lastSeekPosition=null,d._seekBisector=null,d._didSeek=null,d._depth=0,d._needProcessing=!1,d._pendingFrame=0,d._pendingAudio=0,d._framePipelineDepth=8,d._frameParallelism=d._enableThreading?Math.min(16,navigator.hardwareConcurrency)||1:0,d._audioPipelineDepth=12,d._videoInfo=null,d._audioInfo=null,d._width=0,d._height=0,d._volume=1,d._playbackRate=1,Object.defineProperties((0,p.default)(d),{src:{get:function getSrc(){return this.getAttribute("src")||""},set:function setSrc(i){this.setAttribute("src",i),this._loading=!1,this._prepForLoad("interactive")}},buffered:{get:function getBuffered(){var i,l=this;return i=this._stream&&this._byteLength&&this._duration?this._stream.getBufferedRanges().map((function(i){return i.map((function(i){return i/l._stream.length*l._duration}))})):[[0,0]],new x.default(i)}},seekable:{get:function getSeekable(){return new x.default(this.duration<1/0&&this._stream&&this._stream.seekable&&this._codec&&this._codec.seekable?[[0,this._duration]]:[])}},currentTime:{get:function getCurrentTime(){return this._state==j?this._seekTargetTime:this._codec?this._state!=B||this._paused?this._initialPlaybackOffset:this._getPlaybackTime():this._initialSeekTime},set:function setCurrentTime(i){this._seek(i,"exact")}},duration:{get:function getDuration(){return this._codec&&this._codec.loadedMetadata?null!==this._duration?this._duration:1/0:NaN}},paused:{get:function getPaused(){return this._paused}},ended:{get:function getEnded(){return this._ended}},seeking:{get:function getSeeking(){return this._state==j}},muted:{get:function getMuted(){return this._muted},set:function setMuted(i){this._muted=i,this._audioFeeder?this._audioFeeder.muted=this._muted:this._started&&!this._muted&&this._codec&&this._codec.hasAudio&&(this._log("unmuting: switching from timer to audio clock"),this._initAudioFeeder(),this._startPlayback(this._audioEndTimestamp)),this._fireEventAsync("volumechange")}},poster:{get:function getPoster(){return this._poster},set:function setPoster(i){var l=this;if(this._poster=i,!this._started){this._thumbnail&&this.removeChild(this._thumbnail);var d=new Image;d.crossOrigin=this.crossOrigin,d.src=this._poster,d.className="ogvjs-poster",d.style.position="absolute",d.style.top="0",d.style.left="0",d.style.width="100%",d.style.height="100%",d.style.objectFit="contain",d.style.visibility="hidden",d.addEventListener("load",(function(){l._thumbnail===d&&(OGVPlayer.styleManager.appendRule("."+l._instanceId,{width:d.naturalWidth+"px",height:d.naturalHeight+"px"}),d.style.visibility="visible")})),this._thumbnail=d,this.appendChild(d)}}},videoWidth:{get:function getVideoWidth(){return this._videoInfo?this._videoInfo.displayWidth:0}},videoHeight:{get:function getVideoHeight(){return this._videoInfo?this._videoInfo.displayHeight:0}},ogvjsVideoFrameRate:{get:function getOgvJsVideoFrameRate(){return this._videoInfo?0==this._videoInfo.fps?this._totalFrameCount/(this._totalFrameTime/1e3):this._videoInfo.fps:0}},ogvjsAudioChannels:{get:function getOgvJsAudioChannels(){return this._audioInfo?this._audioInfo.channels:0}},ogvjsAudioSampleRate:{get:function getOgvJsAudioChannels(){return this._audioInfo?this._audioInfo.rate:0}},width:{get:function getWidth(){return this._width},set:function setWidth(i){this._width=parseInt(i,10),this.style.width=this._width+"px"}},height:{get:function getHeight(){return this._height},set:function setHeight(i){this._height=parseInt(i,10),this.style.height=this._height+"px"}},autoplay:{get:function getAutoplay(){return!1},set:function setAutoplay(i){}},controls:{get:function getControls(){return!1},set:function setControls(i){}},loop:{get:function getLoop(){return!1},set:function setLoop(i){}},crossOrigin:{get:function getCrossOrigin(){return this._crossOrigin},set:function setCrossOrigin(i){switch(i){case null:this._crossOrigin=i,this.removeAttribute("crossorigin");break;default:i="anonymous";case"":case"anonymous":case"use-credentials":this._crossOrigin=i,this.setAttribute("crossorigin",i)}this._thumbnail&&(this._thumbnail.crossOrigin=i)}},currentSrc:{get:function getCurrentSrc(){return this._currentSrc}},defaultMuted:{get:function getDefaultMuted(){return!1}},defaultPlaybackRate:{get:function getDefaultPlaybackRate(){return 1}},error:{get:function getError(){return this._state===H?this._mediaError?this._mediaError:new w.default("unknown error occurred in media procesing"):null}},preload:{get:function getPreload(){return this.getAttribute("preload")||""},set:function setPreload(i){this.setAttribute("preload",i)}},readyState:{get:function getReadyState(){return this._stream&&this._codec&&this._codec.loadedMetadata?OGVPlayer.HAVE_ENOUGH_DATA:OGVPlayer.HAVE_NOTHING}},networkState:{get:function getNetworkState(){return this._stream?this._stream.waiting?OGVPlayer.NETWORK_LOADING:OGVPlayer.NETWORK_IDLE:this.readyState==OGVPlayer.HAVE_NOTHING?OGVPlayer.NETWORK_EMPTY:OGVPlayer.NETWORK_NO_SOURCE}},playbackRate:{get:function getPlaybackRate(){return this._playbackRate},set:function setPlaybackRate(i){var l=Number(i)||1;this._audioFeeder?this._audioFeeder.tempo=l:this._paused||(this._initialPlaybackOffset=this._getPlaybackTime(),this._initialPlaybackPosition=l*I()/1e3),this._playbackRate=l,this._fireEventAsync("ratechange")}},played:{get:function getPlayed(){return new x.default([[0,this.currentTime]])}},volume:{get:function getVolume(){return this._volume},set:function setVolume(i){this._volume=+i,this._audioFeeder&&(this._audioFeeder.volume=this._volume),this._fireEventAsync("volumechange")}}}),d.onframecallback=null,d.onloadstate=null,d.onprogress=null,d.onsuspend=null,d.onabort=null,d.onemptied=null,d.onstalled=null,d.onloadedmetadata=null,d.onloadeddata=null,d.oncanplay=null,d.oncanplaythrough=null,d.onplaying=null,d.onwaiting=null,d.onseeking=null,d.onseeked=null,d.onended=null,d.ondurationchange=null,d.ontimeupdate=null,d.onplay=null,d.onpause=null,d.onratechange=null,d.onresize=null,d.onvolumechange=null,d.onaudiofeedercreated=null,d}return(0,h.default)(OGVPlayer,[{key:"_time",value:function _time(i){var l=I();i();var d=I()-l;return this._lastFrameDecodeTime+=d,d}},{key:"_log",value:function _log(i){var l=this._options;if(l.debug){var d=I()-this._startTime;l.debugFilter&&!i.match(l.debugFilter)||console.log("["+Math.round(10*d)/10+"ms] "+i)}}},{key:"_fireEvent",value:function _fireEvent(i){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._log("fireEvent "+i);var d,u="function"==typeof Event;for(var c in u?d=new CustomEvent(i):(d=document.createEvent("Event")).initEvent(i,!1,!1),l)l.hasOwnProperty(c)&&(d[c]=l[c]);var h=this.dispatchEvent(d);!u&&"resize"===i&&this.onresize&&h&&this.onresize.call(this,d)}},{key:"_fireEventAsync",value:function _fireEventAsync(i){var l=this,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._log("fireEventAsync "+i),D((function(){l._fireEvent(i,d)}))}},{key:"_initAudioFeeder",value:function _initAudioFeeder(){var i=this,l=this._options,d={bufferSize:8192};l.audioContext&&(d.audioContext=l.audioContext),l.audioDestination&&(d.output=l.audioDestination),l.audioBackendFactory&&(d.backendFactory=l.audioBackendFactory);var u=this._audioFeeder=new T.default(d);u.init(this._audioInfo.channels,this._audioInfo.rate),this.onaudiofeedercreated&&this.onaudiofeedercreated(this._audioFeeder),u.bufferThreshold=1,u.volume=this.volume,u.muted=this.muted,u.tempo=this.playbackRate,u.onbufferlow=function(){i._log("onbufferlow"),i._stream&&(i._stream.buffering||i._stream.seeking)||i._pendingAudio||i._pingProcessing()},u.onstarved=function(){i._dataEnded?i._log("onstarved: appear to have reached end of audio"):(i._log("onstarved: halting audio due to starvation"),i._stopPlayback(),i._prebufferingAudio=!0),i._isProcessing()||i._pingProcessing(0)}}},{key:"_startPlayback",value:function _startPlayback(i){if(this._audioFeeder){this._audioFeeder.start();var l=this._audioFeeder.getPlaybackState();this._initialPlaybackPosition=l.playbackPosition}else this._initialPlaybackPosition=this._playbackRate*I()/1e3;void 0!==i&&(this._initialPlaybackOffset=i),this._prebufferingAudio=!1,this._log("continuing at "+this._initialPlaybackPosition+", "+this._initialPlaybackOffset)}},{key:"_stopPlayback",value:function _stopPlayback(){this._initialPlaybackOffset=this._getPlaybackTime(),this._log("pausing at "+this._initialPlaybackOffset),this._audioFeeder&&this._audioFeeder.stop()}},{key:"_getPlaybackTime",value:function _getPlaybackTime(i){return this._prebufferingAudio||this._paused?this._initialPlaybackOffset:(this._audioFeeder?(i=i||this._audioFeeder.getPlaybackState()).playbackPosition:this._playbackRate*I()/1e3)-this._initialPlaybackPosition+this._initialPlaybackOffset}},{key:"_stopVideo",value:function _stopVideo(){this._log("STOPPING"),this._state=L,this._seekState=$,this._started=!1,this._ended=!1,this._frameEndTimestamp=0,this._audioEndTimestamp=0,this._lastFrameDecodeTime=0,this._prebufferingAudio=!1,this._actionQueue.splice(0,this._actionQueue.length),this._stream&&(this._stream.abort(),this._stream=null,this._streamEnded=!1),this._codec&&(this._codec.close(),this._codec=null,this._pendingFrame=0,this._pendingAudio=0,this._dataEnded=!1),this._videoInfo=null,this._audioInfo=null,this._audioFeeder&&(this._audioFeeder.close(),this._audioFeeder=null),this._nextProcessingTimer&&(clearTimeout(this._nextProcessingTimer),this._nextProcessingTimer=null),this._nextFrameTimer&&(clearTimeout(this._nextFrameTimer),this._nextFrameTimer=null),this._frameSink&&(this._frameSink.clear(),this._frameSink=null),this._decodedFrames&&(this._decodedFrames=[]),this._pendingFrames&&(this._pendingFrames=[]),this._initialSeekTime=0,this._initialPlaybackPosition=0,this._initialPlaybackOffset=0,this._duration=null}},{key:"_doFrameComplete",value:function _doFrameComplete(){var i=this,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._startedPlaybackInDocument&&!document.body.contains(this)&&D((function(){i.stop()}));var d=I(),u=d-this._lastFrameTimestamp,c=this._actualPerFrameTime-this._targetPerFrameTime;this._totalJitter+=Math.abs(c),this._playTime+=u;var h={cpuTime:this._lastFrameDecodeTime,drawingTime:this._drawingTime-this._lastFrameDrawingTime,bufferTime:this._bufferTime-this._lastFrameBufferTime,proxyTime:this._proxyTime-this._lastFrameProxyTime,demuxerTime:0,videoTime:0,audioTime:0,clockTime:this._actualPerFrameTime,late:l.dropped,dropped:l.dropped};function n(i){return Math.round(10*i)/10}this._codec&&(h.demuxerTime=this._codec.demuxerCpuTime-this._lastFrameDemuxerCpuTime,h.videoTime+=this._currentVideoCpuTime-this._lastFrameVideoCpuTime,h.audioTime+=this._codec.audioCpuTime-this._lastFrameAudioCpuTime),h.cpuTime+=h.demuxerTime,this._lastFrameDecodeTime=0,this._lastFrameTimestamp=d,this._codec?(this._lastFrameVideoCpuTime=this._currentVideoCpuTime,this._lastFrameAudioCpuTime=this._codec.audioCpuTime,this._lastFrameDemuxerCpuTime=this._codec.demuxerCpuTime):(this._lastFrameVideoCpuTime=0,this._lastFrameAudioCpuTime=0,this._lastFrameDemuxerCpuTime=0),this._lastFrameDrawingTime=this._drawingTime,this._lastFrameBufferTime=this._bufferTime,this._lastFrameProxyTime=this._proxyTime,this._log("drew frame "+l.frameEndTimestamp+": clock time "+n(u)+" (jitter "+n(c)+") cpu: "+n(h.cpuTime)+" (mux: "+n(h.demuxerTime)+" buf: "+n(h.bufferTime)+" draw: "+n(h.drawingTime)+" proxy: "+n(h.proxyTime)+") vid: "+n(h.videoTime)+" aud: "+n(h.audioTime)),this._fireEventAsync("framecallback",h),(!this._lastTimeUpdate||d-this._lastTimeUpdate>=this._timeUpdateInterval)&&(this._lastTimeUpdate=d,this._fireEventAsync("timeupdate")),this._codec&&l.yCbCrBuffer&&this._codec.recycleFrame(l.yCbCrBuffer)}},{key:"_seekStream",value:function _seekStream(i){var l=this;this._stream.seeking&&this._stream.abort(),this._stream.buffering&&this._stream.abort(),this._streamEnded=!1,this._dataEnded=!1,this._ended=!1,this._stream.seek(i).then((function(){l._readBytesAndWait()})).catch((function(i){l._onStreamError(i)}))}},{key:"_onStreamError",value:function _onStreamError(i){"AbortError"===i.name?this._log("i/o promise canceled; ignoring"):(this._log("i/o error: "+i),this._mediaError=new w.default(w.default.MEDIA_ERR_NETWORK,String(i)),this._state=H,this._stopPlayback())}},{key:"_seek",value:function _seek(i,l){var d=this;if(this._log("requested seek to "+i+", mode "+l),this.readyState==this.HAVE_NOTHING)return this._log("not yet loaded; saving seek position for later"),void(this._initialSeekTime=i);if(this._stream&&!this._stream.seekable)throw new Error("Cannot seek a non-seekable stream");if(this._codec&&!this._codec.seekable)throw new Error("Cannot seek in a non-seekable file");var u=function prepForSeek(u){d._stream&&d._stream.buffering&&d._stream.abort(),d._stream&&d._stream.seeking&&d._stream.abort(),d._actionQueue.splice(0,d._actionQueue.length),d._stopPlayback(),d._prebufferingAudio=!1,d._audioFeeder&&d._audioFeeder.flush(),d._state=j,d._seekTargetTime=i,d._seekMode=l,d._codec?d._codec.flush(u):u()};u((function(){d._isProcessing()||d._pingProcessing(0)})),this._actionQueue.push((function(){u((function(){d._doSeek(i)}))}))}},{key:"_doSeek",value:function _doSeek(i){var l=this;this._streamEnded=!1,this._dataEnded=!1,this._ended=!1,this._state=j,this._seekTargetTime=i,this._lastSeekPosition=-1,this._decodedFrames=[],this._pendingFrames=[],this._pendingFrame=0,this._pendingAudio=0,this._didSeek=!1,this._codec.seekToKeypoint(i,(function(d){if(d)return l._seekState=X,l._fireEventAsync("seeking"),l._didSeek?void 0:void l._pingProcessing();l._codec.getKeypointOffset(i,(function(i){i>0?(l._seekState=X,l._seekStream(i)):(l._seekState=z,l._startBisection(l._seekTargetTime)),l._fireEventAsync("seeking")}))}))}},{key:"_startBisection",value:function _startBisection(i){var l=this,d=Math.max(0,this._stream.length-65536);this._bisectTargetTime=i,this._seekBisector=new E.default({start:0,end:d,process:function process(i,d,u){return u!=l._lastSeekPosition&&(l._lastSeekPosition=u,l._codec.flush((function(){l._seekStream(u)})),!0)}}),this._seekBisector.start()}},{key:"_continueSeekedPlayback",value:function _continueSeekedPlayback(){var i=this;this._seekState=$,this._state=N,this._frameEndTimestamp=this._codec.frameTimestamp,this._audioEndTimestamp=this._codec.audioTimestamp,this._seekTargetTime=this._codec.hasAudio?this._codec.audioTimestamp:this._codec.frameTimestamp,this._initialPlaybackOffset=this._seekTargetTime;var l=function finishedSeeking(){i._lastTimeUpdate=i._seekTargetTime,i._fireEventAsync("timeupdate"),i._fireEventAsync("seeked"),i._isProcessing()||i._pingProcessing()};if(this._codec.hasVideo&&this._decodedFrames.length){var d=this._decodedFrames.shift();this._drawFrame(d.yCbCrBuffer),l()}else{if(this._codec.hasVideo&&this._codec.frameReady)return this._codec.decodeFrame((function(d){d&&i._drawFrame(i._codec.frameBuffer),l()})),void this._codec.sync();l()}}},{key:"_drawFrame",value:function _drawFrame(i){this._thumbnail&&(this.removeChild(this._thumbnail),this._thumbnail=null),this._frameSink.drawFrame(i)}},{key:"_doProcessLinearSeeking",value:function _doProcessLinearSeeking(){var i,l=this;if(i=this._codec.hasVideo?this._targetPerFrameTime/1e3:1/256,this._codec.hasVideo){if(this._pendingFrame)return;if(!this._codec.frameReady)return void this._codec.process((function(i){i?l._pingProcessing():l._streamEnded?(l._log("stream ended during linear seeking on video"),l._dataEnded=!0,l._continueSeekedPlayback()):l._readBytesAndWait()}));if(this._seekMode===K&&this._codec.keyframeTimestamp==this._codec.frameTimestamp)return void this._continueSeekedPlayback();if(this._codec.frameTimestamp<=this._seekTargetTime){var d=this._codec.frameTimestamp;return this._pendingFrame++,this._pendingFrames.push({frameEndTimestamp:d}),this._decodedFrames.splice(0,this._decodedFrames.length),this._codec.decodeFrame((function(i){l._pendingFrame--,l._pendingFrames.shift(),l._decodedFrames.push({yCbCrBuffer:l._codec.frameBuffer,videoCpuTime:l._codec.videoCpuTime,frameEndTimestamp:d}),l._pingProcessing()})),void this._codec.sync()}if(!this._codec.hasAudio)return void this._continueSeekedPlayback()}if(this._codec.hasAudio){if(this._pendingAudio)return;return this._codec.audioReady?this._codec.audioTimestamp+i<this._seekTargetTime?void this._codec.decodeAudio((function(){l._pingProcessing()})):void this._continueSeekedPlayback():void this._codec.process((function(i){i?l._pingProcessing():l._streamEnded?(l._log("stream ended during linear seeking on audio"),l._dataEnded=!0,l._continueSeekedPlayback()):l._readBytesAndWait()}))}}},{key:"_doProcessBisectionSeek",value:function _doProcessBisectionSeek(){var i,l,d=this;if(this._codec.hasVideo)l=this._codec.frameTimestamp,i=this._targetPerFrameTime/1e3;else{if(!this._codec.hasAudio)throw new Error("Invalid seek state; no audio or video track available");l=this._codec.audioTimestamp,i=1/256}l<0?this._codec.process((function(i){if(i)d._pingProcessing();else if(d._streamEnded){if(d._log("stream ended during bisection seek"),!d._seekBisector.right())throw d._log("failed going back"),new Error("not sure what to do")}else d._readBytesAndWait()})):l-i/2>this._bisectTargetTime?this._seekBisector.left()||(this._log("close enough (left)"),this._seekTargetTime=l,this._continueSeekedPlayback()):l+i/2<this._bisectTargetTime?this._seekBisector.right()||(this._log("close enough (right)"),this._seekState=X,this._pingProcessing()):this._seekState==z&&this._codec.hasVideo&&this._codec.keyframeTimestamp<this._codec.frameTimestamp?(this._log("finding the keypoint now"),this._seekState=W,this._startBisection(this._codec.keyframeTimestamp)):(this._log("straight seeking now"),this._seekState=X,this._pingProcessing())}},{key:"_setupVideo",value:function _setupVideo(){this._targetPerFrameTime=this._videoInfo.fps>0?1e3/this._videoInfo.fps:16.667,this._canvas.width=this._videoInfo.displayWidth,this._canvas.height=this._videoInfo.displayHeight,OGVPlayer.styleManager.appendRule("."+this._instanceId,{width:this._videoInfo.displayWidth+"px",height:this._videoInfo.displayHeight+"px"});var i={};void 0!==this._options.webGL&&(i.webGL=this._options.webGL),this._options.forceWebGL&&(i.webGL="required"),this._frameSink=v.default.attach(this._canvas,i)}},{key:"_doProcessing",value:function _doProcessing(){if(this._didSeek&&(this._didSeek=!1),this._nextProcessingTimer=null,this._isProcessing(),this._depth>0)throw new Error("REENTRANCY FAIL: doProcessing recursing unexpectedly");var i=0;do{if(this._needProcessing=!1,this._depth++,this._doProcessingLoop(),this._depth--,this._needProcessing&&this._isProcessing())throw new Error("REENTRANCY FAIL: waiting on input or codec but asked to keep processing");++i>500&&(this._log("stuck in processing loop; breaking with timer"),this._needProcessing=0,this._pingProcessing(0))}while(this._needProcessing)}},{key:"_doProcessingLoop",value:function _doProcessingLoop(){if(this._actionQueue.length)this._actionQueue.shift()();else if(this._state==L)this._doProcessInitial();else if(this._state==R)this._doProcessSeekingEnd();else if(this._state==V)this._doProcessLoaded();else if(this._state==M)this._doProcessPreload();else if(this._state==N)this._doProcessReady();else if(this._state==j)this._doProcessSeeking();else if(this._state==B)this._doProcessPlay();else{if(this._state!=H)throw new Error("Unexpected OGVPlayer state "+this._state);this._doProcessError()}}},{key:"_doProcessInitial",value:function _doProcessInitial(){var i=this;if(this._codec.loadedMetadata){if(!this._codec.hasVideo&&!this._codec.hasAudio)throw new Error("No audio or video found, something is wrong");this._codec.hasAudio&&(this._audioInfo=this._codec.audioFormat),this._codec.hasVideo&&(this._videoInfo=this._codec.videoFormat,this._setupVideo()),isNaN(this._codec.duration)||(this._duration=this._codec.duration),null===this._duration&&this._stream.seekable&&"video/ogg"==this._detectedType?(this._state=R,this._lastSeenTimestamp=-1,this._codec.flush((function(){i._seekStream(Math.max(0,i._stream.length-131072))}))):(this._state=V,this._pingProcessing())}else this._codec.process((function(l){if(l)i._pingProcessing();else{if(i._streamEnded)throw new Error("end of file before headers found");i._log("reading more cause we are out of data"),i._readBytesAndWait()}}))}},{key:"_doProcessSeekingEnd",value:function _doProcessSeekingEnd(){var i=this;this._codec.frameReady?(this._log("saw frame with "+this._codec.frameTimestamp),this._lastSeenTimestamp=Math.max(this._lastSeenTimestamp,this._codec.frameTimestamp),this._codec.discardFrame((function(){i._pingProcessing()}))):this._codec.audioReady?(this._log("saw audio with "+this._codec.audioTimestamp),this._lastSeenTimestamp=Math.max(this._lastSeenTimestamp,this._codec.audioTimestamp),this._codec.discardAudio((function(){i._pingProcessing()}))):this._codec.process((function(l){l?i._pingProcessing():i._stream.eof?(i._log("seek-duration: we are at the end: "+i._lastSeenTimestamp),i._lastSeenTimestamp>0&&(i._duration=i._lastSeenTimestamp),i._state=V,i._codec.flush((function(){i._streamEnded=!1,i._dataEnded=!1,i._seekStream(0)}))):i._readBytesAndWait()}))}},{key:"_doProcessLoaded",value:function _doProcessLoaded(){this._state=M,this._fireEventAsync("loadedmetadata"),this._fireEventAsync("durationchange"),this._codec.hasVideo&&this._fireEventAsync("resize"),this._pingProcessing(0)}},{key:"_doProcessPreload",value:function _doProcessPreload(){var i=this;!this._codec.frameReady&&this._codec.hasVideo||!this._codec.audioReady&&this._codec.hasAudio?this._codec.process((function(l){l?i._pingProcessing():i._streamEnded?i._ended=!0:i._readBytesAndWait()})):(this._state=N,this._fireEventAsync("loadeddata"),this._pingProcessing())}},{key:"_doProcessReady",value:function _doProcessReady(){var i=this;if(this._log("initial seek to "+this._initialSeekTime),this._initialSeekTime>0){var l=this._initialSeekTime;this._initialSeekTime=0,this._log("initial seek to "+l),this._doSeek(l)}else if(this._paused)this._log("paused while in ready");else{var d=function finishStartPlaying(){i._log("finishStartPlaying"),i._state=B,i._lastFrameTimestamp=I(),i._codec.hasAudio&&i._audioFeeder?i._prebufferingAudio=!0:i._startPlayback(),i._pingProcessing(0),i._fireEventAsync("play"),i._fireEventAsync("playing")};!this._codec.hasAudio||this._audioFeeder||this._muted?d():(this._initAudioFeeder(),this._audioFeeder.waitUntilReady(d))}}},{key:"_doProcessSeeking",value:function _doProcessSeeking(){if(this._seekState==$)throw new Error("seeking in invalid state (not seeking?)");if(this._seekState==z)this._doProcessBisectionSeek();else if(this._seekState==W)this._doProcessBisectionSeek();else{if(this._seekState!=X)throw new Error("Invalid seek state "+this._seekState);this._doProcessLinearSeeking()}}},{key:"_doProcessPlay",value:function _doProcessPlay(){var i=this,l=this._codec;if(this._paused)this._log("paused during playback; stopping loop");else if((!l.hasAudio||l.audioReady||this._pendingAudio||this._dataEnded)&&(!l.hasVideo||l.frameReady||this._pendingFrame||this._decodedFrames.length||this._dataEnded)){var d,u,c,h=null,p=0,m=!1,g=0;if(l.hasAudio&&this._audioFeeder?(h=this._audioFeeder.getPlaybackState(),p=this._getPlaybackTime(h),m=this._dataEnded&&0==this._audioFeeder.durationBuffered,this._prebufferingAudio&&(this._audioFeeder.durationBuffered>=2*this._audioFeeder.bufferThreshold&&(!l.hasVideo||this._decodedFrames.length>=this._framePipelineDepth)||this._dataEnded)&&(this._log("prebuffering audio done; buffered to "+this._audioFeeder.durationBuffered),this._startPlayback(p),this._prebufferingAudio=!1),h.dropped!=this._droppedAudio&&this._log("dropped "+(h.dropped-this._droppedAudio)),h.delayed!=this._delayedAudio&&this._log("delayed "+(h.delayed-this._delayedAudio)),this._droppedAudio=h.dropped,this._delayedAudio=h.delayed,(d=this._audioFeeder.durationBuffered<=2*this._audioFeeder.bufferThreshold)&&(this._codec.audioReady?this._pendingAudio>=this._audioPipelineDepth&&(this._log("audio decode disabled: "+this._pendingAudio+" packets in flight"),d=!1):d=!1)):(p=this._getPlaybackTime(),d=this._codec.audioReady&&this._audioEndTimestamp<p),this._codec.hasVideo){c=this._pendingFrame+this._decodedFrames.length<this._framePipelineDepth+this._frameParallelism&&this._codec.frameReady,(u=this._decodedFrames.length>0)&&(this._actualPerFrameTime=this._targetPerFrameTime-(g=1e3*(this._decodedFrames[0].frameEndTimestamp-p)));var y=this._targetPerFrameTime;if(this._prebufferingAudio)c&&this._log("decoding a frame during prebuffering"),u=!1;else if(u&&this._dataEnded&&m)this._log("audio timeline ended? ready to draw frame");else if(u&&-g>=y){for(var _=-1,v=0;v<this._decodedFrames.length-1;v++)this._decodedFrames[v].frameEndTimestamp<p&&(_=v-1);if(_>=0)for(;_-- >=0;){this._lateFrames++;var b=this._decodedFrames.shift();this._log("skipping already-decoded late frame at "+b.frameEndTimestamp),g=1e3*(b.frameEndTimestamp-p),this._frameEndTimestamp=b.frameEndTimestamp,this._actualPerFrameTime=this._targetPerFrameTime-g,this._framesProcessed++,b.dropped=!0,this._doFrameComplete(b)}var T=this._codec.nextKeyframeTimestamp;if(T>=0&&T!=this._codec.frameTimestamp&&p>=T-this._targetPerFrameTime/1e3*(this._framePipelineDepth+this._pendingFrame)){this._log("skipping late frame at "+this._decodedFrames[0].frameEndTimestamp+" vs "+p+", expect to see keyframe at "+T);for(var S=0;S<this._decodedFrames.length;S++){var E=this._decodedFrames[S];this._lateFrames++,this._framesProcessed++,this._frameEndTimestamp=E.frameEndTimestamp,this._actualPerFrameTime=this._targetPerFrameTime-(g=1e3*(E.frameEndTimestamp-p)),E.dropped=!0,this._doFrameComplete(E)}this._decodedFrames=[];for(var k=0;k<this._pendingFrames.length;k++){var w=this._pendingFrames[k];this._lateFrames++,this._framesProcessed++,this._frameEndTimestamp=w.frameEndTimestamp,this._actualPerFrameTime=this._targetPerFrameTime-(g=1e3*(w.frameEndTimestamp-p)),w.dropped=!0,this._doFrameComplete(w)}for(this._pendingFrames=[],this._pendingFrame=0;this._codec.frameReady&&this._codec.frameTimestamp<T;){var C={frameEndTimestamp:this._codec.frameTimestamp,dropped:!0};this._actualPerFrameTime=this._targetPerFrameTime-(g=1e3*(C.frameEndTimestamp-p)),this._lateFrames++,this._codec.discardFrame((function(){})),this._framesProcessed++,this._doFrameComplete(C)}return void(this._isProcessing()||this._pingProcessing())}}else u&&g<=4||(u=!1)}if(c){this._log("play loop: ready to decode frame; thread depth: "+this._pendingFrame+", have buffered: "+this._decodedFrames.length),0==this._videoInfo.fps&&this._codec.frameTimestamp-this._frameEndTimestamp>0&&(this._targetPerFrameTime=1e3*(this._codec.frameTimestamp-this._frameEndTimestamp)),this._totalFrameTime+=this._targetPerFrameTime,this._totalFrameCount++;var x=this._frameEndTimestamp=this._codec.frameTimestamp;this._pendingFrame++,this._pendingFrames.push({frameEndTimestamp:x});var A=this._pendingFrames,P=!1,I=this._time((function(){i._codec.decodeFrame((function(l){A===i._pendingFrames?(i._log("play loop callback: decoded frame"),i._pendingFrame--,i._pendingFrames.shift(),l?i._decodedFrames.push({yCbCrBuffer:i._codec.frameBuffer,videoCpuTime:i._codec.videoCpuTime,frameEndTimestamp:x}):i._log("Bad video packet or something"),i._codec.process((function(){i._isProcessing()||i._pingProcessing(P?void 0:0)}))):i._log("play loop callback after flush, discarding")}))}));this._pendingFrame&&(P=!0,this._proxyTime+=I,this._pingProcessing(),this._dataEnded&&this._codec.sync())}else if(d){this._log("play loop: ready for audio; depth: "+this._pendingAudio),this._pendingAudio++;var D=this._codec.audioTimestamp,O=this._time((function(){i._codec.decodeAudio((function(l){if(i._pendingAudio--,i._log("play loop callback: decoded audio"),i._audioEndTimestamp=D,l){var d=i._codec.audioBuffer;if(d&&(i._bufferTime+=i._time((function(){i._audioFeeder&&i._audioFeeder.bufferData(d)})),!i._codec.hasVideo))i._framesProcessed++,i._doFrameComplete({frameEndTimestamp:i._audioEndTimestamp})}i._isProcessing()||i._pingProcessing()}))}));this._pendingAudio&&(this._proxyTime+=O,this._codec.audioReady?this._pingProcessing():this._doProcessPlayDemux())}else if(u){this._log("play loop: ready to draw frame"),this._nextFrameTimer&&(clearTimeout(this._nextFrameTimer),this._nextFrameTimer=null),this._thumbnail&&(this.removeChild(this._thumbnail),this._thumbnail=null);var L=this._decodedFrames.shift();this._currentVideoCpuTime=L.videoCpuTime,this._drawingTime+=this._time((function(){i._drawFrame(L.yCbCrBuffer)})),this._framesProcessed++,this._doFrameComplete(L),this._pingProcessing()}else if(!this._decodedFrames.length||this._nextFrameTimer||this._prebufferingAudio)if(this._dataEnded&&!(this._pendingAudio||this._pendingFrame||this._decodedFrames.length)){this._log("play loop: playback reached end of data "+[this._pendingAudio,this._pendingFrame,this._decodedFrames.length]);var R=0;this._codec.hasAudio&&this._audioFeeder&&(R=1e3*this._audioFeeder.durationBuffered),R>0?(this._log("play loop: ending pending "+R+" ms"),this._pingProcessing(Math.max(0,R))):(this._log("play loop: ENDING NOW: playback time "+this._getPlaybackTime()+"; frameEndTimestamp: "+this._frameEndTimestamp),this._stopPlayback(),this._prebufferingAudio=!1,this._initialPlaybackOffset=Math.max(this._audioEndTimestamp,this._frameEndTimestamp),this._ended=!0,this._paused=!0,this._fireEventAsync("pause"),this._fireEventAsync("ended"))}else this._prebufferingAudio&&(l.hasVideo&&!l.frameReady||l.hasAudio&&!l.audioReady)?(this._log("play loop: prebuffering demuxing"),this._doProcessPlayDemux()):this._log("play loop: waiting on async/timers");else{var V=g;this._log("play loop: setting a timer for drawing "+V),this._nextFrameTimer=setTimeout((function(){i._nextFrameTimer=null,i._pingProcessing()}),V)}}else this._log("play loop: demuxing"),this._doProcessPlayDemux()}},{key:"_doProcessPlayDemux",value:function _doProcessPlayDemux(){var i=this,l=this._codec.frameReady,d=this._codec.audioReady;this._codec.process((function(u){i._codec.frameReady&&!l||i._codec.audioReady&&!d?(i._log("demuxer has packets"),i._pingProcessing()):u?(i._log("demuxer processing to find more packets"),i._pingProcessing()):(i._log("demuxer ran out of data"),i._streamEnded?(i._log("demuxer reached end of data stream"),i._dataEnded=!0,i._pingProcessing()):(i._log("demuxer loading more data"),i._readBytesAndWait()))}))}},{key:"_doProcessError",value:function _doProcessError(){}},{key:"_isProcessing",value:function _isProcessing(){return this._stream&&(this._stream.buffering||this._stream.seeking)||this._codec&&this._codec.processing}},{key:"_readBytesAndWait",value:function _readBytesAndWait(){var i=this;this._stream.buffering||this._stream.seeking?this._log("readBytesAndWait during i/o"):this._stream.read(32768).then((function(l){i._log("got input "+[l.byteLength]),l.byteLength&&i._actionQueue.push((function(){i._codec.receiveInput(l,(function(){i._pingProcessing()}))})),i._stream.eof&&(i._log("stream is at end!"),i._streamEnded=!0),i._isProcessing()||i._pingProcessing()})).catch((function(l){i._onStreamError(l)}))}},{key:"_pingProcessing",value:function _pingProcessing(){var i=this,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(this._stream&&this._stream.waiting)this._log("waiting on input");else{this._nextProcessingTimer&&(this._log("canceling old processing timer"),clearTimeout(this._nextProcessingTimer),this._nextProcessingTimer=null);l>-1/256?this._nextProcessingTimer=setTimeout((function(){i._pingProcessing()}),l):this._depth?this._needProcessing=!0:this._doProcessing()}}},{key:"_startProcessingVideo",value:function _startProcessingVideo(i){var l=this;if(!this._started&&!this._codec){this._framesProcessed=0,this._bufferTime=0,this._drawingTime=0,this._proxyTime=0,this._started=!0,this._ended=!1;var d={base:this._options.base,worker:this._enableWorker,threading:this._enableThreading,simd:this._enableSIMD};this._detectedType&&(d.type=this._detectedType),this._codec=new A.default(d),this._lastVideoCpuTime=0,this._lastAudioCpuTime=0,this._lastDemuxerCpuTime=0,this._lastBufferTime=0,this._lastDrawingTime=0,this._lastProxyTime=0,this._lastFrameVideoCpuTime=0,this._lastFrameAudioCpuTime=0,this._lastFrameDemuxerCpuTime=0,this._lastFrameBufferTime=0,this._lastFrameProxyTime=0,this._lastFrameDrawingTime=0,this._currentVideoCpuTime=0,this._codec.onseek=function(i){l._didSeek=!0,l._stream&&l._seekStream(i)},this._codec.init((function(){l._codec.receiveInput(i,(function(){l._readBytesAndWait()}))}))}}},{key:"_loadCodec",value:function _loadCodec(i){var l=this;this._stream.read(1024).then((function(d){var u=new Uint8Array(d);l._detectedType=u.length>4&&u[0]=="O".charCodeAt(0)&&u[1]=="g".charCodeAt(0)&&u[2]=="g".charCodeAt(0)&&u[3]=="S".charCodeAt(0)?"video/ogg":u.length>4&&26==u[0]&&69==u[1]&&223==u[2]&&163==u[3]?"video/webm":"video/ogg",i(d)}))}},{key:"_prepForLoad",value:function _prepForLoad(i){var l=this;this._stopVideo(),this._currentSrc="",this._loading=!0,this._actionQueue.push((function(){i&&"none"===l.preload?l._loading=!1:function doLoad(){l._stream=l._options.stream?l._options.stream:new b.default({url:l.src,cacheSize:16777216,progressive:!1}),l._stream.load().then((function(){l._loading=!1,l._currentSrc=l.src,l._byteLength=l._stream.seekable?l._stream.length:0;var i=l._stream.headers["x-content-duration"];"string"==typeof i&&(l._duration=parseFloat(i)),l._loadCodec((function(i){l._startProcessingVideo(i)}))})).catch((function(i){l._onStreamError(i)}))}()})),this._pingProcessing(0)}},{key:"load",value:function load(){this._prepForLoad()}},{key:"canPlayType",value:function canPlayType(i){var l=new C.default(i);function checkTypes(i){if(l.codecs){var d=0,u=0;return l.codecs.forEach((function(l){i.indexOf(l)>=0?d++:u++})),0===d||u>0?"":"probably"}return"maybe"}return"ogg"!==l.minor||"audio"!==l.major&&"video"!==l.major&&"application"!==l.major?"webm"!==l.minor||"audio"!==l.major&&"video"!==l.major?"":checkTypes(["vorbis","opus","vp8","vp9"]):checkTypes(["vorbis","opus","theora"])}},{key:"play",value:function play(){this._muted||this._options.audioContext||OGVPlayer.initSharedAudioContext(),this._paused&&(this._startedPlaybackInDocument=document.body.contains(this),this._paused=!1,this._state==j||(this._started&&this._codec&&this._codec.loadedMetadata?(this._ended&&this._stream&&this._byteLength?(this._log(".play() starting over after end"),this._seek(0)):this._log(".play() while already started"),this._state=N,this._isProcessing()||this._pingProcessing()):this._loading?this._log(".play() while loading"):(this._log(".play() before started"),this._stream||this.load())))}},{key:"getPlaybackStats",value:function getPlaybackStats(){return{targetPerFrameTime:this._targetPerFrameTime,framesProcessed:this._framesProcessed,videoBytes:this._codec?this._codec.videoBytes:0,audioBytes:this._codec?this._codec.audioBytes:0,playTime:this._playTime,demuxingTime:this._codec?this._codec.demuxerCpuTime-this._lastDemuxerCpuTime:0,videoDecodingTime:this._codec?this._codec.videoCpuTime-this._lastVideoCpuTime:0,audioDecodingTime:this._codec?this._codec.audioCpuTime-this._lastAudioCpuTime:0,bufferTime:this._bufferTime-this._lastBufferTime,drawingTime:this._drawingTime-this._lastDrawingTime,proxyTime:this._proxyTime-this._lastProxyTime,droppedAudio:this._droppedAudio,delayedAudio:this._delayedAudio,jitter:this._totalJitter/this._framesProcessed,lateFrames:this._lateFrames}}},{key:"resetPlaybackStats",value:function resetPlaybackStats(){this._framesProcessed=0,this._playTime=0,this._codec&&(this._lastDemuxerCpuTime=this._codec.demuxerCpuTime,this._lastVideoCpuTime=this._codec.videoCpuTime,this._lastAudioCpuTime=this._codec.audioCpuTime,this._codec.videoBytes=0,this._codec.audioBytes=0),this._lastBufferTime=this._bufferTime,this._lastDrawingTime=this._drawingTime,this._lastProxyTime=this._proxyTime,this._totalJitter=0,this._totalFrameTime=0,this._totalFrameCount=0}},{key:"getVideoFrameSink",value:function getVideoFrameSink(){return this._frameSink}},{key:"getCanvas",value:function getCanvas(){return this._canvas}},{key:"getVideo",value:function getVideo(){return null}},{key:"pause",value:function pause(){this._paused||(this._nextProcessingTimer&&(clearTimeout(this._nextProcessingTimer),this._nextProcessingTimer=null),this._stopPlayback(),this._prebufferingAudio=!1,this._paused=!0,this._fireEvent("pause"))}},{key:"stop",value:function stop(){this._stopVideo(),this._paused=!0}},{key:"fastSeek",value:function fastSeek(i){this._seek(+i,K)}}],[{key:"initSharedAudioContext",value:function initSharedAudioContext(){var i=document.createElement("audio");i.src=P.default,i.play(),T.default.initSharedAudioContext()}}]),OGVPlayer}(OGVJSElement);(0,k.default)(Y,O),Y.instanceCount=0,Y.styleManager=new function StyleManager(){var i=document.createElement("style");i.type="text/css",i.textContent="ogvjs { display: inline-block; position: relative; -webkit-user-select: none; -webkit-tap-highlight-color: rgba(0,0,0,0); ",document.head.appendChild(i);var l=i.sheet;this.appendRule=function(i,d){var u=[];for(var c in d)d.hasOwnProperty(c)&&u.push(c+":"+d[c]);var h=i+"{"+u.join(";")+"}";l.insertRule(h,l.cssRules.length-1)}},l.default=Y},580:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913));l.default=function OGVProxyClass(i){return function(){function _class(l,d,u){var h=this;for(var p in(0,c.default)(this,_class),u=u||{},this.worker=l,this.transferables=function(){var i=new ArrayBuffer(1024),d=new Uint8Array(i);try{return l.postMessage({action:"transferTest",bytes:d},[i]),!i.byteLength}catch(i){return!1}}(),i)i.hasOwnProperty(p)&&(this[p]=i[p]);this.processingQueue=0,Object.defineProperty(this,"processing",{get:function get(){return this.processingQueue>0}}),this.messageCount=0,this.pendingCallbacks={},this.worker.addEventListener("message",(function(i){h.handleMessage(i)})),this.proxy("construct",[d,u],(function(){}))}return(0,h.default)(_class,[{key:"proxy",value:function proxy(i,l,d){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!this.worker)throw'Tried to call "'+i+'" method on closed proxy object';var c="callback-"+ ++this.messageCount+"-"+i;d&&(this.pendingCallbacks[c]=d);var h={action:i,callbackId:c,args:l||[]};this.processingQueue++,this.transferables?this.worker.postMessage(h,u):this.worker.postMessage(h)}},{key:"terminate",value:function terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.processingQueue=0,this.pendingCallbacks={})}},{key:"handleMessage",value:function handleMessage(i){if(this.processingQueue--,"callback"===i.data.action){var l=i.data,d=l.callbackId,u=l.args,c=this.pendingCallbacks[d];if(l.props)for(var h in l.props)l.props.hasOwnProperty(h)&&(this[h]=l.props[h]);c&&(delete this.pendingCallbacks[d],c.apply(this,u))}}}]),_class}()}},168:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=function(){function OGVTimeRanges(i){(0,c.default)(this,OGVTimeRanges),this._ranges=i,this.length=i.length}return(0,h.default)(OGVTimeRanges,[{key:"start",value:function start(i){if(i<0||i>this.length||i!==(0|i))throw new RangeError("Invalid index");return this._ranges[i][0]}},{key:"end",value:function end(i){if(i<0||i>this.length||i!==(0|i))throw new RangeError("Invalid index");return this._ranges[i][1]}}]),OGVTimeRanges}();l.default=p},625:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(575)),h=u(d(913)),p=u(d(964));function _arrayLikeToArray(i,l){(null==l||l>i.length)&&(l=i.length);for(var d=0,u=new Array(l);d<l;d++)u[d]=i[d];return u}var m=function(){function OGVWrapperCodec(i){return(0,c.default)(this,OGVWrapperCodec),this.options=i||{},this.demuxer=null,this.videoDecoder=null,this.audioDecoder=null,this.flushIter=0,this.loadedMetadata=!1,this.processing=!1,Object.defineProperties(this,{duration:{get:function get(){return this.loadedMetadata?this.demuxer.duration:NaN}},hasAudio:{get:function get(){return this.loadedMetadata&&!!this.audioDecoder}},audioReady:{get:function get(){return this.hasAudio&&this.demuxer.audioReady}},audioTimestamp:{get:function get(){return this.demuxer.audioTimestamp}},audioFormat:{get:function get(){return this.hasAudio?this.audioDecoder.audioFormat:null}},audioBuffer:{get:function get(){return this.hasAudio?this.audioDecoder.audioBuffer:null}},hasVideo:{get:function get(){return this.loadedMetadata&&!!this.videoDecoder}},frameReady:{get:function get(){return this.hasVideo&&this.demuxer.frameReady}},frameTimestamp:{get:function get(){return this.demuxer.frameTimestamp}},keyframeTimestamp:{get:function get(){return this.demuxer.keyframeTimestamp}},nextKeyframeTimestamp:{get:function get(){return this.demuxer.nextKeyframeTimestamp}},videoFormat:{get:function get(){return this.hasVideo?this.videoDecoder.videoFormat:null}},frameBuffer:{get:function get(){return this.hasVideo?this.videoDecoder.frameBuffer:null}},seekable:{get:function get(){return this.demuxer.seekable}},demuxerCpuTime:{get:function get(){return this.demuxer?this.demuxer.cpuTime:0}},audioCpuTime:{get:function get(){return this.audioDecoder?this.audioDecoder.cpuTime:0}},videoCpuTime:{get:function get(){return this.videoDecoder?this.videoDecoder.cpuTime:0}}}),this.loadedDemuxerMetadata=!1,this.loadedAudioMetadata=!1,this.loadedVideoMetadata=!1,this.loadedAllMetadata=!1,this.onseek=null,this.videoBytes=0,this.audioBytes=0,this}return(0,h.default)(OGVWrapperCodec,[{key:"flushSafe",value:function flushSafe(i){var l=this,d=this.flushIter;return function(u){l.flushIter<=d&&i(u)}}},{key:"init",value:function init(i){var l=this;this.processing=!0,p.default.loadClass("video/webm"===this.options.type||"audio/webm"===this.options.type?"OGVDemuxerWebMW":"OGVDemuxerOggW",(function(d){d().then((function(d){l.demuxer=d,d.onseek=function(i){l.onseek&&l.onseek(i)},d.init((function(){l.processing=!1,i()}))}))}))}},{key:"close",value:function close(){this.demuxer&&(this.demuxer.close(),this.demuxer=null),this.videoDecoder&&(this.videoDecoder.close(),this.videoDecoder=null),this.audioDecoder&&(this.audioDecoder.close(),this.audioDecoder=null)}},{key:"receiveInput",value:function receiveInput(i,l){this.demuxer.receiveInput(i,l)}},{key:"process",value:function process(i){var l=this;if(this.processing)throw new Error("reentrancy fail on OGVWrapperCodec.process");this.processing=!0;var d=function finish(d){l.processing=!1,i(d)},u=function doProcessData(){l.demuxer.process(d)};this.demuxer.loadedMetadata&&!this.loadedDemuxerMetadata?this.loadAudioCodec((function(){l.loadVideoCodec((function(){l.loadedDemuxerMetadata=!0,l.loadedAudioMetadata=!l.audioDecoder,l.loadedVideoMetadata=!l.videoDecoder,l.loadedAllMetadata=l.loadedAudioMetadata&&l.loadedVideoMetadata,d(!0)}))})):this.loadedDemuxerMetadata&&!this.loadedAudioMetadata?this.audioDecoder.loadedMetadata?(this.loadedAudioMetadata=!0,this.loadedAllMetadata=this.loadedAudioMetadata&&this.loadedVideoMetadata,d(!0)):this.demuxer.audioReady?this.demuxer.dequeueAudioPacket((function(i,u){l.audioBytes+=i.byteLength,l.audioDecoder.processHeader(i,(function(i){d(!0)}))})):u():this.loadedAudioMetadata&&!this.loadedVideoMetadata?this.videoDecoder.loadedMetadata?(this.loadedVideoMetadata=!0,this.loadedAllMetadata=this.loadedAudioMetadata&&this.loadedVideoMetadata,d(!0)):this.demuxer.frameReady?(this.processing=!0,this.demuxer.dequeueVideoPacket((function(i){l.videoBytes+=i.byteLength,l.videoDecoder.processHeader(i,(function(){d(!0)}))}))):u():this.loadedVideoMetadata&&!this.loadedMetadata&&this.loadedAllMetadata?(this.loadedMetadata=!0,d(!0)):!this.loadedMetadata||this.hasAudio&&!this.demuxer.audioReady||this.hasVideo&&!this.demuxer.frameReady?u():d(!0)}},{key:"decodeFrame",value:function decodeFrame(i){var l=this,d=this.flushSafe(i),u=this.frameTimestamp,c=this.keyframeTimestamp;this.demuxer.dequeueVideoPacket((function(i){l.videoBytes+=i.byteLength,l.videoDecoder.processFrame(i,(function(i){var h=l.videoDecoder.frameBuffer;h&&(h.timestamp=u,h.keyframeTimestamp=c),d(i)}))}))}},{key:"decodeAudio",value:function decodeAudio(i){var l=this,d=this.flushSafe(i);this.demuxer.dequeueAudioPacket((function(i,u){l.audioBytes+=i.byteLength,l.audioDecoder.processAudio(i,(function(i){if(u){var c,h=[],p=function _createForOfIteratorHelper(i,l){var d="undefined"!=typeof Symbol&&i[Symbol.iterator]||i["@@iterator"];if(!d){if(Array.isArray(i)||(d=function _unsupportedIterableToArray(i,l){if(i){if("string"==typeof i)return _arrayLikeToArray(i,l);var d=Object.prototype.toString.call(i).slice(8,-1);return"Object"===d&&i.constructor&&(d=i.constructor.name),"Map"===d||"Set"===d?Array.from(i):"Arguments"===d||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?_arrayLikeToArray(i,l):void 0}}(i))||l&&i&&"number"==typeof i.length){d&&(i=d);var u=0,c=function F(){};return{s:c,n:function n(){return u>=i.length?{done:!0}:{done:!1,value:i[u++]}},e:function e(i){throw i},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h,p=!0,m=!1;return{s:function s(){d=d.call(i)},n:function n(){var i=d.next();return p=i.done,i},e:function e(i){m=!0,h=i},f:function f(){try{p||null==d.return||d.return()}finally{if(m)throw h}}}}(l.audioDecoder.audioBuffer);try{for(p.s();!(c=p.n()).done;){var m=c.value,g=Math.round(u*l.audioFormat.rate/1e9);h.push(g>0?m.subarray(0,m.length-Math.min(g,m.length)):m.subarray(Math.min(Math.abs(g),m.length),m.length))}}catch(i){p.e(i)}finally{p.f()}l.audioDecoder.audioBuffer=h}return d(i)}))}))}},{key:"discardFrame",value:function discardFrame(i){var l=this;this.demuxer.dequeueVideoPacket((function(d){l.videoBytes+=d.byteLength,i()}))}},{key:"discardAudio",value:function discardAudio(i){var l=this;this.demuxer.dequeueAudioPacket((function(d,u){l.audioBytes+=d.byteLength,i()}))}},{key:"flush",value:function flush(i){this.flushIter++,this.demuxer.flush(i)}},{key:"sync",value:function sync(){this.videoDecoder&&this.videoDecoder.sync()}},{key:"recycleFrame",value:function recycleFrame(i){this.videoDecoder&&this.videoDecoder.recycleFrame(i)}},{key:"getKeypointOffset",value:function getKeypointOffset(i,l){this.demuxer.getKeypointOffset(i,l)}},{key:"seekToKeypoint",value:function seekToKeypoint(i,l){this.demuxer.seekToKeypoint(i,this.flushSafe(l))}},{key:"loadAudioCodec",value:function loadAudioCodec(i){var l=this;if(this.demuxer.audioCodec){var d={vorbis:"OGVDecoderAudioVorbisW",opus:"OGVDecoderAudioOpusW"}[this.demuxer.audioCodec];this.processing=!0,p.default.loadClass(d,(function(d){var u={};l.demuxer.audioFormat&&(u.audioFormat=l.demuxer.audioFormat),d(u).then((function(d){l.audioDecoder=d,d.init((function(){l.loadedAudioMetadata=d.loadedMetadata,l.processing=!1,i()}))}))}),{worker:this.options.worker})}else i()}},{key:"loadVideoCodec",value:function loadVideoCodec(i){var l=this;if(this.demuxer.videoCodec){var d=!!this.options.simd,u=!!this.options.threading,c={theora:"OGVDecoderVideoTheoraW",vp8:u?"OGVDecoderVideoVP8MTW":"OGVDecoderVideoVP8W",vp9:u?d?"OGVDecoderVideoVP9SIMDMTW":"OGVDecoderVideoVP9MTW":d?"OGVDecoderVideoVP9SIMDW":"OGVDecoderVideoVP9W",av1:u?d?"OGVDecoderVideoAV1SIMDMTW":"OGVDecoderVideoAV1MTW":d?"OGVDecoderVideoAV1SIMDW":"OGVDecoderVideoAV1W"}[this.demuxer.videoCodec];this.processing=!0,p.default.loadClass(c,(function(d){var c={};l.demuxer.videoFormat&&(c.videoFormat=l.demuxer.videoFormat),u&&delete window.ENVIRONMENT_IS_PTHREAD,d(c).then((function(d){l.videoDecoder=d,d.init((function(){l.loadedVideoMetadata=d.loadedMetadata,l.processing=!1,i()}))}))}),{worker:this.options.worker&&!this.options.threading})}else i()}}]),OGVWrapperCodec}();l.default=m},539:(i,l,d)=>{"use strict";var u=d(318);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=u(d(8)),h=u(d(575)),p=u(d(913)),m=new(function(){function WebAssemblyChecker(){(0,h.default)(this,WebAssemblyChecker),this.tested=!1,this.testResult=void 0}return(0,p.default)(WebAssemblyChecker,[{key:"wasmSupported",value:function wasmSupported(){if(!this.tested){try{this.testResult="object"===("undefined"==typeof WebAssembly?"undefined":(0,c.default)(WebAssembly))&&function testSafariWebAssemblyBug(){var i=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),l=new WebAssembly.Module(i);return 0!==new WebAssembly.Instance(l,{}).exports.test(4)}()}catch(i){console.log("Exception while testing WebAssembly",i),this.testResult=!1}this.tested=!0}return this.testResult}}]),WebAssemblyChecker}());l.default=m},309:(i,l)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;l.default=function extend(i,l){for(var d in l)l.hasOwnProperty(d)&&(i[d]=l[d])}},431:(i,l,d)=>{"use strict";var u=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}(),c=function get(i,l,d){null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,l);if(void 0===u){var c=Object.getPrototypeOf(i);return null===c?void 0:get(c,l,d)}if("value"in u)return u.value;var h=u.get;return void 0!==h?h.call(d):void 0};var h=d(828),p="arraybuffer",m=function(i){function ArrayBufferBackend(){return function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}(this,ArrayBufferBackend),function _possibleConstructorReturn(i,l){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!l||"object"!=typeof l&&"function"!=typeof l?i:l}(this,(ArrayBufferBackend.__proto__||Object.getPrototypeOf(ArrayBufferBackend)).apply(this,arguments))}return function _inherits(i,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function, not "+typeof l);i.prototype=Object.create(l&&l.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(i,l):i.__proto__=l)}(ArrayBufferBackend,i),u(ArrayBufferBackend,[{key:"initXHR",value:function initXHR(){c(ArrayBufferBackend.prototype.__proto__||Object.getPrototypeOf(ArrayBufferBackend.prototype),"initXHR",this).call(this),this.xhr.responseType=p}},{key:"onXHRProgress",value:function onXHRProgress(){}},{key:"onXHRLoad",value:function onXHRLoad(){var i=this.xhr.response;this.bytesRead+=i.byteLength,this.emit("buffer",i),c(ArrayBufferBackend.prototype.__proto__||Object.getPrototypeOf(ArrayBufferBackend.prototype),"onXHRLoad",this).call(this)}}]),ArrayBufferBackend}(h);m.supported=function(){try{var i=new XMLHttpRequest;return i.responseType=p,i.responseType===p}catch(i){return!1}},i.exports=m},306:(i,l,d)=>{"use strict";var u=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}();function getXHRRangeMatches(i){var l=i.getResponseHeader("Content-Range");return l&&l.match(/^bytes (\d+)-(\d+)\/(\d+)/)}var c=function(i){function Backend(i){var l=i.url,d=i.offset,u=i.length,c=i.cachever,h=void 0===c?0:c;!function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}(this,Backend);var p=function _possibleConstructorReturn(i,l){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!l||"object"!=typeof l&&"function"!=typeof l?i:l}(this,(Backend.__proto__||Object.getPrototypeOf(Backend)).call(this));return p.url=l,p.offset=d,p.length=u,p.cachever=h,p.loaded=!1,p.seekable=!1,p.headers={},p.eof=!1,p.bytesRead=0,p.xhr=new XMLHttpRequest,p}return function _inherits(i,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function, not "+typeof l);i.prototype=Object.create(l&&l.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(i,l):i.__proto__=l)}(Backend,i),u(Backend,[{key:"load",value:function load(){var i=this;return new Promise((function(l,d){var u=null;i._onAbort=function(i){u(),d(i)};var c=function checkOpen(){if(2==i.xhr.readyState){if(206==i.xhr.status){var c=function getXHRRangeStart(i){var l=getXHRRangeMatches(i);return l?parseInt(l[1],10):0}(i.xhr);if(i.offset!=c)return console.log("Expected start at "+i.offset+" but got "+c+"; working around Safari range caching bug: https://bugs.webkit.org/show_bug.cgi?id=82672"),i.cachever++,i.emit("cachever"),i.abort(),u(),void i.load().then(l).catch(d);i.seekable=!0}i.xhr.status>=200&&i.xhr.status<300?(i.length=function getXHRLength(i){if(206==i.status)return function getXHRRangeTotal(i){var l=getXHRRangeMatches(i);return l?parseInt(l[3],10):-1}(i);var l=i.getResponseHeader("Content-Length");return null===l||""===l?-1:parseInt(l,10)}(i.xhr),i.headers=function getXHRHeaders(i){var l={};return i.getAllResponseHeaders().split(/\r?\n/).forEach((function(i){var d=i.split(/:\s*/,2);d.length>1&&(l[d[0].toLowerCase()]=d[1])})),l}(i.xhr),i.onXHRStart()):(u(),d(new Error("HTTP error "+i.xhr.status)))}},h=function checkError(){u(),d(new Error("network error"))},p=function checkBackendOpen(){u(),l()};u=function oncomplete(){i.xhr.removeEventListener("readystatechange",c),i.xhr.removeEventListener("error",h),i.off("open",p),i._onAbort=null},i.initXHR(),i.xhr.addEventListener("readystatechange",c),i.xhr.addEventListener("error",h),i.on("open",p),i.xhr.send()}))}},{key:"bufferToOffset",value:function bufferToOffset(i){return Promise.reject(new Error("abstract"))}},{key:"abort",value:function abort(){if(this.xhr.abort(),this._onAbort){var i=this._onAbort;this._onAbort=null;var l=new Error("Aborted");l.name="AbortError",i(l)}}},{key:"initXHR",value:function initXHR(){var i=this.url;this.cachever&&(i+="?buggy_cachever="+this.cachever),this.xhr.open("GET",i);var l=null;(this.offset||this.length)&&(l="bytes="+this.offset+"-"),this.length&&(l+=this.offset+this.length-1),null!==l&&this.xhr.setRequestHeader("Range",l)}},{key:"onXHRStart",value:function onXHRStart(){throw new Error("abstract")}}]),Backend}(d(566));i.exports=c},810:(i,l,d)=>{"use strict";var u=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}(),c=function get(i,l,d){null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,l);if(void 0===u){var c=Object.getPrototypeOf(i);return null===c?void 0:get(c,l,d)}if("value"in u)return u.value;var h=u.get;return void 0!==h?h.call(d):void 0};var h=function(i){function BinaryStringBackend(){return function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}(this,BinaryStringBackend),function _possibleConstructorReturn(i,l){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!l||"object"!=typeof l&&"function"!=typeof l?i:l}(this,(BinaryStringBackend.__proto__||Object.getPrototypeOf(BinaryStringBackend)).apply(this,arguments))}return function _inherits(i,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function, not "+typeof l);i.prototype=Object.create(l&&l.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(i,l):i.__proto__=l)}(BinaryStringBackend,i),u(BinaryStringBackend,[{key:"initXHR",value:function initXHR(){c(BinaryStringBackend.prototype.__proto__||Object.getPrototypeOf(BinaryStringBackend.prototype),"initXHR",this).call(this),this.xhr.responseType="text",this.xhr.overrideMimeType("text/plain; charset=x-user-defined")}},{key:"onXHRProgress",value:function onXHRProgress(){var i=this.xhr.responseText.slice(this.bytesRead);i.length>0&&(this.bytesRead+=i.length,this.emit("buffer",i))}},{key:"onXHRLoad",value:function onXHRLoad(){this.onXHRProgress(),c(BinaryStringBackend.prototype.__proto__||Object.getPrototypeOf(BinaryStringBackend.prototype),"onXHRLoad",this).call(this)}}]),BinaryStringBackend}(d(828));h.supported=function(){try{return!!(new XMLHttpRequest).overrideMimeType}catch(i){return!1}},i.exports=h},828:(i,l,d)=>{"use strict";var u=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}(),c=function get(i,l,d){null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,l);if(void 0===u){var c=Object.getPrototypeOf(i);return null===c?void 0:get(c,l,d)}if("value"in u)return u.value;var h=u.get;return void 0!==h?h.call(d):void 0};var h=function(i){function DownloadBackend(){return function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}(this,DownloadBackend),function _possibleConstructorReturn(i,l){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!l||"object"!=typeof l&&"function"!=typeof l?i:l}(this,(DownloadBackend.__proto__||Object.getPrototypeOf(DownloadBackend)).apply(this,arguments))}return function _inherits(i,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function, not "+typeof l);i.prototype=Object.create(l&&l.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(i,l):i.__proto__=l)}(DownloadBackend,i),u(DownloadBackend,[{key:"bufferToOffset",value:function bufferToOffset(i){var l=this;return new Promise((function(d,u){if(l.eof||l.offset>=i)d();else{var c=null;l._onAbort=function(i){c(),u(i)};var h=function checkBuffer(){l.offset>=i&&!l.eof&&(c(),d())},p=function checkDone(){c(),d()},m=function checkError(){c(),u(new Error("error streaming"))};c=function oncomplete(){l.buffering=!1,l.off("buffer",h),l.off("done",p),l.off("error",m),l._onAbort=null},l.buffering=!0,l.on("buffer",h),l.on("done",p),l.on("error",m)}}))}},{key:"initXHR",value:function initXHR(){c(DownloadBackend.prototype.__proto__||Object.getPrototypeOf(DownloadBackend.prototype),"initXHR",this).call(this)}},{key:"onXHRStart",value:function onXHRStart(){var i=this;this.xhr.addEventListener("progress",(function(){return i.onXHRProgress()})),this.xhr.addEventListener("error",(function(){return i.onXHRError()})),this.xhr.addEventListener("load",(function(){return i.onXHRLoad()})),this.emit("open")}},{key:"onXHRProgress",value:function onXHRProgress(){throw new Error("abstract")}},{key:"onXHRError",value:function onXHRError(){this.emit("error")}},{key:"onXHRLoad",value:function onXHRLoad(){this.eof=!0,this.emit("done")}}]),DownloadBackend}(d(306));i.exports=h},761:(i,l,d)=>{"use strict";var u=d(855),c=d(810),h=d(431),p=null;i.exports=function instantiate(i){if(!1===i.progressive)return new h(i);if(p||(p=function autoselect(){return u.supported()?u:c.supported()?c:null}()),!p)throw new Error("No supported backend class");return new p(i)}},855:(i,l,d)=>{"use strict";var u=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}(),c=function get(i,l,d){null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,l);if(void 0===u){var c=Object.getPrototypeOf(i);return null===c?void 0:get(c,l,d)}if("value"in u)return u.value;var h=u.get;return void 0!==h?h.call(d):void 0};var h=d(828),p="moz-chunked-arraybuffer",m=function(i){function MozChunkedBackend(){return function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}(this,MozChunkedBackend),function _possibleConstructorReturn(i,l){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!l||"object"!=typeof l&&"function"!=typeof l?i:l}(this,(MozChunkedBackend.__proto__||Object.getPrototypeOf(MozChunkedBackend)).apply(this,arguments))}return function _inherits(i,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function, not "+typeof l);i.prototype=Object.create(l&&l.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(i,l):i.__proto__=l)}(MozChunkedBackend,i),u(MozChunkedBackend,[{key:"initXHR",value:function initXHR(){c(MozChunkedBackend.prototype.__proto__||Object.getPrototypeOf(MozChunkedBackend.prototype),"initXHR",this).call(this),this.xhr.responseType=p}},{key:"onXHRProgress",value:function onXHRProgress(){var i=this.xhr.response;this.bytesRead+=i.byteLength,this.emit("buffer",i)}}]),MozChunkedBackend}(h);m.supported=function(){try{var i=new XMLHttpRequest;return i.responseType=p,i.responseType===p}catch(i){return!1}},i.exports=m},503:i=>{"use strict";var l=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}();var d=function(){function CacheItem(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=i.buffer,d=void 0===l?void 0:l,u=i.string,c=void 0===u?void 0:u,h=i.start,p=void 0===h?0:h,m=i.end,g=void 0===m?p+(d?d.byteLength:c?c.length:0):m,y=i.prev,_=void 0===y?null:y,v=i.next,b=void 0===v?null:v,T=i.eof,S=void 0!==T&&T,E=i.empty,k=void 0===E?!(d||c):E,w=i.timestamp,C=void 0===w?Date.now():w;(function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")})(this,CacheItem),this.start=p,this.end=g,this.prev=_,this.next=b,this.eof=S,this.empty=k,this.timestamp=C,this.buffer=d,this.string=c,Object.defineProperty(this,"length",{get:function get(){return this.end-this.start}})}return l(CacheItem,[{key:"contains",value:function contains(i){return i>=this.start&&(i<this.end||this.eof)}},{key:"readBytes",value:function readBytes(i,l,d){var u=l-this.start,c=d-l;if(this.buffer){var h=new Uint8Array(this.buffer,u,c);i.set(h)}else{if(!this.string)throw new Error("invalid state");for(var p=this.string,m=0;m<c;m++)i[m]=p.charCodeAt(u+m)}this.timestamp=Date.now()}},{key:"split",value:function split(i){if(!this.empty||!this.contains(i))throw new Error("invalid split");var l=new CacheItem({start:this.start,end:i}),d=new CacheItem({start:i,end:this.eof?i:this.end,eof:this.eof});return l.next=d,d.prev=l,[l,d]}},{key:"first",value:function first(i){for(var l=this;l;l=l.next)if(i(l))return l;return null}},{key:"last",value:function last(i){for(var last=null,l=this;l&&i(l);l=l.next)last=l;return last}}]),CacheItem}();i.exports=d},91:(i,l,d)=>{"use strict";var u=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}();var c=d(503),h=function(){function CachePool(){var i=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cacheSize,l=void 0===i?0:i;!function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}(this,CachePool);var d=new c({eof:!0});this.head=d,this.tail=d,this.readOffset=0,this.readCursor=d,this.writeOffset=0,this.writeCursor=d,this.cacheSize=l}return u(CachePool,[{key:"bytesReadable",value:function bytesReadable(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,l=this.readOffset,d=this.readCursor.last((function(d){return!d.empty&&d.start<=l+i}));return d?Math.min(i,d.end-l):0}},{key:"bytesWritable",value:function bytesWritable(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,l=this.writeOffset,d=this.writeCursor;if(d.eof)return i;var u=d.last((function(d){return d.empty&&d.start<=l+i}));return u?Math.min(i,u.end-l):0}},{key:"seekRead",value:function seekRead(i){var l=this.head.first((function(l){return l.contains(i)}));if(!l)throw new Error("read seek out of range");this.readOffset=i,this.readCursor=l}},{key:"seekWrite",value:function seekWrite(i){var l=this.head.first((function(l){return l.contains(i)}));if(!l)throw new Error("write seek out of range");this.writeOffset=i,this.writeCursor=l}},{key:"readBytes",value:function readBytes(i){for(var l=this.bytesReadable(i.byteLength),d=this.readOffset,u=d+l,c=d,h=this.readCursor;h&&!h.empty&&!(h.start>=u);h=h.next){var p=Math.min(u,h.end),m=i.subarray(c-d,p-d);h.readBytes(m,c,p),c=p}return this.readOffset=c,this.readCursor=this.readCursor.first((function(i){return i.contains(c)})),l}},{key:"write",value:function write(i){var l=this.bufferItem(i),d=this.writeCursor;if(!d.empty)throw new Error("write cursor not empty");if(!d.contains(l.end)&&d.end!==l.end)throw new Error("write cursor too small");d.start<l.start&&(this.split(d,l.start),d=this.writeCursor),(l.end<d.end||d.eof)&&(this.split(d,l.end),d=this.writeCursor),this.splice(d,d,l,l),this.writeOffset=l.end,this.writeCursor=l.next,this.gc()}},{key:"bufferItem",value:function bufferItem(i){if(i instanceof ArrayBuffer)return new c({start:this.writeOffset,end:this.writeOffset+i.byteLength,buffer:i});if("string"==typeof i)return new c({start:this.writeOffset,end:this.writeOffset+i.length,string:i});throw new Error("invalid input to write")}},{key:"split",value:function split(i,l){var d=i.split(l);this.splice(i,i,d[0],d[1])}},{key:"ranges",value:function ranges(){for(var ranges=[],i=this.head;i;i=i.next)if(!i.empty){var l=i;i=i.last((function(i){return!i.empty})),ranges.push([l.start,i.end])}return ranges}},{key:"gc",value:function gc(){for(var i=0,l=[],d=this.head;d;d=d.next)d.empty||(i+=d.length,(d.end<this.readOffset||d.start>this.readOffset+this.chunkSize)&&l.push(d));if(i>this.cacheSize){l.sort((function(i,l){return i.timestamp-l.timestamp}));for(var u=0;u<l.length;u++){var c=l[u];if(i<=this.cacheSize)break;this.remove(c),i-=c.length}}}},{key:"remove",value:function remove(i){var l=new c({start:i.start,end:i.end});this.splice(i,i,l,l),(i=l).prev&&i.prev.empty&&(i=this.consolidate(i.prev)),i.next&&i.next.empty&&!i.next.eof&&(i=this.consolidate(i)),0===i.start&&(this.head=i)}},{key:"consolidate",value:function consolidate(i){var l=i.last((function(i){return i.empty&&!i.eof})),d=new c({start:i.start,end:l.end});return this.splice(i,l,d,d),d}},{key:"splice",value:function splice(i,l,d,u){var c=this;if(i.start!==d.start)throw new Error("invalid splice head");if(!(l.end===u.end||l.eof&&u.eof))throw new Error("invalid splice tail");var h=i.prev,p=l.next;i.prev=null,l.next=null,h&&(h.next=d,d.prev=h),p&&(p.prev=u,u.next=p),i===this.head&&(this.head=d),l===this.tail&&(this.tail=u),this.readCursor=this.head.first((function(i){return i.contains(c.readOffset)})),this.writeCursor=this.head.first((function(i){return i.contains(c.writeOffset)}))}},{key:"eof",get:function get(){return this.readCursor.eof}}]),CachePool}();i.exports=h},814:(i,l,d)=>{"use strict";i.exports=d(91)},566:i=>{"use strict";var l=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}(),d=function(){function TinyEvents(){!function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}(this,TinyEvents),this._e={}}return l(TinyEvents,[{key:"on",value:function on(i,l){(this._e[i]||(this._e[i]=[])).push(l)}},{key:"off",value:function off(i,l){var d=this._e[i]||[],u=d.indexOf(l);l>=0&&d.splice(u,1)}},{key:"emit",value:function emit(i,l){(this._e[i]||[]).slice().forEach((function(i){return i(l)}))}}]),TinyEvents}();i.exports=d},936:(i,l,d)=>{"use strict";var u=function(){function defineProperties(i,l){for(var d=0;d<l.length;d++){var u=l[d];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}return function(i,l,d){return l&&defineProperties(i.prototype,l),d&&defineProperties(i,d),i}}();d(566);var c=d(814),h=d(761),p=function(){function StreamFile(i){var l=i.url,d=void 0===l?"":l,u=i.chunkSize,h=void 0===u?1048576:u,p=i.cacheSize,m=void 0===p?0:p,g=i.progressive,y=void 0===g||g;!function _classCallCheck(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}(this,StreamFile),this.length=-1,this.loaded=!1,this.loading=!1,this.seekable=!1,this.buffering=!1,this.seeking=!1,this.progressive=y,Object.defineProperties(this,{offset:{get:function get(){return this._cache.readOffset}},eof:{get:function get(){return this.length===this._cache.readOffset}}}),this.url=d,this.headers={},this._cache=new c({cacheSize:m}),this._backend=null,this._cachever=0,this._chunkSize=h}return u(StreamFile,[{key:"load",value:function load(){var i=this;return new Promise((function(l,d){if(i.loading)throw new Error("cannot load when loading");if(i.loaded)throw new Error("cannot load when loaded");i.loading=!0,i._openBackend().then((function(d){i.seekable=d.seekable,i.headers=d.headers,i.length=d.length,i.loaded=!0,i.loading=!1,l()})).catch((function(l){"AbortError"!==l.name&&(i.loading=!1),d(l)}))}))}},{key:"_openBackend",value:function _openBackend(){var i=this;return new Promise((function(l,d){if(i._backend)l(i._backend);else if(i.eof)d(new Error("cannot open at end of file"));else{var u=i._cache,c=i._chunkSize,p=u.bytesReadable(c),m=u.readOffset+p;if(u.seekWrite(m),i.length>=0&&m>=i.length)return void l(null);var g=i._clampToLength(u.writeOffset+u.bytesWritable(c))-u.writeOffset;if(0===g)l(null);else{var y=i._backend=new h({url:i.url,offset:i._cache.writeOffset,length:g,cachever:i._cachever,progressive:i.progressive}),_=null,v=function checkOpen(){y!==i._backend?(_(),d(new Error("invalid state"))):(y.on("buffer",(function(l){y===i._backend&&i._cache.write(l)})),y.on("done",(function(){y===i._backend&&(-1===i.length&&(i.length=i._backend.offset+i._backend.bytesRead),i._backend=null)})),l(y))},b=function checkError(l){y!==i._backend?d(new Error("invalid state")):(i._backend=null,d(l))};_=function oncomplete(){y.off("open",v),y.off("error",b)},y.on("open",v),y.on("error",b),y.on("cachever",(function(){i._cachever++})),y.load()}}}))}},{key:"_readAhead",value:function _readAhead(){var i=this;return new Promise((function(l,d){i._backend||i.eof?l():i._openBackend().then((function(){l()})).catch((function(i){d(i)}))}))}},{key:"seek",value:function seek(i){var l=this;return new Promise((function(d,u){if(!l.loaded||l.buffering||l.seeking)throw new Error("invalid state");if(i!==(0|i)||i<0)throw new Error("invalid input");if(l.length>=0&&i>l.length)throw new Error("seek past end of file");if(!l.seekable)throw new Error("seek on non-seekable stream");l._backend&&l.abort(),l._cache.seekRead(i),l._cache.seekWrite(i),l._readAhead().then(d).catch(u)}))}},{key:"read",value:function read(i){var l=this;return this.buffer(i).then((function(i){return l.readSync(i)}))}},{key:"readSync",value:function readSync(i){var l=this.bytesAvailable(i),d=new Uint8Array(l);if(this.readBytes(d)!==l)throw new Error("failed to read expected data");return d.buffer}},{key:"readBytes",value:function readBytes(i){if(!this.loaded||this.buffering||this.seeking)throw new Error("invalid state");if(!(i instanceof Uint8Array))throw new Error("invalid input");var l=this._cache.readBytes(i);return this._readAhead(),l}},{key:"buffer",value:function buffer(i){var l=this;return new Promise((function(d,u){if(!l.loaded||l.buffering||l.seeking)throw new Error("invalid state");if(i!==(0|i)||i<0)throw new Error("invalid input");var c=l._clampToLength(l.offset+i),h=c-l.offset,p=l.bytesAvailable(h);p>=h?d(p):(l.buffering=!0,l._openBackend().then((function(d){return d?d.bufferToOffset(c).then((function(){return l.buffering=!1,l.buffer(i)})):Promise.resolve(p)})).then((function(i){l.buffering=!1,d(i)})).catch((function(i){"AbortError"!==i.name&&(l.buffering=!1),u(i)})))}))}},{key:"bytesAvailable",value:function bytesAvailable(){return this._cache.bytesReadable(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0)}},{key:"abort",value:function abort(){this.loading&&(this.loading=!1),this.buffering&&(this.buffering=!1),this.seeking&&(this.seeking=!1),this._backend&&(this._backend.abort(),this._backend=null)}},{key:"getBufferedRanges",value:function getBufferedRanges(){return this._cache.ranges()}},{key:"_clampToLength",value:function _clampToLength(i){return this.length<0?i:Math.min(this.length,i)}}]),StreamFile}();i.exports=p},302:(i,l,d)=>{"use strict";d.r(l),d.d(l,{default:()=>u});const u="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU5LjE2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAAEEwCZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZ//////////////////////////////////////////////////////////////////8AAAAATGF2YzU5LjE4AAAAAAAAAAAAAAAAJAZAAAAAAAAABBMIw3vfAAAAAAAAAAAAAAAAAAAAAP/7kGQAD/AAAGkAAAAIAAANIAAAAQAAAaQAAAAgAAA0gAAABExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7kmRAj/AAAGkAAAAIAAANIAAAAQAAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU="},826:i=>{i.exports={vertex:"precision mediump float;\n\nattribute vec2 aPosition;\nattribute vec2 aLumaPosition;\nattribute vec2 aChromaPosition;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vLumaPosition = aLumaPosition;\n    vChromaPosition = aChromaPosition;\n}\n",fragment:"// inspired by https://github.com/mbebenita/Broadway/blob/master/Player/canvas.js\n\nprecision mediump float;\n\nuniform sampler2D uTextureY;\nuniform sampler2D uTextureCb;\nuniform sampler2D uTextureCr;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n   // Y, Cb, and Cr planes are uploaded as ALPHA textures.\n   float fY = texture2D(uTextureY, vLumaPosition).w;\n   float fCb = texture2D(uTextureCb, vChromaPosition).w;\n   float fCr = texture2D(uTextureCr, vChromaPosition).w;\n\n   // Premultipy the Y...\n   float fYmul = fY * 1.1643828125;\n\n   // And convert that to RGB!\n   gl_FragColor = vec4(\n     fYmul + 1.59602734375 * fCr - 0.87078515625,\n     fYmul - 0.39176171875 * fCb - 0.81296875 * fCr + 0.52959375,\n     fYmul + 2.017234375   * fCb - 1.081390625,\n     1\n   );\n}\n",vertexStripe:"precision mediump float;\n\nattribute vec2 aPosition;\nattribute vec2 aTexturePosition;\nvarying vec2 vTexturePosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vTexturePosition = aTexturePosition;\n}\n",fragmentStripe:"// extra 'stripe' texture fiddling to work around IE 11's poor performance on gl.LUMINANCE and gl.ALPHA textures\n\nprecision mediump float;\n\nuniform sampler2D uStripe;\nuniform sampler2D uTexture;\nvarying vec2 vTexturePosition;\nvoid main() {\n   // Y, Cb, and Cr planes are mapped into a pseudo-RGBA texture\n   // so we can upload them without expanding the bytes on IE 11\n   // which doesn't allow LUMINANCE or ALPHA textures\n   // The stripe textures mark which channel to keep for each pixel.\n   // Each texture extraction will contain the relevant value in one\n   // channel only.\n\n   float fLuminance = dot(\n      texture2D(uStripe, vTexturePosition),\n      texture2D(uTexture, vTexturePosition)\n   );\n\n   gl_FragColor = vec4(0, 0, 0, fLuminance);\n}\n"}},487:i=>{!function(){"use strict";function FrameSink(i,l){throw new Error("abstract")}FrameSink.prototype.drawFrame=function(i){throw new Error("abstract")},FrameSink.prototype.clear=function(){throw new Error("abstract")},i.exports=FrameSink}()},926:(i,l,d)=>{!function(){"use strict";var l=d(487),u=d(627);function SoftwareFrameSink(i){var l=this,d=i.getContext("2d"),c=null,h=null,p=null;return l.drawFrame=function drawFrame(l){var m=l.format;i.width===m.displayWidth&&i.height===m.displayHeight||(i.width=m.displayWidth,i.height=m.displayHeight),null!==c&&c.width==m.width&&c.height==m.height||function initImageData(i,l){for(var u=(c=d.createImageData(i,l)).data,h=i*l*4,p=0;p<h;p+=4)u[p+3]=255}(m.width,m.height),u.convertYCbCr(l,c.data);var g,y=m.cropWidth!=m.displayWidth||m.cropHeight!=m.displayHeight;y?(h||function initResampleCanvas(i,l){(h=document.createElement("canvas")).width=i,h.height=l,p=h.getContext("2d")}(m.cropWidth,m.cropHeight),g=p):g=d,g.putImageData(c,-m.cropLeft,-m.cropTop,m.cropLeft,m.cropTop,m.cropWidth,m.cropHeight),y&&d.drawImage(h,0,0,m.displayWidth,m.displayHeight)},l.clear=function(){d.clearRect(0,0,i.width,i.height)},l}SoftwareFrameSink.prototype=Object.create(l.prototype),i.exports=SoftwareFrameSink}()},895:(i,l,d)=>{!function(){"use strict";var l=d(487),u=d(826);function WebGLFrameSink(i){var l,d,c=this,h=WebGLFrameSink.contextForCanvas(i);if(null===h)throw new Error("WebGL unavailable");function compileShader(i,l){var d=h.createShader(i);if(h.shaderSource(d,l),h.compileShader(d),!h.getShaderParameter(d,h.COMPILE_STATUS)){var u=h.getShaderInfoLog(d);throw h.deleteShader(d),new Error("GL shader compilation for "+i+" failed: "+u)}return d}var p,m,g,y,_,v,b,T,S,E,k=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),w={},C={},x={};function createOrReuseTexture(i,l){return w[i]&&!l||(w[i]=h.createTexture()),w[i]}function uploadTexture(i,l,d,u,c){var p=!w[i]||l,m=createOrReuseTexture(i,l);if(h.activeTexture(h.TEXTURE0),WebGLFrameSink.stripe){var g=!w[i+"_temp"]||l,y=createOrReuseTexture(i+"_temp",l);h.bindTexture(h.TEXTURE_2D,y),g?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,d/4,u,0,h.RGBA,h.UNSIGNED_BYTE,c)):h.texSubImage2D(h.TEXTURE_2D,0,0,0,d/4,u,h.RGBA,h.UNSIGNED_BYTE,c);var _=w[i+"_stripe"],v=!_||l;v&&(_=createOrReuseTexture(i+"_stripe",l)),h.bindTexture(h.TEXTURE_2D,_),v&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,d,1,0,h.RGBA,h.UNSIGNED_BYTE,function buildStripe(i){if(x[i])return x[i];for(var l=i,d=new Uint32Array(l),u=0;u<l;u+=4)d[u]=255,d[u+1]=65280,d[u+2]=16711680,d[u+3]=4278190080;return x[i]=new Uint8Array(d.buffer)}(d)))}else h.bindTexture(h.TEXTURE_2D,m),p?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,d,u,0,h.ALPHA,h.UNSIGNED_BYTE,c)):h.texSubImage2D(h.TEXTURE_2D,0,0,0,d,u,h.ALPHA,h.UNSIGNED_BYTE,c)}function unpackTexture(i,l,u,c){var b=w[i];h.useProgram(d);var T=C[i];T&&!l||(h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,b),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,u,c,0,h.RGBA,h.UNSIGNED_BYTE,null),T=C[i]=h.createFramebuffer()),h.bindFramebuffer(h.FRAMEBUFFER,T),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,b,0);var S=w[i+"_temp"];h.activeTexture(h.TEXTURE1),h.bindTexture(h.TEXTURE_2D,S),h.uniform1i(v,1);var E=w[i+"_stripe"];h.activeTexture(h.TEXTURE2),h.bindTexture(h.TEXTURE_2D,E),h.uniform1i(_,2),h.bindBuffer(h.ARRAY_BUFFER,p),h.enableVertexAttribArray(m),h.vertexAttribPointer(m,2,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,g),h.enableVertexAttribArray(y),h.vertexAttribPointer(y,2,h.FLOAT,!1,0,0),h.viewport(0,0,u,c),h.drawArrays(h.TRIANGLES,0,k.length/2),h.bindFramebuffer(h.FRAMEBUFFER,null)}function attachTexture(i,d,u){h.activeTexture(d),h.bindTexture(h.TEXTURE_2D,w[i]),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.uniform1i(h.getUniformLocation(l,i),u)}function initProgram(i,l){var d=compileShader(h.VERTEX_SHADER,i),u=compileShader(h.FRAGMENT_SHADER,l),c=h.createProgram();if(h.attachShader(c,d),h.attachShader(c,u),h.linkProgram(c),!h.getProgramParameter(c,h.LINK_STATUS)){var p=h.getProgramInfoLog(c);throw h.deleteProgram(c),new Error("GL program linking failed: "+p)}return c}return c.drawFrame=function(w){var C=w.format,x=!l||i.width!==C.displayWidth||i.height!==C.displayHeight;if(x&&(i.width=C.displayWidth,i.height=C.displayHeight,c.clear()),l||function init(){if(WebGLFrameSink.stripe){d=initProgram(u.vertexStripe,u.fragmentStripe),h.getAttribLocation(d,"aPosition"),g=h.createBuffer();var i=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);h.bindBuffer(h.ARRAY_BUFFER,g),h.bufferData(h.ARRAY_BUFFER,i,h.STATIC_DRAW),y=h.getAttribLocation(d,"aTexturePosition"),_=h.getUniformLocation(d,"uStripe"),v=h.getUniformLocation(d,"uTexture")}l=initProgram(u.vertex,u.fragment),p=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,p),h.bufferData(h.ARRAY_BUFFER,k,h.STATIC_DRAW),m=h.getAttribLocation(l,"aPosition"),b=h.createBuffer(),T=h.getAttribLocation(l,"aLumaPosition"),S=h.createBuffer(),E=h.getAttribLocation(l,"aChromaPosition")}(),x){var setupTexturePosition=function(i,l,d){var u=C.cropLeft/d,c=(C.cropLeft+C.cropWidth)/d,p=(C.cropTop+C.cropHeight)/C.height,m=C.cropTop/C.height,g=new Float32Array([u,p,c,p,u,m,u,m,c,p,c,m]);h.bindBuffer(h.ARRAY_BUFFER,i),h.bufferData(h.ARRAY_BUFFER,g,h.STATIC_DRAW)};setupTexturePosition(b,0,w.y.stride),setupTexturePosition(S,0,w.u.stride*C.width/C.chromaWidth)}uploadTexture("uTextureY",x,w.y.stride,C.height,w.y.bytes),uploadTexture("uTextureCb",x,w.u.stride,C.chromaHeight,w.u.bytes),uploadTexture("uTextureCr",x,w.v.stride,C.chromaHeight,w.v.bytes),WebGLFrameSink.stripe&&(unpackTexture("uTextureY",x,w.y.stride,C.height),unpackTexture("uTextureCb",x,w.u.stride,C.chromaHeight),unpackTexture("uTextureCr",x,w.v.stride,C.chromaHeight)),h.useProgram(l),h.viewport(0,0,i.width,i.height),attachTexture("uTextureY",h.TEXTURE0,0),attachTexture("uTextureCb",h.TEXTURE1,1),attachTexture("uTextureCr",h.TEXTURE2,2),h.bindBuffer(h.ARRAY_BUFFER,p),h.enableVertexAttribArray(m),h.vertexAttribPointer(m,2,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,b),h.enableVertexAttribArray(T),h.vertexAttribPointer(T,2,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,S),h.enableVertexAttribArray(E),h.vertexAttribPointer(E,2,h.FLOAT,!1,0,0),h.drawArrays(h.TRIANGLES,0,k.length/2)},c.clear=function(){h.viewport(0,0,i.width,i.height),h.clearColor(0,0,0,0),h.clear(h.COLOR_BUFFER_BIT)},c.clear(),c}WebGLFrameSink.stripe=!1,WebGLFrameSink.contextForCanvas=function(i){var l={preferLowPowerToHighPerformance:!0,powerPreference:"low-power",failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0};return i.getContext("webgl",l)||i.getContext("experimental-webgl",l)},WebGLFrameSink.isAvailable=function(){var i,l=document.createElement("canvas");l.width=1,l.height=1;try{i=WebGLFrameSink.contextForCanvas(l)}catch(i){return!1}if(i){var d=i.TEXTURE0,u=i.createTexture(),c=new Uint8Array(16),h=WebGLFrameSink.stripe?1:4,p=WebGLFrameSink.stripe?i.RGBA:i.ALPHA,m=WebGLFrameSink.stripe?i.NEAREST:i.LINEAR;return i.activeTexture(d),i.bindTexture(i.TEXTURE_2D,u),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,m),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,m),i.texImage2D(i.TEXTURE_2D,0,p,h,4,0,p,i.UNSIGNED_BYTE,c),!i.getError()}return!1},WebGLFrameSink.prototype=Object.create(l.prototype),i.exports=WebGLFrameSink}()},627:(i,l,d)=>{!function(){"use strict";var l=d(877);i.exports={convertYCbCr:function convertYCbCr(i,d){var u=0|i.format.width,c=0|i.format.height,h=0|l(i.format.width/i.format.chromaWidth),p=0|l(i.format.height/i.format.chromaHeight),m=i.y.bytes,g=i.u.bytes,y=i.v.bytes,_=0|i.y.stride,v=0|i.u.stride,b=0|i.v.stride,T=u<<2,S=0,E=0,k=0,w=0,C=0,x=0,A=0,P=0,I=0,D=0,O=0,L=0,R=0,V=0,M=0,N=0,B=0,j=0;if(1==h&&1==p)for(A=0,P=T,j=0,N=0;N<c;N+=2){for(k=(E=N*_|0)+_|0,w=j*v|0,C=j*b|0,M=0;M<u;M+=2)I=0|g[w++],L=(409*(D=0|y[C++])|0)-57088|0,R=(100*I|0)+(208*D|0)-34816|0,V=(516*I|0)-70912|0,O=298*m[E++]|0,d[A]=O+L>>8,d[A+1]=O-R>>8,d[A+2]=O+V>>8,O=298*m[E++]|0,d[A+=4]=O+L>>8,d[A+1]=O-R>>8,d[A+2]=O+V>>8,A+=4,O=298*m[k++]|0,d[P]=O+L>>8,d[P+1]=O-R>>8,d[P+2]=O+V>>8,O=298*m[k++]|0,d[P+=4]=O+L>>8,d[P+1]=O-R>>8,d[P+2]=O+V>>8,P+=4;A+=T,P+=T,j++}else for(x=0,N=0;N<c;N++)for(B=0,S=N*_|0,w=(j=N>>p)*v|0,C=j*b|0,M=0;M<u;M++)I=0|g[w+(B=M>>h)],L=(409*(D=0|y[C+B])|0)-57088|0,R=(100*I|0)+(208*D|0)-34816|0,V=(516*I|0)-70912|0,O=298*m[S++]|0,d[x]=O+L>>8,d[x+1]=O-R>>8,d[x+2]=O+V>>8,x+=4}}}()},877:i=>{!function(){"use strict";i.exports=function depower(i){for(var l=0,d=i>>1;0!=d;)d>>=1,l++;if(i!==1<<l)throw"chroma plane dimensions must be power of 2 ratio to luma plane dimensions; got "+i;return l}}()},731:(i,l,d)=>{!function(){"use strict";var l=d(487),u=d(926),c=d(895),h={FrameSink:l,SoftwareFrameSink:u,WebGLFrameSink:c,attach:function(i,l){return("webGL"in(l=l||{})?l.webGL:c.isAvailable())?new c(i,l):new u(i,l)}};i.exports=h}()}},l={};function __nested_webpack_require_207848__(d){var u=l[d];if(void 0!==u)return u.exports;var c=l[d]={exports:{}};return i[d](c,c.exports,__nested_webpack_require_207848__),c.exports}__nested_webpack_require_207848__.d=(i,l)=>{for(var d in l)__nested_webpack_require_207848__.o(l,d)&&!__nested_webpack_require_207848__.o(i,d)&&Object.defineProperty(i,d,{enumerable:!0,get:l[d]})},__nested_webpack_require_207848__.o=(i,l)=>Object.prototype.hasOwnProperty.call(i,l),__nested_webpack_require_207848__.r=i=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var d={};return(()=>{"use strict";var i=d,l=__nested_webpack_require_207848__(318);Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"OGVCompat",{enumerable:!0,get:function get(){return c.default}}),Object.defineProperty(i,"OGVLoader",{enumerable:!0,get:function get(){return h.default}}),Object.defineProperty(i,"OGVMediaError",{enumerable:!0,get:function get(){return p.default}}),Object.defineProperty(i,"OGVMediaType",{enumerable:!0,get:function get(){return m.default}}),Object.defineProperty(i,"OGVPlayer",{enumerable:!0,get:function get(){return g.default}}),Object.defineProperty(i,"OGVTimeRanges",{enumerable:!0,get:function get(){return y.default}}),i.OGVVersion=void 0;var u=l(__nested_webpack_require_207848__(8)),c=l(__nested_webpack_require_207848__(523)),h=l(__nested_webpack_require_207848__(964)),p=l(__nested_webpack_require_207848__(759)),m=l(__nested_webpack_require_207848__(278)),g=l(__nested_webpack_require_207848__(869)),y=l(__nested_webpack_require_207848__(168)),_="1.9.0-20240423190513-22f6924";i.OGVVersion=_,"object"===("undefined"==typeof window?"undefined":(0,u.default)(window))&&(window.OGVCompat=c.default,window.OGVLoader=h.default,window.OGVMediaError=p.default,window.OGVMediaType=m.default,window.OGVTimeRanges=y.default,window.OGVPlayer=g.default,window.OGVVersion=_)})(),d})()}))},31400:(i,l,d)=>{i.exports=d(89997)},80509:(i,l,d)=>{var u=d(12843),c=i.exports={WebVTT:d(83042),VTTCue:d(70411),VTTRegion:d(29370)};u.vttjs=c,u.WebVTT=c.WebVTT;var h=c.VTTCue,p=c.VTTRegion,m=u.VTTCue,g=u.VTTRegion;c.shim=function(){u.VTTCue=h,u.VTTRegion=p},c.restore=function(){u.VTTCue=m,u.VTTRegion=g},u.VTTCue||c.shim()},83042:(i,l,d)=>{var u=d(90410),c=Object.create||function(){function F(){}return function(i){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return F.prototype=i,new F}}();function ParsingError(i,l){this.name="ParsingError",this.code=i.code,this.message=l||i.message}function parseTimeStamp(i){function computeSeconds(i,l,d,u){return 3600*(0|i)+60*(0|l)+(0|d)+(0|u)/1e3}var l=i.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return l?l[3]?computeSeconds(l[1],l[2],l[3].replace(":",""),l[4]):l[1]>59?computeSeconds(l[1],l[2],0,l[4]):computeSeconds(0,l[1],l[2],l[4]):null}function Settings(){this.values=c(null)}function parseOptions(i,l,d,u){var c=u?i.split(u):[i];for(var h in c)if("string"==typeof c[h]){var p=c[h].split(d);if(2===p.length)l(p[0].trim(),p[1].trim())}}function parseCue(i,l,d){var u=i;function consumeTimeStamp(){var l=parseTimeStamp(i);if(null===l)throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed timestamp: "+u);return i=i.replace(/^[^\sa-zA-Z-]+/,""),l}function skipWhitespace(){i=i.replace(/^\s+/,"")}if(skipWhitespace(),l.startTime=consumeTimeStamp(),skipWhitespace(),"--\x3e"!==i.substr(0,3))throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+u);i=i.substr(3),skipWhitespace(),l.endTime=consumeTimeStamp(),skipWhitespace(),function consumeCueSettings(i,l){var u=new Settings;parseOptions(i,(function(i,l){switch(i){case"region":for(var c=d.length-1;c>=0;c--)if(d[c].id===l){u.set(i,d[c].region);break}break;case"vertical":u.alt(i,l,["rl","lr"]);break;case"line":var h=l.split(","),p=h[0];u.integer(i,p),u.percent(i,p)&&u.set("snapToLines",!1),u.alt(i,p,["auto"]),2===h.length&&u.alt("lineAlign",h[1],["start","center","end"]);break;case"position":h=l.split(","),u.percent(i,h[0]),2===h.length&&u.alt("positionAlign",h[1],["start","center","end"]);break;case"size":u.percent(i,l);break;case"align":u.alt(i,l,["start","center","end","left","right"])}}),/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");try{l.line=u.get("line","auto")}catch(i){}l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100);try{l.align=u.get("align","center")}catch(i){l.align=u.get("align","middle")}try{l.position=u.get("position","auto")}catch(i){l.position=u.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},l.align)}l.positionAlign=u.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},l.align)}(i,l)}(ParsingError.prototype=c(Error.prototype)).constructor=ParsingError,ParsingError.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Settings.prototype={set:function(i,l){this.get(i)||""===l||(this.values[i]=l)},get:function(i,l,d){return d?this.has(i)?this.values[i]:l[d]:this.has(i)?this.values[i]:l},has:function(i){return i in this.values},alt:function(i,l,d){for(var u=0;u<d.length;++u)if(l===d[u]){this.set(i,l);break}},integer:function(i,l){/^-?\d+$/.test(l)&&this.set(i,parseInt(l,10))},percent:function(i,l){return!!(l.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(l=parseFloat(l))>=0&&l<=100)&&(this.set(i,l),!0)}};var h=u.createElement&&u.createElement("textarea"),p={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},m={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},g={v:"title",lang:"lang"},y={rt:"ruby"};function parseContent(i,l){function nextToken(){if(!l)return null;var i=l.match(/^([^<]*)(<[^>]*>?)?/);return function consume(i){return l=l.substr(i.length),i}(i[1]?i[1]:i[2])}function shouldAdd(i,l){return!y[l.localName]||y[l.localName]===i.localName}function createElement(l,d){var u=p[l];if(!u)return null;var c=i.document.createElement(u),h=g[l];return h&&d&&(c[h]=d.trim()),c}for(var d,u,c=i.document.createElement("div"),_=c,v=[];null!==(d=nextToken());)if("<"!==d[0])_.appendChild(i.document.createTextNode((h.innerHTML=u=d,u=h.textContent,h.textContent="",u)));else{if("/"===d[1]){v.length&&v[v.length-1]===d.substr(2).replace(">","")&&(v.pop(),_=_.parentNode);continue}var b,T=parseTimeStamp(d.substr(1,d.length-2));if(T){b=i.document.createProcessingInstruction("timestamp",T),_.appendChild(b);continue}var S=d.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!S)continue;if(!(b=createElement(S[1],S[3])))continue;if(!shouldAdd(_,b))continue;if(S[2]){var E=S[2].split(".");E.forEach((function(i){var l=/^bg_/.test(i),d=l?i.slice(3):i;m.hasOwnProperty(d)&&(b.style[l?"background-color":"color"]=m[d])})),b.className=E.join(" ")}v.push(S[1]),_.appendChild(b),_=b}return c}var _=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function isStrongRTLChar(i){for(var l=0;l<_.length;l++){var d=_[l];if(i>=d[0]&&i<=d[1])return!0}return!1}function determineBidi(i){var l=[],d="";if(!i||!i.childNodes)return"ltr";function pushNodes(i,l){for(var d=l.childNodes.length-1;d>=0;d--)i.push(l.childNodes[d])}function nextTextNode(i){if(!i||!i.length)return null;var l=i.pop(),d=l.textContent||l.innerText;if(d){var u=d.match(/^.*(\n|\r)/);return u?(i.length=0,u[0]):d}return"ruby"===l.tagName?nextTextNode(i):l.childNodes?(pushNodes(i,l),nextTextNode(i)):void 0}for(pushNodes(l,i);d=nextTextNode(l);)for(var u=0;u<d.length;u++)if(isStrongRTLChar(d.charCodeAt(u)))return"rtl";return"ltr"}function StyleBox(){}function CueStyleBox(i,l,d){StyleBox.call(this),this.cue=l,this.cueDiv=parseContent(i,l.text);var u={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===l.vertical?"horizontal-tb":"lr"===l.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(u,this.cueDiv),this.div=i.document.createElement("div"),u={direction:determineBidi(this.cueDiv),writingMode:""===l.vertical?"horizontal-tb":"lr"===l.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===l.align?"center":l.align,font:d.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(u),this.div.appendChild(this.cueDiv);var c=0;switch(l.positionAlign){case"start":case"line-left":c=l.position;break;case"center":c=l.position-l.size/2;break;case"end":case"line-right":c=l.position-l.size}this.applyStyles(""===l.vertical?{left:this.formatStyle(c,"%"),width:this.formatStyle(l.size,"%")}:{top:this.formatStyle(c,"%"),height:this.formatStyle(l.size,"%")}),this.move=function(i){this.applyStyles({top:this.formatStyle(i.top,"px"),bottom:this.formatStyle(i.bottom,"px"),left:this.formatStyle(i.left,"px"),right:this.formatStyle(i.right,"px"),height:this.formatStyle(i.height,"px"),width:this.formatStyle(i.width,"px")})}}function BoxPosition(i){var l,d,u,c;if(i.div){d=i.div.offsetHeight,u=i.div.offsetWidth,c=i.div.offsetTop;var h=(h=i.div.childNodes)&&(h=h[0])&&h.getClientRects&&h.getClientRects();i=i.div.getBoundingClientRect(),l=h?Math.max(h[0]&&h[0].height||0,i.height/h.length):0}this.left=i.left,this.right=i.right,this.top=i.top||c,this.height=i.height||d,this.bottom=i.bottom||c+(i.height||d),this.width=i.width||u,this.lineHeight=void 0!==l?l:i.lineHeight}function moveBoxToLinePosition(i,l,d,u){var c=new BoxPosition(l),h=l.cue,p=function computeLinePos(i){if("number"==typeof i.line&&(i.snapToLines||i.line>=0&&i.line<=100))return i.line;if(!i.track||!i.track.textTrackList||!i.track.textTrackList.mediaElement)return-1;for(var l=i.track,d=l.textTrackList,u=0,c=0;c<d.length&&d[c]!==l;c++)"showing"===d[c].mode&&u++;return-1*++u}(h),m=[];if(h.snapToLines){var g;switch(h.vertical){case"":m=["+y","-y"],g="height";break;case"rl":m=["+x","-x"],g="width";break;case"lr":m=["-x","+x"],g="width"}var y=c.lineHeight,_=y*Math.round(p),v=d[g]+y,b=m[0];Math.abs(_)>v&&(_=_<0?-1:1,_*=Math.ceil(v/y)*y),p<0&&(_+=""===h.vertical?d.height:d.width,m=m.reverse()),c.move(b,_)}else{var T=c.lineHeight/d.height*100;switch(h.lineAlign){case"center":p-=T/2;break;case"end":p-=T}switch(h.vertical){case"":l.applyStyles({top:l.formatStyle(p,"%")});break;case"rl":l.applyStyles({left:l.formatStyle(p,"%")});break;case"lr":l.applyStyles({right:l.formatStyle(p,"%")})}m=["+y","-x","+x","-y"],c=new BoxPosition(l)}var S=function findBestPosition(i,l){for(var c,h=new BoxPosition(i),p=1,m=0;m<l.length;m++){for(;i.overlapsOppositeAxis(d,l[m])||i.within(d)&&i.overlapsAny(u);)i.move(l[m]);if(i.within(d))return i;var g=i.intersectPercentage(d);p>g&&(c=new BoxPosition(i),p=g),i=new BoxPosition(h)}return c||h}(c,m);l.move(S.toCSSCompatValues(d))}function WebVTT(){}StyleBox.prototype.applyStyles=function(i,l){for(var d in l=l||this.div,i)i.hasOwnProperty(d)&&(l.style[d]=i[d])},StyleBox.prototype.formatStyle=function(i,l){return 0===i?0:i+l},(CueStyleBox.prototype=c(StyleBox.prototype)).constructor=CueStyleBox,BoxPosition.prototype.move=function(i,l){switch(l=void 0!==l?l:this.lineHeight,i){case"+x":this.left+=l,this.right+=l;break;case"-x":this.left-=l,this.right-=l;break;case"+y":this.top+=l,this.bottom+=l;break;case"-y":this.top-=l,this.bottom-=l}},BoxPosition.prototype.overlaps=function(i){return this.left<i.right&&this.right>i.left&&this.top<i.bottom&&this.bottom>i.top},BoxPosition.prototype.overlapsAny=function(i){for(var l=0;l<i.length;l++)if(this.overlaps(i[l]))return!0;return!1},BoxPosition.prototype.within=function(i){return this.top>=i.top&&this.bottom<=i.bottom&&this.left>=i.left&&this.right<=i.right},BoxPosition.prototype.overlapsOppositeAxis=function(i,l){switch(l){case"+x":return this.left<i.left;case"-x":return this.right>i.right;case"+y":return this.top<i.top;case"-y":return this.bottom>i.bottom}},BoxPosition.prototype.intersectPercentage=function(i){return Math.max(0,Math.min(this.right,i.right)-Math.max(this.left,i.left))*Math.max(0,Math.min(this.bottom,i.bottom)-Math.max(this.top,i.top))/(this.height*this.width)},BoxPosition.prototype.toCSSCompatValues=function(i){return{top:this.top-i.top,bottom:i.bottom-this.bottom,left:this.left-i.left,right:i.right-this.right,height:this.height,width:this.width}},BoxPosition.getSimpleBoxPosition=function(i){var l=i.div?i.div.offsetHeight:i.tagName?i.offsetHeight:0,d=i.div?i.div.offsetWidth:i.tagName?i.offsetWidth:0,u=i.div?i.div.offsetTop:i.tagName?i.offsetTop:0;return{left:(i=i.div?i.div.getBoundingClientRect():i.tagName?i.getBoundingClientRect():i).left,right:i.right,top:i.top||u,height:i.height||l,bottom:i.bottom||u+(i.height||l),width:i.width||d}},WebVTT.StringDecoder=function(){return{decode:function(i){if(!i)return"";if("string"!=typeof i)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(i))}}},WebVTT.convertCueToDOMTree=function(i,l){return i&&l?parseContent(i,l):null};WebVTT.processCues=function(i,l,d){if(!i||!l||!d)return null;for(;d.firstChild;)d.removeChild(d.firstChild);var u=i.document.createElement("div");if(u.style.position="absolute",u.style.left="0",u.style.right="0",u.style.top="0",u.style.bottom="0",u.style.margin="1.5%",d.appendChild(u),function shouldCompute(i){for(var l=0;l<i.length;l++)if(i[l].hasBeenReset||!i[l].displayState)return!0;return!1}(l)){var c=[],h=BoxPosition.getSimpleBoxPosition(u),p={font:Math.round(.05*h.height*100)/100+"px sans-serif"};!function(){for(var d,m,g=0;g<l.length;g++)d=new CueStyleBox(i,m=l[g],p),u.appendChild(d.div),moveBoxToLinePosition(0,d,h,c),m.displayState=d.div,c.push(BoxPosition.getSimpleBoxPosition(d))}()}else for(var m=0;m<l.length;m++)u.appendChild(l[m].displayState)},(WebVTT.Parser=function(i,l,d){d||(d=l,l={}),l||(l={}),this.window=i,this.vttjs=l,this.state="INITIAL",this.buffer="",this.decoder=d||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(i){if(!(i instanceof ParsingError))throw i;this.onparsingerror&&this.onparsingerror(i)},parse:function(i){var l=this;function collectNextLine(){for(var i=l.buffer,d=0;d<i.length&&"\r"!==i[d]&&"\n"!==i[d];)++d;var u=i.substr(0,d);return"\r"===i[d]&&++d,"\n"===i[d]&&++d,l.buffer=i.substr(d),u}function parseHeader(i){i.match(/X-TIMESTAMP-MAP/)?parseOptions(i,(function(i,d){if("X-TIMESTAMP-MAP"===i)!function parseTimestampMap(i){var d=new Settings;parseOptions(i,(function(i,l){switch(i){case"MPEGT":d.integer(i+"S",l);break;case"LOCA":d.set(i+"L",parseTimeStamp(l))}}),/[^\d]:/,/,/),l.ontimestampmap&&l.ontimestampmap({MPEGTS:d.get("MPEGTS"),LOCAL:d.get("LOCAL")})}(d)}),/=/):parseOptions(i,(function(i,d){if("Region"===i)!function parseRegion(i){var d=new Settings;if(parseOptions(i,(function(i,l){switch(i){case"id":d.set(i,l);break;case"width":d.percent(i,l);break;case"lines":d.integer(i,l);break;case"regionanchor":case"viewportanchor":var u=l.split(",");if(2!==u.length)break;var c=new Settings;if(c.percent("x",u[0]),c.percent("y",u[1]),!c.has("x")||!c.has("y"))break;d.set(i+"X",c.get("x")),d.set(i+"Y",c.get("y"));break;case"scroll":d.alt(i,l,["up"])}}),/=/,/\s/),d.has("id")){var u=new(l.vttjs.VTTRegion||l.window.VTTRegion);u.width=d.get("width",100),u.lines=d.get("lines",3),u.regionAnchorX=d.get("regionanchorX",0),u.regionAnchorY=d.get("regionanchorY",100),u.viewportAnchorX=d.get("viewportanchorX",0),u.viewportAnchorY=d.get("viewportanchorY",100),u.scroll=d.get("scroll",""),l.onregion&&l.onregion(u),l.regionList.push({id:d.get("id"),region:u})}}(d)}),/:/)}i&&(l.buffer+=l.decoder.decode(i,{stream:!0}));try{var d;if("INITIAL"===l.state){if(!/\r\n|\n/.test(l.buffer))return this;var u=(d=collectNextLine()).match(/^WEBVTT([ \t].*)?$/);if(!u||!u[0])throw new ParsingError(ParsingError.Errors.BadSignature);l.state="HEADER"}for(var c=!1;l.buffer;){if(!/\r\n|\n/.test(l.buffer))return this;switch(c?c=!1:d=collectNextLine(),l.state){case"HEADER":/:/.test(d)?parseHeader(d):d||(l.state="ID");continue;case"NOTE":d||(l.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(d)){l.state="NOTE";break}if(!d)continue;l.cue=new(l.vttjs.VTTCue||l.window.VTTCue)(0,0,"");try{l.cue.align="center"}catch(i){l.cue.align="middle"}if(l.state="CUE",-1===d.indexOf("--\x3e")){l.cue.id=d;continue}case"CUE":try{parseCue(d,l.cue,l.regionList)}catch(i){l.reportOrThrowError(i),l.cue=null,l.state="BADCUE";continue}l.state="CUETEXT";continue;case"CUETEXT":var h=-1!==d.indexOf("--\x3e");if(!d||h&&(c=!0)){l.oncue&&l.oncue(l.cue),l.cue=null,l.state="ID";continue}l.cue.text&&(l.cue.text+="\n"),l.cue.text+=d.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":d||(l.state="ID");continue}}}catch(i){l.reportOrThrowError(i),"CUETEXT"===l.state&&l.cue&&l.oncue&&l.oncue(l.cue),l.cue=null,l.state="INITIAL"===l.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var i=this;try{if(i.buffer+=i.decoder.decode(),(i.cue||"HEADER"===i.state)&&(i.buffer+="\n\n",i.parse()),"INITIAL"===i.state)throw new ParsingError(ParsingError.Errors.BadSignature)}catch(l){i.reportOrThrowError(l)}return i.onflush&&i.onflush(),this}},i.exports=WebVTT},70411:i=>{var l={"":1,lr:1,rl:1},d={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function findAlignSetting(i){return"string"==typeof i&&(!!d[i.toLowerCase()]&&i.toLowerCase())}function VTTCue(i,d,u){this.hasBeenReset=!1;var c="",h=!1,p=i,m=d,g=u,y=null,_="",v=!0,b="auto",T="start",S="auto",E="auto",k=100,w="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return c},set:function(i){c=""+i}},pauseOnExit:{enumerable:!0,get:function(){return h},set:function(i){h=!!i}},startTime:{enumerable:!0,get:function(){return p},set:function(i){if("number"!=typeof i)throw new TypeError("Start time must be set to a number.");p=i,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return m},set:function(i){if("number"!=typeof i)throw new TypeError("End time must be set to a number.");m=i,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return g},set:function(i){g=""+i,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return y},set:function(i){y=i,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return _},set:function(i){var d=function findDirectionSetting(i){return"string"==typeof i&&!!l[i.toLowerCase()]&&i.toLowerCase()}(i);if(!1===d)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");_=d,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return v},set:function(i){v=!!i,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return b},set:function(i){if("number"!=typeof i&&"auto"!==i)throw new SyntaxError("Line: an invalid number or illegal string was specified.");b=i,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return T},set:function(i){var l=findAlignSetting(i);l?(T=l,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return S},set:function(i){if(i<0||i>100)throw new Error("Position must be between 0 and 100.");S=i,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return E},set:function(i){var l=findAlignSetting(i);l?(E=l,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return k},set:function(i){if(i<0||i>100)throw new Error("Size must be between 0 and 100.");k=i,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return w},set:function(i){var l=findAlignSetting(i);if(!l)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");w=l,this.hasBeenReset=!0}}}),this.displayState=void 0}VTTCue.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},i.exports=VTTCue},29370:i=>{var l={"":!0,up:!0};function isValidPercentValue(i){return"number"==typeof i&&i>=0&&i<=100}i.exports=function VTTRegion(){var i=100,d=3,u=0,c=100,h=0,p=100,m="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return i},set:function(l){if(!isValidPercentValue(l))throw new Error("Width must be between 0 and 100.");i=l}},lines:{enumerable:!0,get:function(){return d},set:function(i){if("number"!=typeof i)throw new TypeError("Lines must be set to a number.");d=i}},regionAnchorY:{enumerable:!0,get:function(){return c},set:function(i){if(!isValidPercentValue(i))throw new Error("RegionAnchorX must be between 0 and 100.");c=i}},regionAnchorX:{enumerable:!0,get:function(){return u},set:function(i){if(!isValidPercentValue(i))throw new Error("RegionAnchorY must be between 0 and 100.");u=i}},viewportAnchorY:{enumerable:!0,get:function(){return p},set:function(i){if(!isValidPercentValue(i))throw new Error("ViewportAnchorY must be between 0 and 100.");p=i}},viewportAnchorX:{enumerable:!0,get:function(){return h},set:function(i){if(!isValidPercentValue(i))throw new Error("ViewportAnchorX must be between 0 and 100.");h=i}},scroll:{enumerable:!0,get:function(){return m},set:function(i){var d=function findScrollSetting(i){return"string"==typeof i&&!!l[i.toLowerCase()]&&i.toLowerCase()}(i);!1===d?console.warn("Scroll: an invalid or illegal string was specified."):m=d}}})}},80542:()=>{},94634:i=>{function _extends(){return i.exports=_extends=Object.assign?Object.assign.bind():function(i){for(var l=1;l<arguments.length;l++){var d=arguments[l];for(var u in d)({}).hasOwnProperty.call(d,u)&&(i[u]=d[u])}return i},i.exports.__esModule=!0,i.exports.default=i.exports,_extends.apply(null,arguments)}i.exports=_extends,i.exports.__esModule=!0,i.exports.default=i.exports}}]);