"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[33695],{33695:(e,n,t)=>{t.r(n),t.d(n,{default:()=>I});var o=t(10467),a=t(55554),c=t(8014),r=t(41094),g=t(79555),i=t(10883),s=t(15324),l=t(24742),_=t(22693),h=t(44426),C=t(52749),d=t(25572),u=t(86654),P=t(20871),f=t(75357),O=t(54438),M=t(60177),p=t(2910),m=t(16986),T=t(64422),b=t(7570),z=t(88246),S=t(73955);const _c0=e=>({$a:e});function CoreTagSearchPage_ion_col_19_ion_select_option_5_Template(e,n){if(1&e&&(O.j41(0,"ion-select-option",14),O.EFF(1),O.k0s()),2&e){const e=n.$implicit;O.Y8G("value",e.id),O.R7$(),O.SpI(" ",e.name,"")}}function CoreTagSearchPage_ion_col_19_Template(e,n){if(1&e){const e=O.RV6();O.j41(0,"ion-col",7)(1,"core-combobox",13),O.bIt("onChange",(function CoreTagSearchPage_ion_col_19_Template_core_combobox_onChange_1_listener(n){O.eBV(e);const t=O.XpG();return O.Njj(t.searchTags(t.query,n))})),O.j41(2,"ion-select-option",14),O.EFF(3),O.nI1(4,"translate"),O.k0s(),O.DNE(5,CoreTagSearchPage_ion_col_19_ion_select_option_5_Template,2,2,"ion-select-option",15),O.k0s()()}if(2&e){const e=O.XpG();O.R7$(),O.Y8G("selection",e.collectionId)("disabled",e.searching),O.R7$(),O.Y8G("value",0),O.R7$(),O.SpI(" ",O.bMT(4,5,"core.tag.inalltagcoll")," "),O.R7$(2),O.Y8G("ngForOf",e.collections)}}function CoreTagSearchPage_core_empty_box_21_Template(e,n){if(1&e&&(O.nrm(0,"core-empty-box",16),O.nI1(1,"translate")),2&e){const e=O.XpG();O.Y8G("message",O.i5U(1,1,"core.tag.notagsfound",O.eq3(4,_c0,e.query)))}}function CoreTagSearchPage_ng_container_22_ion_badge_2_Template(e,n){if(1&e){const e=O.RV6();O.j41(0,"ion-badge",20),O.bIt("click",(function CoreTagSearchPage_ng_container_22_ion_badge_2_Template_ion_badge_click_0_listener(){const n=O.eBV(e).$implicit,t=O.XpG(2);return O.Njj(t.openTag(n))})),O.j41(1,"span"),O.EFF(2),O.k0s()()}if(2&e){const e=n.$implicit;O.R7$(),O.HbH("size"+e.size),O.R7$(),O.JRh(e.name)}}function CoreTagSearchPage_ng_container_22_p_3_Template(e,n){if(1&e&&(O.j41(0,"p",21),O.EFF(1),O.nI1(2,"translate"),O.k0s()),2&e){const e=O.XpG(2);O.R7$(),O.SpI(" ",O.i5U(2,1,"core.tag.showingfirsttags",O.eq3(4,_c0,e.cloud.tags.length))," ")}}function CoreTagSearchPage_ng_container_22_Template(e,n){if(1&e&&(O.qex(0),O.j41(1,"div",17),O.DNE(2,CoreTagSearchPage_ng_container_22_ion_badge_2_Template,3,3,"ion-badge",18),O.k0s(),O.DNE(3,CoreTagSearchPage_ng_container_22_p_3_Template,3,6,"p",19),O.bVm()),2&e){const e=O.XpG();O.R7$(2),O.Y8G("ngForOf",e.cloud.tags),O.R7$(),O.Y8G("ngIf",e.cloud.tags.length<e.cloud.totalcount)}}let I=(()=>{var e;class CoreTagSearchPage{constructor(){this.collections=[],this.loaded=!1,this.searching=!1,this.logView=l.j.once((0,o.A)((function*(){_.OF.logEvent({type:_.qr.VIEW_ITEM_LIST,ws:"core_tag_get_tag_cloud",name:g.HT.instant("core.tag.searchtags"),data:{category:"tag"},url:"/tag/search.php"})})))}ngOnInit(){this.collectionId=s.CoreNavigator.getRouteNumberParam("collectionId")||0,this.query=s.CoreNavigator.getRouteParam("query")||"",C.CoreSites.loginNavigationFinished(),this.fetchData().finally((()=>{this.loaded=!0}))}fetchData(){var e=this;return(0,o.A)((function*(){try{yield Promise.all([e.fetchCollections(),e.fetchTags()]),e.query||e.logView()}catch(e){d.CoreAlerts.showError(e,{default:"Error loading tags."})}}))()}fetchCollections(){var e=this;return(0,o.A)((function*(){const n=yield r.CoreTag.getTagCollections();n.forEach((e=>{!e.name&&e.isdefault&&(e.name=g.HT.instant("core.tag.defautltagcoll"))})),e.collections=n}))()}fetchTags(){var e=this;return(0,o.A)((function*(){var n;e.cloud=yield r.CoreTag.getTagCloud(e.collectionId,void 0,void 0,e.query),null===(n=e.logSearch)||void 0===n||n.call(e)}))()}openTag(e){const n=c.F.decodeURI(e.viewurl);i.CoreContentLinksHelper.handleLink(n)}refreshData(e){a.g.allPromises([r.CoreTag.invalidateTagCollections(),r.CoreTag.invalidateTagCloud(this.collectionId,void 0,void 0,this.query)]).finally((()=>this.fetchData().finally((()=>{null==e||e.complete()}))))}searchTags(e,n){return this.searching=!0,this.query=e,void 0!==n&&(this.collectionId=n),this.logSearch=l.j.once((()=>this.performLogSearch())),h.p.close(),this.fetchTags().catch((e=>{d.CoreAlerts.showError(e,{default:"Error loading tags."})})).finally((()=>{this.searching=!1}))}performLogSearch(){var e=this;return(0,o.A)((function*(){e.query&&_.OF.logEvent({type:_.qr.VIEW_ITEM_LIST,ws:"core_tag_get_tag_cloud",name:g.HT.instant("core.tag.searchtags"),data:{category:"tag"},url:`/tag/search.php&query=${e.query}&tc=${e.collectionId}&go=${g.HT.instant("core.search")}`})}))()}}return(e=CoreTagSearchPage).ɵfac=function CoreTagSearchPage_Factory(n){return new(n||e)},e.ɵcmp=O.VBU({type:e,selectors:[["page-core-tag-search"]],standalone:!0,features:[O.aNF],decls:23,vars:20,consts:[["slot","start"],[3,"text"],["slot","end"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[1,"safe-area-padding"],[1,"ion-no-padding","ion-wrap"],["size","12","size-sm","6",1,"ion-no-padding"],["autocorrect","off","searchArea","CoreTag",3,"onSubmit","onClear","initialSearch","disabled","spellcheck","autoFocus","lengthCheck"],["class","ion-no-padding","size","12","size-sm","6",4,"ngIf"],[3,"hideUntil"],["icon","fas-tags","role","alert",3,"message",4,"ngIf"],[4,"ngIf"],[3,"onChange","selection","disabled"],[1,"ion-text-wrap",3,"value"],["class","ion-text-wrap",3,"value",4,"ngFor","ngForOf"],["icon","fas-tags","role","alert",3,"message"],[1,"ion-text-center","core-tag-cloud"],["class","ion-text-wrap",3,"click",4,"ngFor","ngForOf"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-wrap",3,"click"],[1,"ion-text-center"]],template:function CoreTagSearchPage_Template(e,n){1&e&&(O.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),O.nrm(3,"ion-back-button",1),O.nI1(4,"translate"),O.k0s(),O.j41(5,"ion-title")(6,"h1"),O.EFF(7),O.nI1(8,"translate"),O.k0s()(),O.j41(9,"ion-buttons",2),O.nrm(10,"core-user-menu-button"),O.k0s()()(),O.j41(11,"ion-content")(12,"ion-refresher",3),O.bIt("ionRefresh",(function CoreTagSearchPage_Template_ion_refresher_ionRefresh_12_listener(e){return n.refreshData(e.target)})),O.nrm(13,"ion-refresher-content",4),O.nI1(14,"translate"),O.k0s(),O.j41(15,"ion-grid",5)(16,"ion-row",6)(17,"ion-col",7)(18,"core-search-box",8),O.bIt("onSubmit",(function CoreTagSearchPage_Template_core_search_box_onSubmit_18_listener(e){return n.searchTags(e)}))("onClear",(function CoreTagSearchPage_Template_core_search_box_onClear_18_listener(){return n.searchTags("")})),O.k0s()(),O.DNE(19,CoreTagSearchPage_ion_col_19_Template,6,7,"ion-col",9),O.k0s()(),O.j41(20,"core-loading",10),O.DNE(21,CoreTagSearchPage_core_empty_box_21_Template,2,6,"core-empty-box",11)(22,CoreTagSearchPage_ng_container_22_Template,4,2,"ng-container",12),O.k0s()()),2&e&&(O.R7$(3),O.Y8G("text",O.bMT(4,14,"core.back")),O.R7$(4),O.JRh(O.bMT(8,16,"core.tag.searchtags")),O.R7$(5),O.Y8G("disabled",!n.loaded),O.R7$(),O.FS9("pullingText",O.bMT(14,18,"core.pulltorefresh")),O.R7$(4),O.BMQ("col-sm-6",n.collections&&n.collections.length>1?"":null),O.R7$(),O.Y8G("initialSearch",n.query)("disabled",n.searching)("spellcheck",!1)("autoFocus",!1)("lengthCheck",1),O.R7$(),O.Y8G("ngIf",n.collections&&n.collections.length>1),O.R7$(),O.Y8G("hideUntil",n.loaded&&!n.searching),O.R7$(),O.Y8G("ngIf",!n.cloud||!n.cloud.tags||!n.cloud.tags.length),O.R7$(),O.Y8G("ngIf",n.cloud&&n.cloud.tags&&n.cloud.tags.length>0))},dependencies:[u.n,M.Sq,M.bT,p.In,p.QW,p.hU,p.W9,p.lO,p.eU,p.To,p.Ki,p.ln,p.Ip,p.BC,p.ai,p.el,m.h,T.R,b._,z.i,S.D9,P.U,f.CoreSearchBoxComponent],styles:["[_nghost-%COMP%]   core-search-box[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:100%!important;margin:0!important}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{margin:8px;cursor:pointer}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size20[_ngcontent-%COMP%]{font-size:3.4rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size19[_ngcontent-%COMP%]{font-size:3.3rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size18[_ngcontent-%COMP%]{font-size:3.2rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size17[_ngcontent-%COMP%]{font-size:3.1rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size16[_ngcontent-%COMP%]{font-size:3rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size15[_ngcontent-%COMP%]{font-size:2.9rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size14[_ngcontent-%COMP%]{font-size:2.8rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size13[_ngcontent-%COMP%]{font-size:2.7rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size12[_ngcontent-%COMP%]{font-size:2.6rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size11[_ngcontent-%COMP%]{font-size:2.5rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size10[_ngcontent-%COMP%]{font-size:2.4rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size9[_ngcontent-%COMP%]{font-size:2.3rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size8[_ngcontent-%COMP%]{font-size:2.2rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size7[_ngcontent-%COMP%]{font-size:2.1rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size6[_ngcontent-%COMP%]{font-size:2rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size5[_ngcontent-%COMP%]{font-size:1.9rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size4[_ngcontent-%COMP%]{font-size:1.8rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size3[_ngcontent-%COMP%]{font-size:1.7rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size2[_ngcontent-%COMP%]{font-size:1.6rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size1[_ngcontent-%COMP%]{font-size:1.5rem}[_nghost-%COMP%]   .core-tag-cloud[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   .size0[_ngcontent-%COMP%]{font-size:1.4rem}"]}),CoreTagSearchPage})()}}]);