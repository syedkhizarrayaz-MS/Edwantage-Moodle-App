"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1140],{1140:(e,t,o)=>{o.r(t),o.d(t,{default:()=>b});var n=o(10467),i=o(29492),r=o(79555),c=o(15324),s=o(75629),a=o(71852),l=o(74094),u=o(2401),p=o(83696),d=o(22693),m=o(52749),g=o(24742),h=o(25572),f=o(86654),_=o(54438),C=o(60177),I=o(2910),v=o(64422),y=o(58197),R=o(88246),S=o(73955);function AddonCompetencyCompetenciesPage_ion_item_15_ion_badge_6_Template(e,t){if(1&e&&(_.j41(0,"ion-badge",10),_.EFF(1),_.k0s()),2&e){const e=_.XpG().$implicit;_.Y8G("color",e.usercompetency.proficiency?"success":"danger"),_.R7$(),_.SpI(" ",e.usercompetency.gradename," ")}}function AddonCompetencyCompetenciesPage_ion_item_15_ion_badge_7_Template(e,t){if(1&e&&(_.j41(0,"ion-badge",10),_.EFF(1),_.k0s()),2&e){const e=_.XpG().$implicit;_.Y8G("color",e.usercompetencycourse.proficiency?"success":"danger"),_.R7$(),_.SpI(" ",e.usercompetencycourse.gradename," ")}}function AddonCompetencyCompetenciesPage_ion_item_15_Template(e,t){if(1&e){const e=_.RV6();_.j41(0,"ion-item",7),_.bIt("click",(function AddonCompetencyCompetenciesPage_ion_item_15_Template_ion_item_click_0_listener(){const t=_.eBV(e).$implicit,o=_.XpG();return _.Njj(o.competencies.select(t))})),_.j41(1,"ion-label")(2,"p",8),_.nrm(3,"core-format-text",2),_.j41(4,"em"),_.EFF(5),_.k0s()()(),_.DNE(6,AddonCompetencyCompetenciesPage_ion_item_15_ion_badge_6_Template,2,2,"ion-badge",9)(7,AddonCompetencyCompetenciesPage_ion_item_15_ion_badge_7_Template,2,2,"ion-badge",9),_.k0s()}if(2&e){const e=t.$implicit,o=_.XpG();_.Y8G("detail",!0),_.BMQ("aria-label",e.competency.shortname)("aria-current",o.competencies.getItemAriaCurrent(e)),_.R7$(3),_.Y8G("text",e.competency.shortname)("contextLevel",o.contextLevel)("contextInstanceId",o.contextInstanceId),_.R7$(2),_.JRh(e.competency.idnumber),_.R7$(),_.Y8G("ngIf",e.usercompetency),_.R7$(),_.Y8G("ngIf",e.usercompetencycourse)}}let b=(()=>{var e;class AddonCompetencyCompetenciesPage{constructor(){this.title="";const e=c.CoreNavigator.getRouteNumberParam("planId");if(this.logView=g.j.once((()=>this.performLogView())),!e){const e=c.CoreNavigator.getRequiredRouteNumberParam("courseId"),t=c.CoreNavigator.getRouteNumberParam("userId"),o=p.u.getOrCreateSource(l.L,[e,t]);return this.competencies=new u.R(o,AddonCompetencyCompetenciesPage),void 0}const t=p.u.getOrCreateSource(a.P,[e]);this.competencies=new u.R(t,AddonCompetencyCompetenciesPage)}ngAfterViewInit(){var e=this;return(0,n.A)((function*(){yield e.fetchCompetencies(),e.competencies.start(e.splitView)}))()}fetchCompetencies(){var e=this;return(0,n.A)((function*(){try{const o=e.competencies.getSource();if(yield e.competencies.load(),o instanceof a.P){var t;if(!o.plan||o.plan&&o.plan.competencycount<=0)throw new s.CoreError(r.HT.instant("addon.competency.errornocompetenciesfound"));e.title=o.plan.plan.name,e.contextLevel="user",e.contextInstanceId=(null===(t=o.user)||void 0===t?void 0:t.id)||o.plan.plan.userid}else e.title=r.HT.instant("addon.competency.coursecompetencies"),e.contextLevel="course",e.contextInstanceId=o.COURSE_ID;e.logView()}catch(e){h.CoreAlerts.showError(e,{default:"Error getting competencies data."})}}))()}refreshCompetencies(e){var t=this;return(0,n.A)((function*(){yield t.competencies.getSource().invalidateCache(),t.competencies.getSource().setDirty(!0),t.fetchCompetencies().finally((()=>{null==e||e.complete()}))}))()}ngOnDestroy(){this.competencies.destroy()}performLogView(){const e=this.competencies.getSource();if(e instanceof a.P)return d.OF.logEvent({type:d.qr.VIEW_ITEM_LIST,ws:"tool_lp_data_for_plan_page",name:this.title,data:{category:"competency",planid:e.PLAN_ID},url:`/admin/tool/lp/plan.php?id=${e.PLAN_ID}`}),void 0;e.USER_ID&&e.USER_ID!==m.CoreSites.getCurrentSiteUserId()||d.OF.logEvent({type:d.qr.VIEW_ITEM_LIST,ws:"tool_lp_data_for_course_competencies_page",name:this.title,data:{category:"competency",courseid:e.COURSE_ID},url:`/admin/tool/lp/coursecompetencies.php?courseid=${e.COURSE_ID}`})}}return(e=AddonCompetencyCompetenciesPage).ɵfac=function AddonCompetencyCompetenciesPage_Factory(t){return new(t||e)},e.ɵcmp=_.VBU({type:e,selectors:[["page-addon-competency-competencies"]],viewQuery:function AddonCompetencyCompetenciesPage_Query(e,t){if(1&e&&_.GBs(i.M,5),2&e){let e;_.mGM(e=_.lsd())&&(t.splitView=e.first)}},standalone:!0,features:[_.aNF],decls:16,vars:12,consts:[["slot","start"],[3,"text"],[3,"text","contextLevel","contextInstanceId"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"click","detail"],[1,"item-heading"],["slot","end",3,"color",4,"ngIf"],["slot","end",3,"color"]],template:function AddonCompetencyCompetenciesPage_Template(e,t){1&e&&(_.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),_.nrm(3,"ion-back-button",1),_.nI1(4,"translate"),_.k0s(),_.j41(5,"ion-title")(6,"h1"),_.nrm(7,"core-format-text",2),_.k0s()()()(),_.j41(8,"ion-content")(9,"core-split-view")(10,"ion-refresher",3),_.bIt("ionRefresh",(function AddonCompetencyCompetenciesPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshCompetencies(e.target)})),_.nrm(11,"ion-refresher-content",4),_.nI1(12,"translate"),_.k0s(),_.j41(13,"core-loading",5)(14,"ion-list"),_.DNE(15,AddonCompetencyCompetenciesPage_ion_item_15_Template,8,9,"ion-item",6),_.k0s()()()()),2&e&&(_.R7$(3),_.Y8G("text",_.bMT(4,8,"core.back")),_.R7$(4),_.Y8G("text",t.title)("contextLevel",t.contextLevel)("contextInstanceId",t.contextInstanceId),_.R7$(3),_.Y8G("disabled",!t.competencies.loaded),_.R7$(),_.FS9("pullingText",_.bMT(12,10,"core.pulltorefresh")),_.R7$(2),_.Y8G("hideUntil",t.competencies.loaded),_.R7$(2),_.Y8G("ngForOf",t.competencies.items))},dependencies:[f.n,C.Sq,C.bT,I.In,I.QW,I.W9,I.eU,I.uz,I.he,I.nf,I.To,I.Ki,I.BC,I.ai,I.el,v.R,i.M,y.B,R.i,S.D9],encapsulation:2}),AddonCompetencyCompetenciesPage})()},2401:(e,t,o)=>{o.d(t,{R:()=>CoreListItemsManager});var n=o(10467),i=o(21182),r=o(15324),c=o(93417),s=o(81690),a=o(95990),l=o(82907),u=o(24742),p=o(55554);class CoreListItemsManager extends a.u{constructor(e,t){super(e);const o=s.j.debounce((()=>this.scrollToCurrentElement()),300);this.pageRouteLocator=t,this.addListener({onSelectedItemUpdated:o}),this.finishSuccessfulFetch=u.j.once((()=>p.g.ignoreErrors(this.logActivity())))}get items(){return this.getSource().getItems()||[]}get loaded(){return null!==this.itemsMap}get completed(){return this.getSource().isCompleted()}get empty(){const e=this.getSource().getItems();return null===e||0===e.length}start(e){var t=this;return(0,n.A)((function*(){e&&t.watchSplitViewOutlet(e),t.updateSelectedItem()}))()}destroy(){var e;super.destroy(),null===(e=this.splitViewOutletSubscription)||void 0===e||e.unsubscribe()}watchSplitViewOutlet(e){var t;this.splitView=e,this.splitViewOutletSubscription=e.outletRouteObservable.subscribe((e=>this.updateSelectedItem(this.getPageRouteFromSplitViewOutlet(e)))),this.updateSelectedItem(null!==(t=this.getPageRouteFromSplitViewOutlet(e.outletRoute))&&void 0!==t?t:null)}isSelected(e){return this.selectedItem===e}getItemAriaCurrent(e){return this.isSelected(e)?"page":"false"}select(e){var t=this;return(0,n.A)((function*(){if(!e)return yield t.navigateToIndex({reset:t.resetNavigation()}),void 0;yield t.navigateToItem(e,{reset:t.resetNavigation()})}))()}reset(){this.getSource().reset()}reload(){var e=this;return(0,n.A)((function*(){yield e.getSource().reload(),e.finishSuccessfulFetch()}))()}load(){var e=this;return(0,n.A)((function*(){yield e.getSource().load(),e.finishSuccessfulFetch()}))()}logActivity(){return(0,n.A)((function*(){}))()}resetNavigation(){var e;return!!c.CoreScreen.isTablet&&!(!this.splitView||null!==(e=this.splitView)&&void 0!==e&&e.isNested)}updateSelectedItem(e=null){super.updateSelectedItem(e);this.select(c.CoreScreen.isTablet&&null===this.selectedItem&&this.splitView&&!this.splitView.isNested?this.getDefaultItem():this.selectedItem)}scrollToCurrentElement(){var e=this;return(0,n.A)((function*(){var t,o,n;if(c.CoreScreen.isMobile)return;const i=(null!==(t=null===(o=e.splitView)||void 0===o?void 0:o.nativeElement)&&void 0!==t?t:document).querySelector('[aria-current="page"]');if(!i)return;l.y.isElementInViewport(i,1,null===(n=e.splitView)||void 0===n?void 0:n.nativeElement)||i.scrollIntoView({behavior:"smooth"})}))()}getDefaultItem(){return this.items[0]||null}getCurrentPageRoute(){return this.pageRouteLocator instanceof i.nX?r.CoreNavigator.isRouteActive(this.pageRouteLocator)?this.pageRouteLocator:null:r.CoreNavigator.getCurrentRoute({pageComponent:this.pageRouteLocator})}getSelectedItemPathFromRoute(e){const t=[];for(;e.firstChild;)t.push(...r.CoreNavigator.getRouteUrl(e=e.firstChild));return t.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}getPageRouteFromSplitViewOutlet(e){const t=this.buildRouteMatcher();for(;e&&!t(e);)e=e.parent;return e}buildRouteMatcher(){if(this.pageRouteLocator instanceof i.nX){const e=r.CoreNavigator.getRouteFullPath(this.pageRouteLocator);return t=>r.CoreNavigator.getRouteFullPath(t)===e}return e=>e.component===this.pageRouteLocator}}}}]);