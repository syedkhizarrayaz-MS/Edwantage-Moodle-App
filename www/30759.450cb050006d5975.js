"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[30759],{30759:(e,n,t)=>{t.r(n),t.d(n,{default:()=>q});var o=t(10467),a=t(8224),i=t(68581),r=t(57186),d=t(13462),s=t(94455),l=t(49882),c=t(75383),_=t(52749),v=t(95384),m=t(24742),u=t(79555),f=t(15324),g=t(55554),h=t(74431),p=t(83696),I=t(90137),C=t(52266),E=t(21604),b=t(67935),A=t(18022),R=t(85190),y=t(47551),T=t(24813),x=t(33014),P=t(8014),k=t(99234),O=t(43959),$=t(25572),G=t(86654),M=t(54438),S=t(21182),w=t(60177),F=t(2910),N=t(69502),j=t(17388),Y=t(64422),L=t(32572),D=t(86198),X=t(58197),H=t(23007),z=t(68273),J=t(28988),U=t(88246),B=t(43570),W=t(73955),V=t(32885);const _c0=e=>[e],_c1=e=>({$a:e});function AddonCalendarEventPage_h1_6_Template(e,n){if(1&e&&(M.j41(0,"h1"),M.nrm(1,"core-format-text",14),M.k0s()),2&e){const e=M.XpG();M.R7$(),M.Y8G("text",e.event.name)("contextLevel",e.event.contextLevel)("contextInstanceId",e.event.contextInstanceId)("sanitize",e.event.offline)}}function AddonCalendarEventPage_ion_list_22_core_mod_icon_2_Template(e,n){if(1&e&&M.nrm(0,"core-mod-icon",28),2&e){const e=M.XpG(2);M.Y8G("modicon",e.event.moduleIcon)("showAlt",!1)("modname",e.event.modulename)("componentId",e.event.instance)("purpose",e.event.purpose)("isBranded",e.event.branded)}}function AddonCalendarEventPage_ion_list_22_ion_icon_3_Template(e,n){if(1&e&&M.nrm(0,"ion-icon",29),2&e){const e=M.XpG(2);M.Y8G("name",e.event.eventIcon)}}function AddonCalendarEventPage_ion_list_22_span_8_Template(e,n){if(1&e&&(M.j41(0,"span",18),M.EFF(1),M.k0s()),2&e){const e=M.XpG(2);M.R7$(),M.JRh(e.event.iconTitle)}}function AddonCalendarEventPage_ion_list_22_ion_card_11_Template(e,n){1&e&&(M.j41(0,"ion-card",30)(1,"ion-item"),M.nrm(2,"ion-icon",31),M.j41(3,"ion-label"),M.EFF(4),M.nI1(5,"translate"),M.nI1(6,"translate"),M.k0s()()()),2&e&&(M.R7$(4),M.JRh(M.i5U(6,3,"core.hasdatatosync",M.eq3(6,_c1,M.bMT(5,1,"addon.calendar.calendarevent")))))}function AddonCalendarEventPage_ion_list_22_ion_note_18_Template(e,n){1&e&&(M.j41(0,"ion-note",4),M.nrm(1,"ion-icon",32),M.EFF(2),M.nI1(3,"translate"),M.k0s()),2&e&&(M.R7$(2),M.SpI(" ",M.bMT(3,1,"core.deletedoffline")," "))}function AddonCalendarEventPage_ion_list_22_ion_item_27_Template(e,n){if(1&e&&(M.j41(0,"ion-item",33)(1,"ion-label")(2,"p",22),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.j41(5,"p"),M.nrm(6,"core-format-text",34),M.k0s()()()),2&e){const e=M.XpG(2);M.Y8G("href",e.courseUrl)("detail",!0),M.R7$(3),M.JRh(M.bMT(4,5,"core.course")),M.R7$(3),M.Y8G("text",e.courseName)("contextInstanceId",e.courseId)}}function AddonCalendarEventPage_ion_list_22_ion_item_28_Template(e,n){if(1&e&&(M.j41(0,"ion-item",35)(1,"ion-label")(2,"p",22),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.j41(5,"p"),M.nrm(6,"core-format-text",34),M.k0s()()()),2&e){const e=M.XpG(2);M.R7$(3),M.JRh(M.bMT(4,3,"core.group")),M.R7$(3),M.Y8G("text",e.groupName)("contextInstanceId",e.event.courseid)}}function AddonCalendarEventPage_ion_list_22_ion_item_29_Template(e,n){if(1&e&&(M.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.j41(5,"p"),M.nrm(6,"core-format-text",36),M.k0s()()()),2&e){const e=M.XpG(2);M.R7$(3),M.JRh(M.bMT(4,3,"core.category")),M.R7$(3),M.Y8G("text",e.categoryPath)("contextInstanceId",e.event.categoryid)}}function AddonCalendarEventPage_ion_list_22_ion_item_30_Template(e,n){if(1&e&&(M.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.j41(5,"p"),M.nrm(6,"core-format-text",14),M.k0s()()()),2&e){const e=M.XpG(2);M.R7$(3),M.JRh(M.bMT(4,5,"core.description")),M.R7$(3),M.Y8G("text",e.event.description)("contextLevel",e.event.contextLevel)("contextInstanceId",e.event.contextInstanceId)("sanitize",e.event.offline)}}function AddonCalendarEventPage_ion_list_22_ion_item_31_Template(e,n){if(1&e&&(M.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.j41(5,"p")(6,"a",37),M.nrm(7,"core-format-text",14),M.k0s()()()()),2&e){const e=M.XpG(2);M.R7$(3),M.JRh(M.bMT(4,7,"core.location")),M.R7$(3),M.Y8G("href",e.event.encodedLocation,M.B4B)("autoLogin",!1),M.R7$(),M.Y8G("text",e.event.location)("contextLevel",e.event.contextLevel)("contextInstanceId",e.event.contextInstanceId)("sanitize",e.event.offline)}}function AddonCalendarEventPage_ion_list_22_ion_item_32_Template(e,n){if(1&e&&(M.j41(0,"ion-item")(1,"ion-label")(2,"ion-button",38),M.EFF(3),M.nI1(4,"translate"),M.k0s()()()),2&e){const e=M.XpG(2);M.R7$(2),M.Y8G("href",e.moduleUrl),M.R7$(),M.SpI(" ",M.bMT(4,2,"addon.calendar.gotoactivity")," ")}}function AddonCalendarEventPage_ion_list_22_Template(e,n){if(1&e&&(M.j41(0,"ion-list")(1,"ion-item",15),M.DNE(2,AddonCalendarEventPage_ion_list_22_core_mod_icon_2_Template,1,6,"core-mod-icon",16)(3,AddonCalendarEventPage_ion_list_22_ion_icon_3_Template,1,1,"ion-icon",17),M.j41(4,"ion-label")(5,"span",18),M.EFF(6),M.nI1(7,"translate"),M.DNE(8,AddonCalendarEventPage_ion_list_22_span_8_Template,2,1,"span",19),M.k0s(),M.j41(9,"h1"),M.nrm(10,"core-format-text",14),M.k0s()()(),M.DNE(11,AddonCalendarEventPage_ion_list_22_ion_card_11_Template,7,8,"ion-card",20),M.j41(12,"ion-item",21)(13,"ion-label")(14,"p",22),M.EFF(15),M.nI1(16,"translate"),M.k0s(),M.nrm(17,"core-format-text",23),M.k0s(),M.DNE(18,AddonCalendarEventPage_ion_list_22_ion_note_18_Template,4,3,"ion-note",24),M.k0s(),M.j41(19,"ion-item")(20,"ion-label")(21,"p",22),M.EFF(22),M.nI1(23,"translate"),M.k0s(),M.j41(24,"p"),M.EFF(25),M.nI1(26,"translate"),M.k0s()()(),M.DNE(27,AddonCalendarEventPage_ion_list_22_ion_item_27_Template,7,7,"ion-item",25)(28,AddonCalendarEventPage_ion_list_22_ion_item_28_Template,7,5,"ion-item",26)(29,AddonCalendarEventPage_ion_list_22_ion_item_29_Template,7,5,"ion-item",27)(30,AddonCalendarEventPage_ion_list_22_ion_item_30_Template,7,7,"ion-item",27)(31,AddonCalendarEventPage_ion_list_22_ion_item_31_Template,8,9,"ion-item",27)(32,AddonCalendarEventPage_ion_list_22_ion_item_32_Template,5,4,"ion-item",3),M.k0s()),2&e){const e=M.XpG();M.R7$(),M.Y8G("ngClass",M.eq3(30,_c0,"addon-calendar-eventtype-"+e.event.eventtype)),M.R7$(),M.Y8G("ngIf",e.event.moduleIcon),M.R7$(),M.Y8G("ngIf",e.event.eventIcon&&!e.event.moduleIcon),M.R7$(3),M.SpI(" ",M.bMT(7,22,"addon.calendar.type"+e.event.formattedType)," "),M.R7$(2),M.Y8G("ngIf",e.event.moduleIcon&&e.event.iconTitle),M.R7$(2),M.Y8G("text",e.event.name)("contextLevel",e.event.contextLevel)("contextInstanceId",e.event.contextInstanceId)("sanitize",e.event.offline),M.R7$(),M.Y8G("ngIf",e.hasOffline||e.event.deleted),M.R7$(4),M.JRh(M.bMT(16,24,"addon.calendar.when")),M.R7$(2),M.Y8G("text",e.event.formattedtime)("filter",!1),M.R7$(),M.Y8G("ngIf",e.event.deleted),M.R7$(4),M.JRh(M.bMT(23,26,"addon.calendar.eventtype")),M.R7$(3),M.JRh(M.bMT(26,28,"addon.calendar.type"+e.event.formattedType)),M.R7$(2),M.Y8G("ngIf",e.courseName),M.R7$(),M.Y8G("ngIf",e.groupName),M.R7$(),M.Y8G("ngIf",e.categoryPath),M.R7$(),M.Y8G("ngIf",e.event.description),M.R7$(),M.Y8G("ngIf",e.event.location),M.R7$(),M.Y8G("ngIf",e.moduleUrl)}}function AddonCalendarEventPage_ion_card_23_Template(e,n){if(1&e){const e=M.RV6();M.j41(0,"ion-card",39)(1,"ion-item",21),M.nrm(2,"ion-icon",40),M.j41(3,"ion-label")(4,"p")(5,"strong"),M.EFF(6),M.nI1(7,"translate"),M.k0s()(),M.j41(8,"p"),M.EFF(9),M.nI1(10,"translate"),M.k0s()()(),M.j41(11,"div",41)(12,"ion-button",42),M.bIt("click",(function AddonCalendarEventPage_ion_card_23_Template_ion_button_click_12_listener(){M.eBV(e);const n=M.XpG();return M.Njj(n.hideAlarmWarning())})),M.EFF(13),M.nI1(14,"translate"),M.nI1(15,"coreNoPeriod"),M.k0s(),M.j41(16,"ion-button",43),M.bIt("click",(function AddonCalendarEventPage_ion_card_23_Template_ion_button_click_16_listener(){M.eBV(e);const n=M.XpG();return M.Njj(n.openAlarmSettings())})),M.EFF(17),M.nI1(18,"translate"),M.k0s()()()}2&e&&(M.R7$(6),M.JRh(M.bMT(7,4,"core.exactalarmsturnedoff")),M.R7$(3),M.JRh(M.bMT(10,6,"core.exactalarmsturnedoffmessage")),M.R7$(4),M.SpI(" ",M.bMT(15,10,M.bMT(14,8,"core.dontshowagain"))," "),M.R7$(4),M.JRh(M.bMT(18,12,"core.turnon")))}function AddonCalendarEventPage_ion_card_24_ng_container_6_ion_item_1_p_4_Template(e,n){if(1&e&&(M.j41(0,"p"),M.EFF(1),M.k0s()),2&e){const e=M.XpG(2).$implicit;M.R7$(),M.JRh(e.sublabel)}}function AddonCalendarEventPage_ion_card_24_ng_container_6_ion_item_1_Template(e,n){if(1&e){const e=M.RV6();M.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),M.EFF(3),M.k0s(),M.DNE(4,AddonCalendarEventPage_ion_card_24_ng_container_6_ion_item_1_p_4_Template,2,1,"p",3),M.k0s(),M.j41(5,"ion-button",46),M.nI1(6,"translate"),M.bIt("click",(function AddonCalendarEventPage_ion_card_24_ng_container_6_ion_item_1_Template_ion_button_click_5_listener(n){M.eBV(e);const t=M.XpG().$implicit,o=M.XpG(2);return M.Njj(o.deleteReminder(t.id,n))})),M.nrm(7,"ion-icon",47),M.k0s()()}if(2&e){const e=M.XpG().$implicit,n=M.XpG(2);M.AVh("item-dimmed",e.timestamp<=n.currentTime),M.R7$(3),M.JRh(e.label),M.R7$(),M.Y8G("ngIf",e.sublabel),M.R7$(),M.Y8G("ariaLabel",M.bMT(6,5,"core.delete"))}}function AddonCalendarEventPage_ion_card_24_ng_container_6_Template(e,n){if(1&e&&(M.qex(0),M.DNE(1,AddonCalendarEventPage_ion_card_24_ng_container_6_ion_item_1_Template,8,7,"ion-item",45),M.bVm()),2&e){const e=n.$implicit;M.R7$(),M.Y8G("ngIf",e.timestamp>0)}}function AddonCalendarEventPage_ion_card_24_ng_container_7_Template(e,n){if(1&e){const e=M.RV6();M.qex(0),M.j41(1,"ion-item")(2,"ion-label")(3,"ion-button",48),M.bIt("click",(function AddonCalendarEventPage_ion_card_24_ng_container_7_Template_ion_button_click_3_listener(){M.eBV(e);const n=M.XpG(2);return M.Njj(n.addReminder())})),M.EFF(4),M.nI1(5,"translate"),M.k0s()()(),M.bVm()}2&e&&(M.R7$(4),M.SpI(" ",M.bMT(5,1,"addon.calendar.setnewreminder")," "))}function AddonCalendarEventPage_ion_card_24_Template(e,n){if(1&e&&(M.j41(0,"ion-card")(1,"ion-item")(2,"ion-label")(3,"h2"),M.EFF(4),M.nI1(5,"translate"),M.k0s()()(),M.DNE(6,AddonCalendarEventPage_ion_card_24_ng_container_6_Template,2,1,"ng-container",44)(7,AddonCalendarEventPage_ion_card_24_ng_container_7_Template,6,3,"ng-container",3),M.k0s()),2&e){const e=M.XpG();M.R7$(4),M.JRh(M.bMT(5,3,"addon.calendar.reminders")),M.R7$(2),M.Y8G("ngForOf",e.reminders),M.R7$(),M.Y8G("ngIf",e.event.timestart>e.currentTime)}}let q=(()=>{var e;class AddonCalendarEventPage{constructor(e){this.route=e,this.eventLoaded=!1,this.courseName="",this.courseUrl="",this.remindersEnabled=!1,this.moduleUrl="",this.categoryPath="",this.currentTime=-1,this.reminders=[],this.canEdit=!1,this.hasOffline=!1,this.isOnline=!1,this.syncIcon=h.CoreConstants.ICON_LOADING,this.canScheduleExactAlarms=!0,this.scheduleExactWarningHidden=!1,this.remindersEnabled=E.CoreReminders.isEnabled(),this.siteHomeId=_.CoreSites.getCurrentSiteHomeId(),this.currentSiteId=_.CoreSites.getCurrentSiteId(),this.canEdit=a.AddonCalendar.canEditEventsInSite(),this.editEventObserver=l.z.on(k.bp,(e=>{e&&e.eventId===this.eventId&&(this.eventLoaded=!1,this.refreshEvent(!0,!1))}),this.currentSiteId),this.newEventObserver=l.z.on(k.zl,(e=>{this.eventId<0&&e&&(e.eventId===this.eventId||e.oldEventId===this.eventId)&&(this.eventId=e.eventId,this.eventLoaded=!1,this.refreshEvent(!0,!1))}),this.currentSiteId),this.syncObserver=l.z.on(k.FK,(e=>this.checkSyncResult(!1,e)),this.currentSiteId),this.manualSyncObserver=l.z.on(k.y$,(e=>this.checkSyncResult(!0,e)),this.currentSiteId),this.onlineObserver=s.WE.onChange().subscribe((()=>{u.SK.run((()=>{this.isOnline=s.WE.isOnline()}))})),this.defaultTimeChangedObserver=l.z.on(O.ny,(()=>{this.loadReminders()}),this.currentSiteId),this.currentTime=m.j.timestamp(),this.updateCurrentTime=window.setInterval((()=>{this.currentTime=m.j.timestamp()}),5e3),this.checkExactAlarms(),this.appResumeSubscription=A.CorePlatform.resume.subscribe((()=>{this.checkExactAlarms()}))}loadReminders(){var e=this;return(0,o.A)((function*(){e.remindersEnabled&&e.event&&(e.reminders=yield i.AddonCalendarHelper.getEventReminders(e.eventId,e.event.timestart,e.currentSiteId))}))()}checkExactAlarms(){var e=this;return(0,o.A)((function*(){e.scheduleExactWarningHidden=!!(yield R.CoreConfig.get(h.CoreConstants.DONT_SHOW_EXACT_ALARMS_WARNING,0)),e.canScheduleExactAlarms=yield b.CoreLocalNotifications.canScheduleExactAlarms()}))()}ngOnInit(){var e=this;return(0,o.A)((function*(){try{e.eventId=f.CoreNavigator.getRequiredRouteNumberParam("id")}catch(e){return $.CoreAlerts.showError(e),f.CoreNavigator.back(),void 0}e.syncIcon=h.CoreConstants.ICON_LOADING,yield e.initializeSwipeManager(),yield e.fetchEvent()}))()}fetchEvent(e=!1,n=!1){var t=this;return(0,o.A)((function*(){if(t.isOnline=s.WE.isOnline(),e){if(yield t.syncEvents(n))return}try{if(t.eventId>=0){const e=yield a.AddonCalendar.getEventById(t.eventId);t.event=yield i.AddonCalendarHelper.formatEventData(e)}try{const e=i.AddonCalendarHelper.formatOfflineEventData(yield r.AddonCalendarOffline.getEvent(t.eventId));t.hasOffline=!0,t.event=Object.assign(t.event||{},e)}catch{if(t.hasOffline=!1,t.eventId<0)return $.CoreAlerts.showError("Event not found."),f.CoreNavigator.back(),void 0}if(!t.event)return;if(t.loadReminders(),t.categoryPath="",t.courseName="",t.courseUrl="",t.moduleUrl="",t.event.moduleIcon){const e=v.CoreCourseModuleHelper.translateModuleName(t.event.modulename||"");-1===e.indexOf("core.mod_")&&(t.event.modulename=e),t.moduleUrl=t.event.url||""}const e=[],n=t.event,d=t.event.courseid;d!=t.siteHomeId&&t.event.course&&(t.courseId=t.event.course.id,t.courseName=t.event.course.fullname,t.courseUrl=t.event.course.viewurl),d&&t.event.groupid&&(t.groupName=n.groupname),t.event.iscategoryevent&&t.event.category&&(t.categoryPath=t.event.category.nestedname),t.event.location&&(t.event.location=c.Ni.decodeHTML(t.event.location),t.event.encodedLocation=u.up.bypassSecurityTrustUrl(P.F.buildMapsURL({query:t.event.location}))),e.push(r.AddonCalendarOffline.isEventDeleted(t.eventId).then((e=>{n.deleted=e}))),e.push(a.AddonCalendar.getCalendarTimeFormat().then(function(){var e=(0,o.A)((function*(e){n.formattedtime=yield a.AddonCalendar.formatEventTime(n,e)}));return function(n){return e.apply(this,arguments)}}())),yield Promise.all(e)}catch(e){$.CoreAlerts.showError(e,{default:u.HT.instant("addon.calendar.errorloadevent")})}t.eventLoaded=!0,t.syncIcon=h.CoreConstants.ICON_SYNC}))()}initializeSwipeManager(){var e=this;return(0,o.A)((function*(){const n=f.CoreNavigator.getRouteParam("date"),t=n&&p.u.getSource(I.t,[n]);t&&(e.events=new AddonCalendarEventsSwipeItemsManager(t),yield e.events.start())}))()}syncEvents(e=!1){var n=this;return(0,o.A)((function*(){let t=!1;try{const e=yield d.AddonCalendarSync.syncEvents();e.warnings&&e.warnings.length&&$.CoreAlerts.show({message:e.warnings[0]}),e.deleted&&-1!=e.deleted.indexOf(n.eventId)?t=!0:n.eventId<0&&e.offlineIdMap[n.eventId]&&(n.eventId=e.offlineIdMap[n.eventId]),e.updated&&(e.source="event",l.z.trigger(k.y$,e,n.currentSiteId))}catch(n){e&&$.CoreAlerts.showError(n,{default:u.HT.instant("core.errorsync")})}return t}))()}addReminder(){var e=this;return(0,o.A)((function*(){if(!e.event||!e.event.id)return;const{CoreRemindersSetReminderMenuComponent:n}=yield t.e(64260).then(t.bind(t,64260)),o=yield T.CorePopovers.open({component:n,componentProps:{eventTime:e.event.timestart}});void 0!==o&&(yield a.AddonCalendar.addEventReminder(e.event,o.timeBefore,e.currentSiteId),yield e.loadReminders())}))()}deleteReminder(e,n){var t=this;return(0,o.A)((function*(){n.preventDefault(),n.stopPropagation();try{yield $.CoreAlerts.confirmDelete(u.HT.instant("core.areyousure"));const n=yield x.CoreLoadings.show("core.deleting",!0);try{yield E.CoreReminders.removeReminder(e),yield t.loadReminders()}catch(e){$.CoreAlerts.showError(e,{default:"Error deleting reminder"})}finally{n.dismiss()}}catch{}}))()}doRefresh(e,n,t=!1){var a=this;return(0,o.A)((function*(){a.eventLoaded&&(yield a.refreshEvent(!0,t).finally((()=>{null==e||e.complete(),n&&n()})))}))()}refreshEvent(e=!1,n=!1){var t=this;return(0,o.A)((function*(){t.syncIcon=h.CoreConstants.ICON_LOADING;const o=[];t.eventId>0&&o.push(a.AddonCalendar.invalidateEvent(t.eventId)),o.push(a.AddonCalendar.invalidateTimeFormat()),yield g.g.allPromisesIgnoringErrors(o),yield t.fetchEvent(e,n)}))()}openEdit(){f.CoreNavigator.navigateToSitePath(`/calendar/edit/${this.eventId}`)}deleteEvent(){var e=this;return(0,o.A)((function*(){if(!e.event)return;let n;const t={header:u.HT.instant("addon.calendar.deleteevent")};e.event.eventcount>1?(n=u.HT.instant("addon.calendar.confirmeventseriesdelete",{$a:{name:e.event.name,count:e.event.eventcount}}),t.inputs=[{type:"radio",name:"deleteall",checked:!0,value:!1,label:u.HT.instant("addon.calendar.deleteoneevent")},{type:"radio",name:"deleteall",checked:!1,value:!0,label:u.HT.instant("addon.calendar.deleteallevents")}]):n=u.HT.instant("addon.calendar.confirmeventdelete",{$a:e.event.name});let o=!1;try{o=yield $.CoreAlerts.confirm(n,t)}catch{return}const d=yield x.CoreLoadings.show("core.sending",!0);try{let n=!1;if(e.event.id<0?yield r.AddonCalendarOffline.deleteEvent(e.event.id):n=yield a.AddonCalendar.deleteEvent(e.event.id,e.event.name,o),n)try{yield i.AddonCalendarHelper.refreshAfterChangeEvent(e.event,o?e.event.eventcount:1)}catch{}e.event.id<0?l.z.trigger(k.D1,{},_.CoreSites.getCurrentSiteId()):l.z.trigger(k.Mq,{eventId:e.eventId,sent:n},_.CoreSites.getCurrentSiteId()),n||e.event.id<0?(y.CoreToasts.show({message:"addon.calendar.eventcalendareventdeleted",translateMessage:!0,duration:y.ToastDuration.LONG}),f.CoreNavigator.back()):e.event.deleted=!0}catch(e){$.CoreAlerts.showError(e,{default:"Error deleting event."})}d.dismiss()}))()}undoDelete(){var e=this;return(0,o.A)((function*(){if(!e.event)return;const n=yield x.CoreLoadings.show("core.sending",!0);try{yield r.AddonCalendarOffline.unmarkDeleted(e.event.id),l.z.trigger(k.hZ,{eventId:e.eventId},_.CoreSites.getCurrentSiteId()),e.event.deleted=!1}catch(e){$.CoreAlerts.showError(e,{default:"Error undeleting event."})}n.dismiss()}))()}checkSyncResult(e,n){if(n)if(n.deleted&&-1!=n.deleted.indexOf(this.eventId))y.CoreToasts.show({message:"addon.calendar.eventcalendareventdeleted",translateMessage:!0,duration:y.ToastDuration.LONG}),f.CoreNavigator.back();else if(n.events&&(!e||"event"!=n.source))if(this.eventId<0)n.offlineIdMap[this.eventId]&&(this.eventId=n.offlineIdMap[this.eventId],this.eventLoaded=!1,this.refreshEvent());else{n.events.find((e=>e.id==this.eventId))&&(this.eventLoaded=!1,this.refreshEvent())}}openAlarmSettings(){b.CoreLocalNotifications.openAlarmSettings()}hideAlarmWarning(){R.CoreConfig.set(h.CoreConstants.DONT_SHOW_EXACT_ALARMS_WARNING,1),this.scheduleExactWarningHidden=!0}ngOnDestroy(){var e;this.editEventObserver.off(),this.syncObserver.off(),this.manualSyncObserver.off(),this.onlineObserver.unsubscribe(),this.newEventObserver.off(),null===(e=this.events)||void 0===e||e.destroy(),this.appResumeSubscription.unsubscribe(),clearInterval(this.updateCurrentTime)}}return(e=AddonCalendarEventPage).ɵfac=function AddonCalendarEventPage_Factory(n){return new(n||e)(M.rXU(S.nX))},e.ɵcmp=M.VBU({type:e,selectors:[["page-addon-calendar-event"]],standalone:!0,features:[M.aNF],decls:25,vars:35,consts:[["collapsible",""],["slot","start"],[3,"text"],[4,"ngIf"],["slot","end"],[3,"action","hidden","priority","content","iconAction","closeOnClick"],["iconAction","fas-pen",3,"action","hidden","priority","content"],["iconAction","fas-trash",3,"action","hidden","priority","content"],["iconAction","fas-rotate-left",3,"action","hidden","priority","content"],[3,"core-swipe-navigation"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["class","core-warning-card core-card-with-buttons",4,"ngIf"],[3,"text","contextLevel","contextInstanceId","sanitize"],["collapsible","",1,"ion-text-wrap","addon-calendar-event",3,"ngClass"],["slot","start",3,"modicon","showAlt","modname","componentId","purpose","isBranded",4,"ngIf"],["aria-hidden","true","slot","start",3,"name",4,"ngIf"],[1,"sr-only"],["class","sr-only",4,"ngIf"],["class","core-warning-card",4,"ngIf"],[1,"ion-text-wrap"],[1,"item-heading"],[3,"text","filter"],["slot","end",4,"ngIf"],["class","ion-text-wrap","core-link","","capture","true",3,"href","detail",4,"ngIf"],["class","ion-text-wrap core-groupname",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],["slot","start",3,"modicon","showAlt","modname","componentId","purpose","isBranded"],["aria-hidden","true","slot","start",3,"name"],[1,"core-warning-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],["name","fas-trash","aria-hidden","true"],["core-link","","capture","true",1,"ion-text-wrap",3,"href","detail"],["contextLevel","course",3,"text","contextInstanceId"],[1,"ion-text-wrap","core-groupname"],["contextLevel","coursecat",3,"text","contextInstanceId"],["core-link","",3,"href","autoLogin"],["expand","block","core-link","","capture","true",3,"href"],[1,"core-warning-card","core-card-with-buttons"],["name","fas-circle-info","slot","start","aria-hidden","true"],[1,"core-card-buttons"],["fill","clear",3,"click"],["fill","outline",3,"click"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",3,"item-dimmed",4,"ngIf"],["fill","clear","slot","end",3,"click","ariaLabel"],["name","fas-trash","color","danger","slot","icon-only","aria-hidden","true"],["expand","block",3,"click"]],template:function AddonCalendarEventPage_Template(e,n){1&e&&(M.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),M.nrm(3,"ion-back-button",2),M.nI1(4,"translate"),M.k0s(),M.j41(5,"ion-title"),M.DNE(6,AddonCalendarEventPage_h1_6_Template,2,4,"h1",3),M.k0s(),M.j41(7,"ion-buttons",4)(8,"core-context-menu")(9,"core-context-menu-item",5),M.nI1(10,"translate"),M.bIt("action",(function AddonCalendarEventPage_Template_core_context_menu_item_action_9_listener(e){return n.doRefresh(void 0,e,!0)})),M.k0s(),M.j41(11,"core-context-menu-item",6),M.nI1(12,"translate"),M.bIt("action",(function AddonCalendarEventPage_Template_core_context_menu_item_action_11_listener(){return n.openEdit()})),M.k0s(),M.j41(13,"core-context-menu-item",7),M.nI1(14,"translate"),M.bIt("action",(function AddonCalendarEventPage_Template_core_context_menu_item_action_13_listener(){return n.deleteEvent()})),M.k0s(),M.j41(15,"core-context-menu-item",8),M.nI1(16,"translate"),M.bIt("action",(function AddonCalendarEventPage_Template_core_context_menu_item_action_15_listener(){return n.undoDelete()})),M.k0s()()()()(),M.j41(17,"ion-content",9)(18,"ion-refresher",10),M.bIt("ionRefresh",(function AddonCalendarEventPage_Template_ion_refresher_ionRefresh_18_listener(e){return n.doRefresh(e.target)})),M.nrm(19,"ion-refresher-content",11),M.nI1(20,"translate"),M.k0s(),M.j41(21,"core-loading",12),M.DNE(22,AddonCalendarEventPage_ion_list_22_Template,33,32,"ion-list",3)(23,AddonCalendarEventPage_ion_card_23_Template,19,14,"ion-card",13)(24,AddonCalendarEventPage_ion_card_24_Template,8,5,"ion-card",3),M.k0s()()),2&e&&(M.R7$(3),M.Y8G("text",M.bMT(4,23,"core.back")),M.R7$(3),M.Y8G("ngIf",n.event),M.R7$(3),M.Y8G("hidden",!n.eventLoaded||!n.hasOffline&&n.event&&!n.event.deleted||!n.isOnline)("priority",400)("content",M.bMT(10,25,"core.settings.synchronizenow"))("iconAction",n.syncIcon)("closeOnClick",!1),M.R7$(2),M.Y8G("hidden",!n.event||!n.event.canedit||n.event.deleted||!n.canEdit&&n.event.id>0)("priority",300)("content",M.bMT(12,27,"core.edit")),M.R7$(2),M.Y8G("hidden",!n.event||!n.event.candelete||n.event.deleted)("priority",200)("content",M.bMT(14,29,"core.delete")),M.R7$(2),M.Y8G("hidden",!n.event||!n.event.deleted)("priority",200)("content",M.bMT(16,31,"core.restore")),M.R7$(2),M.Y8G("core-swipe-navigation",n.events),M.R7$(),M.Y8G("disabled",!n.eventLoaded),M.R7$(),M.FS9("pullingText",M.bMT(20,33,"core.pulltorefresh")),M.R7$(2),M.Y8G("hideUntil",n.eventLoaded),M.R7$(),M.Y8G("ngIf",n.event),M.R7$(),M.Y8G("ngIf",n.remindersEnabled&&n.event&&!n.canScheduleExactAlarms&&!n.scheduleExactWarningHidden),M.R7$(),M.Y8G("ngIf",n.remindersEnabled&&n.event))},dependencies:[G.n,w.YU,w.Sq,w.bT,F.Jm,F.QW,F.b_,F.W9,F.eU,F.iq,F.uz,F.he,F.nf,F.JI,F.To,F.Ki,F.BC,F.ai,F.el,N.B,j.Q,Y.R,L.I,D.t,X.B,H.j,z.M,J.n,U.i,B.T,W.D9,V.w],styles:["[_nghost-%COMP%]{--addon-calendar-blank-day-background-color: var(--light)}[_nghost-%COMP%]   .item.addon-calendar-event[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{color:#fff;border-radius:50%;padding:.7rem;--margin-vertical: 12px;--margin-end: 12px;margin-top:var(--margin-vertical);margin-bottom:var(--margin-vertical);margin-inline-end:var(--margin-end)}[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-category[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{background-color:#8e24aa}[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-course[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{background-color:#ca3120}[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-group[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{background-color:#f0ad4e}[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-user[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{background-color:#0f6cbf}[_nghost-%COMP%]   .item.addon-calendar-event.addon-calendar-eventtype-site[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{background-color:#10846c}","[_nghost-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:1.6rem}"]}),AddonCalendarEventPage})();class AddonCalendarEventsSwipeItemsManager extends C.Z{getSelectedItemPathFromRoute(e){return f.CoreNavigator.getRouteParams(e).id}}}}]);