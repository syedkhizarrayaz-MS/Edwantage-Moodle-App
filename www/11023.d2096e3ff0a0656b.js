"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[11023],{11023:(e,t,i)=>{i.r(t),i.d(t,{AddonModDataFieldPictureComponent:()=>F});var n=i(88436),o=i(24942),a=i(82907),d=i(10093),l=i(45507),r=i(95209),s=i(86654),m=i(54438),c=i(60177),u=i(89417),p=i(2910),f=i(95638),h=i(25880),_=i(10892),g=i(73955);function AddonModDataFieldPictureComponent_ng_container_0_core_input_errors_3_Template(e,t){if(1&e&&m.nrm(0,"core-input-errors",7),2&e){const e=m.XpG(2);m.Y8G("errorText",e.error)}}function AddonModDataFieldPictureComponent_ng_container_0_Template(e,t){if(1&e&&(m.qex(0,3),m.nrm(1,"core-attachments",4),m.nI1(2,"translate"),m.DNE(3,AddonModDataFieldPictureComponent_ng_container_0_core_input_errors_3_Template,1,1,"core-input-errors",5),m.nrm(4,"ion-input",6),m.nI1(5,"translate"),m.nI1(6,"translate"),m.bVm()),2&e){const e=m.XpG();m.Y8G("formGroup",e.form),m.R7$(),m.Y8G("files",e.files)("maxSize",e.maxSizeBytes)("component",e.component)("componentId",e.componentId)("allowOffline",!0)("courseId",null==e.database?null:e.database.course)("required",e.field.required)("title",m.bMT(2,13,"addon.mod_data_fields_picture.fieldtypelabel")),m.R7$(2),m.Y8G("ngIf",e.error),m.R7$(),m.Y8G("label",m.bMT(5,15,"addon.mod_data.alttext"))("formControlName","f_"+e.field.id+"_alttext")("placeholder",m.bMT(6,17,"addon.mod_data.alttext"))}}function AddonModDataFieldPictureComponent_ng_container_1_Template(e,t){if(1&e&&(m.qex(0,3),m.nrm(1,"ion-input",8),m.bVm()),2&e){const e=m.XpG();m.Y8G("formGroup",e.form),m.R7$(),m.Y8G("formControlName","f_"+e.field.id)("placeholder",e.field.name)}}function AddonModDataFieldPictureComponent_button_2_Template(e,t){if(1&e){const e=m.RV6();m.j41(0,"button",9),m.bIt("click",(function AddonModDataFieldPictureComponent_button_2_Template_button_click_0_listener(){m.eBV(e);const t=m.XpG();return m.Njj(t.navigateEntry())})),m.nrm(1,"img",10),m.k0s()}if(2&e){const e=m.XpG();m.R7$(),m.Y8G("url",e.imageUrl)("alt",e.title)}}function AddonModDataFieldPictureComponent_img_3_Template(e,t){if(1&e&&m.nrm(0,"img",10),2&e){const e=m.XpG();m.Y8G("url",e.imageUrl)("alt",e.title),m.BMQ("width",e.width)("height",e.height)}}let F=(()=>{var e;class AddonModDataFieldPictureComponent extends d.u{constructor(){super(...arguments),this.files=[]}getFiles(e){let t=(null==e?void 0:e.files)||[];return t.length>0&&(t=[t[0]]),t}findFile(e,t){return e.find((e=>("name"in e?e.name:e.filename)==t))||void 0}init(){if(this.searchMode)return this.addControl(`f_${this.field.id}`),void 0;if(this.component=r.$W,this.componentId=this.database.coursemodule,this.updateValue(this.value),this.editMode){this.maxSizeBytes=parseInt(this.field.param3,10),o.CoreFileSession.setFiles(this.component,`${this.database.id}_${this.field.id}`,this.files);this.addControl(`f_${this.field.id}_alttext`,this.value&&this.value.content1||"")}}updateValue(e){const t=(null==e?void 0:e.files)||[];if(t.length>0){this.image=this.findFile(t,(this.listMode?`thumb_${null==e?void 0:e.content}`:null==e?void 0:e.content)||""),!this.image&&this.listMode&&(this.image=this.findFile(t,(null==e?void 0:e.content)||"")),this.image&&(this.files=[this.image])}else this.image=void 0,this.files=[];this.editMode||(this.entryId=e&&e.recordid||void 0,this.title=e&&e.content1||"",this.imageUrl=void 0,setTimeout((()=>{this.image&&(this.imageUrl="name"in this.image?l.CoreFile.convertFileSrc(l.CoreFile.getFileEntryURL(this.image)):n.CoreFileHelper.getFileUrl(this.image))}),1),this.width=a.y.formatSizeUnits(this.field.param1),this.height=a.y.formatSizeUnits(this.field.param2))}navigateEntry(){this.gotoEntry.emit(this.entryId)}}return(e=AddonModDataFieldPictureComponent).ɵfac=(()=>{let t;return function AddonModDataFieldPictureComponent_Factory(i){return(t||(t=m.xGo(e)))(i||e)}})(),e.ɵcmp=m.VBU({type:e,selectors:[["addon-mod-data-field-picture"]],standalone:!0,features:[m.Vt3,m.aNF],decls:4,vars:4,consts:[[3,"formGroup",4,"ngIf"],["class","as-link",3,"click",4,"ngIf"],["class","core-media-adapt-width list_picture","core-external-content","",3,"url","alt",4,"ngIf"],[3,"formGroup"],["maxSubmissions","1","acceptedTypes","image",3,"files","maxSize","component","componentId","allowOffline","courseId","required","title"],[3,"errorText",4,"ngIf"],["labelPlacement","stacked","type","text",3,"label","formControlName","placeholder"],[3,"errorText"],["type","text",3,"formControlName","placeholder"],[1,"as-link",3,"click"],["core-external-content","",1,"core-media-adapt-width","list_picture",3,"url","alt"]],template:function AddonModDataFieldPictureComponent_Template(e,t){1&e&&m.DNE(0,AddonModDataFieldPictureComponent_ng_container_0_Template,7,19,"ng-container",0)(1,AddonModDataFieldPictureComponent_ng_container_1_Template,2,3,"ng-container",0)(2,AddonModDataFieldPictureComponent_button_2_Template,2,2,"button",1)(3,AddonModDataFieldPictureComponent_img_3_Template,1,4,"img",2),2&e&&(m.Y8G("ngIf",t.editMode&&t.form),m.R7$(),m.Y8G("ngIf",t.searchMode&&t.form),m.R7$(),m.Y8G("ngIf",t.listMode&&t.imageUrl),m.R7$(),m.Y8G("ngIf",t.showMode&&t.imageUrl))},dependencies:[s.n,c.bT,u.BC,u.cb,p.$w,p.Gw,u.j4,u.JD,f.V,h.q,_.l,g.D9],encapsulation:2}),AddonModDataFieldPictureComponent})()}}]);