"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[36488],{36488:(t,n,o)=>{o.r(n),o.d(n,{AddonModDataActionComponent:()=>M});var e=o(10467),a=o(41094),i=o(98870),r=o(15324),s=o(52749),d=o(49882),c=o(57934),l=o(57587),p=o(24813),_=o(95209),m=o(25367),u=o(81879),f=o(86654),b=o(54438),g=o(60177),A=o(2910),I=o(16658),y=o(86198),C=o(37557),T=o(43570),h=o(73955),D=o(59528);function AddonModDataActionComponent_ion_button_0_Template(t,n){if(1&t){const t=b.RV6();b.j41(0,"ion-button",7),b.nI1(1,"translate"),b.bIt("click",(function AddonModDataActionComponent_ion_button_0_Template_ion_button_click_0_listener(n){b.eBV(t);const o=b.XpG();return b.Njj(o.actionsMenu(n))})),b.nrm(2,"ion-icon",8),b.k0s()}2&t&&b.Y8G("ariaLabel",b.bMT(1,1,"addon.mod_data.actionsmenu"))}function AddonModDataActionComponent_ion_button_1_Template(t,n){if(1&t){const t=b.RV6();b.j41(0,"ion-button",7),b.nI1(1,"translate"),b.bIt("click",(function AddonModDataActionComponent_ion_button_1_Template_ion_button_click_0_listener(){b.eBV(t);const n=b.XpG();return b.Njj(n.viewEntry())})),b.nrm(2,"ion-icon",9),b.k0s()}2&t&&b.Y8G("ariaLabel",b.bMT(1,1,"addon.mod_data.showmore"))}function AddonModDataActionComponent_ion_button_2_Template(t,n){if(1&t){const t=b.RV6();b.j41(0,"ion-button",7),b.nI1(1,"translate"),b.bIt("click",(function AddonModDataActionComponent_ion_button_2_Template_ion_button_click_0_listener(){b.eBV(t);const n=b.XpG();return b.Njj(n.editEntry())})),b.nrm(2,"ion-icon",10),b.k0s()}2&t&&b.Y8G("ariaLabel",b.bMT(1,1,"core.edit"))}function AddonModDataActionComponent_ion_button_3_Template(t,n){if(1&t){const t=b.RV6();b.j41(0,"ion-button",11),b.nI1(1,"translate"),b.bIt("click",(function AddonModDataActionComponent_ion_button_3_Template_ion_button_click_0_listener(){b.eBV(t);const n=b.XpG();return b.Njj(n.deleteEntry())})),b.nrm(2,"ion-icon",12),b.k0s()}2&t&&b.Y8G("ariaLabel",b.bMT(1,1,"core.delete"))}function AddonModDataActionComponent_ion_button_4_Template(t,n){if(1&t){const t=b.RV6();b.j41(0,"ion-button",11),b.nI1(1,"translate"),b.bIt("click",(function AddonModDataActionComponent_ion_button_4_Template_ion_button_click_0_listener(){b.eBV(t);const n=b.XpG();return b.Njj(n.undoDelete())})),b.nrm(2,"ion-icon",13),b.k0s()}2&t&&b.Y8G("ariaLabel",b.bMT(1,1,"core.restore"))}function AddonModDataActionComponent_ion_button_5_Template(t,n){if(1&t){const t=b.RV6();b.j41(0,"ion-button",7),b.nI1(1,"translate"),b.bIt("click",(function AddonModDataActionComponent_ion_button_5_Template_ion_button_click_0_listener(){b.eBV(t);const n=b.XpG();return b.Njj(n.approveEntry())})),b.nrm(2,"ion-icon",14),b.k0s()}2&t&&b.Y8G("ariaLabel",b.bMT(1,1,"addon.mod_data.approve"))}function AddonModDataActionComponent_ion_button_6_Template(t,n){if(1&t){const t=b.RV6();b.j41(0,"ion-button",7),b.nI1(1,"translate"),b.bIt("click",(function AddonModDataActionComponent_ion_button_6_Template_ion_button_click_0_listener(){b.eBV(t);const n=b.XpG();return b.Njj(n.disapproveEntry())})),b.nrm(2,"ion-icon",15),b.k0s()}2&t&&b.Y8G("ariaLabel",b.bMT(1,1,"addon.mod_data.disapprove"))}function AddonModDataActionComponent_core_comments_7_Template(t,n){if(1&t&&b.nrm(0,"core-comments",16),2&t){const t=b.XpG();b.Y8G("instanceId",t.database.coursemodule)("itemId",t.entry.id)("courseId",t.database.course)}}function AddonModDataActionComponent_span_8_Template(t,n){if(1&t&&(b.j41(0,"span",17),b.nI1(1,"coreFormatDate"),b.EFF(2),b.nI1(3,"coreFormatDate"),b.k0s()),2&t){const t=b.XpG();b.Y8G("title",b.bMT(1,2,1e3*t.entry.timecreated)),b.R7$(2),b.SpI(" ",b.i5U(3,4,1e3*t.entry.timecreated,"strftimedatemonthabbr"),"\n")}}function AddonModDataActionComponent_span_9_Template(t,n){if(1&t&&(b.j41(0,"span",17),b.nI1(1,"coreFormatDate"),b.EFF(2),b.nI1(3,"coreFormatDate"),b.k0s()),2&t){const t=b.XpG();b.Y8G("title",b.bMT(1,2,1e3*t.entry.timemodified)),b.R7$(2),b.SpI(" ",b.i5U(3,4,1e3*t.entry.timemodified,"strftimedatemonthabbr"),"\n")}}function AddonModDataActionComponent_core_user_avatar_10_Template(t,n){if(1&t&&b.nrm(0,"core-user-avatar",18),2&t){const t=b.XpG();b.Y8G("user",t.entry)("courseId",t.database.course)("userId",t.entry.userid)("profileUrl",t.userPicture)}}function AddonModDataActionComponent_a_11_Template(t,n){if(1&t&&(b.j41(0,"a",19),b.EFF(1),b.k0s()),2&t){const t=b.XpG();b.Y8G("courseId",t.database.course)("userId",t.entry.userid)("title",t.entry.fullname),b.R7$(),b.SpI(" ",t.entry.fullname,"\n")}}function AddonModDataActionComponent_core_tag_list_12_Template(t,n){if(1&t&&b.nrm(0,"core-tag-list",20),2&t){const t=b.XpG();b.Y8G("tags",t.entry.tags)}}let M=(()=>{var t;class AddonModDataActionComponent{constructor(){this.title="",this.group=0,this.tagsEnabled=!1,this.siteId=s.CoreSites.getCurrentSiteId(),this.tagsEnabled=a.CoreTag.areTagsAvailableInSite()}ngOnInit(){var t=this;return(0,e.A)((function*(){if(t.action==_.Z4.USERPICTURE){const n=yield i.CoreUser.getProfile(t.entry.userid,t.database.course);t.userPicture=n.profileimageurl}}))()}approveEntry(){c.r.approveOrDisapproveEntry(this.database.id,this.entry.id,!0,this.database.course)}deleteEntry(){c.r.showDeleteEntryModal(this.database.id,this.entry.id,this.database.course)}disapproveEntry(){c.r.approveOrDisapproveEntry(this.database.id,this.entry.id,!1,this.database.course)}editEntry(){r.CoreNavigator.navigateToSitePath(`${_.Fn}/${this.database.course}/${this.database.coursemodule}/edit/${this.entry.id}`,{params:{title:this.title}})}viewEntry(){r.CoreNavigator.navigateToSitePath(`${_.Fn}/${this.database.course}/${this.database.coursemodule}/${this.entry.id}`,{params:{title:this.title,group:this.group,offset:this.offset,sortBy:this.sortBy,sortDirection:this.sortDirection}})}undoDelete(){var t=this;return(0,e.A)((function*(){const n=t.database.id,o=t.entry.id;yield l.i.getEntry(n,o,_.Z4.DELETE,t.siteId),yield l.i.deleteEntry(n,o,_.Z4.DELETE,t.siteId),d.z.trigger(_.bg,{dataId:n,entryId:o},t.siteId)}))()}actionsMenu(t){var n=this;return(0,e.A)((function*(){var e;t.stopPropagation(),t.preventDefault();const a=[];n.entry.canmanageentry&&(a.push(n.entry.deleted?{action:()=>n.undoDelete(),text:"core.restore",icon:"fas-rotate-left"}:{action:()=>n.deleteEntry(),text:"core.delete",icon:"fas-trash"}),n.entry.deleted||a.unshift({action:()=>n.editEntry(),text:"core.edit",icon:"fas-pen"})),n.database.approval&&null!==(e=n.access)&&void 0!==e&&e.canapprove&&!n.entry.deleted&&a.push(n.entry.approved?{action:()=>n.disapproveEntry(),text:"addon.mod_data.disapprove",icon:"far-thumbs-down"}:{action:()=>n.approveEntry(),text:"addon.mod_data.approve",icon:"fas-thumbs-up"}),n.mode===_.KP.LIST&&a.unshift({action:()=>n.viewEntry(),text:"addon.mod_data.showmore",icon:"fas-magnifying-glass-plus"});const{AddonModDataActionsMenuComponent:i}=yield o.e(77122).then(o.bind(o,77122));yield p.CorePopovers.openWithoutResult({component:i,componentProps:{items:a},id:"actionsmenu-popover",event:t})}))()}}return(t=AddonModDataActionComponent).ɵfac=function AddonModDataActionComponent_Factory(n){return new(n||t)},t.ɵcmp=b.VBU({type:t,selectors:[["addon-mod-data-action"]],inputs:{access:"access",mode:"mode",action:"action",entry:"entry",database:"database",title:"title",group:"group",offset:"offset",sortBy:"sortBy",sortDirection:"sortDirection"},standalone:!0,features:[b.aNF],decls:13,vars:13,consts:[["size","small","fill","clear",3,"ariaLabel","click",4,"ngIf"],["size","small","fill","clear","color","danger",3,"ariaLabel","click",4,"ngIf"],["contextLevel","module","component","mod_data","area","database_entry",3,"instanceId","itemId","courseId",4,"ngIf"],[3,"title",4,"ngIf"],["slot","start",3,"user","courseId","userId","profileUrl",4,"ngIf"],["core-user-link","",3,"courseId","userId","title",4,"ngIf"],[3,"tags",4,"ngIf"],["size","small","fill","clear",3,"click","ariaLabel"],["name","fas-ellipsis-vertical","slot","icon-only","aria-hidden","true"],["name","fas-magnifying-glass-plus","slot","icon-only","aria-hidden","true"],["name","fas-pen","slot","icon-only","aria-hidden","true"],["size","small","fill","clear","color","danger",3,"click","ariaLabel"],["name","fas-trash","slot","icon-only","aria-hidden","true"],["name","fas-rotate-left","slot","icon-only","aria-hidden","true"],["name","fas-thumbs-up","slot","icon-only","aria-hidden","true"],["name","far-thumbs-down","slot","icon-only","aria-hidden","true"],["contextLevel","module","component","mod_data","area","database_entry",3,"instanceId","itemId","courseId"],[3,"title"],["slot","start",3,"user","courseId","userId","profileUrl"],["core-user-link","",3,"courseId","userId","title"],[3,"tags"]],template:function AddonModDataActionComponent_Template(t,n){1&t&&b.DNE(0,AddonModDataActionComponent_ion_button_0_Template,3,3,"ion-button",0)(1,AddonModDataActionComponent_ion_button_1_Template,3,3,"ion-button",0)(2,AddonModDataActionComponent_ion_button_2_Template,3,3,"ion-button",0)(3,AddonModDataActionComponent_ion_button_3_Template,3,3,"ion-button",1)(4,AddonModDataActionComponent_ion_button_4_Template,3,3,"ion-button",1)(5,AddonModDataActionComponent_ion_button_5_Template,3,3,"ion-button",0)(6,AddonModDataActionComponent_ion_button_6_Template,3,3,"ion-button",0)(7,AddonModDataActionComponent_core_comments_7_Template,1,3,"core-comments",2)(8,AddonModDataActionComponent_span_8_Template,4,7,"span",3)(9,AddonModDataActionComponent_span_9_Template,4,7,"span",3)(10,AddonModDataActionComponent_core_user_avatar_10_Template,1,4,"core-user-avatar",4)(11,AddonModDataActionComponent_a_11_Template,2,4,"a",5)(12,AddonModDataActionComponent_core_tag_list_12_Template,1,1,"core-tag-list",6),2&t&&(b.Y8G("ngIf","actionsmenu"===n.action),b.R7$(),b.Y8G("ngIf","more"===n.action),b.R7$(),b.Y8G("ngIf","edit"===n.action),b.R7$(),b.Y8G("ngIf","delete"===n.action&&!n.entry.deleted),b.R7$(),b.Y8G("ngIf","delete"===n.action&&n.entry.deleted),b.R7$(),b.Y8G("ngIf","approve"===n.action),b.R7$(),b.Y8G("ngIf","disapprove"===n.action),b.R7$(),b.Y8G("ngIf","comments"===n.action&&"list"===n.mode),b.R7$(),b.Y8G("ngIf","timeadded"===n.action),b.R7$(),b.Y8G("ngIf","timemodified"===n.action),b.R7$(),b.Y8G("ngIf","userpicture"===n.action),b.R7$(),b.Y8G("ngIf","user"===n.action&&n.entry),b.R7$(),b.Y8G("ngIf",n.tagsEnabled&&"tags"===n.action&&n.entry))},dependencies:[f.n,g.bT,A.Jm,A.iq,I.T,y.t,C.O,T.T,h.D9,D.f,u.L,m.v],encapsulation:2}),AddonModDataActionComponent})()},25367:(t,n,o)=>{o.d(n,{v:()=>d});var e=o(15324),a=o(86654),i=o(54438),r=o(60177),s=o(2910);function CoreTagListComponent_ng_container_0_Template(t,n){if(1&t){const t=i.RV6();i.qex(0),i.j41(1,"ion-badge",1),i.bIt("click",(function CoreTagListComponent_ng_container_0_Template_ion_badge_click_1_listener(){const n=i.eBV(t).$implicit,o=i.XpG();return i.Njj(o.openTag(n))})),i.EFF(2),i.k0s(),i.bVm()}if(2&t){const t=n.$implicit;i.R7$(2),i.JRh(t.rawname)}}let d=(()=>{var t;class CoreTagListComponent{constructor(){this.tags=[]}openTag(t){e.CoreNavigator.navigateToSitePath("/tag/index",{params:{tagId:t.id,tagName:t.rawname,collectionId:t.tagcollid,fromContextId:t.taginstancecontextid}})}}return(t=CoreTagListComponent).ɵfac=function CoreTagListComponent_Factory(n){return new(n||t)},t.ɵcmp=i.VBU({type:t,selectors:[["core-tag-list"]],inputs:{tags:"tags"},standalone:!0,features:[i.aNF],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["role","link",1,"core-tag-list-tag",3,"click"]],template:function CoreTagListComponent_Template(t,n){1&t&&i.DNE(0,CoreTagListComponent_ng_container_0_Template,3,1,"ng-container",0),2&t&&i.Y8G("ngForOf",n.tags)},dependencies:[a.n,r.Sq,s.In],styles:["[_nghost-%COMP%]{line-height:1.6}[_nghost-%COMP%]   ion-badge[_ngcontent-%COMP%]{cursor:pointer;margin-left:4px;margin-right:4px}"]}),CoreTagListComponent})()}}]);