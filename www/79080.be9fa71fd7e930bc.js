"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[79080,69006],{79080:(n,e,o)=>{o.r(e),o.d(e,{AddonModScormIndexComponent:()=>z});var t=o(10467),i=o(74431),d=o(75629),r=o(69006),a=o(51024),_=o(44682),c=o(15324),s=o(48966),m=o(58364),l=o(79555),p=o(49882),u=o(60438),f=o(1717),g=o(8214),v=o(98045),I=o(50891),h=o(53794),A=o(55554),C=o(94455),M=o(25572),S=o(30864),x=o(6736),T=o(86654),y=o(54438),R=o(2910),b=o(60177),G=o(89417),w=o(69502),k=o(17388),$=o(64422),E=o(13988),F=o(49234),O=o(86198),D=o(58197),j=o(66731),N=o(43570),Y=o(73955);const _c0=n=>({header:n}),_c1=n=>({number:n});function AddonModScormIndexComponent_Conditional_1_Template(n,e){if(1&n){const n=y.RV6();y.j41(0,"ion-button",7),y.nI1(1,"translate"),y.bIt("click",(function AddonModScormIndexComponent_Conditional_1_Template_ion_button_click_0_listener(){y.eBV(n);const e=y.XpG();return y.Njj(e.openModuleSummary())})),y.nrm(2,"ion-icon",8),y.k0s()}2&n&&y.Y8G("ariaLabel",y.bMT(1,1,"core.info"))}function AddonModScormIndexComponent_Conditional_2_Template(n,e){if(1&n){const n=y.RV6();y.j41(0,"core-context-menu")(1,"core-context-menu-item",9),y.nI1(2,"translate"),y.bIt("action",(function AddonModScormIndexComponent_Conditional_2_Template_core_context_menu_item_action_1_listener(){y.eBV(n);const e=y.XpG();return y.Njj(e.openModuleSummary())})),y.k0s()()}2&n&&(y.R7$(),y.Y8G("priority",5e3)("content",y.bMT(2,2,"core.info")))}function AddonModScormIndexComponent_ion_card_5_Template(n,e){if(1&n&&(y.j41(0,"ion-card",10)(1,"ion-item"),y.nrm(2,"ion-icon",11),y.j41(3,"ion-label"),y.EFF(4),y.k0s()()()),2&n){const n=y.XpG();y.R7$(4),y.JRh(n.scorm.warningMessage)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_span_6_Template(n,e){1&n&&(y.j41(0,"span"),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n&&(y.R7$(),y.JRh(y.bMT(2,1,"core.unlimited")))}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_span_7_Template(n,e){if(1&n&&(y.j41(0,"span"),y.EFF(1),y.k0s()),2&n){const n=y.XpG(5);y.R7$(),y.JRh(n.scorm.maxattempt)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_Template(n,e){if(1&n&&(y.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),y.EFF(3),y.nI1(4,"translate"),y.k0s()(),y.j41(5,"p",0),y.DNE(6,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_span_6_Template,3,3,"span",5)(7,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_span_7_Template,2,1,"span",5),y.k0s()()),2&n){const n=y.XpG(4);y.R7$(3),y.JRh(y.bMT(4,3,"addon.mod_scorm.noattemptsallowed")),y.R7$(3),y.Y8G("ngIf",0===n.scorm.maxattempt),y.R7$(),y.Y8G("ngIf",n.scorm.maxattempt>0)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_2_Template(n,e){if(1&n&&(y.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),y.EFF(3),y.nI1(4,"translate"),y.k0s()(),y.j41(5,"p",0),y.EFF(6),y.k0s()()),2&n){const n=y.XpG(4);y.R7$(3),y.JRh(y.bMT(4,2,"addon.mod_scorm.noattemptsmade")),y.R7$(3),y.JRh(n.numAttempts)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_3_Template(n,e){if(1&n){const n=y.RV6();y.j41(0,"ion-item",19),y.nI1(1,"translate"),y.bIt("click",(function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_3_Template_ion_item_click_0_listener(){y.eBV(n);const e=y.XpG(4);return y.Njj(e.toggleGrades())})),y.nrm(2,"ion-icon",20),y.j41(3,"ion-label")(4,"h3",18),y.EFF(5),y.nI1(6,"translate"),y.k0s()()()}if(2&n){const n=y.XpG(4);y.Y8G("detail",!1),y.BMQ("aria-label",y.bMT(1,5,n.gradesExpanded?"core.collapse":"core.expand")),y.R7$(2),y.AVh("expandable-status-icon-expanded",n.gradesExpanded),y.R7$(3),y.JRh(y.bMT(6,7,"core.grades.grades"))}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_span_6_Template(n,e){if(1&n&&(y.j41(0,"span"),y.EFF(1),y.k0s()),2&n){const n=y.XpG().$implicit;y.R7$(),y.JRh(n.gradeFormatted)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_span_7_Template(n,e){1&n&&(y.j41(0,"span"),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n&&(y.R7$(),y.JRh(y.bMT(2,1,"addon.mod_scorm.cannotcalculategrade")))}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_Template(n,e){if(1&n&&(y.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),y.EFF(3),y.nI1(4,"translate"),y.k0s()(),y.j41(5,"p",0),y.DNE(6,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_span_6_Template,2,1,"span",5)(7,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_span_7_Template,3,3,"span",5),y.k0s()()),2&n){const n=e.$implicit;y.R7$(3),y.Lme("",y.bMT(4,4,"addon.mod_scorm.gradeforattempt")," ",n.num,""),y.R7$(3),y.Y8G("ngIf",-1!==n.grade),y.R7$(),y.Y8G("ngIf",-1===n.grade)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_Template(n,e){if(1&n&&(y.qex(0),y.DNE(1,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_Template,8,6,"ion-item",15),y.bVm()),2&n){const n=y.XpG(4);y.R7$(),y.Y8G("ngForOf",n.onlineAttempts)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_Template(n,e){if(1&n&&(y.qex(0),y.DNE(1,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_Template,8,5,"ion-item",16)(2,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_2_Template,7,4,"ion-item",16)(3,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_3_Template,7,9,"ion-item",17)(4,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_Template,2,1,"ng-container",5),y.bVm()),2&n){const n=y.XpG(3);y.R7$(),y.Y8G("ngIf",n.scorm.maxattempt>=0),y.R7$(),y.Y8G("ngIf",n.numAttempts>=0),y.R7$(),y.Y8G("ngIf",n.onlineAttempts.length>0),y.R7$(),y.Y8G("ngIf",n.gradesExpanded&&n.onlineAttempts.length>0)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_p_5_Template(n,e){1&n&&(y.j41(0,"p"),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n&&(y.R7$(),y.SpI(" ",y.bMT(2,1,"addon.mod_scorm.offlineattemptnote")," "))}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_p_6_Template(n,e){1&n&&(y.j41(0,"p"),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n&&(y.R7$(),y.SpI(" ",y.bMT(2,1,"addon.mod_scorm.offlineattemptovermax")," "))}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_span_8_Template(n,e){if(1&n&&(y.j41(0,"span"),y.EFF(1),y.k0s()),2&n){const n=y.XpG().$implicit;y.R7$(),y.JRh(n.gradeFormatted)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_span_9_Template(n,e){1&n&&(y.j41(0,"span"),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n&&(y.R7$(),y.JRh(y.bMT(2,1,"addon.mod_scorm.cannotcalculategrade")))}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_Template(n,e){if(1&n&&(y.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),y.EFF(3),y.nI1(4,"translate"),y.k0s(),y.DNE(5,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_p_5_Template,3,3,"p",5)(6,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_p_6_Template,3,3,"p",5),y.k0s(),y.j41(7,"p",0),y.DNE(8,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_span_8_Template,2,1,"span",5)(9,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_span_9_Template,3,3,"span",5),y.k0s()()),2&n){const n=e.$implicit,o=y.XpG(3);y.R7$(3),y.Lme("",y.bMT(4,6,"addon.mod_scorm.gradeforattempt")," ",n.num,""),y.R7$(2),y.Y8G("ngIf",!o.scorm.maxattempt||n.num<=o.scorm.maxattempt),y.R7$(),y.Y8G("ngIf",o.scorm.maxattempt&&n.num>o.scorm.maxattempt),y.R7$(2),y.Y8G("ngIf",-1!==n.grade),y.R7$(),y.Y8G("ngIf",-1===n.grade)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_8_Template(n,e){if(1&n&&(y.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),y.EFF(3),y.nI1(4,"translate"),y.k0s()(),y.j41(5,"p",0),y.EFF(6),y.k0s()()),2&n){const n=y.XpG(3);y.R7$(3),y.JRh(y.bMT(4,2,"addon.mod_scorm.grademethod")),y.R7$(3),y.JRh(n.gradeMethodReadable)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_span_6_Template(n,e){if(1&n&&(y.j41(0,"span"),y.EFF(1),y.k0s()),2&n){const n=y.XpG(4);y.R7$(),y.JRh(n.gradeFormatted)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_span_7_Template(n,e){1&n&&(y.j41(0,"span"),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n&&(y.R7$(),y.JRh(y.bMT(2,1,"addon.mod_scorm.cannotcalculategrade")))}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_Template(n,e){if(1&n&&(y.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),y.EFF(3),y.nI1(4,"translate"),y.k0s()(),y.j41(5,"p",0),y.DNE(6,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_span_6_Template,2,1,"span",5)(7,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_span_7_Template,3,3,"span",5),y.k0s()()),2&n){const n=y.XpG(3);y.R7$(3),y.JRh(y.bMT(4,3,"addon.mod_scorm.gradereported")),y.R7$(3),y.Y8G("ngIf",-1!==n.grade),y.R7$(),y.Y8G("ngIf",-1===n.grade)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_10_Template(n,e){if(1&n&&(y.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),y.EFF(3),y.nI1(4,"translate"),y.k0s(),y.j41(5,"p",21),y.EFF(6),y.k0s()()()),2&n){const n=y.XpG(3);y.R7$(3),y.JRh(y.bMT(4,2,"core.lastsync")),y.R7$(3),y.JRh(n.syncTime)}}function AddonModScormIndexComponent_div_6_ion_card_1_Template(n,e){if(1&n&&(y.j41(0,"ion-card")(1,"ion-card-header",13)(2,"ion-card-title"),y.EFF(3),y.nI1(4,"translate"),y.k0s()(),y.j41(5,"ion-list",14),y.DNE(6,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_Template,5,4,"ng-container",5)(7,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_Template,10,8,"ion-item",15)(8,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_8_Template,7,4,"ion-item",16)(9,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_Template,8,5,"ion-item",16)(10,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_10_Template,7,4,"ion-item",16),y.k0s()()),2&n){const n=y.XpG(2);y.R7$(3),y.JRh(y.bMT(4,6,"addon.mod_scorm.attempts")),y.R7$(3),y.Y8G("ngIf",n.scorm.displayattemptstatus),y.R7$(),y.Y8G("ngForOf",n.offlineAttempts),y.R7$(),y.Y8G("ngIf",n.scorm.displayattemptstatus&&n.gradeMethodReadable),y.R7$(),y.Y8G("ngIf",n.scorm.displayattemptstatus&&n.gradeFormatted),y.R7$(),y.Y8G("ngIf",n.syncTime)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_ion_select_option_7_Template(n,e){if(1&n&&(y.j41(0,"ion-select-option",27),y.EFF(1),y.k0s()),2&n){const n=e.$implicit;y.Y8G("value",n.identifier),y.R7$(),y.SpI(" ",n.title," ")}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_Template(n,e){if(1&n){const n=y.RV6();y.j41(0,"ion-item",13)(1,"ion-select",24),y.nI1(2,"translate"),y.nI1(3,"translate"),y.mxI("ngModelChange",(function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_Template_ion_select_ngModelChange_1_listener(e){y.eBV(n);const o=y.XpG(3);return y.DH7(o.currentOrganization.identifier,e)||(o.currentOrganization.identifier=e),y.Njj(e)})),y.bIt("ionChange",(function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_Template_ion_select_ionChange_1_listener(){y.eBV(n);const e=y.XpG(3);return y.Njj(e.loadOrganization())})),y.j41(4,"p",25),y.EFF(5),y.nI1(6,"translate"),y.k0s(),y.DNE(7,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_ion_select_option_7_Template,2,2,"ion-select-option",26),y.k0s()()}if(2&n){const n=y.XpG(3);y.R7$(),y.R50("ngModel",n.currentOrganization.identifier),y.Y8G("cancelText",y.bMT(2,5,"core.cancel"))("interfaceOptions",y.eq3(11,_c0,y.bMT(3,7,"addon.mod_scorm.organizations"))),y.R7$(4),y.JRh(y.bMT(6,9,"addon.mod_scorm.organizations")),y.R7$(2),y.Y8G("ngForOf",n.organizations)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_7_Template(n,e){1&n&&(y.j41(0,"ion-item",28)(1,"ion-label"),y.nrm(2,"ion-spinner"),y.nI1(3,"translate"),y.k0s()()),2&n&&(y.R7$(2),y.BMQ("aria-label",y.bMT(3,1,"core.loading")))}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_p_2_Template(n,e){if(1&n&&(y.j41(0,"p"),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n){const n=y.XpG(4);y.R7$(),y.SpI(" ",y.i5U(2,1,"addon.mod_scorm.dataattemptshown",y.eq3(4,_c1,n.attemptToContinue))," ")}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_ion_icon_1_Template(n,e){if(1&n&&y.nrm(0,"ion-icon",32),2&n){const n=y.XpG(2).$implicit;y.Y8G("name",n.icon.icon),y.BMQ("aria-label",n.icon.description)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_button_2_Template(n,e){if(1&n){const n=y.RV6();y.j41(0,"button",33),y.bIt("click",(function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_button_2_Template_button_click_0_listener(e){y.eBV(n);const o=y.XpG(2).$implicit,t=y.XpG(4);return y.Njj(t.open(e,!1,o.id))})),y.nrm(1,"core-format-text",34),y.k0s()}if(2&n){const n=y.XpG(2).$implicit,e=y.XpG(4);y.R7$(),y.Y8G("text",n.title)("contextInstanceId",e.module.id)("courseId",e.courseId)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_span_3_Template(n,e){if(1&n&&(y.j41(0,"span"),y.nrm(1,"core-format-text",34),y.k0s()),2&n){const n=y.XpG(2).$implicit,e=y.XpG(4);y.R7$(),y.Y8G("text",n.title)("contextInstanceId",e.module.id)("courseId",e.courseId)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_span_4_Template(n,e){if(1&n&&(y.j41(0,"span"),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n){const n=y.XpG(2).$implicit;y.R7$(),y.Lme(" (",y.bMT(2,2,"addon.mod_scorm.score"),": ",n.scoreraw,") ")}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_Template(n,e){if(1&n&&(y.j41(0,"p"),y.DNE(1,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_ion_icon_1_Template,1,2,"ion-icon",30)(2,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_button_2_Template,2,3,"button",31)(3,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_span_3_Template,2,3,"span",5)(4,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_span_4_Template,3,4,"span",5),y.k0s()),2&n){const n=y.XpG().$implicit,e=y.XpG(4);y.R7$(),y.Y8G("ngIf",n.icon),y.R7$(),y.Y8G("ngIf",n.prereq&&n.launch),y.R7$(),y.Y8G("ngIf",!n.prereq||!n.launch),y.R7$(),y.Y8G("ngIf",e.accessInfo&&e.accessInfo.canviewscores&&n.scoreraw)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_Template(n,e){if(1&n&&(y.j41(0,"div"),y.DNE(1,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_Template,5,4,"p",5),y.k0s()),2&n){const n=e.$implicit;y.STu("core-padding-",n.level," addon-mod_scorm-type-",n.scormtype,""),y.R7$(),y.Y8G("ngIf",n.isvisible)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_Template(n,e){if(1&n&&(y.j41(0,"ion-item",13)(1,"ion-label"),y.DNE(2,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_p_2_Template,3,6,"p",5),y.j41(3,"p"),y.EFF(4),y.k0s(),y.DNE(5,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_Template,2,5,"div",29),y.k0s()()),2&n){const n=y.XpG(3);y.R7$(2),y.Y8G("ngIf",n.attemptToContinue),y.R7$(2),y.JRh(n.currentOrganization.title),y.R7$(),y.Y8G("ngForOf",n.toc)}}function AddonModScormIndexComponent_div_6_ion_card_2_Template(n,e){if(1&n&&(y.j41(0,"ion-card",22)(1,"ion-card-header",13)(2,"ion-card-title"),y.EFF(3),y.nI1(4,"translate"),y.k0s()(),y.j41(5,"ion-list"),y.DNE(6,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_Template,8,13,"ion-item",16)(7,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_7_Template,4,3,"ion-item",23)(8,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_Template,6,3,"ion-item",16),y.k0s()()),2&n){const n=y.XpG(2);y.R7$(3),y.JRh(y.bMT(4,4,"addon.mod_scorm.contents")),y.R7$(3),y.Y8G("ngIf",n.organizations.length>1),y.R7$(),y.Y8G("ngIf",n.scorm.displaycoursestructure&&n.loadingToc),y.R7$(),y.Y8G("ngIf",n.scorm.displaycoursestructure&&!n.loadingToc)}}function AddonModScormIndexComponent_div_6_Template(n,e){if(1&n&&(y.j41(0,"div"),y.DNE(1,AddonModScormIndexComponent_div_6_ion_card_1_Template,11,8,"ion-card",5)(2,AddonModScormIndexComponent_div_6_ion_card_2_Template,9,6,"ion-card",12),y.k0s()),2&n){const n=y.XpG();y.R7$(),y.Y8G("ngIf",(n.scorm.displayattemptstatus||n.offlineAttempts.length)&&!n.skip),y.R7$(),y.Y8G("ngIf",n.scorm&&n.organizations&&!n.skip&&(n.scorm.displaycoursestructure&&n.organizations.length||n.organizations.length>1))}}function AddonModScormIndexComponent_div_7_div_1_ion_card_1_Template(n,e){1&n&&(y.j41(0,"ion-card",41)(1,"ion-item",13)(2,"ion-label")(3,"p"),y.EFF(4),y.nI1(5,"translate"),y.k0s()()()()),2&n&&(y.R7$(4),y.JRh(y.bMT(5,1,"addon.mod_scorm.exceededmaxattempts")))}function AddonModScormIndexComponent_div_7_div_1_ion_card_2_Template(n,e){1&n&&(y.j41(0,"ion-card",42)(1,"ion-item",13),y.nrm(2,"ion-icon",43),y.j41(3,"ion-label"),y.EFF(4),y.nI1(5,"translate"),y.nI1(6,"translate"),y.k0s()()()),2&n&&(y.R7$(4),y.Lme(" ",y.bMT(5,2,"core.course.activitynotavailableoffline")," ",y.bMT(6,4,"core.needinternettoaccessit")," "))}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_1_Template(n,e){if(1&n){const n=y.RV6();y.j41(0,"ion-item",13)(1,"ion-checkbox",47),y.mxI("ngModelChange",(function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_1_Template_ion_checkbox_ngModelChange_1_listener(e){y.eBV(n);const o=y.XpG(5);return y.DH7(o.startNewAttempt,e)||(o.startNewAttempt=e),y.Njj(e)})),y.EFF(2),y.nI1(3,"translate"),y.k0s()()}if(2&n){const n=y.XpG(5);y.R7$(),y.R50("ngModel",n.startNewAttempt),y.R7$(),y.SpI(" ",y.bMT(3,2,"addon.mod_scorm.newattempt")," ")}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_2_Template(n,e){if(1&n&&(y.j41(0,"ion-item")(1,"ion-label",48)(2,"p"),y.EFF(3),y.nI1(4,"translate"),y.k0s()()()),2&n){const n=y.XpG(5);y.R7$(3),y.JRh(y.bMT(4,1,n.statusMessage))}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_button_4_Template(n,e){if(1&n){const n=y.RV6();y.j41(0,"ion-button",49),y.bIt("click",(function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_button_4_Template_ion_button_click_0_listener(e){y.eBV(n);const o=y.XpG(5);return y.Njj(o.open(e,!0))})),y.nrm(1,"ion-icon",50),y.EFF(2),y.nI1(3,"translate"),y.k0s()}2&n&&(y.R7$(2),y.SpI(" ",y.bMT(3,1,"addon.mod_scorm.browse")," "))}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_Template(n,e){if(1&n){const n=y.RV6();y.qex(0),y.DNE(1,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_1_Template,4,4,"ion-item",16)(2,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_2_Template,5,3,"ion-item",5),y.j41(3,"div",44),y.DNE(4,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_button_4_Template,4,3,"ion-button",45),y.j41(5,"ion-button",46),y.bIt("click",(function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_Template_ion_button_click_5_listener(e){y.eBV(n);const o=y.XpG(4);return y.Njj(o.open(e))})),y.EFF(6),y.nI1(7,"translate"),y.k0s()(),y.bVm()}if(2&n){const n=y.XpG(4);y.R7$(),y.Y8G("ngIf",!n.scorm.forcenewattempt&&n.numAttempts>0&&!n.incomplete&&n.attemptsLeft>0),y.R7$(),y.Y8G("ngIf",n.statusMessage),y.R7$(2),y.Y8G("ngIf",!n.scorm.hidebrowse),y.R7$(2),y.SpI(" ",y.bMT(7,4,"addon.mod_scorm.enter")," ")}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_p_4_Template(n,e){if(1&n&&(y.j41(0,"p",18),y.EFF(1),y.nI1(2,"translate"),y.k0s()),2&n){const n=y.XpG(5);y.R7$(),y.JRh(y.bMT(2,1,n.progressMessage))}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_core_progress_bar_5_Template(n,e){if(1&n&&y.nrm(0,"core-progress-bar",53),2&n){const n=y.XpG(5);y.Y8G("progress",n.percentage)("a11yText",n.progressMessage)}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_Template(n,e){if(1&n&&(y.j41(0,"ion-item",28)(1,"ion-label"),y.nrm(2,"ion-spinner"),y.nI1(3,"translate"),y.DNE(4,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_p_4_Template,3,3,"p",51)(5,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_core_progress_bar_5_Template,1,2,"core-progress-bar",52),y.k0s()()),2&n){const n=y.XpG(4);y.R7$(2),y.BMQ("aria-label",y.bMT(3,3,"core.loading")),y.R7$(2),y.Y8G("ngIf",n.progressMessage),y.R7$(),y.Y8G("ngIf",n.showPercentage)}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_Template(n,e){if(1&n&&(y.qex(0),y.DNE(1,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_Template,8,6,"ng-container",5)(2,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_Template,6,5,"ion-item",23),y.bVm()),2&n){const n=y.XpG(3);y.R7$(),y.Y8G("ngIf",!n.downloading&&!n.skip),y.R7$(),y.Y8G("ngIf",n.downloading)}}function AddonModScormIndexComponent_div_7_div_1_Template(n,e){if(1&n&&(y.j41(0,"div",38),y.DNE(1,AddonModScormIndexComponent_div_7_div_1_ion_card_1_Template,6,3,"ion-card",39)(2,AddonModScormIndexComponent_div_7_div_1_ion_card_2_Template,7,6,"ion-card",40)(3,AddonModScormIndexComponent_div_7_div_1_ng_container_3_Template,3,2,"ng-container",5),y.k0s()),2&n){const n=y.XpG(2);y.R7$(),y.Y8G("ngIf",0===n.attemptsLeft),y.R7$(),y.Y8G("ngIf",n.useOnlinePlayer&&!n.isOnline),y.R7$(),y.Y8G("ngIf",(!n.scorm.lastattemptlock||n.attemptsLeft>0)&&(!n.useOnlinePlayer||n.isOnline))}}function AddonModScormIndexComponent_div_7_Template(n,e){if(1&n&&(y.j41(0,"div",35),y.DNE(1,AddonModScormIndexComponent_div_7_div_1_Template,4,3,"div",36),y.nrm(2,"core-course-module-navigation",37),y.k0s()),2&n){const n=y.XpG();y.R7$(),y.Y8G("ngIf",n.scorm&&!n.scorm.warningMessage),y.R7$(),y.Y8G("courseId",n.courseId)("currentModuleId",n.module.id)}}let z=(()=>{var n;class AddonModScormIndexComponent extends r.y{constructor(n,e){super("AddonModScormIndexComponent",n,e),this.content=n,this.component=I.RL,this.pluginName="scorm",this.currentOrganization={identifier:""},this.startNewAttempt=!1,this.hasOffline=!1,this.downloading=!1,this.showPercentage=!1,this.organizations=[],this.loadingToc=!1,this.incomplete=!1,this.numAttempts=-1,this.attemptsLeft=-1,this.onlineAttempts=[],this.offlineAttempts=[],this.gradesExpanded=!1,this.fetchContentDefaultError="addon.mod_scorm.errorgetscorm",this.syncEventName=I.xg,this.lastIsOffline=!1,this.hasPlayed=!1,this.dataSent=!1,this.useOnlinePlayer=!1,this.isOnline=C.WE.isOnline(),this.onlineObserver=C.WE.onChange().subscribe((()=>{l.SK.run((()=>{this.isOnline=C.WE.isOnline()}))}))}ngOnInit(){var _superprop_getNgOnInit=()=>super.ngOnInit,n=this;return(0,t.A)((function*(){_superprop_getNgOnInit().call(n),yield n.loadContent(!1,!0),n.scorm&&n.skip&&n.open()}))()}downloadScormPackage(){var n=this;return(0,t.A)((function*(){n.downloading=!0;try{yield u._.download(n.module,n.courseId,void 0,(e=>{if(e&&n.scorm)if(n.percentage=void 0,n.showPercentage=!1,e.downloading){if(n.scorm.packagesize&&e.progress){const o=100*Number(e.progress.loaded/n.scorm.packagesize);n.percentage=o.toFixed(1),n.showPercentage=o>=0&&o<=100}}else if(e.message)n.progressMessage=e.message;else if(e.progress&&e.progress.loaded&&e.progress.total){const o=100*Number(e.progress.loaded/e.progress.total);n.percentage=o.toFixed(1),n.showPercentage=o>=0&&o<=100}}))}finally{n.progressMessage=void 0,n.percentage=void 0,n.downloading=!1}}))()}fetchContent(n,e=!1,o=!1){var i=this;return(0,t.A)((function*(){if(i.scorm=yield f.v.getScorm(i.courseId,i.module.id,{moduleUrl:i.module.url}),i.dataRetrieved.emit(i.scorm),i.description=i.scorm.intro||i.description,i.useOnlinePlayer=f.v.useOnlinePlayer(i.scorm),i.scorm.warningMessage)return;e&&!i.useOnlinePlayer&&(yield A.g.ignoreErrors(i.syncActivity(o)));const[n,t]=yield Promise.all([i.useOnlinePlayer?void 0:v.S.getReadableSyncTime(i.scorm.id),f.v.getAccessInformation(i.scorm.id,{cmId:i.module.id}),i.fetchAttemptData(i.scorm)]);var d;(i.syncTime=n,i.accessInfo=t,void 0===i.skip)&&(i.skip=!i.hasOffline&&(!i.scorm.lastattemptlock||i.attemptsLeft>0)&&(!!i.autoPlayData||i.accessInfo.canskipview&&!i.accessInfo.canviewreport&&(null!==(d=i.scorm.skipview)&&void 0!==d?d:0)>=1&&(2===i.scorm.skipview||0===i.lastAttempt)))}))()}fetchAttemptData(n){var e=this;return(0,t.A)((function*(){e.attempts=yield f.v.getAttemptCount(n.id,{cmId:e.module.id}),e.hasOffline=!!e.attempts.offline.length;const o=yield g.V.determineAttemptToContinue(n,e.attempts);e.lastAttempt=o.num,e.lastIsOffline=o.offline,e.attemptToContinue=e.lastAttempt!==e.attempts.lastAttempt.num?e.lastAttempt:void 0,e.incomplete=yield f.v.isAttemptIncomplete(n.id,e.lastAttempt,{offline:e.lastIsOffline,cmId:e.module.id}),e.numAttempts=e.attempts.total,e.gradeMethodReadable=f.v.getScormGradeMethod(n),e.attemptsLeft=f.v.countAttemptsLeft(n,e.attempts.lastAttempt.num),(2===n.forcenewattempt||n.forcenewattempt&&!e.incomplete)&&(e.startNewAttempt=!0),yield Promise.all([e.getReportedGrades(n,e.attempts),e.fetchStructure(n),e.loadPackageSize(n),e.setStatusListener()])}))()}loadPackageSize(n){var e=this;return(0,t.A)((function*(){n.packagesize||e.useOnlinePlayer||(n.packagesize=yield f.v.calculateScormSize(n))}))()}fetchStructure(n){var e=this;return(0,t.A)((function*(){var o;return e.organizations=yield f.v.getOrganizations(n.id,{cmId:e.module.id}),""===e.currentOrganization.identifier&&null!==(o=e.organizations[0])&&void 0!==o&&o.identifier&&(e.currentOrganization.identifier=e.organizations[0].identifier),e.loadOrganizationToc(n,e.currentOrganization.identifier)}))()}getAttemptGrade(n,e,o){var i=this;return(0,t.A)((function*(){i.scorm&&(o[n]=yield f.v.getAttemptGrade(i.scorm,n,e))}))()}getReportedGrades(n,e){var o=this;return(0,t.A)((function*(){const t=[],i={},d={};e.online.forEach((n=>{-1==e.offline.indexOf(n)&&t.push(o.getAttemptGrade(n,!1,i))})),e.offline.forEach((n=>{t.push(o.getAttemptGrade(n,!0,d))})),yield Promise.all(t),o.grade=f.v.calculateScormGrade(n,i),o.onlineAttempts=m.T.toArray(i),o.offlineAttempts=m.T.toArray(d),o.onlineAttempts.sort(((n,e)=>n.num-e.num)),o.offlineAttempts.sort(((n,e)=>n.num-e.num)),o.onlineAttempts.forEach((e=>{e.gradeFormatted=f.v.formatGrade(n,e.score)})),o.offlineAttempts.forEach((e=>{e.gradeFormatted=f.v.formatGrade(n,e.score)})),o.gradeFormatted=f.v.formatGrade(n,o.grade)}))()}logActivity(){var n=this;return(0,t.A)((function*(){n.scorm&&(yield A.g.ignoreErrors(f.v.logView(n.scorm.id)),n.analyticsLogEvent("mod_scorm_view_scorm"))}))()}hasSyncSucceed(n){return(n.updated||this.dataSent)&&this.checkCompletion(),this.dataSent=!1,n.updated}ionViewDidEnter(){super.ionViewDidEnter(),this.hasPlayed&&(this.hasPlayed=!1,this.startNewAttempt=!1,setTimeout((()=>{var n;null===(n=this.dataSentObserver)||void 0===n||n.off(),this.dataSentObserver=void 0,this.showLoadingAndRefresh(!0,!1)}),500))}invalidateContent(){var n=this;return(0,t.A)((function*(){const e=[];e.push(f.v.invalidateScormData(n.courseId)),n.scorm&&e.push(f.v.invalidateAllScormData(n.scorm.id)),yield Promise.all(e)}))()}isRefreshSyncNeeded(n){return!(!n.updated||!this.scorm||n.scormId!=this.scorm.id)&&(this.checkCompletion(),!0)}loadOrganization(){var n=this;return(0,t.A)((function*(){if(n.scorm)try{yield n.loadOrganizationToc(n.scorm,n.currentOrganization.identifier)}catch(e){M.CoreAlerts.showError(e,{default:l.HT.instant(n.fetchContentDefaultError)})}}))()}loadOrganizationToc(n,e){var o=this;return(0,t.A)((function*(){if(n.displaycoursestructure&&void 0!==o.lastAttempt){o.loadingToc=!0;try{o.toc=yield g.V.getToc(n.id,o.lastAttempt,o.incomplete,{organization:e,offline:o.lastIsOffline,cmId:o.module.id});const t=o.organizations.find((n=>n.identifier===e));t&&(o.currentOrganization.title=t.title)}finally{o.loadingToc=!1}}}))()}open(n,e=!1,o){var d=this;return(0,t.A)((function*(){if(null==n||n.preventDefault(),null==n||n.stopPropagation(),d.useOnlinePlayer)return d.isOnline&&d.openScorm(o,e),void 0;if(d.downloading||!d.scorm)return;const t=d.currentStatus===i.DownloadStatus.OUTDATED,r=d.scorm;if(!t&&d.currentStatus!==i.DownloadStatus.DOWNLOADABLE_NOT_DOWNLOADED)return d.openScorm(o,e),void 0;yield g.V.confirmDownload(r,t),t&&(yield A.g.ignoreErrors(f.v.invalidateAllScormData(r.id)));try{yield d.downloadScormPackage(),d.isDestroyed||d.openScorm(o,e)}catch(n){d.isDestroyed||M.CoreAlerts.showError(n,{default:l.HT.instant("addon.mod_scorm.errordownloadscorm",{name:r.name})})}}))()}toggleGrades(){this.gradesExpanded=!this.gradesExpanded}openScorm(n,e=!1){var o,t,i,d,r;const a=this.autoPlayData;this.autoPlayData=void 0,this.skip=!1,this.hasPlayed=!0,null===(o=this.dataSentObserver)||void 0===o||o.off(),this.dataSentObserver=p.z.on(I.OI,(n=>{var e;n.scormId===(null===(e=this.scorm)||void 0===e?void 0:e.id)&&(this.dataSent=!0,this.module.completiondata&&_.CoreCourse.isIncompleteAutomaticCompletion(this.module.completiondata)&&_.CoreCourse.invalidateSections(this.courseId))}),this.siteId);c.CoreNavigator.navigateToSitePath(`${I.T2}/${this.courseId}/${this.module.id}/${this.useOnlinePlayer?"online-player":"player"}`,{params:{mode:null!==(t=null==a?void 0:a.mode)&&void 0!==t?t:e?"browse":"normal",moduleUrl:this.module.url,newAttempt:null!==(i=null==a?void 0:a.newAttempt)&&void 0!==i?i:this.startNewAttempt,organizationId:null!==(d=null==a?void 0:a.organizationId)&&void 0!==d?d:this.currentOrganization.identifier,scoId:null!==(r=null==a?void 0:a.scoId)&&void 0!==r?r:n}})}showStatus(n){var e=this;return(0,t.A)((function*(){if(e.useOnlinePlayer)return e.statusMessage="",void 0;if(n===i.DownloadStatus.OUTDATED&&e.scorm){const n=yield f.v.shouldDownloadMainFile(e.scorm,!0);e.statusMessage=n?"addon.mod_scorm.scormstatusoutdated":""}else n===i.DownloadStatus.DOWNLOADABLE_NOT_DOWNLOADED?e.statusMessage="addon.mod_scorm.scormstatusnotdownloaded":n===i.DownloadStatus.DOWNLOADING?e.downloading||e.downloadScormPackage():e.statusMessage=""}))()}sync(n=0){var e=this;return(0,t.A)((function*(){if(!e.scorm)throw new d.CoreError("Cannot sync without a scorm.");if(s.CoreSync.isBlocked(I.Rz,e.scorm.id)&&n<5)return yield h.H.wait(400),e.sync(n+1);const o=yield v.S.syncScorm(e.scorm);return!o.updated&&e.dataSent&&(yield A.g.ignoreErrors(v.S.prefetchModuleAfterUpdate(e.module,e.courseId))),o}))()}ngOnDestroy(){this.onlineObserver.unsubscribe()}}return(n=AddonModScormIndexComponent).ɵfac=function AddonModScormIndexComponent_Factory(e){return new(e||n)(y.rXU(R.W9),y.rXU(a.A,8))},n.ɵcmp=y.VBU({type:n,selectors:[["addon-mod-scorm-index"]],inputs:{autoPlayData:"autoPlayData"},standalone:!0,features:[y.Vt3,y.aNF],decls:8,vars:11,consts:[["slot","end"],["fill","clear","aria-haspopup","true",3,"ariaLabel"],[3,"hideUntil"],[3,"completionChanged","module","description","component","componentId","courseId","hasDataToSync"],["class","core-info-card",4,"ngIf"],[4,"ngIf"],["collapsible-footer","","slot","fixed",4,"ngIf"],["fill","clear","aria-haspopup","true",3,"click","ariaLabel"],["name","fas-circle-info","slot","icon-only","aria-hidden","true"],["iconAction","fas-circle-info",3,"action","priority","content"],[1,"core-info-card"],["name","fas-circle-info","slot","start","aria-hidden","true"],["class","addon-mod_scorm-toc",4,"ngIf"],[1,"ion-text-wrap"],[1,"addon-mod_scorm-attempt-summary"],["class","ion-text-wrap",4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],["button","","class","divider ion-text-wrap",3,"detail","click",4,"ngIf"],[1,"item-heading"],["button","",1,"divider","ion-text-wrap",3,"click","detail"],["name","fas-chevron-right","flip-rtl","","slot","start","aria-hidden","true",1,"expandable-status-icon"],[1,"addon-scorm-last-sync-date"],[1,"addon-mod_scorm-toc"],["class","ion-text-center",4,"ngIf"],["interface","action-sheet",3,"ngModelChange","ionChange","ngModel","cancelText","interfaceOptions"],["slot","label",1,"item-heading"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"ion-text-center"],[3,"class",4,"ngFor","ngForOf"],[3,"name",4,"ngIf"],["class","as-link",3,"click",4,"ngIf"],[3,"name"],[1,"as-link",3,"click"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["collapsible-footer","","slot","fixed"],["class","list-item-limited-width",4,"ngIf"],[3,"courseId","currentModuleId"],[1,"list-item-limited-width"],["class","core-danger-card",4,"ngIf"],["class","core-warning-card",4,"ngIf"],[1,"core-danger-card"],[1,"core-warning-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[1,"adaptable-buttons-row"],["expand","block","fill","outline","class","ion-text-wrap ion-margin",3,"click",4,"ngIf"],["expand","block",1,"ion-text-wrap","ion-margin",3,"click"],["name","newAttempt",3,"ngModelChange","ngModel"],[1,"ion-text-wrap","ion-no-margin","ion-margin-top"],["expand","block","fill","outline",1,"ion-text-wrap","ion-margin",3,"click"],["name","fas-magnifying-glass","slot","start","aria-hidden","true"],["class","item-heading",4,"ngIf"],[3,"progress","a11yText",4,"ngIf"],[3,"progress","a11yText"]],template:function AddonModScormIndexComponent_Template(n,e){1&n&&(y.j41(0,"core-navbar-buttons",0),y.DNE(1,AddonModScormIndexComponent_Conditional_1_Template,3,3,"ion-button",1)(2,AddonModScormIndexComponent_Conditional_2_Template,3,4),y.k0s(),y.j41(3,"core-loading",2)(4,"core-course-module-info",3),y.bIt("completionChanged",(function AddonModScormIndexComponent_Template_core_course_module_info_completionChanged_4_listener(){return e.onCompletionChange()})),y.k0s(),y.DNE(5,AddonModScormIndexComponent_ion_card_5_Template,5,1,"ion-card",4)(6,AddonModScormIndexComponent_div_6_Template,3,2,"div",5)(7,AddonModScormIndexComponent_div_7_Template,3,3,"div",6),y.k0s()),2&n&&(y.R7$(),y.vxM(1,e.courseContentsPage?2:1),y.R7$(2),y.Y8G("hideUntil",!e.showLoading),y.R7$(),y.Y8G("module",e.module)("description",e.description)("component",e.component)("componentId",e.componentId)("courseId",e.courseId)("hasDataToSync",e.hasOffline),y.R7$(),y.Y8G("ngIf",e.scorm&&e.scorm.warningMessage),y.R7$(),y.Y8G("ngIf",e.scorm&&!e.showLoading&&!e.scorm.warningMessage),y.R7$(),y.Y8G("ngIf",!e.showLoading))},dependencies:[T.n,b.Sq,b.bT,G.BC,G.vS,R.Jm,R.b_,R.ME,R.tN,R.eY,R.iq,R.uz,R.he,R.nf,R.Nm,R.Ip,R.w2,R.hB,R.Je,w.B,k.Q,$.R,E.c,F.z,O.t,D.B,j.i,N.T,Y.D9,x.CoreCourseModuleInfoComponent,S.CoreCourseModuleNavigationComponent],styles:["[_nghost-%COMP%]   .addon-mod_scorm-attempt-summary[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{font-size:var(--text-size)}[_nghost-%COMP%]   .addon-mod_scorm-toc[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-inline-end:8px;margin-top:4px}"]}),AddonModScormIndexComponent})()},8214:(n,e,o)=>{o.d(e,{V:()=>f});var t=o(10467),i=o(75629),d=o(52749),r=o(81690),a=o(79555),_=o(1717),c=o(85387),s=o(55554),m=o(25572),l=o(54438);const p=["status","score_raw","total_time","session_time","student_id","student_name","credit","mode","entry"];let u=(()=>{var n;class AddonModScormHelperProvider{confirmDownload(n,e){return(0,t.A)((function*(){if(!(yield _.v.shouldDownloadMainFile(n,e)))return;let o=n.packagesize;return o||(o=yield _.v.calculateScormSize(n),n.packagesize=o),m.CoreAlerts.confirmDownloadSize({size:o,total:!0})}))()}convertAttemptToOffline(n,e,o){return(0,t.A)((function*(){o=o||d.CoreSites.getCurrentSiteId();const t=yield s.g.ignoreErrors(_.v.getScormUserData(n.id,e,{cmId:n.coursemodule,siteId:o}));if(!t)throw new i.CoreError(a.HT.instant("addon.mod_scorm.errorcreateofflineattempt"));const m=yield s.g.ignoreErrors(c.o.getScormUserData(n.id,e,void 0,o)),l=r.j.clone(t);for(const n in l){const e=l[n];if(p.forEach((n=>{delete e.userdata[n]})),m&&m[e.scoid]&&m[e.scoid].userdata){const n={};for(const o in e.userdata)m[e.scoid].userdata[o]||(n[o]=e.userdata[o]);e.userdata=n}}yield c.o.createNewAttempt(n,e,l,t,o)}))()}createOfflineAttempt(n,e,o,r){var _=this;return(0,t.A)((function*(){r=r||d.CoreSites.getCurrentSiteId();const t=yield s.g.ignoreErrors(_.searchOnlineAttemptUserData(n.id,o,{cmId:n.coursemodule,siteId:r}));if(!t)throw new i.CoreError(a.HT.instant("addon.mod_scorm.errorcreateofflineattempt"));for(const n in t){const e=t[n],o={};for(const n in e.userdata)-1==n.indexOf(".")&&-1==p.indexOf(n)&&(o[n]=e.userdata[n]);e.userdata=o}return c.o.createNewAttempt(n,e,t,void 0,r)}))()}determineAttemptToContinue(n,e,o){var i=this;return(0,t.A)((function*(){let t;if(e.online.length&&(t=Math.max.apply(Math,e.online)),!t)return i.getLastBeforeMax(n,e);const d=e.offline.indexOf(t)>-1;return(yield _.v.isAttemptIncomplete(n.id,t,{offline:d,cmId:n.coursemodule,siteId:o}))?{num:t,offline:d}:i.getLastBeforeMax(n,e)}))()}getFirstSco(n,e,o={}){return(0,t.A)((function*(){const t="normal"===(o.mode||"normal");let i=o.toc;i&&i.length||(i=yield _.v.getScosWithData(n,e,o));return i.find((n=>n.isvisible&&n.launch&&n.prereq&&(!t||_.v.isStatusIncomplete(n.status))))||i[0]}))()}getLastBeforeMax(n,e){return n.maxattempt&&e.lastAttempt.num>n.maxattempt?{num:n.maxattempt,offline:e.offline.indexOf(n.maxattempt)>-1}:{num:e.lastAttempt.num,offline:e.lastAttempt.offline}}getNextScoFromToc(n,e){for(let o=n.findIndex((n=>n.id==e))+1;o<n.length;o++)if(n[o].isvisible&&n[o].prereq&&n[o].launch)return n[o]}getPreviousScoFromToc(n,e){for(let o=n.findIndex((n=>n.id==e))-1;o>=0;o--)if(n[o].isvisible&&n[o].prereq&&n[o].launch)return n[o]}getScoFromToc(n,e){return n.find((n=>n.id==e))}getToc(n,e,o,i={}){return(0,t.A)((function*(){const t=yield _.v.getOrganizationToc(n,e,i),d=_.v.formatTocToArray(t);return d.forEach((n=>{n.icon=_.v.getScoStatusIcon(n,o)})),d}))()}searchOnlineAttemptUserData(n,e,o={}){var i=this;return(0,t.A)((function*(){o.siteId=o.siteId||d.CoreSites.getCurrentSiteId();try{return yield _.v.getScormUserData(n,e,o)}catch(t){if(e<=0)throw t;try{return yield i.searchOnlineAttemptUserData(n,e-1,o)}catch{throw t}}}))()}}return(n=AddonModScormHelperProvider).ɵfac=function AddonModScormHelperProvider_Factory(e){return new(e||n)},n.ɵprov=l.jDH({token:n,factory:n.ɵfac,providedIn:"root"}),AddonModScormHelperProvider})();const f=(0,a.Qd)(u)},69006:(n,e,o)=>{o.d(e,{y:()=>f});var t=o(10467),i=o(23063),d=o(49882),r=o(44682),a=o(55554),_=o(51024),c=o(52749),s=o(25572),m=o(79555),l=o(95384),p=o(54438),u=o(2910);let f=(()=>{var n;class CoreCourseModuleMainActivityComponent extends i.x{constructor(n="CoreCourseModuleMainResourceComponent",e,o){super(n,o),this.content=e,this.moduleName=""}ngOnInit(){var _superprop_getNgOnInit=()=>super.ngOnInit,n=this;return(0,t.A)((function*(){yield _superprop_getNgOnInit().call(n),n.hasOffline=!1,n.moduleName=l.CoreCourseModuleHelper.translateModuleName(n.pluginName||n.moduleName||""),n.syncEventName&&(n.syncObserver=d.z.on(n.syncEventName,(e=>{n.autoSyncEventReceived(e)}),n.siteId))}))()}isRefreshSyncNeeded(n){return!1}autoSyncEventReceived(n){this.isRefreshSyncNeeded(n)&&this.showLoadingAndRefresh(!1)}refreshContent(n=!1,e=!1){var o=this;return(0,t.A)((function*(){o.module&&(yield a.g.ignoreErrors(Promise.all([o.invalidateContent(),o.showCompletion?r.CoreCourse.invalidateModule(o.module.id):void 0])),yield o.loadContent(!0,n,e))}))()}showLoadingAndFetch(n=!1,e=!1){var o=this;return(0,t.A)((function*(){var t;o.showLoading=!0,null===(t=o.content)||void 0===t||t.scrollToTop(),yield o.loadContent(!1,n,e)}))()}showLoadingAndRefresh(n=!1,e=!1){var o;return this.showLoading=!0,null===(o=this.content)||void 0===o||o.scrollToTop(),this.refreshContent(n,e)}fetchContent(n=!1,e=!1,o=!1){return(0,t.A)((function*(){}))()}loadContent(n,e=!1,o=!1){var i=this;return(0,t.A)((function*(){if(i.module)try{n&&i.showCompletion&&(yield a.g.ignoreErrors(i.fetchModule())),yield i.fetchContent(n,e,o),i.finishSuccessfulFetch()}catch(o){var t;if(!n&&(null===(t=c.CoreSites.getCurrentSite())||void 0===t||!t.isOfflineDisabled())&&l.CoreCourseModuleHelper.isNotFoundError(o))return yield i.refreshContent(e);s.CoreAlerts.showError(o,{default:m.HT.instant(i.fetchContentDefaultError)})}finally{i.showLoading=!1}}))()}sync(){return(0,t.A)((function*(){return{updated:!1,warnings:[]}}))()}hasSyncSucceed(n){return n.updated}syncActivity(n=!1){var e=this;return(0,t.A)((function*(){try{const n=yield e.sync();return n.warnings.length&&s.CoreAlerts.show({message:n.warnings[0]}),e.hasSyncSucceed(n)}catch(e){return n&&s.CoreAlerts.showError(e,{default:m.HT.instant("core.errorsync")}),!1}}))()}ngOnDestroy(){var n;super.ngOnDestroy(),null===(n=this.syncObserver)||void 0===n||n.off()}}return(n=CoreCourseModuleMainActivityComponent).ɵfac=function CoreCourseModuleMainActivityComponent_Factory(e){return new(e||n)(p.rXU("",8),p.rXU(u.W9),p.rXU(_.A))},n.ɵcmp=p.VBU({type:n,selectors:[["ng-component"]],inputs:{group:"group"},features:[p.Vt3],decls:0,vars:0,template:function CoreCourseModuleMainActivityComponent_Template(n,e){},encapsulation:2}),CoreCourseModuleMainActivityComponent})()}}]);