"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[13004],{13004:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var i=n(10467),o=n(29492),r=n(15324),a=n(19193),s=n(83696),l=n(2401),c=n(24742),u=n(22693),d=n(52749),p=n(79555),m=n(25572),g=n(86654),h=n(54438),f=n(60177),_=n(2910),y=n(16986),v=n(64422),I=n(58197),P=n(88246),C=n(73955),R=n(59528);function AddonCompetencyPlanListPage_core_empty_box_15_Template(e,t){1&e&&(h.nrm(0,"core-empty-box",7),h.nI1(1,"translate")),2&e&&h.Y8G("message",h.bMT(1,1,"addon.competency.noplanswerecreated"))}function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_p_4_Template(e,t){if(1&e&&(h.j41(0,"p"),h.EFF(1),h.nI1(2,"translate"),h.nI1(3,"coreFormatDate"),h.k0s()),2&e){const e=h.XpG().$implicit;h.R7$(),h.Lme(" ",h.bMT(2,2,"addon.competency.duedate"),":  ",h.i5U(3,4,1e3*e.duedate,"strftimedatetimeshort")," ")}}function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template(e,t){if(1&e){const e=h.RV6();h.j41(0,"ion-item",10),h.bIt("click",(function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template_ion_item_click_0_listener(){const t=h.eBV(e).$implicit,n=h.XpG(2);return h.Njj(n.plans.select(t))})),h.j41(1,"ion-label")(2,"p",11),h.nrm(3,"core-format-text",12),h.k0s(),h.DNE(4,AddonCompetencyPlanListPage_ion_list_16_ion_item_1_p_4_Template,4,7,"p",13),h.k0s(),h.j41(5,"ion-badge",14),h.EFF(6),h.k0s()()}if(2&e){const e=t.$implicit,n=h.XpG(2);h.Y8G("detail",!0),h.BMQ("aria-label",e.name)("aria-current",n.plans.getItemAriaCurrent(e)),h.R7$(3),h.Y8G("text",e.name)("contextInstanceId",e.userid),h.R7$(),h.Y8G("ngIf",e.duedate>0),h.R7$(),h.Y8G("color",e.statuscolor),h.R7$(),h.JRh(e.statusname)}}function AddonCompetencyPlanListPage_ion_list_16_Template(e,t){if(1&e&&(h.j41(0,"ion-list",8),h.DNE(1,AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template,7,8,"ion-item",9),h.k0s()),2&e){const e=h.XpG();h.R7$(),h.Y8G("ngForOf",e.plans.items)}}let b=(()=>{var e;class AddonCompetencyPlanListPage{constructor(){var e;const t=null!==(e=r.CoreNavigator.getRouteNumberParam("userId"))&&void 0!==e?e:d.CoreSites.getCurrentSiteUserId(),n=s.u.getOrCreateSource(a.L,[t]);this.plans=new l.R(n,AddonCompetencyPlanListPage),this.logView=c.j.once((0,i.A)((function*(){u.OF.logEvent({type:u.qr.VIEW_ITEM_LIST,ws:"tool_lp_data_for_plans_page",name:p.HT.instant("addon.competency.userplans"),data:{userid:t},url:`/admin/tool/lp/plans.php?userid=${t}`})})))}ngAfterViewInit(){var e=this;return(0,i.A)((function*(){yield e.fetchLearningPlans(),e.plans.start(e.splitView)}))()}fetchLearningPlans(){var e=this;return(0,i.A)((function*(){try{yield e.plans.load(),e.logView()}catch(e){m.CoreAlerts.showError(e,{default:"Error getting learning plans data."})}}))()}refreshLearningPlans(e){var t=this;return(0,i.A)((function*(){yield t.plans.getSource().invalidateCache(),t.plans.getSource().setDirty(!0),t.fetchLearningPlans().finally((()=>{null==e||e.complete()}))}))()}ngOnDestroy(){this.plans.destroy()}}return(e=AddonCompetencyPlanListPage).ɵfac=function AddonCompetencyPlanListPage_Factory(t){return new(t||e)},e.ɵcmp=h.VBU({type:e,selectors:[["page-addon-competency-planlist"]],viewQuery:function AddonCompetencyPlanListPage_Query(e,t){if(1&e&&h.GBs(o.M,5),2&e){let e;h.mGM(e=h.lsd())&&(t.splitView=e.first)}},standalone:!0,features:[h.aNF],decls:17,vars:13,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-route",3,"message",4,"ngIf"],["class","ion-no-margin",4,"ngIf"],["icon","fas-route",3,"message"],[1,"ion-no-margin"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"click","detail"],[1,"item-heading"],["contextLevel","user",3,"text","contextInstanceId"],[4,"ngIf"],["slot","end",1,"ion-text-wrap",3,"color"]],template:function AddonCompetencyPlanListPage_Template(e,t){1&e&&(h.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),h.nrm(3,"ion-back-button",1),h.nI1(4,"translate"),h.k0s(),h.j41(5,"ion-title")(6,"h1"),h.EFF(7),h.nI1(8,"translate"),h.k0s()()()(),h.j41(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),h.bIt("ionRefresh",(function AddonCompetencyPlanListPage_Template_ion_refresher_ionRefresh_11_listener(e){return t.refreshLearningPlans(e.target)})),h.nrm(12,"ion-refresher-content",3),h.nI1(13,"translate"),h.k0s(),h.j41(14,"core-loading",4),h.DNE(15,AddonCompetencyPlanListPage_core_empty_box_15_Template,2,3,"core-empty-box",5)(16,AddonCompetencyPlanListPage_ion_list_16_Template,2,1,"ion-list",6),h.k0s()()()),2&e&&(h.R7$(3),h.Y8G("text",h.bMT(4,7,"core.back")),h.R7$(4),h.JRh(h.bMT(8,9,"addon.competency.userplans")),h.R7$(4),h.Y8G("disabled",!t.plans.loaded),h.R7$(),h.FS9("pullingText",h.bMT(13,11,"core.pulltorefresh")),h.R7$(2),h.Y8G("hideUntil",t.plans.loaded),h.R7$(),h.Y8G("ngIf",t.plans.empty),h.R7$(),h.Y8G("ngIf",!t.plans.empty))},dependencies:[g.n,f.Sq,f.bT,_.In,_.QW,_.W9,_.eU,_.uz,_.he,_.nf,_.To,_.Ki,_.BC,_.ai,_.el,y.h,v.R,o.M,I.B,P.i,C.D9,R.f],encapsulation:2}),AddonCompetencyPlanListPage})()},2401:(e,t,n)=>{n.d(t,{R:()=>CoreListItemsManager});var i=n(10467),o=n(21182),r=n(15324),a=n(93417),s=n(81690),l=n(95990),c=n(82907),u=n(24742),d=n(55554);class CoreListItemsManager extends l.u{constructor(e,t){super(e);const n=s.j.debounce((()=>this.scrollToCurrentElement()),300);this.pageRouteLocator=t,this.addListener({onSelectedItemUpdated:n}),this.finishSuccessfulFetch=u.j.once((()=>d.g.ignoreErrors(this.logActivity())))}get items(){return this.getSource().getItems()||[]}get loaded(){return null!==this.itemsMap}get completed(){return this.getSource().isCompleted()}get empty(){const e=this.getSource().getItems();return null===e||0===e.length}start(e){var t=this;return(0,i.A)((function*(){e&&t.watchSplitViewOutlet(e),t.updateSelectedItem()}))()}destroy(){var e;super.destroy(),null===(e=this.splitViewOutletSubscription)||void 0===e||e.unsubscribe()}watchSplitViewOutlet(e){var t;this.splitView=e,this.splitViewOutletSubscription=e.outletRouteObservable.subscribe((e=>this.updateSelectedItem(this.getPageRouteFromSplitViewOutlet(e)))),this.updateSelectedItem(null!==(t=this.getPageRouteFromSplitViewOutlet(e.outletRoute))&&void 0!==t?t:null)}isSelected(e){return this.selectedItem===e}getItemAriaCurrent(e){return this.isSelected(e)?"page":"false"}select(e){var t=this;return(0,i.A)((function*(){if(!e)return yield t.navigateToIndex({reset:t.resetNavigation()}),void 0;yield t.navigateToItem(e,{reset:t.resetNavigation()})}))()}reset(){this.getSource().reset()}reload(){var e=this;return(0,i.A)((function*(){yield e.getSource().reload(),e.finishSuccessfulFetch()}))()}load(){var e=this;return(0,i.A)((function*(){yield e.getSource().load(),e.finishSuccessfulFetch()}))()}logActivity(){return(0,i.A)((function*(){}))()}resetNavigation(){var e;return!!a.CoreScreen.isTablet&&!(!this.splitView||null!==(e=this.splitView)&&void 0!==e&&e.isNested)}updateSelectedItem(e=null){super.updateSelectedItem(e);this.select(a.CoreScreen.isTablet&&null===this.selectedItem&&this.splitView&&!this.splitView.isNested?this.getDefaultItem():this.selectedItem)}scrollToCurrentElement(){var e=this;return(0,i.A)((function*(){var t,n,i;if(a.CoreScreen.isMobile)return;const o=(null!==(t=null===(n=e.splitView)||void 0===n?void 0:n.nativeElement)&&void 0!==t?t:document).querySelector('[aria-current="page"]');if(!o)return;c.y.isElementInViewport(o,1,null===(i=e.splitView)||void 0===i?void 0:i.nativeElement)||o.scrollIntoView({behavior:"smooth"})}))()}getDefaultItem(){return this.items[0]||null}getCurrentPageRoute(){return this.pageRouteLocator instanceof o.nX?r.CoreNavigator.isRouteActive(this.pageRouteLocator)?this.pageRouteLocator:null:r.CoreNavigator.getCurrentRoute({pageComponent:this.pageRouteLocator})}getSelectedItemPathFromRoute(e){const t=[];for(;e.firstChild;)t.push(...r.CoreNavigator.getRouteUrl(e=e.firstChild));return t.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}getPageRouteFromSplitViewOutlet(e){const t=this.buildRouteMatcher();for(;e&&!t(e);)e=e.parent;return e}buildRouteMatcher(){if(this.pageRouteLocator instanceof o.nX){const e=r.CoreNavigator.getRouteFullPath(this.pageRouteLocator);return t=>r.CoreNavigator.getRouteFullPath(t)===e}return e=>e.component===this.pageRouteLocator}}}}]);