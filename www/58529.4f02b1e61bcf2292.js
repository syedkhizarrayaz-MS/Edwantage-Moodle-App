"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[58529],{58529:(e,o,n)=>{n.r(o),n.d(o,{CoreQuestionComponent:()=>I});var t=n(10467),r=n(91416),i=n(54438),c=n(25124),s=n(13482),a=n(89857),u=n(69319),l=n(82907),d=n(55554),p=n(79555),m=n(62393),g=n(6787),C=n(58364),b=n(68162),q=n(86654),h=n(60177),f=n(2910),_=n(58197),v=n(43570),k=n(73955);const _c0=e=>({$a:e});function CoreQuestionComponent_core_dynamic_component_0_Template(e,o){if(1&e&&(i.j41(0,"core-dynamic-component",7)(1,"p",8),i.EFF(2),i.nI1(3,"translate"),i.k0s()()),2&e){const e=i.XpG();i.ZvI("core-question-",null==e.question?null:e.question.slot,""),i.Y8G("component",e.componentClass)("data",e.data),i.R7$(2),i.JRh(i.i5U(3,6,"core.question.errorquestionnotsupported",i.eq3(9,_c0,null==e.question?null:e.question.type)))}}function CoreQuestionComponent_input_1_Template(e,o){if(1&e&&i.nrm(0,"input",9),2&e){const e=i.XpG();i.FS9("name",e.seqCheck.name),i.FS9("value",e.seqCheck.value)}}function CoreQuestionComponent_core_dynamic_component_2_Template(e,o){if(1&e&&i.nrm(0,"core-dynamic-component",7),2&e){const e=o.$implicit,n=i.XpG();i.Y8G("component",e)("data",n.data)}}function CoreQuestionComponent_ion_item_3_Template(e,o){if(1&e&&(i.j41(0,"ion-item",10)(1,"ion-label")(2,"p"),i.EFF(3),i.k0s()()()),2&e){const e=i.XpG();i.R7$(3),i.JRh(e.validationError)}}function CoreQuestionComponent_ion_button_4_Template(e,o){if(1&e){const e=i.RV6();i.j41(0,"ion-button",11),i.bIt("click",(function CoreQuestionComponent_ion_button_4_Template_ion_button_click_0_listener(){const o=i.eBV(e).$implicit,n=i.XpG();return i.Njj(n.buttonClicked.emit(o))})),i.nrm(1,"core-format-text",12),i.k0s()}if(2&e){const e=o.$implicit,n=i.XpG();i.Y8G("disabled",e.disabled),i.R7$(),i.Y8G("component",n.component)("componentId",n.componentId)("text",e.value)("contextLevel",n.contextLevel)("contextInstanceId",n.contextInstanceId)("courseId",n.courseId)}}function CoreQuestionComponent_ion_item_5_Template(e,o){if(1&e&&(i.j41(0,"ion-item",13)(1,"ion-label"),i.nrm(2,"core-format-text",12),i.k0s()()),2&e){const e=i.XpG();i.R7$(2),i.Y8G("component",e.component)("componentId",e.componentId)("text",e.question.feedbackHtml)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId)("courseId",e.courseId)}}function CoreQuestionComponent_ion_item_6_Template(e,o){if(1&e&&(i.j41(0,"ion-item",14)(1,"ion-label"),i.nrm(2,"core-format-text",12),i.k0s()()),2&e){const e=i.XpG();i.R7$(2),i.Y8G("component",e.component)("componentId",e.componentId)("text",e.question.commentHtml)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId)("courseId",e.courseId)}}let I=(()=>{var e;class CoreQuestionComponent{set dynComponent(e){e&&this.promisedDynamicComponent.resolve(e)}get showQuestion(){return this.showQuestionPromise.isResolved()}ready(){var e=this;return(0,t.A)((function*(){yield e.showQuestionPromise;return(yield e.promisedDynamicComponent).ready()}))()}constructor(e,o){this.changeDetector=e,this.element=o,this.offlineEnabled=!1,this.review=!1,this.buttonClicked=new i.bkB,this.onAbort=new i.bkB,this.data={},this.behaviourComponents=[],this.promisedDynamicComponent=new c._,this.showQuestionPromise=new c._,this.logger=g.CoreLogger.getInstance("CoreQuestionComponent"),m.D.register(this.element.nativeElement,this)}ngOnInit(){var e=this;return(0,t.A)((function*(){if(!e.question||"random"!==e.question.type&&!a.CoreQuestionDelegate.isQuestionSupported(e.question.type))return e.showQuestionPromise.resolve(),void 0;if(e.componentClass=yield d.g.ignoreErrors(a.CoreQuestionDelegate.getComponentForQuestion(e.question)),!e.componentClass)return e.showQuestionPromise.resolve(),void 0;e.data={question:e.question,component:e.component,componentId:e.componentId,attemptId:e.attemptId,offlineEnabled:e.offlineEnabled,contextLevel:e.contextLevel,contextInstanceId:e.contextInstanceId,courseId:e.courseId,review:e.review,preferredBehaviour:e.preferredBehaviour,buttonClicked:e.buttonClicked,onAbort:e.onAbort},u.CoreQuestionHelper.extractQuestionScripts(e.question,e.usageId);const o=a.CoreQuestionDelegate.getBehaviourForQuestion(e.question,e.preferredBehaviour||"");if(!s.CoreQuestionBehaviourDelegate.isBehaviourSupported(o))return e.logger.warn("Aborting question because the behaviour is not supported.",e.question.slot),u.CoreQuestionHelper.showComponentError(e.onAbort,`${p.HT.instant("addon.mod_quiz.errorbehaviournotsupported")} ${o}`),void 0;if(e.seqCheck=u.CoreQuestionHelper.getQuestionSequenceCheckFromHtml(e.question.html),!e.seqCheck)return e.logger.warn("Aborting question because couldn't retrieve sequence check.",e.question.slot),u.CoreQuestionHelper.showComponentError(e.onAbort),void 0;u.CoreQuestionHelper.extractQbehaviourRedoButton(e.question),e.offlineEnabled&&e.component&&e.attemptId?yield u.CoreQuestionHelper.loadLocalAnswers(e.question,e.component,e.attemptId):e.question.localAnswers={},u.CoreQuestionHelper.loadLocalAnswersInHtml(e.question),u.CoreQuestionHelper.extractQuestionFeedback(e.question),u.CoreQuestionHelper.extractQuestionComment(e.question);try{e.behaviourComponents=yield s.CoreQuestionBehaviourDelegate.handleQuestion(e.preferredBehaviour||"",e.question)}finally{e.question.html=l.y.removeElementFromHtml(e.question.html,".im-controls"),e.showQuestionPromise.resolve(),yield e.loadValidationError()}}))()}loadValidationError(){var e=this;return(0,t.A)((function*(){e.question&&(yield e.ready(),e.validationError=u.CoreQuestionHelper.getValidationErrorFromHtml(e.question.html),e.offlineEnabled&&e.component&&e.attemptId&&e.question.localAnswers&&!C.T.isEmpty(e.question.localAnswers)&&(e.validationError=a.CoreQuestionDelegate.getValidationError(e.question,e.question.localAnswers,e.validationError,e.component,e.attemptId)))}))()}updateSequenceCheck(e){this.question&&e[this.question.slot]&&(this.seqCheck=e[this.question.slot],this.changeDetector.detectChanges())}}return(e=CoreQuestionComponent).ɵfac=function CoreQuestionComponent_Factory(o){return new(o||e)(i.rXU(i.gRc),i.rXU(i.aKT))},e.ɵcmp=i.VBU({type:e,selectors:[["core-question"]],viewQuery:function CoreQuestionComponent_Query(e,o){if(1&e&&i.GBs(b.m,5),2&e){let e;i.mGM(e=i.lsd())&&(o.dynComponent=e.first)}},inputs:{question:"question",component:"component",componentId:"componentId",attemptId:"attemptId",usageId:"usageId",offlineEnabled:[i.Mj6.HasDecoratorInputTransform,"offlineEnabled","offlineEnabled",r.G],contextLevel:"contextLevel",contextInstanceId:"contextInstanceId",courseId:"courseId",review:[i.Mj6.HasDecoratorInputTransform,"review","review",r.G],preferredBehaviour:"preferredBehaviour"},outputs:{buttonClicked:"buttonClicked",onAbort:"onAbort"},standalone:!0,features:[i.GFd,i.aNF],decls:7,vars:7,consts:[[3,"component","data","class",4,"ngIf"],["type","hidden",3,"name","value",4,"ngIf"],[3,"component","data",4,"ngFor","ngForOf"],["class","ion-text-wrap core-danger-item",4,"ngIf"],["class","ion-margin-vertical ion-text-wrap","expand","block",3,"disabled","click",4,"ngFor","ngForOf"],["class","ion-text-wrap core-question-feedback-container",4,"ngIf"],["class","ion-text-wrap core-question-comment",4,"ngIf"],[3,"component","data"],[1,"ion-padding"],["type","hidden",3,"name","value"],[1,"ion-text-wrap","core-danger-item"],["expand","block",1,"ion-margin-vertical","ion-text-wrap",3,"click","disabled"],[3,"component","componentId","text","contextLevel","contextInstanceId","courseId"],[1,"ion-text-wrap","core-question-feedback-container"],[1,"ion-text-wrap","core-question-comment"]],template:function CoreQuestionComponent_Template(e,o){1&e&&i.DNE(0,CoreQuestionComponent_core_dynamic_component_0_Template,4,11,"core-dynamic-component",0)(1,CoreQuestionComponent_input_1_Template,1,2,"input",1)(2,CoreQuestionComponent_core_dynamic_component_2_Template,1,2,"core-dynamic-component",2)(3,CoreQuestionComponent_ion_item_3_Template,4,1,"ion-item",3)(4,CoreQuestionComponent_ion_button_4_Template,2,7,"ion-button",4)(5,CoreQuestionComponent_ion_item_5_Template,3,6,"ion-item",5)(6,CoreQuestionComponent_ion_item_6_Template,3,6,"ion-item",6),2&e&&(i.Y8G("ngIf",o.showQuestion),i.R7$(),i.Y8G("ngIf",o.seqCheck),i.R7$(),i.Y8G("ngForOf",o.behaviourComponents),i.R7$(),i.Y8G("ngIf",o.validationError),i.R7$(),i.Y8G("ngForOf",null==o.question?null:o.question.behaviourButtons),i.R7$(),i.Y8G("ngIf",o.question&&o.question.feedbackHtml),i.R7$(),i.Y8G("ngIf",o.question&&o.question.commentHtml))},dependencies:[q.n,h.Sq,h.bT,f.Jm,f.uz,f.he,b.m,_.B,v.T,k.D9],styles:["[_nghost-%COMP%]     .core-question-answer-correct{color:var(--core-question-correct-color)}[_nghost-%COMP%]     .core-question-answer-partiallycorrect{color:var(--core-question-partial-color)}[_nghost-%COMP%]     .core-question-answer-incorrect{color:var(--core-question-incorrect-color)}[_nghost-%COMP%]     input.core-question-answer-correct, [_nghost-%COMP%]     select.core-question-answer-correct{--background: var(--core-question-correct-color-bg);--contrast-background: var(--background)}[_nghost-%COMP%]     input.core-question-answer-partiallycorrect, [_nghost-%COMP%]     select.core-question-answer-partiallycorrect{--background: var(--core-question-partial-color-bg);--contrast-background: var(--background)}[_nghost-%COMP%]     input.core-question-answer-incorrect, [_nghost-%COMP%]     select.core-question-answer-incorrect{--background: var(--core-question-incorrect-color-bg);--contrast-background: var(--background)}[_nghost-%COMP%]     .core-question-feedback-container  {--color: var(--core-question-feedback-color);--background: var(--core-question-feedback-background-color);color:var(--core-question-feedback-color);background-color:var(--core-question-feedback-background-color)}[_nghost-%COMP%]     .core-question-feedback-container   .specificfeedback, [_nghost-%COMP%]     .core-question-feedback-container   .rightanswer, [_nghost-%COMP%]     .core-question-feedback-container   .im-feedback, [_nghost-%COMP%]     .core-question-feedback-container   .feedback, [_nghost-%COMP%]     .core-question-feedback-container   .generalfeedback{font:var(--mdl-typography-body-font-md);margin:0 0 .5em}[_nghost-%COMP%]     .core-question-feedback-container   .specificfeedback p, [_nghost-%COMP%]     .core-question-feedback-container   .rightanswer p, [_nghost-%COMP%]     .core-question-feedback-container   .im-feedback p, [_nghost-%COMP%]     .core-question-feedback-container   .feedback p, [_nghost-%COMP%]     .core-question-feedback-container   .generalfeedback p{--color: var(--core-question-feedback-color)}[_nghost-%COMP%]     .core-question-feedback-container   .correctness{display:inline-block;padding:2px 4px;font-weight:700;line-height:14px;color:var(--white);text-shadow:0 -1px 0 rgba(0,0,0,.25);background-color:var(--gray-500);border-radius:3px}[_nghost-%COMP%]     .core-question-feedback-container   .correctness.incorrect{background-color:var(--danger)}[_nghost-%COMP%]     .core-question-feedback-container   .correctness.correct{background-color:var(--success)}[_nghost-%COMP%]     .core-question-feedback-inline{display:inline-block;margin-inline-start:4px;margin-inline-end:0px}[_nghost-%COMP%]     .core-question-feedback-padding{padding-inline-start:14px;padding-inline-end:35px;padding-top:8px;padding-bottom:8px}[_nghost-%COMP%]     .core-question-correct, [_nghost-%COMP%]     .core-question-comment{--background: var(--core-question-correct-color-bg);background-color:var(--core-question-correct-color-bg);color:var(--core-question-correct-color)}[_nghost-%COMP%]     .core-question-partiallycorrect{--background: var(--core-question-partial-color-bg);background-color:var(--core-question-partial-color-bg);color:var(--core-question-partial-color)}[_nghost-%COMP%]     .core-question-notanswered, [_nghost-%COMP%]     .core-question-incorrect{--background: var(--core-question-incorrect-color-bg);background-color:var(--core-question-incorrect-color-bg);color:var(--core-question-incorrect-color)}[_nghost-%COMP%]     .core-question-answersaved, [_nghost-%COMP%]     .core-question-requiresgrading{color:var(--ion-text-color);background-color:var(--core-question-saved-color-bg)}[_nghost-%COMP%]     .core-question-warning{color:var(--core-question-warning-color)}[_nghost-%COMP%]     .questioncorrectnessicon, [_nghost-%COMP%]     .fa.icon.questioncorrectnessicon{font-size:var(--mdl-typography-icon-fontSize-md);vertical-align:middle;margin:4px}"]}),CoreQuestionComponent})()}}]);