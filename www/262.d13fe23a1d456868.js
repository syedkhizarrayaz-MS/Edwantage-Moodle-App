"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[262],{262:(e,o,n)=>{n.r(o),n.d(o,{CoreBlockSideBlocksComponent:()=>v});var l=n(10467),t=n(79555),i=n(44682),c=n(63561),s=n(44666),r=n(55554),a=n(50572),d=n(82907),k=n(53794),m=n(86654),p=n(25572),_=n(54438),f=n(60177),u=n(2910),b=n(16986),C=n(64422),B=n(86198),h=n(88246),g=n(43570),I=n(73955);function CoreBlockSideBlocksComponent_ion_list_11_ng_container_1_core_block_1_Template(e,o){if(1&e&&_.nrm(0,"core-block",12),2&e){const e=_.XpG().$implicit,o=_.XpG(2);_.Y8G("block",e)("contextLevel",o.contextLevel)("instanceId",o.instanceId)}}function CoreBlockSideBlocksComponent_ion_list_11_ng_container_1_Template(e,o){if(1&e&&(_.qex(0),_.DNE(1,CoreBlockSideBlocksComponent_ion_list_11_ng_container_1_core_block_1_Template,1,3,"core-block",11),_.bVm()),2&e){const e=o.$implicit;_.R7$(),_.Y8G("ngIf",e.visible)}}function CoreBlockSideBlocksComponent_ion_list_11_Template(e,o){if(1&e&&(_.j41(0,"ion-list"),_.DNE(1,CoreBlockSideBlocksComponent_ion_list_11_ng_container_1_Template,2,1,"ng-container",10),_.k0s()),2&e){const e=_.XpG();_.R7$(),_.Y8G("ngForOf",e.blocks)}}function CoreBlockSideBlocksComponent_core_empty_box_12_Template(e,o){1&e&&(_.nrm(0,"core-empty-box",13),_.nI1(1,"translate")),2&e&&_.Y8G("message",_.bMT(1,1,"core.block.noblocks"))}let v=(()=>{var e;class CoreBlockSideBlocksComponent{constructor(e){this.elementRef=e,this.loaded=!1,this.blocks=[]}ngOnInit(){var e=this;return(0,l.A)((function*(){e.loadContent().finally((()=>{e.loaded=!0,e.focusInitialBlock()}))}))()}invalidateBlocks(){var e=this;return(0,l.A)((function*(){var o;const n=[];n.push("course"===e.contextLevel?i.CoreCourse.invalidateCourseBlocks(e.instanceId):a.CoreCoursesDashboard.invalidateDashboardBlocks()),null===(o=e.blocksComponents)||void 0===o||o.forEach((e=>{n.push(e.invalidate().catch((()=>{})))})),yield Promise.all(n)}))()}loadContent(){var e=this;return(0,l.A)((function*(){try{if("course"===e.contextLevel)e.blocks=yield c.CoreBlockHelper.getCourseBlocks(e.instanceId);else{const o=yield a.CoreCoursesDashboard.getDashboardBlocks(void 0,void 0,e.myDashboardPage);e.blocks=o.sideBlocks}}catch(o){p.CoreAlerts.showError(o),e.blocks=[]}e.blocks=e.blocks.filter((e=>"html"!==e.name||e.contents&&!d.y.htmlIsBlank(e.contents.content)))}))()}doRefresh(e){var o=this;return(0,l.A)((function*(){yield r.g.ignoreErrors(o.invalidateBlocks()),yield o.loadContent().finally((()=>{null==e||e.complete()}))}))()}closeModal(){t.W3.dismiss()}focusInitialBlock(){var e=this;return(0,l.A)((function*(){if(!e.initialBlockInstanceId)return;const o=`#block-${e.initialBlockInstanceId}`;yield k.H.waitFor((()=>!!e.elementRef.nativeElement.querySelector(o))),yield k.H.wait(200),d.y.scrollToElement(e.elementRef.nativeElement,o,{addYAxis:-10})}))()}}return(e=CoreBlockSideBlocksComponent).ɵfac=function CoreBlockSideBlocksComponent_Factory(o){return new(o||e)(_.rXU(_.aKT))},e.ɵcmp=_.VBU({type:e,selectors:[["core-block-side-blocks"]],viewQuery:function CoreBlockSideBlocksComponent_Query(e,o){if(1&e&&_.GBs(s.CoreBlockComponent,5),2&e){let e;_.mGM(e=_.lsd())&&(o.blocksComponents=e)}},inputs:{contextLevel:"contextLevel",instanceId:"instanceId",initialBlockInstanceId:"initialBlockInstanceId",myDashboardPage:"myDashboardPage"},standalone:!0,features:[_.aNF],decls:13,vars:11,consts:[[1,"no-title"],["slot","end"],["fill","clear",3,"click","ariaLabel"],["name","fas-xmark","slot","icon-only","aria-hidden","true"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],["placeholderType","column","placeholderHeight","120px",3,"hideUntil"],[4,"ngIf"],["icon","fas-table-cells-large",3,"message",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"block","contextLevel","instanceId",4,"ngIf"],[3,"block","contextLevel","instanceId"],["icon","fas-table-cells-large",3,"message"]],template:function CoreBlockSideBlocksComponent_Template(e,o){1&e&&(_.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),_.nI1(4,"translate"),_.bIt("click",(function CoreBlockSideBlocksComponent_Template_ion_button_click_3_listener(){return o.closeModal()})),_.nrm(5,"ion-icon",3),_.k0s()()()(),_.j41(6,"ion-content",4)(7,"ion-refresher",5),_.bIt("ionRefresh",(function CoreBlockSideBlocksComponent_Template_ion_refresher_ionRefresh_7_listener(e){return o.doRefresh(e.target)})),_.nrm(8,"ion-refresher-content",6),_.nI1(9,"translate"),_.k0s(),_.j41(10,"core-loading",7),_.DNE(11,CoreBlockSideBlocksComponent_ion_list_11_Template,2,1,"ion-list",8)(12,CoreBlockSideBlocksComponent_core_empty_box_12_Template,2,3,"core-empty-box",9),_.k0s()()),2&e&&(_.R7$(3),_.Y8G("ariaLabel",_.bMT(4,7,"core.close")),_.R7$(3),_.Y8G("fullscreen",!0),_.R7$(),_.Y8G("disabled",!o.loaded),_.R7$(),_.FS9("pullingText",_.bMT(9,9,"core.pulltorefresh")),_.R7$(2),_.Y8G("hideUntil",o.loaded),_.R7$(),_.Y8G("ngIf",o.blocks.length>0),_.R7$(),_.Y8G("ngIf",0===o.blocks.length))},dependencies:[m.n,f.Sq,f.bT,u.Jm,u.QW,u.W9,u.eU,u.iq,u.nf,u.To,u.Ki,u.ai,b.h,C.R,B.t,h.i,g.T,I.D9,s.CoreBlockComponent],styles:["@media (min-width: 768px){[_nghost-%COMP%]     core-block .ion-hide-md-down{display:none!important}[_nghost-%COMP%]     core-block .ion-hide-md-up{display:block!important}}"]}),CoreBlockSideBlocksComponent})()}}]);