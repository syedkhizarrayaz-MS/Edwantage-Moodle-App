"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[52900],{52900:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var o=n(10467),a=n(15324),i=n(52266),r=n(83696),c=n(19193),l=n(2401),s=n(71852),p=n(22693),d=n(24742),m=n(25572),u=n(86654),_=n(54438),g=n(60177),h=n(2910),f=n(64422),y=n(49234),R=n(16658),P=n(58197),I=n(28988),b=n(88246),C=n(73955),v=n(59528);const _c0=(e,t)=>({x:e,y:t}),_c1=e=>({$a:e});function AddonCompetencyPlanPage_h1_6_Template(e,t){if(1&e&&(_.j41(0,"h1"),_.nrm(1,"core-format-text",7),_.k0s()),2&e){const e=_.XpG();_.R7$(),_.Y8G("text",e.plan.plan.name)("contextInstanceId",e.plan.plan.userid)}}function AddonCompetencyPlanPage_ion_card_12_Template(e,t){if(1&e&&(_.j41(0,"ion-card")(1,"ion-item",8)(2,"ion-label"),_.nrm(3,"core-user-avatar",9),_.j41(4,"p",10),_.EFF(5),_.k0s()()()()),2&e){const e=_.XpG();_.R7$(3),_.Y8G("user",e.user),_.R7$(2),_.JRh(e.user.fullname)}}function AddonCompetencyPlanPage_ion_card_13_ion_item_2_Template(e,t){if(1&e&&(_.j41(0,"ion-item",8)(1,"ion-label")(2,"p"),_.nrm(3,"core-format-text",7),_.k0s()()()),2&e){const e=_.XpG(2);_.R7$(3),_.Y8G("text",e.plan.plan.description)("contextInstanceId",e.plan.plan.userid)}}function AddonCompetencyPlanPage_ion_card_13_ion_item_10_Template(e,t){if(1&e&&(_.j41(0,"ion-item",8)(1,"ion-label")(2,"p",10),_.EFF(3),_.nI1(4,"translate"),_.k0s(),_.j41(5,"p"),_.EFF(6),_.nI1(7,"coreFormatDate"),_.k0s()()()),2&e){const e=_.XpG(2);_.R7$(3),_.JRh(_.bMT(4,2,"addon.competency.duedate")),_.R7$(3),_.JRh(_.bMT(7,4,1e3*e.plan.plan.duedate))}}function AddonCompetencyPlanPage_ion_card_13_ion_item_11_Template(e,t){if(1&e&&(_.j41(0,"ion-item",8)(1,"ion-label")(2,"p",10),_.EFF(3),_.nI1(4,"translate"),_.k0s(),_.j41(5,"p"),_.nrm(6,"core-format-text",14),_.k0s()()()),2&e){const e=_.XpG(2);_.R7$(3),_.JRh(_.bMT(4,3,"addon.competency.template")),_.R7$(3),_.Y8G("text",e.plan.plan.template.shortname)("contextInstanceId",0)}}function AddonCompetencyPlanPage_ion_card_13_Template(e,t){if(1&e&&(_.j41(0,"ion-card")(1,"ion-list"),_.DNE(2,AddonCompetencyPlanPage_ion_card_13_ion_item_2_Template,4,2,"ion-item",11),_.j41(3,"ion-item",8)(4,"ion-label")(5,"p",10),_.EFF(6),_.nI1(7,"translate"),_.k0s(),_.j41(8,"p"),_.EFF(9),_.k0s()()(),_.DNE(10,AddonCompetencyPlanPage_ion_card_13_ion_item_10_Template,8,6,"ion-item",11)(11,AddonCompetencyPlanPage_ion_card_13_ion_item_11_Template,7,5,"ion-item",11),_.j41(12,"ion-item",8)(13,"ion-label",12)(14,"p",10),_.EFF(15),_.nI1(16,"translate"),_.k0s(),_.j41(17,"p"),_.EFF(18),_.nI1(19,"translate"),_.k0s(),_.nrm(20,"core-progress-bar",13),_.k0s()()()()),2&e){const e=_.XpG();_.R7$(2),_.Y8G("ngIf",e.plan.plan.description),_.R7$(4),_.JRh(_.bMT(7,13,"addon.competency.status")),_.R7$(3),_.JRh(e.plan.plan.statusname),_.R7$(),_.Y8G("ngIf",e.plan.plan.duedate>0),_.R7$(),_.Y8G("ngIf",e.plan.plan.template),_.R7$(2),_.Mz_("id","addon-competency-plan-",e.plan.plan.id,"-progress"),_.R7$(2),_.JRh(_.bMT(16,15,"addon.competency.progress")),_.R7$(3),_.SpI(" ",_.i5U(19,17,"addon.competency.xcompetenciesproficientoutofy",_.eq3(23,_c1,_.l_i(20,_c0,e.plan.proficientcompetencycount,e.plan.competencycount)))," "),_.R7$(2),_.Mz_("ariaDescribedBy","addon-competency-plan-",e.plan.plan.id,"-progress"),_.Y8G("progress",e.plan.proficientcompetencypercentage)("text",e.plan.proficientcompetencypercentageformatted)}}function AddonCompetencyPlanPage_ion_card_14_ion_item_6_Template(e,t){1&e&&(_.j41(0,"ion-item",8)(1,"ion-label")(2,"p"),_.EFF(3),_.nI1(4,"translate"),_.k0s()()()),2&e&&(_.R7$(3),_.JRh(_.bMT(4,1,"addon.competency.nocompetencies")))}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_6_Template(e,t){if(1&e&&(_.j41(0,"ion-badge",18),_.EFF(1),_.k0s()),2&e){const e=_.XpG().$implicit;_.Y8G("color",e.usercompetencyplan.proficiency?"success":"danger"),_.R7$(),_.SpI(" ",e.usercompetencyplan.gradename," ")}}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_7_Template(e,t){if(1&e&&(_.j41(0,"ion-badge",18),_.EFF(1),_.k0s()),2&e){const e=_.XpG().$implicit;_.Y8G("color",e.usercompetency.proficiency?"success":"danger"),_.R7$(),_.SpI(" ",e.usercompetency.gradename," ")}}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template(e,t){if(1&e){const e=_.RV6();_.j41(0,"ion-item",16),_.bIt("click",(function AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template_ion_item_click_0_listener(){const t=_.eBV(e).$implicit,n=_.XpG(2);return _.Njj(n.competencies.select(t))})),_.j41(1,"ion-label")(2,"p",10),_.nrm(3,"core-format-text",7),_.j41(4,"em"),_.EFF(5),_.k0s()()(),_.DNE(6,AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_6_Template,2,2,"ion-badge",17)(7,AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_7_Template,2,2,"ion-badge",17),_.k0s()}if(2&e){const e=t.$implicit,n=_.XpG(2);_.Y8G("detail",!0),_.BMQ("aria-label",e.competency.shortname),_.R7$(3),_.Y8G("text",e.competency.shortname)("contextInstanceId",n.plan.plan.userid),_.R7$(2),_.JRh(e.competency.idnumber),_.R7$(),_.Y8G("ngIf",e.usercompetencyplan),_.R7$(),_.Y8G("ngIf",!e.usercompetencyplan)}}function AddonCompetencyPlanPage_ion_card_14_Template(e,t){if(1&e&&(_.j41(0,"ion-card")(1,"ion-card-header",8)(2,"ion-card-title"),_.EFF(3),_.nI1(4,"translate"),_.k0s()(),_.j41(5,"ion-list"),_.DNE(6,AddonCompetencyPlanPage_ion_card_14_ion_item_6_Template,5,3,"ion-item",11)(7,AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template,8,7,"ion-item",15),_.k0s()()),2&e){const e=_.XpG();_.R7$(3),_.JRh(_.bMT(4,3,"addon.competency.learningplancompetencies")),_.R7$(3),_.Y8G("ngIf",0===e.plan.competencycount),_.R7$(),_.Y8G("ngForOf",e.competencies.items)}}let T=(()=>{var e;class AddonCompetencyPlanPage{constructor(){this.logView=d.j.once((()=>this.performLogView()));try{const e=a.CoreNavigator.getRequiredRouteNumberParam("planId"),t=a.CoreNavigator.getRouteNumberParam("userId"),n=r.u.getOrCreateSource(c.L,[t]),o=r.u.getOrCreateSource(s.P,[e]);this.competencies=new l.R(o,AddonCompetencyPlanPage),this.plans=new i.Z(n)}catch(e){return m.CoreAlerts.showError(e),a.CoreNavigator.back(),void 0}}get plan(){return this.competencies.getSource().plan}get user(){return this.competencies.getSource().user}ngOnInit(){var e=this;return(0,o.A)((function*(){yield e.fetchLearningPlan(),yield e.plans.start(),yield e.competencies.start()}))()}ngOnDestroy(){this.plans.destroy(),this.competencies.destroy()}fetchLearningPlan(){var e=this;return(0,o.A)((function*(){try{yield e.competencies.getSource().reload(),e.logView()}catch(e){m.CoreAlerts.showError(e,{default:"Error getting learning plan data."})}}))()}refreshLearningPlan(e){var t=this;return(0,o.A)((function*(){yield t.competencies.getSource().invalidateCache(),t.fetchLearningPlan().finally((()=>{null==e||e.complete()}))}))()}performLogView(){if(!this.plan)return;const e=this.competencies.getSource().PLAN_ID;p.OF.logEvent({type:p.qr.VIEW_ITEM_LIST,ws:"tool_lp_data_for_plan_page",name:this.plan.plan.name,data:{category:"competency",planid:e},url:`/admin/tool/lp/coursecompetencies.php?id=${e}`})}}return(e=AddonCompetencyPlanPage).ɵfac=function AddonCompetencyPlanPage_Factory(t){return new(t||e)},e.ɵcmp=_.VBU({type:e,selectors:[["page-addon-competency-plan"]],standalone:!0,features:[_.aNF],decls:15,vars:13,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[1,"limited-width",3,"core-swipe-navigation"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["contextLevel","user",3,"text","contextInstanceId"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["class","ion-text-wrap",4,"ngIf"],[3,"id"],[3,"progress","text","ariaDescribedBy"],["contextLevel","system",3,"text","contextInstanceId"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"click","detail"],["slot","end",3,"color",4,"ngIf"],["slot","end",3,"color"]],template:function AddonCompetencyPlanPage_Template(e,t){1&e&&(_.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),_.nrm(3,"ion-back-button",1),_.nI1(4,"translate"),_.k0s(),_.j41(5,"ion-title"),_.DNE(6,AddonCompetencyPlanPage_h1_6_Template,2,2,"h1",2),_.k0s()()(),_.j41(7,"ion-content",3)(8,"ion-refresher",4),_.bIt("ionRefresh",(function AddonCompetencyPlanPage_Template_ion_refresher_ionRefresh_8_listener(e){return t.refreshLearningPlan(e.target)})),_.nrm(9,"ion-refresher-content",5),_.nI1(10,"translate"),_.k0s(),_.j41(11,"core-loading",6),_.DNE(12,AddonCompetencyPlanPage_ion_card_12_Template,6,2,"ion-card",2)(13,AddonCompetencyPlanPage_ion_card_13_Template,21,25,"ion-card",2)(14,AddonCompetencyPlanPage_ion_card_14_Template,8,5,"ion-card",2),_.k0s()()),2&e&&(_.R7$(3),_.Y8G("text",_.bMT(4,9,"core.back")),_.R7$(3),_.Y8G("ngIf",t.plan),_.R7$(),_.Y8G("core-swipe-navigation",t.plans),_.R7$(),_.Y8G("disabled",!t.competencies.loaded),_.R7$(),_.FS9("pullingText",_.bMT(10,11,"core.pulltorefresh")),_.R7$(2),_.Y8G("hideUntil",t.competencies.loaded),_.R7$(),_.Y8G("ngIf",t.user),_.R7$(),_.Y8G("ngIf",t.plan),_.R7$(),_.Y8G("ngIf",t.plan))},dependencies:[u.n,g.Sq,g.bT,h.In,h.QW,h.b_,h.ME,h.tN,h.W9,h.eU,h.uz,h.he,h.nf,h.To,h.Ki,h.BC,h.ai,h.el,f.R,y.z,R.T,P.B,I.n,b.i,C.D9,v.f],encapsulation:2}),AddonCompetencyPlanPage})()},2401:(e,t,n)=>{n.d(t,{R:()=>CoreListItemsManager});var o=n(10467),a=n(21182),i=n(15324),r=n(93417),c=n(81690),l=n(95990),s=n(82907),p=n(24742),d=n(55554);class CoreListItemsManager extends l.u{constructor(e,t){super(e);const n=c.j.debounce((()=>this.scrollToCurrentElement()),300);this.pageRouteLocator=t,this.addListener({onSelectedItemUpdated:n}),this.finishSuccessfulFetch=p.j.once((()=>d.g.ignoreErrors(this.logActivity())))}get items(){return this.getSource().getItems()||[]}get loaded(){return null!==this.itemsMap}get completed(){return this.getSource().isCompleted()}get empty(){const e=this.getSource().getItems();return null===e||0===e.length}start(e){var t=this;return(0,o.A)((function*(){e&&t.watchSplitViewOutlet(e),t.updateSelectedItem()}))()}destroy(){var e;super.destroy(),null===(e=this.splitViewOutletSubscription)||void 0===e||e.unsubscribe()}watchSplitViewOutlet(e){var t;this.splitView=e,this.splitViewOutletSubscription=e.outletRouteObservable.subscribe((e=>this.updateSelectedItem(this.getPageRouteFromSplitViewOutlet(e)))),this.updateSelectedItem(null!==(t=this.getPageRouteFromSplitViewOutlet(e.outletRoute))&&void 0!==t?t:null)}isSelected(e){return this.selectedItem===e}getItemAriaCurrent(e){return this.isSelected(e)?"page":"false"}select(e){var t=this;return(0,o.A)((function*(){if(!e)return yield t.navigateToIndex({reset:t.resetNavigation()}),void 0;yield t.navigateToItem(e,{reset:t.resetNavigation()})}))()}reset(){this.getSource().reset()}reload(){var e=this;return(0,o.A)((function*(){yield e.getSource().reload(),e.finishSuccessfulFetch()}))()}load(){var e=this;return(0,o.A)((function*(){yield e.getSource().load(),e.finishSuccessfulFetch()}))()}logActivity(){return(0,o.A)((function*(){}))()}resetNavigation(){var e;return!!r.CoreScreen.isTablet&&!(!this.splitView||null!==(e=this.splitView)&&void 0!==e&&e.isNested)}updateSelectedItem(e=null){super.updateSelectedItem(e);this.select(r.CoreScreen.isTablet&&null===this.selectedItem&&this.splitView&&!this.splitView.isNested?this.getDefaultItem():this.selectedItem)}scrollToCurrentElement(){var e=this;return(0,o.A)((function*(){var t,n,o;if(r.CoreScreen.isMobile)return;const a=(null!==(t=null===(n=e.splitView)||void 0===n?void 0:n.nativeElement)&&void 0!==t?t:document).querySelector('[aria-current="page"]');if(!a)return;s.y.isElementInViewport(a,1,null===(o=e.splitView)||void 0===o?void 0:o.nativeElement)||a.scrollIntoView({behavior:"smooth"})}))()}getDefaultItem(){return this.items[0]||null}getCurrentPageRoute(){return this.pageRouteLocator instanceof a.nX?i.CoreNavigator.isRouteActive(this.pageRouteLocator)?this.pageRouteLocator:null:i.CoreNavigator.getCurrentRoute({pageComponent:this.pageRouteLocator})}getSelectedItemPathFromRoute(e){const t=[];for(;e.firstChild;)t.push(...i.CoreNavigator.getRouteUrl(e=e.firstChild));return t.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}getPageRouteFromSplitViewOutlet(e){const t=this.buildRouteMatcher();for(;e&&!t(e);)e=e.parent;return e}buildRouteMatcher(){if(this.pageRouteLocator instanceof a.nX){const e=i.CoreNavigator.getRouteFullPath(this.pageRouteLocator);return t=>i.CoreNavigator.getRouteFullPath(t)===e}return e=>e.component===this.pageRouteLocator}}}}]);