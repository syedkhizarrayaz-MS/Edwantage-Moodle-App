"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[24800],{24800:(e,i,r)=>{r.r(i),r.d(i,{default:()=>j});var t=r(10467),o=r(52749),n=r(49882),s=r(98870),a=r(41131),l=r(5784),_=r(55554),d=r(15324),c=r(66110),u=r(52266),m=r(32379),p=r(83696),g=r(24742),f=r(22693),P=r(79555),h=r(25572),b=r(86654),C=r(76833),I=r(54438),T=r(21182),U=r(60177),R=r(2910),k=r(16986),v=r(64422),$=r(16658),G=r(86198),x=r(68273),Y=r(28988),y=r(88246),F=r(43570),E=r(73955),M=r(93453),w=r(14028);const _c0=e=>["core-user-profile-handler",e],_c1=e=>({$a:e});function CoreUserProfilePage_For_31_Template(e,i){1&e&&(I.j41(0,"ion-item")(1,"ion-label")(2,"h3"),I.nrm(3,"ion-skeleton-text",17),I.k0s(),I.j41(4,"p"),I.nrm(5,"ion-skeleton-text",13),I.k0s()()()),2&e&&(I.R7$(3),I.Y8G("animated",!0),I.R7$(2),I.Y8G("animated",!0))}function CoreUserProfilePage_ion_list_33_p_6_Template(e,i){if(1&e&&(I.j41(0,"p"),I.nrm(1,"ion-icon",26),I.EFF(2),I.k0s()),2&e){const e=I.XpG(2);I.R7$(),I.BMQ("aria-hidden",!0),I.R7$(),I.SpI(" ",e.user.address," ")}}function CoreUserProfilePage_ion_list_33_p_7_Template(e,i){if(1&e&&(I.j41(0,"p")(1,"strong"),I.EFF(2),I.nI1(3,"translate"),I.k0s(),I.EFF(4),I.nI1(5,"translate"),I.k0s()),2&e){const e=I.XpG(2);I.R7$(2),I.JRh(I.bMT(3,3,"core.user.roles")),I.R7$(2),I.Lme("",I.bMT(5,5,"core.labelsep")," ",e.rolesFormatted," ")}}function CoreUserProfilePage_ion_list_33_p_8_span_4_Template(e,i){if(1&e&&(I.j41(0,"span"),I.EFF(1),I.nI1(2,"coreTimeAgo"),I.k0s()),2&e){const e=I.XpG(3);I.R7$(),I.JRh(I.bMT(2,1,e.user.lastaccess))}}function CoreUserProfilePage_ion_list_33_p_8_ng_container_5_Template(e,i){1&e&&(I.qex(0),I.EFF(1),I.nI1(2,"translate"),I.bVm()),2&e&&(I.R7$(),I.JRh(I.bMT(2,1,"core.never")))}function CoreUserProfilePage_ion_list_33_p_8_Template(e,i){if(1&e&&(I.j41(0,"p")(1,"strong"),I.EFF(2),I.nI1(3,"translate"),I.k0s(),I.DNE(4,CoreUserProfilePage_ion_list_33_p_8_span_4_Template,3,3,"span",15)(5,CoreUserProfilePage_ion_list_33_p_8_ng_container_5_Template,3,3,"ng-container",15),I.k0s()),2&e){const e=I.XpG(2);I.R7$(2),I.SpI("",I.bMT(3,3,"core.lastaccess"),": "),I.R7$(2),I.Y8G("ngIf",e.user.lastaccess),I.R7$(),I.Y8G("ngIf",!e.user.lastaccess)}}function CoreUserProfilePage_ion_list_33_div_9_ion_item_1_ion_button_2_ion_icon_2_Template(e,i){if(1&e&&I.nrm(0,"ion-icon",31),2&e){const e=I.XpG().$implicit;I.Y8G("name",e.icon)}}function CoreUserProfilePage_ion_list_33_div_9_ion_item_1_ion_button_2_Template(e,i){if(1&e){const e=I.RV6();I.j41(0,"ion-button",29),I.nI1(1,"translate"),I.bIt("click",(function CoreUserProfilePage_ion_list_33_div_9_ion_item_1_ion_button_2_Template_ion_button_click_0_listener(i){const r=I.eBV(e).$implicit,t=I.XpG(4);return I.Njj(t.handlerClicked(i,r))})),I.DNE(2,CoreUserProfilePage_ion_list_33_div_9_ion_item_1_ion_button_2_ion_icon_2_Template,1,1,"ion-icon",30),I.EFF(3),I.nI1(4,"translate"),I.k0s()}if(2&e){const e=i.$implicit;I.Y8G("ngClass",I.eq3(10,_c0,e.class||""))("hidden",e.hidden)("disabled",e.spinner),I.BMQ("aria-label",I.bMT(1,6,e.title)),I.R7$(2),I.Y8G("ngIf",e.icon),I.R7$(),I.SpI(" ",I.bMT(4,8,e.title)," ")}}function CoreUserProfilePage_ion_list_33_div_9_ion_item_1_Template(e,i){if(1&e&&(I.j41(0,"ion-item")(1,"ion-label"),I.DNE(2,CoreUserProfilePage_ion_list_33_div_9_ion_item_1_ion_button_2_Template,5,12,"ion-button",28),I.k0s()()),2&e){const e=I.XpG(3);I.R7$(2),I.Y8G("ngForOf",e.buttonHandlers)}}function CoreUserProfilePage_ion_list_33_div_9_div_2_Template(e,i){1&e&&(I.j41(0,"div",32),I.nrm(1,"ion-spinner"),I.nI1(2,"translate"),I.k0s()),2&e&&(I.R7$(),I.BMQ("aria-label",I.bMT(2,1,"core.loading")))}function CoreUserProfilePage_ion_list_33_div_9_Template(e,i){if(1&e&&(I.j41(0,"div",27),I.DNE(1,CoreUserProfilePage_ion_list_33_div_9_ion_item_1_Template,3,1,"ion-item",15)(2,CoreUserProfilePage_ion_list_33_div_9_div_2_Template,3,3,"div",24),I.k0s()),2&e){const e=I.XpG(2);I.R7$(),I.Y8G("ngIf",e.buttonHandlers&&e.buttonHandlers.length),I.R7$(),I.Y8G("ngIf",e.isLoadingHandlers)}}function CoreUserProfilePage_ion_list_33_ion_item_17_Template(e,i){1&e&&(I.j41(0,"ion-item",32)(1,"ion-label"),I.nrm(2,"ion-spinner"),I.nI1(3,"translate"),I.k0s()()),2&e&&(I.R7$(2),I.BMQ("aria-label",I.bMT(3,1,"core.loading")))}function CoreUserProfilePage_ion_list_33_ion_item_18_ion_icon_2_Template(e,i){if(1&e&&I.nrm(0,"ion-icon",31),2&e){const e=I.XpG().$implicit;I.Y8G("name",e.icon)}}function CoreUserProfilePage_ion_list_33_ion_item_18_ion_badge_7_Template(e,i){if(1&e&&(I.j41(0,"ion-badge",37),I.EFF(1),I.k0s()),2&e){const e=I.XpG().$implicit;I.Y8G("hidden",e.loading||!e.badge),I.R7$(),I.SpI(" ",e.badge," ")}}function CoreUserProfilePage_ion_list_33_ion_item_18_span_8_Template(e,i){if(1&e&&(I.j41(0,"span",38),I.EFF(1),I.nI1(2,"translate"),I.k0s()),2&e){const e=I.XpG().$implicit;I.R7$(),I.SpI(" ",I.i5U(2,1,e.badgeA11yText,I.eq3(4,_c1,e.badge))," ")}}function CoreUserProfilePage_ion_list_33_ion_item_18_ion_spinner_9_Template(e,i){1&e&&(I.nrm(0,"ion-spinner",39),I.nI1(1,"translate")),2&e&&I.BMQ("aria-label",I.bMT(1,1,"core.loading"))}function CoreUserProfilePage_ion_list_33_ion_item_18_Template(e,i){if(1&e){const e=I.RV6();I.j41(0,"ion-item",33),I.nI1(1,"translate"),I.bIt("click",(function CoreUserProfilePage_ion_list_33_ion_item_18_Template_ion_item_click_0_listener(i){const r=I.eBV(e).$implicit,t=I.XpG(2);return I.Njj(t.handlerClicked(i,r))})),I.DNE(2,CoreUserProfilePage_ion_list_33_ion_item_18_ion_icon_2_Template,1,1,"ion-icon",30),I.j41(3,"ion-label")(4,"p",23),I.EFF(5),I.nI1(6,"translate"),I.k0s()(),I.DNE(7,CoreUserProfilePage_ion_list_33_ion_item_18_ion_badge_7_Template,2,2,"ion-badge",34)(8,CoreUserProfilePage_ion_list_33_ion_item_18_span_8_Template,3,6,"span",35)(9,CoreUserProfilePage_ion_list_33_ion_item_18_ion_spinner_9_Template,2,3,"ion-spinner",36),I.k0s()}if(2&e){const e=i.$implicit;I.Y8G("ngClass",I.eq3(13,_c0,e.class||""))("hidden",e.hidden)("detail",!0),I.BMQ("aria-label",I.bMT(1,9,e.title)),I.R7$(2),I.Y8G("ngIf",e.icon),I.R7$(3),I.JRh(I.bMT(6,11,e.title)),I.R7$(2),I.Y8G("ngIf",e.showBadge),I.R7$(),I.Y8G("ngIf",e.showBadge&&e.badge&&e.badgeA11yText),I.R7$(),I.Y8G("ngIf",e.showBadge&&e.loading)}}function CoreUserProfilePage_ion_list_33_Template(e,i){if(1&e){const e=I.RV6();I.j41(0,"ion-list")(1,"ion-item",18),I.nrm(2,"core-user-avatar",19),I.j41(3,"ion-label")(4,"h1"),I.EFF(5),I.k0s(),I.DNE(6,CoreUserProfilePage_ion_list_33_p_6_Template,3,2,"p",15)(7,CoreUserProfilePage_ion_list_33_p_7_Template,6,7,"p",15)(8,CoreUserProfilePage_ion_list_33_p_8_Template,6,5,"p",15),I.k0s()(),I.DNE(9,CoreUserProfilePage_ion_list_33_div_9_Template,3,2,"div",20),I.j41(10,"ion-item",21),I.nI1(11,"translate"),I.bIt("click",(function CoreUserProfilePage_ion_list_33_Template_ion_item_click_10_listener(){I.eBV(e);const i=I.XpG();return I.Njj(i.openUserDetails())})),I.nrm(12,"ion-icon",22),I.j41(13,"ion-label")(14,"p",23),I.EFF(15),I.nI1(16,"translate"),I.k0s()()(),I.DNE(17,CoreUserProfilePage_ion_list_33_ion_item_17_Template,4,3,"ion-item",24)(18,CoreUserProfilePage_ion_list_33_ion_item_18_Template,10,15,"ion-item",25),I.k0s()}if(2&e){const e=I.XpG();I.R7$(2),I.Y8G("user",e.user)("userId",e.user.id)("linkProfile",!1)("checkOnline",!0),I.R7$(3),I.JRh(e.user.fullname),I.R7$(),I.Y8G("ngIf",e.user.address),I.R7$(),I.Y8G("ngIf",e.rolesFormatted),I.R7$(),I.Y8G("ngIf",void 0!==e.user.lastaccess),I.R7$(),I.Y8G("ngIf",e.buttonHandlers&&e.buttonHandlers.length||e.isLoadingHandlers),I.R7$(),I.Y8G("detail",!0),I.BMQ("aria-label",I.bMT(11,14,"core.user.details")),I.R7$(5),I.JRh(I.bMT(16,16,"core.user.details")),I.R7$(2),I.Y8G("ngIf",e.isLoadingHandlers),I.R7$(),I.Y8G("ngForOf",e.listItemHandlers)}}function CoreUserProfilePage_core_empty_box_34_Template(e,i){1&e&&(I.nrm(0,"core-empty-box",40),I.nI1(1,"translate")),2&e&&I.Y8G("message",I.bMT(1,1,"core.user.detailsnotavailable"))}function CoreUserProfilePage_core_empty_box_35_Template(e,i){1&e&&(I.nrm(0,"core-empty-box",40),I.nI1(1,"translate")),2&e&&I.Y8G("message",I.bMT(1,1,"core.userdeleted"))}function CoreUserProfilePage_core_empty_box_36_Template(e,i){1&e&&(I.nrm(0,"core-empty-box",40),I.nI1(1,"translate")),2&e&&I.Y8G("message",I.bMT(1,1,"core.usersuspended"))}function CoreUserProfilePage_core_empty_box_37_Template(e,i){1&e&&(I.nrm(0,"core-empty-box",40),I.nI1(1,"translate")),2&e&&I.Y8G("message",I.bMT(1,1,"core.notenrolledprofile"))}let j=(()=>{var e;class CoreUserProfilePage{constructor(e){var i=this;this.route=e,this.userLoaded=!1,this.isLoadingHandlers=!1,this.isDeleted=!1,this.isSuspended=!1,this.isEnrolled=!0,this.listItemHandlers=[],this.buttonHandlers=[],this.obsProfileRefreshed=n.z.on(C.z2,(e=>{this.user&&e.user&&(this.user.email=e.user.email)}),o.CoreSites.getCurrentSiteId()),this.logView=g.j.once(function(){var e=(0,t.A)((function*(e){try{yield s.CoreUser.logView(i.userId,i.courseId,e.fullname)}catch(e){i.isDeleted="userdeleted"===(null==e?void 0:e.errorcode)||"wsaccessuserdeleted"===(null==e?void 0:e.errorcode),i.isSuspended="wsaccessusersuspended"===(null==e?void 0:e.errorcode),i.isEnrolled="notenrolledprofile"!==(null==e?void 0:e.errorcode)}let r="";if(i.userId!==o.CoreSites.getCurrentSiteUserId()){const e=i.courseId&&i.courseId!==o.CoreSites.getCurrentSiteHomeId();r=`?id=${i.userId}`+(e?`&course=${i.courseId}`:"")}f.OF.logEvent({type:f.qr.VIEW_ITEM,ws:"core_user_view_user_profile",name:e.fullname+": "+P.HT.instant("core.publicprofile"),data:{id:i.userId,courseid:i.courseId||void 0,category:"user"},url:`/user/profile.php${r}`})}));return function(i){return e.apply(this,arguments)}}())}ngOnInit(){var e=this;return(0,t.A)((function*(){try{e.site=o.CoreSites.getRequiredCurrentSite(),e.courseId=d.CoreNavigator.getRouteNumberParam("courseId"),e.userId=d.CoreNavigator.getRequiredRouteNumberParam("userId")}catch(e){return h.CoreAlerts.showError(e),d.CoreNavigator.back(),void 0}if(e.courseId===e.site.getSiteHomeId()&&(e.courseId=void 0),e.courseId&&"participants"===d.CoreNavigator.getRouteData(e.route).swipeManagerSource){const i=d.CoreNavigator.getRouteParam("search"),r=p.u.getOrCreateSource(m.u,[e.courseId,i]);e.users=new CoreUserSwipeItemsManager(r),e.users.start()}try{yield e.fetchUser()}finally{e.userLoaded=!0}}))()}fetchUser(){var e=this;return(0,t.A)((function*(){try{var i;const r=yield s.CoreUser.getProfile(e.userId,e.courseId);e.rolesFormatted="roles"in r?a.CoreUserHelper.formatRoleList(r.roles):"",e.user=r,null===(i=e.subscription)||void 0===i||i.unsubscribe();const t=e.courseId?l.CoreUserDelegateContext.COURSE:l.CoreUserDelegateContext.SITE;e.subscription=l.CoreUserDelegate.getProfileHandlersFor(r,t,e.courseId).subscribe((i=>{e.listItemHandlers=[],e.buttonHandlers=[],i.forEach((i=>{switch(i.type){case l.CoreUserProfileHandlerType.BUTTON:e.buttonHandlers.push(i.data);break;case l.CoreUserProfileHandlerType.LIST_ACCOUNT_ITEM:break;default:e.listItemHandlers.push(i.data)}})),e.isLoadingHandlers=!l.CoreUserDelegate.areHandlersLoaded(r.id,t,e.courseId)})),e.logView(r)}catch(e){h.CoreAlerts.showError(e)}}))()}refreshUser(e){var i=this;return(0,t.A)((function*(){var r;(yield _.g.ignoreErrors(Promise.all([s.CoreUser.invalidateUserCache(i.userId),c.CoreCourses.invalidateUserNavigationOptions(),c.CoreCourses.invalidateUserAdministrationOptions()])),yield i.fetchUser(),null==e||e.complete(),i.user)&&n.z.trigger(C.z2,{courseId:i.courseId,userId:i.userId,user:i.user},null===(r=i.site)||void 0===r?void 0:r.getId())}))()}openUserDetails(){d.CoreNavigator.navigateToSitePath("user/about",{params:{courseId:this.courseId,userId:this.userId}})}handlerClicked(e,i){if(!this.user)return;i.action(e,this.user,this.courseId?l.CoreUserDelegateContext.COURSE:l.CoreUserDelegateContext.SITE,this.courseId)}ngOnDestroy(){var e,i;null===(e=this.users)||void 0===e||e.destroy(),null===(i=this.subscription)||void 0===i||i.unsubscribe(),this.obsProfileRefreshed.off()}}return(e=CoreUserProfilePage).ɵfac=function CoreUserProfilePage_Factory(i){return new(i||e)(I.rXU(T.nX))},e.ɵcmp=I.VBU({type:e,selectors:[["page-core-user-profile"]],standalone:!0,features:[I.aNF],decls:38,vars:24,consts:[["collapsible",""],["slot","start"],[3,"text"],[1,"limited-width",3,"core-swipe-navigation"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],["placeholderType","free",3,"hideUntil"],["loading-placeholder","",1,"ion-padding","list-item-limited-width"],["slot","start",2,"width","80px","height","80px"],[3,"animated"],[2,"width","80%",3,"animated"],[2,"width","70%",3,"animated"],[2,"width","30%",3,"animated"],[2,"width","60%",3,"animated"],[1,"ion-margin",2,"width","100%","height","44px",3,"animated"],[4,"ngIf"],["icon","far-user",3,"message",4,"ngIf"],[2,"width","100%",3,"animated"],["collapsible","",1,"core-user-profile-maininfo","ion-text-wrap"],["slot","start",3,"user","userId","linkProfile","checkOnline"],["class","core-user-communication-handlers",4,"ngIf"],["button","",1,"ion-text-wrap","core-user-profile-handler",3,"click","detail"],["name","fas-user","slot","start","aria-hidden","true"],[1,"item-heading"],["class","ion-text-center core-loading-handlers",4,"ngIf"],["button","","class","ion-text-wrap",3,"ngClass","hidden","detail","click",4,"ngFor","ngForOf"],["name","fas-location-dot"],[1,"core-user-communication-handlers"],["expand","block","size","default",3,"ngClass","hidden","disabled","click",4,"ngFor","ngForOf"],["expand","block","size","default",3,"click","ngClass","hidden","disabled"],["slot","start","aria-hidden","true",3,"name",4,"ngIf"],["slot","start","aria-hidden","true",3,"name"],[1,"ion-text-center","core-loading-handlers"],["button","",1,"ion-text-wrap",3,"click","ngClass","hidden","detail"],["slot","end","aria-hidden","true",3,"hidden",4,"ngIf"],["class","sr-only",4,"ngIf"],["slot","end",4,"ngIf"],["slot","end","aria-hidden","true",3,"hidden"],[1,"sr-only"],["slot","end"],["icon","far-user",3,"message"]],template:function CoreUserProfilePage_Template(e,i){1&e&&(I.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),I.nrm(3,"ion-back-button",2),I.nI1(4,"translate"),I.k0s(),I.j41(5,"ion-title")(6,"h1"),I.EFF(7),I.k0s()()()(),I.j41(8,"ion-content",3)(9,"ion-refresher",4),I.bIt("ionRefresh",(function CoreUserProfilePage_Template_ion_refresher_ionRefresh_9_listener(e){return i.refreshUser(e.target)})),I.nrm(10,"ion-refresher-content",5),I.nI1(11,"translate"),I.k0s(),I.j41(12,"core-loading",6)(13,"ion-list",7)(14,"ion-item")(15,"ion-avatar",8),I.nrm(16,"ion-skeleton-text",9),I.k0s(),I.j41(17,"ion-label")(18,"h1"),I.nrm(19,"ion-skeleton-text",10),I.k0s(),I.j41(20,"p"),I.nrm(21,"ion-skeleton-text",11),I.k0s(),I.j41(22,"p"),I.nrm(23,"ion-skeleton-text",12),I.k0s(),I.j41(24,"p"),I.nrm(25,"ion-skeleton-text",13),I.k0s()()(),I.j41(26,"ion-item")(27,"ion-label"),I.nrm(28,"ion-skeleton-text",14)(29,"ion-skeleton-text",14),I.k0s()(),I.Z7z(30,CoreUserProfilePage_For_31_Template,6,2,"ion-item",null,I.fX1),I.nI1(32,"coreTimes"),I.k0s(),I.DNE(33,CoreUserProfilePage_ion_list_33_Template,19,18,"ion-list",15)(34,CoreUserProfilePage_core_empty_box_34_Template,2,3,"core-empty-box",16)(35,CoreUserProfilePage_core_empty_box_35_Template,2,3,"core-empty-box",16)(36,CoreUserProfilePage_core_empty_box_36_Template,2,3,"core-empty-box",16)(37,CoreUserProfilePage_core_empty_box_37_Template,2,3,"core-empty-box",16),I.k0s()()),2&e&&(I.R7$(3),I.Y8G("text",I.bMT(4,18,"core.back")),I.R7$(4),I.JRh(null==i.user?null:i.user.fullname),I.R7$(),I.Y8G("core-swipe-navigation",i.users),I.R7$(),I.Y8G("disabled",!i.userLoaded),I.R7$(),I.FS9("pullingText",I.bMT(11,20,"core.pulltorefresh")),I.R7$(2),I.Y8G("hideUntil",i.userLoaded),I.R7$(4),I.Y8G("animated",!0),I.R7$(3),I.Y8G("animated",!0),I.R7$(2),I.Y8G("animated",!0),I.R7$(2),I.Y8G("animated",!0),I.R7$(2),I.Y8G("animated",!0),I.R7$(3),I.Y8G("animated",!0),I.R7$(),I.Y8G("animated",!0),I.R7$(),I.Dyx(I.bMT(32,22,15)),I.R7$(3),I.Y8G("ngIf",i.user&&!i.isDeleted&&i.isEnrolled),I.R7$(),I.Y8G("ngIf",!i.user&&!i.isDeleted&&i.isEnrolled),I.R7$(),I.Y8G("ngIf",i.isDeleted),I.R7$(),I.Y8G("ngIf",i.isSuspended),I.R7$(),I.Y8G("ngIf",!i.isEnrolled))},dependencies:[b.n,U.YU,U.Sq,U.bT,R.mC,R.In,R.Jm,R.QW,R.W9,R.eU,R.iq,R.uz,R.he,R.nf,R.To,R.Ki,R.ds,R.w2,R.BC,R.ai,R.el,k.h,v.R,$.T,G.t,x.M,Y.n,y.i,F.T,E.D9,M.A,w.O],styles:["[_nghost-%COMP%]   core-user-avatar[_ngcontent-%COMP%]{--core-avatar-size: var(--core-large-avatar-size);--contact-status-size: 24px;--margin-end-on-item: 16px}[_nghost-%COMP%]   core-user-avatar[_ngcontent-%COMP%]   .contact-status[_ngcontent-%COMP%]{right:calc(50% - 12px - var(--core-avatar-size) / 2)!important}"]}),CoreUserProfilePage})();class CoreUserSwipeItemsManager extends u.Z{getSelectedItemPathFromRoute(e){return d.CoreNavigator.getRouteParams(e).userId}}}}]);