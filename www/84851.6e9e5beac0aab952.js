"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[84851,46526,24145,91288],{84851:(t,e,n)=>{n.d(e,{y:()=>h});var o=n(10467),r=n(49588),s=n(79555),i=n(39046),a=n(91416),l=n(33014),c=n(25572),u=n(54438),d=n(46526);let h=(()=>{var t;class CoreSitePluginsCallWSOnClickBaseDirective extends i.J{constructor(t,e){super(t,e),this.showError=!0}ngOnInit(){var t=this;super.ngOnInit(),this.element.addEventListener("click",function(){var e=(0,o.A)((function*(e){if(e.preventDefault(),e.stopPropagation(),void 0!==t.confirmMessage)try{yield c.CoreAlerts.confirm(t.confirmMessage||s.HT.instant("core.areyousure"))}catch{return}t.callWS()}));return function(t){return e.apply(this,arguments)}}())}callWS(){var _superprop_getCallWS=()=>super.callWS,t=this;return(0,o.A)((function*(){const e=yield l.CoreLoadings.show();try{yield _superprop_getCallWS().call(t)}catch(e){var n;if(t.showError)c.CoreAlerts.showError(e,{default:s.HT.instant("core.serverconnection",{details:null!==(n=r.CoreErrorHelper.getErrorMessageFromError(e))&&void 0!==n?n:"Unknown error"})})}finally{e.dismiss()}}))()}}return(t=CoreSitePluginsCallWSOnClickBaseDirective).ɵfac=function CoreSitePluginsCallWSOnClickBaseDirective_Factory(e){return new(e||t)(u.rXU(u.aKT),u.rXU(d.U))},t.ɵdir=u.FsC({type:t,inputs:{confirmMessage:"confirmMessage",showError:[u.Mj6.HasDecoratorInputTransform,"showError","showError",a.G]},features:[u.GFd,u.Vt3]}),CoreSitePluginsCallWSOnClickBaseDirective})()},39046:(t,e,n)=>{n.d(e,{J:()=>c});var o=n(10467),r=n(54438),s=n(32832),i=n(6787),a=n(63153),l=n(46526);let c=(()=>{var t;class CoreSitePluginsCallWSBaseDirective{constructor(t,e){this.parentContent=e,this.onSuccess=new r.bkB,this.onError=new r.bkB,this.onDone=new r.bkB,this.element=t.nativeElement||t,this.logger=i.CoreLogger.getInstance("CoreSitePluginsCallWS")}ngOnInit(){var t;null!==(t=this.parentContent)&&void 0!==t&&t.invalidateObservable&&(this.invalidateObserver=this.parentContent.invalidateObservable.subscribe((()=>{this.invalidate()})))}callWS(){var t=this;return(0,o.A)((function*(){try{const e=t.getParamsForWS(),n=yield s.CoreSitePlugins.callWS(t.name,e,t.preSets);t.onSuccess.emit(n),t.wsCallSuccess(n)}catch(e){throw t.onError.emit(e),t.logger.error(`Error calling WS ${t.name}`,e),e}finally{t.onDone.emit()}}))()}getParamsForWS(){let t=this.params||{};return this.parentContent&&(t=s.CoreSitePlugins.loadOtherDataInArgs(t,this.parentContent.otherData,this.useOtherDataForWS)),this.form&&document.forms[this.form]&&(t=Object.assign(t,a.R.getDataFromForm(document.forms[this.form]))),t}wsCallSuccess(t){}invalidate(){const t=this.getParamsForWS();return s.CoreSitePlugins.invalidateCallWS(this.name,t,this.preSets)}ngOnDestroy(){var t;null===(t=this.invalidateObserver)||void 0===t||t.unsubscribe()}}return(t=CoreSitePluginsCallWSBaseDirective).ɵfac=function CoreSitePluginsCallWSBaseDirective_Factory(e){return new(e||t)(r.rXU(r.aKT),r.rXU(l.U))},t.ɵdir=r.FsC({type:t,inputs:{name:"name",params:"params",preSets:"preSets",useOtherDataForWS:"useOtherDataForWS",form:"form"},outputs:{onSuccess:"onSuccess",onError:"onError",onDone:"onDone"}}),CoreSitePluginsCallWSBaseDirective})()},46526:(t,e,n)=>{n.d(e,{U:()=>v});var o=n(10467),r=n(54438),s=n(21413),i=n(91768),a=n(74978),l=n(32832),c=n(15324),u=n(49882),d=n(52749),h=n(57085),C=n(86654),p=n(25572),g=n(79555),m=n(64422);const f=["compile"];let v=(()=>{var t;class CoreSitePluginsPluginContentComponent{constructor(t){this.component="",this.data={},this.onContentLoaded=new r.bkB,this.onLoadingContent=new r.bkB,this.content="",this.javascript="",this.dataLoaded=!1,this.invalidateObservable=new s.B,this.differ=t.find([]).create()}ngOnInit(){this.fetchContent()}ngDoCheck(){if(!this.data||!this.jsData)return;this.differ.diff(this.data)&&(this.jsData=Object.assign(this.jsData,this.data))}fetchContent(t){var e=this;return(0,o.A)((function*(){e.onLoadingContent.emit(t),e.forceCompile=!1;const n=Object.assign({},e.preSets);n.component=n.component||e.component;try{const o=yield l.CoreSitePlugins.getContent(e.component,e.method,e.args,n);e.content=o.templates.length?o.templates[0].html:"",e.javascript=o.javascript,e.otherData=o.otherdata,e.data=e.data||{},e.forceCompile=!0,e.jsData={...e.args,...e.data,...l.CoreSitePlugins.createDataForJS(e.initResult,o)},e.jsData.fetchContent=t=>e.fetchContent(t),e.jsData.openContent=(t,n,o,r,s,i,a)=>e.openContent(t,n,o,r,s,i,a),e.jsData.refreshContent=t=>e.refreshContent(t),e.jsData.updateContent=(t,n,o,r,s)=>e.updateContent(t,n,o,r,s),e.jsData.updateModuleCourseContent=(t,n)=>e.updateModuleCourseContent(t,n),e.jsData.updateCachedContent=()=>e.updateCachedContent(),e.onContentLoaded.emit({refresh:!!t,success:!0,content:e.content})}catch(n){e.content="<div></div>",e.onContentLoaded.emit({refresh:!!t,success:!1,content:e.content}),p.CoreAlerts.showError(n,{default:g.HT.instant("core.errorloadingcontent")})}finally{e.dataLoaded=!0}}))()}openContent(t,e={},n,o,r,s,a,l){!0===r&&(r=this.data),n=n||this.component,o=o||this.method;const u=i.VV.hashAsciiStr(JSON.stringify(e));c.CoreNavigator.navigateToSitePath(`siteplugins/content/${n}/${o}/${u}`,{params:{title:t,args:e,initResult:this.initResult,jsData:r,preSets:s,ptrEnabled:a,contextLevel:(null==l?void 0:l.contextLevel)||this.contextLevel,contextInstanceId:(null==l?void 0:l.contextInstanceId)||this.contextInstanceId,courseId:(null==l?void 0:l.courseId)||this.courseId}})}refreshContent(t=!0){var e=this;return(0,o.A)((function*(){t&&(e.dataLoaded=!1),e.invalidateObservable.next();try{yield l.CoreSitePlugins.invalidateContent(e.component,e.method,e.args)}finally{yield e.fetchContent(!0)}}))()}updateContent(t,e,n,o,r){this.component=e||this.component,this.method=n||this.method,this.args=t,this.dataLoaded=!1,this.preSets=r||this.preSets,this.data&&o&&Object.assign(this.data,o),this.fetchContent()}callComponentFunction(t,e){var n;return null===(n=this.compileComponent)||void 0===n?void 0:n.callComponentFunction(t,e)}updateModuleCourseContent(t,e){u.z.trigger(h.Vs,{cmId:t,alreadyFetched:e})}updateCachedContent(){var t=this;return(0,o.A)((function*(){yield l.CoreSitePlugins.getContent(t.component,t.method,t.args,d.CoreSites.getReadingStrategyPreSets(2))}))()}}return(t=CoreSitePluginsPluginContentComponent).ɵfac=function CoreSitePluginsPluginContentComponent_Factory(e){return new(e||t)(r.rXU(r.MKu))},t.ɵcmp=r.VBU({type:t,selectors:[["core-site-plugins-plugin-content"]],viewQuery:function CoreSitePluginsPluginContentComponent_Query(t,e){if(1&t&&r.GBs(f,5),2&t){let t;r.mGM(t=r.lsd())&&(e.compileComponent=t.first)}},hostVars:2,hostBindings:function CoreSitePluginsPluginContentComponent_HostBindings(t,e){2&t&&r.HbH(e.component)},inputs:{component:"component",method:"method",args:"args",initResult:"initResult",data:"data",preSets:"preSets",pageTitle:"pageTitle",contextLevel:"contextLevel",contextInstanceId:"contextInstanceId",courseId:"courseId"},outputs:{onContentLoaded:"onContentLoaded",onLoadingContent:"onLoadingContent"},standalone:!0,features:[r.aNF],decls:3,vars:6,consts:[["compile",""],[3,"hideUntil","fullscreen"],[3,"text","javascript","jsData","forceCompile"]],template:function CoreSitePluginsPluginContentComponent_Template(t,e){1&t&&(r.j41(0,"core-loading",1),r.nrm(1,"core-compile-html",2,0),r.k0s()),2&t&&(r.Y8G("hideUntil",e.dataLoaded)("fullscreen",!1),r.R7$(),r.Y8G("text",e.content)("javascript",e.javascript)("jsData",e.jsData)("forceCompile",e.forceCompile))},dependencies:[C.n,m.R,a.h],styles:["[_nghost-%COMP%]{display:contents}"]}),CoreSitePluginsPluginContentComponent})()}}]);