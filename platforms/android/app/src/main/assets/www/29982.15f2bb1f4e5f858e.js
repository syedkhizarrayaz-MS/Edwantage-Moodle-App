"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[29982],{29982:(e,t,o)=>{o.r(t),o.d(t,{default:()=>b});var n=o(10467),i=o(44682),r=o(97086),s=o(94247),a=o(15324),c=o(55554),l=o(24742),_=o(22693),d=o(25572),u=o(98054),p=o(86654),g=o(95384),m=o(54438),C=o(60177),h=o(2910),f=o(16986),T=o(66198),y=o(64422),M=o(58197),x=o(88246),I=o(73955);const _c0=e=>({section:e});function CoreCourseListModTypePage_core_empty_box_13_Template(e,t){1&e&&(m.nrm(0,"core-empty-box",11),m.nI1(1,"translate")),2&e&&m.Y8G("message",m.bMT(1,1,"core.course.nocontentavailable"))}function CoreCourseListModTypePage_ng_container_15_ng_container_1_ng_container_1_Template(e,t){1&e&&m.eu8(0)}function CoreCourseListModTypePage_ng_container_15_ng_container_1_Template(e,t){if(1&e&&(m.qex(0),m.DNE(1,CoreCourseListModTypePage_ng_container_15_ng_container_1_ng_container_1_Template,1,0,"ng-container",13),m.bVm()),2&e){const e=m.XpG().$implicit;m.XpG();const t=m.sdS(18);m.R7$(),m.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",m.eq3(2,_c0,e))}}function CoreCourseListModTypePage_ng_container_15_Template(e,t){if(1&e&&(m.qex(0),m.DNE(1,CoreCourseListModTypePage_ng_container_15_ng_container_1_Template,2,4,"ng-container",12),m.bVm()),2&e){const e=t.index,o=m.XpG();m.R7$(),m.Y8G("ngIf",e<=o.lastShownSectionIndex)}}function CoreCourseListModTypePage_ng_template_17_ion_item_divider_1_Template(e,t){if(1&e&&(m.j41(0,"ion-item-divider",15)(1,"ion-label")(2,"h2"),m.nrm(3,"core-format-text",16),m.k0s()()()),2&e){const e=m.XpG().section,t=m.XpG();m.R7$(3),m.Y8G("text",e.name)("contextInstanceId",t.courseId)}}function CoreCourseListModTypePage_ng_template_17_ng_container_2_Conditional_1_Template(e,t){if(1&e&&m.nrm(0,"core-course-module",17),2&e){const e=m.XpG().$implicit,t=m.XpG().section;m.Y8G("module",e)("section",t)("showActivityDates",!1)("showAvailability",!1)("showExtra",!1)("showDownloadStatus",!1)("showCompletion",!1)("showIndentation",!1)}}function CoreCourseListModTypePage_ng_template_17_ng_container_2_Conditional_2_ng_container_0_Template(e,t){1&e&&m.eu8(0)}function CoreCourseListModTypePage_ng_template_17_ng_container_2_Conditional_2_Template(e,t){if(1&e&&m.DNE(0,CoreCourseListModTypePage_ng_template_17_ng_container_2_Conditional_2_ng_container_0_Template,1,0,"ng-container",13),2&e){const e=m.XpG().$implicit;m.XpG(2);const t=m.sdS(18);m.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",m.eq3(2,_c0,e))}}function CoreCourseListModTypePage_ng_template_17_ng_container_2_Template(e,t){if(1&e&&(m.qex(0),m.DNE(1,CoreCourseListModTypePage_ng_template_17_ng_container_2_Conditional_1_Template,1,8,"core-course-module",17)(2,CoreCourseListModTypePage_ng_template_17_ng_container_2_Conditional_2_Template,1,4),m.bVm()),2&e){const e=t.$implicit,o=m.XpG(2);m.R7$(),m.vxM(1,o.isModule(e)?1:2)}}function CoreCourseListModTypePage_ng_template_17_Template(e,t){if(1&e&&(m.j41(0,"ion-card"),m.DNE(1,CoreCourseListModTypePage_ng_template_17_ion_item_divider_1_Template,4,2,"ion-item-divider",14)(2,CoreCourseListModTypePage_ng_template_17_ng_container_2_Template,3,1,"ng-container",9),m.k0s()),2&e){const e=t.section;m.R7$(),m.Y8G("ngIf",e.name),m.R7$(),m.Y8G("ngForOf",e.contents)}}let b=(()=>{var e;class CoreCourseListModTypePage{constructor(){var e=this;this.sections=[],this.title="",this.loaded=!1,this.courseId=0,this.canLoadMore=!1,this.lastShownSectionIndex=-1,this.isModule=i.sectionContentIsModule,this.archetypes={},this.logView=l.j.once((0,n.A)((function*(){e.modName&&_.OF.logEvent({type:_.qr.VIEW_ITEM_LIST,ws:"core_course_get_contents",name:e.title,data:{category:e.modName},url:("resources"===e.modName?"/course/resources.php":`/mod/${e.modName}/index.php`)+`?id=${e.courseId}`})})))}ngOnInit(){var e=this;return(0,n.A)((function*(){try{e.title=a.CoreNavigator.getRouteParam("title")||"",e.courseId=a.CoreNavigator.getRequiredRouteParam("courseId"),e.modName=a.CoreNavigator.getRequiredRouteParam("modName")}catch(e){return d.CoreAlerts.showError(e),a.CoreNavigator.back(),void 0}try{yield e.fetchData()}finally{e.loaded=!0}}))()}fetchData(){var e=this;return(0,n.A)((function*(){if(e.courseId)try{let t=yield i.CoreCourse.getSections(e.courseId,!1,!0);t=e.filterSectionsAndContents(t);const o=yield s.CoreCourseHelper.addHandlerDataForModules(t,e.courseId);e.sections=o.sections,e.lastShownSectionIndex=-1,e.showMoreActivities()}catch(e){d.CoreAlerts.showError(e,{default:"Error getting data"})}}))()}filterSectionsAndContents(e){return e.filter((e=>!(!e.contents.length||e.hiddenbynumsections)&&(e.contents=e.contents.filter((t=>{if(!(0,i.sectionContentIsModule)(t)){return!!this.filterSectionsAndContents([t]).length}if(!s.CoreCourseHelper.canUserViewModule(t,e)||!g.CoreCourseModuleHelper.moduleHasView(t)||0===t.visibleoncoursepage)return!1;if("resources"===this.modName){if(void 0===this.archetypes[t.modname]&&(this.archetypes[t.modname]=r.CoreCourseModuleDelegate.supportsFeature(t.modname,"mod_archetype",0)),1===this.archetypes[t.modname])return!0}else if(t.modname===this.modName)return!0})),e.contents.length>0)))}showMoreActivities(e){let t=0;for(;this.lastShownSectionIndex<this.sections.length-1&&t<CoreCourseListModTypePage.PAGE_LENGTH;){this.lastShownSectionIndex++;t+=i.CoreCourse.getSectionsModules([this.sections[this.lastShownSectionIndex]]).length}this.canLoadMore=this.lastShownSectionIndex<this.sections.length-1,null==e||e()}refreshData(e){var t=this;return(0,n.A)((function*(){yield c.g.ignoreErrors(i.CoreCourse.invalidateSections(t.courseId));try{yield t.fetchData()}finally{e.complete()}}))()}}return(e=CoreCourseListModTypePage).PAGE_LENGTH=10,e.ɵfac=function CoreCourseListModTypePage_Factory(t){return new(t||e)},e.ɵcmp=m.VBU({type:e,selectors:[["page-core-course-list-mod-type"]],standalone:!0,features:[m.aNF],decls:19,vars:12,consts:[["sectionTemplate",""],["slot","start"],[3,"text"],[1,"limited-width"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-box-open",3,"message",4,"ngIf"],[1,"core-course-module-list-wrapper"],[4,"ngFor","ngForOf"],[3,"action","enabled"],["icon","fas-box-open",3,"message"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","course-section ion-text-wrap",4,"ngIf"],[1,"course-section","ion-text-wrap"],["contextLevel","course",3,"text","contextInstanceId"],[3,"module","section","showActivityDates","showAvailability","showExtra","showDownloadStatus","showCompletion","showIndentation"]],template:function CoreCourseListModTypePage_Template(e,t){if(1&e){const e=m.RV6();m.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),m.nrm(3,"ion-back-button",2),m.nI1(4,"translate"),m.k0s(),m.j41(5,"ion-title")(6,"h1"),m.EFF(7),m.k0s()()()(),m.j41(8,"ion-content",3)(9,"ion-refresher",4),m.bIt("ionRefresh",(function CoreCourseListModTypePage_Template_ion_refresher_ionRefresh_9_listener(o){return m.eBV(e),m.Njj(t.refreshData(o.target))})),m.nrm(10,"ion-refresher-content",5),m.nI1(11,"translate"),m.k0s(),m.j41(12,"core-loading",6),m.DNE(13,CoreCourseListModTypePage_core_empty_box_13_Template,2,3,"core-empty-box",7),m.j41(14,"ion-list",8),m.DNE(15,CoreCourseListModTypePage_ng_container_15_Template,2,1,"ng-container",9),m.k0s(),m.j41(16,"core-infinite-loading",10),m.bIt("action",(function CoreCourseListModTypePage_Template_core_infinite_loading_action_16_listener(o){return m.eBV(e),m.Njj(t.showMoreActivities(o))})),m.k0s()()(),m.DNE(17,CoreCourseListModTypePage_ng_template_17_Template,3,2,"ng-template",null,0,m.C5r)}2&e&&(m.R7$(3),m.Y8G("text",m.bMT(4,8,"core.back")),m.R7$(4),m.JRh(t.title),m.R7$(2),m.Y8G("disabled",!t.loaded),m.R7$(),m.FS9("pullingText",m.bMT(11,10,"core.pulltorefresh")),m.R7$(2),m.Y8G("hideUntil",t.loaded),m.R7$(),m.Y8G("ngIf",!t.sections||!t.sections.length),m.R7$(2),m.Y8G("ngForOf",t.sections),m.R7$(),m.Y8G("enabled",t.canLoadMore))},dependencies:[p.n,C.Sq,C.bT,C.T3,h.QW,h.b_,h.W9,h.eU,h.Dg,h.he,h.nf,h.To,h.Ki,h.BC,h.ai,h.el,f.h,T.b,y.R,M.B,x.i,I.D9,u.CoreCourseModuleComponent],styles:["core-course-module[_ngcontent-%COMP%]:last-child{--activity-border: 0px;--card-padding-bottom: 0px}"]}),CoreCourseListModTypePage})()}}]);