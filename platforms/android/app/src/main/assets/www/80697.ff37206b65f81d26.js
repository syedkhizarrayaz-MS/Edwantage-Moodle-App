"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[80697],{80697:(o,n,e)=>{e.r(n),e.d(n,{AddonModForumPostOptionsMenuComponent:()=>F});var t=e(10467),i=e(52749),s=e(94455),d=e(16179),r=e(79555),a=e(49446),l=e(86654),p=e(25572),m=e(54438),u=e(60177),c=e(2910),f=e(64422),_=e(86198),M=e(23007),h=e(88246),P=e(73955);function AddonModForumPostOptionsMenuComponent_ion_item_3_Template(o,n){if(1&o){const o=m.RV6();m.j41(0,"ion-item",3),m.bIt("click",(function AddonModForumPostOptionsMenuComponent_ion_item_3_Template_ion_item_click_0_listener(){m.eBV(o);const n=m.XpG();return m.Njj(n.editPost())})),m.nrm(1,"ion-icon",4),m.j41(2,"ion-label")(3,"p",5),m.EFF(4),m.nI1(5,"translate"),m.k0s()()()}2&o&&(m.Y8G("detail",!1),m.R7$(4),m.JRh(m.bMT(5,2,"addon.mod_forum.edit")))}function AddonModForumPostOptionsMenuComponent_ion_item_4_p_3_Template(o,n){1&o&&(m.j41(0,"p",5),m.EFF(1),m.nI1(2,"translate"),m.k0s()),2&o&&(m.R7$(),m.JRh(m.bMT(2,1,"addon.mod_forum.delete")))}function AddonModForumPostOptionsMenuComponent_ion_item_4_p_4_Template(o,n){1&o&&(m.j41(0,"p",5),m.EFF(1),m.nI1(2,"translate"),m.k0s()),2&o&&(m.R7$(),m.JRh(m.bMT(2,1,"core.discard")))}function AddonModForumPostOptionsMenuComponent_ion_item_4_Template(o,n){if(1&o){const o=m.RV6();m.j41(0,"ion-item",3),m.bIt("click",(function AddonModForumPostOptionsMenuComponent_ion_item_4_Template_ion_item_click_0_listener(){m.eBV(o);const n=m.XpG();return m.Njj(n.deletePost())})),m.nrm(1,"ion-icon",6),m.j41(2,"ion-label"),m.DNE(3,AddonModForumPostOptionsMenuComponent_ion_item_4_p_3_Template,3,3,"p",7)(4,AddonModForumPostOptionsMenuComponent_ion_item_4_p_4_Template,3,3,"p",7),m.k0s()()}if(2&o){const o=m.XpG();m.Y8G("detail",!1),m.R7$(3),m.Y8G("ngIf",!o.offlinePost),m.R7$(),m.Y8G("ngIf",o.offlinePost)}}function AddonModForumPostOptionsMenuComponent_ion_item_5_Template(o,n){if(1&o&&(m.j41(0,"ion-item",8),m.nrm(1,"ion-icon",9),m.j41(2,"ion-label")(3,"p",5),m.EFF(4),m.nI1(5,"translate"),m.k0s()()()),2&o){const o=m.XpG();m.Y8G("href",o.url)("detail",!1)("showBrowserWarning",!1),m.R7$(4),m.JRh(m.bMT(5,4,"core.openinbrowser"))}}let F=(()=>{var o;class AddonModForumPostOptionsMenuComponent{constructor(){this.canEdit=!1,this.canDelete=!1,this.loaded=!1,this.offlinePost=!1}ngOnInit(){var o=this;return(0,t.A)((function*(){if(o.offlinePost=o.post.id<0,o.offlinePost)return o.loaded=!0,void 0;if(void 0===o.post.capabilities.delete){if(!o.forumId)return o.loaded=!0,o.setOpenInBrowserUrl(),void 0;try{o.post=yield d.AddonModForum.getDiscussionPost(o.forumId,o.post.discussionid,o.post.id,{cmId:o.cmId,readingStrategy:2})}catch(o){p.CoreAlerts.showError(o,{default:"Error getting discussion post."})}}o.canDelete=!!o.post.capabilities.delete&&d.AddonModForum.isDeletePostAvailable(),o.canEdit=!!o.post.capabilities.edit&&d.AddonModForum.isUpdatePostAvailable(),o.canDelete||o.canEdit||o.setOpenInBrowserUrl(),o.loaded=!0}))()}setOpenInBrowserUrl(){const o=i.CoreSites.getRequiredCurrentSite();o.shouldDisplayInformativeLinks()&&(this.url=o.createSiteUrl("/mod/forum/discuss.php",{d:this.post.discussionid.toString()},`p${this.post.id}`))}dismiss(){r.IE.dismiss()}deletePost(){if(this.offlinePost)r.IE.dismiss({action:"deleteoffline"});else{if(!s.WE.isOnline())return p.CoreAlerts.showError(new a.CoreNetworkError),void 0;r.IE.dismiss({action:"delete"})}}editPost(){if(!this.offlinePost&&!s.WE.isOnline())return p.CoreAlerts.showError(new a.CoreNetworkError),void 0;r.IE.dismiss({action:"edit"})}}return(o=AddonModForumPostOptionsMenuComponent).ɵfac=function AddonModForumPostOptionsMenuComponent_Factory(n){return new(n||o)},o.ɵcmp=m.VBU({type:o,selectors:[["addon-forum-post-options-menu"]],inputs:{post:"post",cmId:"cmId",forumId:"forumId"},standalone:!0,features:[m.aNF],decls:6,vars:5,consts:[[3,"hideUntil","fullscreen"],["button","","class","ion-text-wrap",3,"detail","click",4,"ngIf"],["class","ion-text-wrap","core-link","","capture","false","button","",3,"href","detail","showBrowserWarning",4,"ngIf"],["button","",1,"ion-text-wrap",3,"click","detail"],["name","fas-pen","slot","start","aria-hidden","true"],[1,"item-heading"],["name","fas-trash","slot","start","aria-hidden","true"],["class","item-heading",4,"ngIf"],["core-link","","capture","false","button","",1,"ion-text-wrap",3,"href","detail","showBrowserWarning"],["name","fas-up-right-from-square","slot","start","aria-hidden","true"]],template:function AddonModForumPostOptionsMenuComponent_Template(o,n){1&o&&(m.j41(0,"ion-content")(1,"core-loading",0)(2,"ion-list"),m.DNE(3,AddonModForumPostOptionsMenuComponent_ion_item_3_Template,6,4,"ion-item",1)(4,AddonModForumPostOptionsMenuComponent_ion_item_4_Template,5,3,"ion-item",1)(5,AddonModForumPostOptionsMenuComponent_ion_item_5_Template,6,6,"ion-item",2),m.k0s()()()),2&o&&(m.R7$(),m.Y8G("hideUntil",n.loaded)("fullscreen",!1),m.R7$(2),m.Y8G("ngIf",n.offlinePost||n.canEdit),m.R7$(),m.Y8G("ngIf",n.offlinePost||n.canDelete),m.R7$(),m.Y8G("ngIf",n.url))},dependencies:[l.n,u.bT,c.W9,c.iq,c.uz,c.he,c.nf,f.R,_.t,M.j,h.i,P.D9],styles:["core-loading[_ngcontent-%COMP%]{--loading-inline-min-height: 48px;--loading-display-message: none}"]}),AddonModForumPostOptionsMenuComponent})()}}]);