"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[36955],{59336:(e,o,n)=>{n.r(o),n.d(o,{default:()=>S});var t=n(10467),a=n(27338),i=n(97383),r=n(52749),l=n(55554),_=n(15324),d=n(93417),s=n(79555),c=n(52266),C=n(83696),g=n(32379),p=n(99891),u=n(82907),m=n(24742),b=n(22693),P=n(25572),h=n(86654),M=n(54438),G=n(21182),f=n(2910),T=n(16986),x=n(66198),F=n(64422),v=n(32572),w=n(10892),O=n(86198),$=n(58197),R=n(8199),y=n(28988),k=n(35407),I=n(88246),X=n(60177),E=n(73955);const _forTrack0=(e,o)=>o.name;function CoreGradesCoursePage_Conditional_13_Template(e,o){1&e&&(M.nrm(0,"core-empty-box",6),M.nI1(1,"translate")),2&e&&M.Y8G("message",M.bMT(1,1,"core.grades.nogradesreturned"))}function CoreGradesCoursePage_Conditional_14_For_5_Conditional_1_Template(e,o){1&e&&(M.EFF(0),M.nI1(1,"translate")),2&e&&M.SpI(" ",M.bMT(1,1,"core.gradenoun")," ")}function CoreGradesCoursePage_Conditional_14_For_5_Conditional_2_Template(e,o){if(1&e&&(M.EFF(0),M.nI1(1,"translate")),2&e){const e=M.XpG().$implicit;M.SpI(" ",M.bMT(1,1,"core.grades."+e.name)," ")}}function CoreGradesCoursePage_Conditional_14_For_5_Template(e,o){if(1&e&&(M.j41(0,"th",11),M.DNE(1,CoreGradesCoursePage_Conditional_14_For_5_Conditional_1_Template,2,3)(2,CoreGradesCoursePage_Conditional_14_For_5_Conditional_2_Template,2,3),M.k0s()),2&e){const e=o.$implicit;M.AVh("ion-hide-md-down",e.hiddenPhone),M.FS9("id",e.name),M.BMQ("colspan",e.colspan),M.R7$(),M.vxM(1,"grade"===e.name?1:2)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_0_Template(e,o){if(1&e&&(M.j41(0,"tr"),M.nrm(1,"td",13),M.k0s()),2&e){const e=M.XpG().$implicit;M.R7$(),M.BMQ("rowspan",e.rowspan)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_0_Template(e,o){if(1&e&&M.nrm(0,"td",15),2&e){const e=M.XpG(3).$implicit;M.BMQ("rowspan",e.rowspan)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_2_Template(e,o){if(1&e&&M.nrm(0,"ion-icon",20),2&e){const e=M.XpG(3).$implicit;M.AVh("expandable-status-icon-expanded",e.expanded)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_3_Template(e,o){if(1&e&&M.nrm(0,"ion-icon",18),2&e){const e=M.XpG(3).$implicit;M.FS9("name",e.icon),M.BMQ("aria-label",e.iconAlt)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_4_Conditional_0_Template(e,o){if(1&e&&M.nrm(0,"core-mod-icon",21),2&e){const e=M.XpG(4).$implicit;M.Y8G("modicon",e.image)("modname",e.itemmodule)("colorize",!1)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_4_Conditional_1_Template(e,o){if(1&e&&M.nrm(0,"img",22),2&e){const e=M.XpG(4).$implicit;M.Y8G("url",e.image)("alt",e.iconAlt)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_4_Template(e,o){if(1&e&&M.DNE(0,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_4_Conditional_0_Template,1,3,"core-mod-icon",21)(1,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_4_Conditional_1_Template,1,2),2&e){const e=M.XpG(3).$implicit;M.vxM(0,e.itemmodule?0:1)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_0_Template(e,o){if(1&e&&(M.j41(0,"td",24),M.nrm(1,"core-format-text",25),M.k0s()),2&e){const e=M.XpG().$implicit,o=M.XpG(4).$implicit,n=M.XpG(2);M.AVh("ion-hide-md-down",e.hiddenPhone),M.R7$(),M.Y8G("text",o.feedback)("contextInstanceId",n.courseId)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_1_Conditional_2_Template(e,o){if(1&e&&M.nrm(0,"ion-icon",26),2&e){const e=M.XpG(6).$implicit;M.Y8G("name",e.gradeIcon),M.BMQ("aria-label",e.gradeIconAlt)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_1_Conditional_3_Template(e,o){1&e&&M.nrm(0,"ion-icon",27)}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_1_Conditional_5_Template(e,o){if(1&e&&(M.j41(0,"div",29),M.EFF(1),M.k0s()),2&e){const e=M.XpG(6).$implicit,o=M.XpG(2);M.AVh("sr-only",o.showSummary),M.R7$(),M.SpI(" ",e.penalty," ")}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_1_Template(e,o){if(1&e&&(M.j41(0,"td")(1,"div"),M.DNE(2,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_1_Conditional_2_Template,1,2,"ion-icon",26)(3,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_1_Conditional_3_Template,1,0,"ion-icon",27),M.nrm(4,"span",19),M.k0s(),M.DNE(5,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_1_Conditional_5_Template,2,3,"div",28),M.k0s()),2&e){const e=M.XpG().$implicit,o=M.XpG(4).$implicit;M.ZvI("ion-text-start core-grades-table-grade ",o.gradeClass,""),M.AVh("ion-hide-md-down",e.hiddenPhone),M.R7$(2),M.vxM(2,o.gradeIcon?2:-1),M.R7$(),M.vxM(3,o.penalty?3:-1),M.R7$(),M.Y8G("innerHTML",o[e.name],M.npT),M.R7$(),M.vxM(5,o.penalty?5:-1)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_2_Template(e,o){if(1&e&&M.nrm(0,"td",19),2&e){const e=M.XpG().$implicit,o=M.XpG(4).$implicit;M.HbH("ion-text-start core-grades-table-"+e.name),M.AVh("ion-hide-md-down",e.hiddenPhone),M.Y8G("innerHTML",o[e.name],M.npT)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Template(e,o){if(1&e&&M.DNE(0,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_0_Template,2,4,"td",23)(1,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_1_Template,6,9)(2,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Conditional_2_Template,1,5),2&e){const e=o.$implicit,n=M.XpG(4).$implicit;M.vxM(0,"feedback"===e.name&&void 0!==n.feedback?0:"grade"===e.name?1:"gradeitem"!==e.name&&"feedback"!==e.name&&"grade"!==e.name&&void 0!==n[e.name]?2:-1)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_Template(e,o){if(1&e&&M.Z7z(0,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_For_1_Template,3,1,null,null,_forTrack0),2&e){const e=M.XpG(5);M.Dyx(e.columns)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Template(e,o){if(1&e&&(M.DNE(0,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_0_Template,1,1,"td",15),M.j41(1,"th",16),M.DNE(2,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_2_Template,1,2,"ion-icon",17)(3,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_3_Template,1,2,"ion-icon",18)(4,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_4_Template,2,1),M.nrm(5,"span",19),M.k0s(),M.DNE(6,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Conditional_6_Template,2,0)),2&e){const e=M.XpG(2).$implicit,o=M.XpG(2);M.vxM(0,"category"===e.itemtype?0:-1),M.R7$(),M.BMQ("colspan",e.colspan),M.R7$(),M.vxM(2,e.expandable&&o.showSummary?2:-1),M.R7$(),M.vxM(3,e.icon?3:-1),M.R7$(),M.vxM(4,e.image?4:-1),M.R7$(),M.Y8G("innerHTML",e.gradeitem,M.npT),M.R7$(),M.vxM(6,"category"!==e.itemtype?6:-1)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Template(e,o){if(1&e){const e=M.RV6();M.j41(0,"tr",14),M.bIt("ariaButtonClick",(function CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Template_tr_ariaButtonClick_0_listener(){M.eBV(e);const o=M.XpG().$implicit,n=M.XpG(2);return M.Njj(o.expandable&&n.showSummary&&n.toggleRow(o))})),M.DNE(1,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Conditional_1_Template,7,7),M.k0s()}if(2&e){const e=M.XpG().$implicit,o=M.XpG(2);M.HbH(e.rowclass),M.AVh("core-grades-grade-clickable",e.expandable&&o.showSummary),M.Y8G("id","grade-"+e.id),M.BMQ("role",e.expandable&&o.showSummary?"button row":"row")("tabindex",e.expandable&&o.showSummary&&0)("aria-expanded",e.expanded)("aria-label",o.rowAriaLabel(e))("aria-controls",e.detailsid),M.R7$(),M.vxM(1,e.itemtype?1:-1)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_3_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.nrm(5,"p",19),M.k0s()()),2&e){const e=M.XpG(2).$implicit;M.R7$(3),M.JRh(M.bMT(4,2,"core.grades.weight")),M.R7$(2),M.Y8G("innerHTML",e.weight,M.npT)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_4_Conditional_6_Template(e,o){1&e&&M.nrm(0,"ion-icon",27)}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_4_Conditional_8_Template(e,o){if(1&e&&(M.j41(0,"p",29),M.EFF(1),M.k0s()),2&e){const e=M.XpG(3).$implicit;M.R7$(),M.SpI(" ",e.penalty," ")}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_4_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.j41(5,"p",33),M.DNE(6,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_4_Conditional_6_Template,1,0,"ion-icon",27),M.nrm(7,"span",19),M.k0s(),M.DNE(8,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_4_Conditional_8_Template,2,1,"p",29),M.k0s()()),2&e){const e=M.XpG(2).$implicit;M.R7$(3),M.JRh(M.bMT(4,4,"core.gradenoun")),M.R7$(3),M.vxM(6,e.penalty?6:-1),M.R7$(),M.Y8G("innerHTML",e.grade,M.npT),M.R7$(),M.vxM(8,e.penalty?8:-1)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_5_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.nrm(5,"p",19),M.k0s()()),2&e){const e=M.XpG(2).$implicit;M.R7$(3),M.JRh(M.bMT(4,2,"core.grades.range")),M.R7$(2),M.Y8G("innerHTML",e.range,M.npT)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_6_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.nrm(5,"p",19),M.k0s()()),2&e){const e=M.XpG(2).$implicit;M.R7$(3),M.JRh(M.bMT(4,2,"core.grades.percentage")),M.R7$(2),M.Y8G("innerHTML",e.percentage,M.npT)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_7_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.nrm(5,"p",19),M.k0s()()),2&e){const e=M.XpG(2).$implicit;M.R7$(3),M.JRh(M.bMT(4,2,"core.grades.lettergrade")),M.R7$(2),M.Y8G("innerHTML",e.lettergrade,M.npT)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_8_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.nrm(5,"p",19),M.k0s()()),2&e){const e=M.XpG(2).$implicit;M.R7$(3),M.JRh(M.bMT(4,2,"core.grades.rank")),M.R7$(2),M.Y8G("innerHTML",e.rank,M.npT)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_9_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.nrm(5,"p",19),M.k0s()()),2&e){const e=M.XpG(2).$implicit;M.R7$(3),M.JRh(M.bMT(4,2,"core.grades.average")),M.R7$(2),M.Y8G("innerHTML",e.average,M.npT)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_10_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.j41(5,"p"),M.nrm(6,"core-format-text",25),M.k0s()()()),2&e){const e=M.XpG(2).$implicit,o=M.XpG(2);M.R7$(3),M.JRh(M.bMT(4,3,"core.grades.feedback")),M.R7$(3),M.Y8G("text",e.feedback)("contextInstanceId",o.courseId)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_11_Template(e,o){if(1&e&&(M.j41(0,"ion-item",31)(1,"ion-label")(2,"p",32),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.nrm(5,"p",19),M.k0s()()),2&e){const e=M.XpG(2).$implicit;M.R7$(3),M.JRh(M.bMT(4,2,"core.grades.contributiontocoursetotal")),M.R7$(2),M.Y8G("innerHTML",e.contributiontocoursetotal,M.npT)}}function CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Template(e,o){if(1&e&&(M.j41(0,"tr",30)(1,"td")(2,"ion-list"),M.DNE(3,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_3_Template,6,4,"ion-item",31)(4,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_4_Template,9,6,"ion-item",31)(5,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_5_Template,6,4,"ion-item",31)(6,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_6_Template,6,4,"ion-item",31)(7,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_7_Template,6,4,"ion-item",31)(8,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_8_Template,6,4,"ion-item",31)(9,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_9_Template,6,4,"ion-item",31)(10,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_10_Template,7,5,"ion-item",31)(11,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Conditional_11_Template,6,4,"ion-item",31),M.k0s()()()),2&e){const e=M.XpG().$implicit,o=M.XpG(2);M.HbH(e.rowclass),M.Y8G("id",e.detailsid),M.R7$(),M.BMQ("colspan",o.totalColumnsSpan),M.R7$(2),M.vxM(3,e.weight?3:-1),M.R7$(),M.vxM(4,e.grade?4:-1),M.R7$(),M.vxM(5,e.range?5:-1),M.R7$(),M.vxM(6,e.percentage?6:-1),M.R7$(),M.vxM(7,e.lettergrade?7:-1),M.R7$(),M.vxM(8,e.rank?8:-1),M.R7$(),M.vxM(9,e.average?9:-1),M.R7$(),M.vxM(10,e.feedback?10:-1),M.R7$(),M.vxM(11,e.contributiontocoursetotal?11:-1)}}function CoreGradesCoursePage_Conditional_14_For_8_Template(e,o){if(1&e&&M.DNE(0,CoreGradesCoursePage_Conditional_14_For_8_Conditional_0_Template,2,1,"tr")(1,CoreGradesCoursePage_Conditional_14_For_8_Conditional_1_Template,2,11)(2,CoreGradesCoursePage_Conditional_14_For_8_Conditional_2_Template,12,13,"tr",12),2&e){const e=o.$implicit;M.vxM(0,"leader"===e.itemtype?0:1),M.R7$(2),M.vxM(2,e.expandable&&e.expanded?2:-1)}}function CoreGradesCoursePage_Conditional_14_Template(e,o){if(1&e){const e=M.RV6();M.j41(0,"div",7)(1,"table",8)(2,"thead")(3,"tr"),M.Z7z(4,CoreGradesCoursePage_Conditional_14_For_5_Template,3,5,"th",9,_forTrack0),M.k0s()(),M.j41(6,"tbody"),M.Z7z(7,CoreGradesCoursePage_Conditional_14_For_8_Template,3,2,null,null,M.fX1),M.nI1(9,"slice"),M.k0s()(),M.j41(10,"core-infinite-loading",10),M.bIt("action",(function CoreGradesCoursePage_Conditional_14_Template_core_infinite_loading_action_10_listener(o){M.eBV(e);const n=M.XpG();return M.Njj(n.loadMore(o))})),M.k0s()()}if(2&e){const e=M.XpG();M.R7$(),M.AVh("summary",e.showSummary),M.R7$(3),M.Dyx(e.columns),M.R7$(3),M.Dyx(M.brH(9,3,e.rows,0,e.rowsOnView)),M.R7$(3),M.Y8G("enabled",e.rowsOnView<e.rows.length)}}let S=(()=>{var e;class CoreGradesCoursePage{constructor(e,o){this.route=e,this.element=o,this.columns=[],this.rows=[],this.rowsOnView=0,this.loaded=!1,this.logView=m.j.once((()=>this.performLogView()));try{var n,t,a,i;switch(this.courseId=_.CoreNavigator.getRequiredRouteNumberParam("courseId",{route:e}),this.userId=null!==(n=_.CoreNavigator.getRouteNumberParam("userId",{route:e}))&&void 0!==n?n:r.CoreSites.getCurrentSiteUserId(),this.gradeId=_.CoreNavigator.getRouteNumberParam("gradeId",{route:e}),this.expandLabel=s.HT.instant("core.expand"),this.collapseLabel=s.HT.instant("core.collapse"),this.useLegacyLayout=!r.CoreSites.getRequiredCurrentSite().isVersionGreaterEqualThan("4.1"),null!==(t=null===(a=e.snapshot)||void 0===a?void 0:a.data.swipeManagerSource)&&void 0!==t?t:null===(i=e.snapshot)||void 0===i||null===(i=i.parent)||void 0===i?void 0:i.data.swipeManagerSource){case"courses":this.swipeManager=new CoreGradesCourseCoursesSwipeManager(C.u.getOrCreateSource(p.b,[]));break;case"participants":{const e=_.CoreNavigator.getRouteParam("search");this.swipeManager=new CoreGradesCourseParticipantsSwipeManager(C.u.getOrCreateSource(g.u,[this.courseId,e]))}}}catch(e){return P.CoreAlerts.showError(e),_.CoreNavigator.back(),void 0}}get showSummary(){return d.CoreScreen.isMobile||!!this.withinSplitView}ngAfterViewInit(){var e=this;return(0,t.A)((function*(){var o,n;e.withinSplitView=!(null===(o=e.element.nativeElement.parentElement)||void 0===o||!o.closest("core-split-view")),yield null===(n=e.swipeManager)||void 0===n?void 0:n.start(),yield e.fetchInitialGrades(),e.loaded=!0}))()}ngOnDestroy(){var e;null===(e=this.swipeManager)||void 0===e||e.destroy()}rowAriaLabel(e){if(!e.expandable||!this.showSummary)return;return`${e.expanded?this.collapseLabel:this.expandLabel} ${e.ariaLabel}`}toggleRow(e,o){var n;if(!this.rows||!this.columns)return;e.expanded=null!=o?o:!e.expanded;let t=this.columns.length+(null!==(n=e.colspan)&&void 0!==n?n:0);this.useLegacyLayout&&t--;for(let o=this.rows.indexOf(e)-1;o>=0;o--){const n=this.rows[o];!n.rowspan||!n.colspan||n.colspan!==t||!this.useLegacyLayout&&"leader"!==n.itemtype||this.useLegacyLayout&&n.expandable||(t++,n.rowspan+=e.expanded?1:-1)}}refreshGrades(e){var o=this;return(0,t.A)((function*(){yield l.g.ignoreErrors(a.CoreGrades.invalidateCourseGradesData(o.courseId,o.userId)),yield l.g.ignoreErrors(o.fetchGrades()),null==e||e.complete()}))()}fetchInitialGrades(){var e=this;return(0,t.A)((function*(){try{if(yield e.fetchGrades(),e.gradeId&&e.rows){const o=e.rows.find((o=>o.id==e.gradeId));o&&(e.toggleRow(o,!0),u.y.scrollToElement(e.element.nativeElement,`#grade-${o.id}`),e.gradeId=void 0)}}catch(o){P.CoreAlerts.showError(o,{default:"Error loading course"}),e.columns=[],e.rows=[],e.rowsOnView=0}}))()}fetchGrades(){var e=this;return(0,t.A)((function*(){var o,n,t,r;const l=yield a.CoreGrades.getCourseGradesTable(e.courseId,e.userId),_=yield i.CoreGradesHelper.formatGradesTable(l);e.title=null!==(o=null!==(n=null===(t=e.swipeManager)||void 0===t?void 0:t.getPageTitle())&&void 0!==n?n:null===(r=_.rows[0])||void 0===r?void 0:r.gradeitem)&&void 0!==o?o:s.HT.instant("core.grades.grades"),e.columns=_.columns,e.rows=_.rows,e.rowsOnView=e.getRowsOnHeight(),e.totalColumnsSpan=_.columns.reduce(((e,o)=>e+o.colspan),0),e.logView()}))()}getRowsOnHeight(){return Math.floor(window.innerHeight/44)}loadMore(e){this.rowsOnView+=this.getRowsOnHeight(),e&&e()}performLogView(){var e=this;return(0,t.A)((function*(){var o;yield l.g.ignoreErrors(a.CoreGrades.logCourseGradesView(e.courseId,e.userId)),b.OF.logEvent({type:b.qr.VIEW_ITEM,ws:"gradereport_user_view_grade_report",name:null!==(o=e.title)&&void 0!==o?o:"",data:{id:e.courseId,userid:e.userId,category:"grades"},url:`/grade/report/user/index.php?id=${e.courseId}`+(e.userId!==r.CoreSites.getCurrentSiteUserId()?`&userid=${e.userId}`:"")})}))()}}return(e=CoreGradesCoursePage).ɵfac=function CoreGradesCoursePage_Factory(o){return new(o||e)(M.rXU(G.nX),M.rXU(M.aKT))},e.ɵcmp=M.VBU({type:e,selectors:[["page-core-grades-course"]],standalone:!0,features:[M.aNF],decls:15,vars:11,consts:[["slot","start"],[3,"text"],[3,"core-swipe-navigation"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],["placeholderType","column","placeholderHeight","36px",3,"hideUntil"],["icon","fas-chart-bar",3,"message"],[1,"core-grades-container"],[1,"core-table","core-grades-table"],[1,"ion-text-start",3,"id","ion-hide-md-down"],[3,"action","enabled"],[1,"ion-text-start",3,"id"],[3,"id","class"],[1,"core-grades-table-leader"],[3,"ariaButtonClick","id"],[1,"core-grades-table-category"],[1,"core-grades-table-gradeitem","ion-text-start"],["aria-hidden","true","slot","start","name","fas-chevron-right",1,"expandable-status-icon",3,"expandable-status-icon-expanded"],["slot","start",3,"name"],[3,"innerHTML"],["aria-hidden","true","slot","start","name","fas-chevron-right",1,"expandable-status-icon"],["slot","start",3,"modicon","modname","colorize"],["slot","start","core-external-content","",1,"core-module-icon",3,"url","alt"],[1,"ion-text-start","core-grades-table-feedback",3,"ion-hide-md-down"],[1,"ion-text-start","core-grades-table-feedback"],["collapsible-item","","contextLevel","course",3,"text","contextInstanceId"],[3,"name"],["name","fas-triangle-exclamation","color","danger","aria-hidden","true"],[1,"core-grades-expanded-grade-penalty",3,"sr-only"],[1,"core-grades-expanded-grade-penalty"],[3,"id"],[1,"ion-text-wrap"],[1,"item-heading"],[1,"core-grades-expanded-grade"]],template:function CoreGradesCoursePage_Template(e,o){1&e&&(M.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),M.nrm(3,"ion-back-button",1),M.nI1(4,"translate"),M.k0s(),M.j41(5,"ion-title")(6,"h1"),M.EFF(7),M.k0s()()()(),M.j41(8,"ion-content",2)(9,"ion-refresher",3),M.bIt("ionRefresh",(function CoreGradesCoursePage_Template_ion_refresher_ionRefresh_9_listener(e){return o.refreshGrades(e.target)})),M.nrm(10,"ion-refresher-content",4),M.nI1(11,"translate"),M.k0s(),M.j41(12,"core-loading",5),M.DNE(13,CoreGradesCoursePage_Conditional_13_Template,2,3,"core-empty-box",6)(14,CoreGradesCoursePage_Conditional_14_Template,11,7),M.k0s()()),2&e&&(M.R7$(3),M.Y8G("text",M.bMT(4,7,"core.back")),M.R7$(4),M.JRh(o.title),M.R7$(),M.Y8G("core-swipe-navigation",o.swipeManager),M.R7$(),M.Y8G("disabled",!o.columns||!o.rows),M.R7$(),M.FS9("pullingText",M.bMT(11,9,"core.pulltorefresh")),M.R7$(2),M.Y8G("hideUntil",o.loaded),M.R7$(),M.vxM(13,o.rows.length?14:13))},dependencies:[h.n,f.QW,f.W9,f.eU,f.iq,f.uz,f.he,f.nf,f.To,f.Ki,f.BC,f.ai,f.el,T.h,x.b,F.R,v.I,w.l,O.t,$.B,R.a,y.n,k.K,I.i,X.P9,E.D9],styles:["[_nghost-%COMP%]{--icon-color: var(--gray-500);--core-table-border-color: var(--stroke)}:root.dark[_nghost-%COMP%], :root.dark   [_nghost-%COMP%]{--icon-color: var(--gray-200)}table.core-table.core-grades-table[_ngcontent-%COMP%]{width:100%;margin:0}table.core-table.core-grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{padding-inline-start:24px}table.core-table.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.core-bold[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:inherit}table.core-table.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{padding-inline-start:4px}table.core-table.core-grades-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table.core-table.core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-inline-start:0px;padding-inline-end:8px;padding-top:8px;padding-bottom:8px;vertical-align:top}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]{padding-inline-start:4px}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem.column-itemname[_ngcontent-%COMP%]{padding-inline-start:0}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;height:16px}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   core-mod-icon[_ngcontent-%COMP%]{--module-icon-padding: 0px;--module-legacy-icon-padding: 0px;--module-icon-size: 16px;--module-legacy-icon-size: 16px}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--icon-color)}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-inline-start:4px}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon[_ngcontent-%COMP%]{font-size:var(--text-size);margin-inline-start:0;margin-inline-end:2px;transition:transform .2s ease-in-out}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon.expandable-status-icon-expanded[_ngcontent-%COMP%]{transform:var(--rotate-expandable)}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]{padding-inline-start:4px}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]   .no-overflow[_ngcontent-%COMP%]{overflow:auto}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-grade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{line-height:var(--mdl-typography-label-lineHeight-sm);vertical-align:middle}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-grade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{padding-inline-end:4px;padding-bottom:2px}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-grade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]     .penalty-indicator-icon{display:none}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-leader[_ngcontent-%COMP%]{width:0}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]{cursor:pointer}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%], table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   th[_ngcontent-%COMP%], table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   th[aria-current=page][_ngcontent-%COMP%]{background-color:var(--cell-hover)}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{height:var(--a11y-sizing-minTargetSize);vertical-align:middle}table.core-table.core-grades-table[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%], table.core-table.core-grades-table[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]::part(native){background-color:transparent}table.core-table.core-grades-table.summary[_ngcontent-%COMP%]   .ion-hide-md-down[_ngcontent-%COMP%]{display:none;opacity:0}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-expanded-grade[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-expanded-grade[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{flex-shrink:0}table.core-table.core-grades-table[_ngcontent-%COMP%]   .core-grades-expanded-grade-penalty[_ngcontent-%COMP%]{color:var(--danger);font-size:.75em}@media (max-width: 767.98px){.core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85em}}"]}),CoreGradesCoursePage})();class CoreGradesCourseCoursesSwipeManager extends c.Z{constructor(e){super(e)}getPageTitle(){const e=this.getSelectedItem();return null==e?void 0:e.courseFullName}}class CoreGradesCourseParticipantsSwipeManager extends c.Z{constructor(e){super(e)}getPageTitle(){const e=this.getSelectedItem();return null==e?void 0:e.fullname}getSelectedItemPathFromRoute(e){return _.CoreNavigator.getRouteParams(e).userId}}}}]);