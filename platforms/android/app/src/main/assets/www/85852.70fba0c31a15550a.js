"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[85852,30864],{16837:(e,o,n)=>{n.r(o),n.d(o,{default:()=>w});var i=n(10467),t=n(83696),s=n(52266),r=n(44682),a=n(15324),d=n(65045),u=n(81679),l=n(5505),c=n(24742),g=n(22693),m=n(79555),v=n(25572),h=n(86654),b=n(66016),p=n(54438),M=n(21182),C=n(60177),f=n(2910),_=n(64422),I=n(58197),A=n(28988),y=n(88246),P=n(73955);function AddonModAssignSubmissionReviewPage_addon_mod_assign_submission_14_Template(e,o){if(1&e&&p.nrm(0,"addon-mod-assign-submission",9),2&e){const e=p.XpG();p.Y8G("courseId",e.courseId)("moduleId",e.moduleId)("submitId",e.submitId)("blindId",e.blindId)}}let w=(()=>{var e;class AddonModAssignSubmissionReviewPage{constructor(e){this.route=e,this.title="",this.loaded=!1,this.canSaveGrades=!1,this.blindMarking=!1,this.forceLeave=!1,this.logView=c.j.once((()=>{if(!this.assign)return;const e=this.blindMarking?this.blindId:this.submitId,o=this.blindMarking?"blindid":"userid";g.OF.logEvent({type:g.qr.VIEW_ITEM,ws:"mod_assign_get_submission_status",name:m.HT.instant("addon.mod_assign.subpagetitle",{contextname:this.assign.name,subpage:m.HT.instant("addon.mod_assign.grading")}),data:{id:e,assignid:this.assign.id,category:b.KZ},url:`/mod/assign/view.php?id=${this.assign.cmid}&action=grader&${o}=${e}`})}))}ngOnInit(){this.route.queryParams.subscribe((e=>{try{var o;this.moduleId=a.CoreNavigator.getRequiredRouteNumberParam("cmId"),this.courseId=a.CoreNavigator.getRequiredRouteNumberParam("courseId"),this.submitId=a.CoreNavigator.getRouteNumberParam("submitId")||0,this.blindId=a.CoreNavigator.getRouteNumberParam("blindId",{params:e});const n=a.CoreNavigator.getRequiredRouteNumberParam("groupId"),i=a.CoreNavigator.getRouteParam("selectedStatus"),s=t.u.getOrCreateSource(d.W,[this.courseId,this.moduleId,i]);null===(o=this.submissions)||void 0===o||o.destroy(),s.groupId=n,this.submissions=new AddonModAssignSubmissionSwipeItemsManager(s),this.submissions.start()}catch(e){return v.CoreAlerts.showError(e),a.CoreNavigator.back(),void 0}this.fetchSubmission().finally((()=>{this.logView(),this.loaded=!0}))}))}ngOnDestroy(){var e;null===(e=this.submissions)||void 0===e||e.destroy()}fetchSubmission(){var e=this;return(0,i.A)((function*(){e.assign=yield l.AddonModAssign.getAssignment(e.courseId,e.moduleId),e.title=e.assign.name,e.blindMarking=!!e.assign.blindmarking&&!e.assign.revealidentities;const o=yield r.CoreCourse.getModuleBasicGradeInfo(e.moduleId);if(o)if(o.advancedgrading&&o.advancedgrading[0]&&void 0!==o.advancedgrading[0].method){e.canSaveGrades="simple"==(o.advancedgrading[0].method||"simple")}else e.canSaveGrades=!0}))()}refreshAllData(){var e=this;return(0,i.A)((function*(){const o=[];o.push(l.AddonModAssign.invalidateAssignmentData(e.courseId)),e.assign&&(o.push(l.AddonModAssign.invalidateSubmissionData(e.assign.id)),o.push(l.AddonModAssign.invalidateAssignmentUserMappingsData(e.assign.id)),o.push(l.AddonModAssign.invalidateSubmissionStatusData(e.assign.id,e.submitId,void 0,e.blindMarking)));try{yield Promise.all(o)}finally{e.submissionComponent&&e.submissionComponent.invalidateAndRefresh(!0),yield e.fetchSubmission()}}))()}refreshSubmission(e){this.refreshAllData().finally((()=>{null==e||e.complete()}))}}return(e=AddonModAssignSubmissionReviewPage).ɵfac=function AddonModAssignSubmissionReviewPage_Factory(o){return new(o||e)(p.rXU(M.nX))},e.ɵcmp=p.VBU({type:e,selectors:[["page-addon-mod-assign-submission-review"]],viewQuery:function AddonModAssignSubmissionReviewPage_Query(e,o){if(1&e&&p.GBs(u.B,5),2&e){let e;p.mGM(e=p.lsd())&&(o.submissionComponent=e.first)}},standalone:!0,features:[p.aNF],decls:15,vars:13,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[3,"core-swipe-navigation"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[3,"courseId","moduleId","submitId","blindId",4,"ngIf"],[3,"courseId","moduleId","submitId","blindId"]],template:function AddonModAssignSubmissionReviewPage_Template(e,o){1&e&&(p.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),p.nrm(3,"ion-back-button",1),p.nI1(4,"translate"),p.k0s(),p.j41(5,"ion-title")(6,"h1"),p.nrm(7,"core-format-text",2),p.k0s()(),p.nrm(8,"ion-buttons",3),p.k0s()(),p.j41(9,"ion-content",4)(10,"ion-refresher",5),p.bIt("ionRefresh",(function AddonModAssignSubmissionReviewPage_Template_ion_refresher_ionRefresh_10_listener(e){return o.refreshSubmission(e.target)})),p.nrm(11,"ion-refresher-content",6),p.nI1(12,"translate"),p.k0s(),p.j41(13,"core-loading",7),p.DNE(14,AddonModAssignSubmissionReviewPage_addon_mod_assign_submission_14_Template,1,4,"addon-mod-assign-submission",8),p.k0s()()),2&e&&(p.R7$(3),p.Y8G("text",p.bMT(4,9,"core.back")),p.R7$(4),p.Y8G("text",o.title)("contextInstanceId",o.moduleId)("courseId",o.courseId),p.R7$(2),p.Y8G("core-swipe-navigation",o.submissions),p.R7$(),p.Y8G("disabled",!o.loaded),p.R7$(),p.FS9("pullingText",p.bMT(12,11,"core.pulltorefresh")),p.R7$(2),p.Y8G("hideUntil",o.loaded),p.R7$(),p.Y8G("ngIf",o.loaded))},dependencies:[h.n,C.bT,f.QW,f.W9,f.eU,f.To,f.Ki,f.BC,f.ai,f.el,_.R,I.B,A.n,y.i,P.D9,u.B],encapsulation:2}),AddonModAssignSubmissionReviewPage})();class AddonModAssignSubmissionSwipeItemsManager extends s.Z{getSelectedItemPathFromRoute(e){return a.CoreNavigator.getRouteParams(e).submitId}}},30864:(e,o,n)=>{n.r(o),n.d(o,{CoreCourseModuleNavigationComponent:()=>A});var i=n(10467),t=n(44682),s=n(94247),r=n(97086),a=n(33014),d=n(15324),u=n(52749),l=n(55554),c=n(49882),g=n(25572),m=n(79555),v=n(86654),h=n(95384),b=n(54438),p=n(2910),M=n(60177),C=n(64422),f=n(86198),_=n(43570),I=n(73955);function CoreCourseModuleNavigationComponent_ion_row_1_Template(e,o){if(1&e){const e=b.RV6();b.j41(0,"ion-row",2)(1,"ion-col",3)(2,"ion-button",4),b.bIt("click",(function CoreCourseModuleNavigationComponent_ion_row_1_Template_ion_button_click_2_listener(){b.eBV(e);const o=b.XpG();return b.Njj(o.goToActivity(!1))})),b.nrm(3,"ion-icon",5),b.j41(4,"div",6),b.EFF(5),b.nI1(6,"translate"),b.k0s()()(),b.j41(7,"ion-col",3)(8,"ion-button",7),b.bIt("click",(function CoreCourseModuleNavigationComponent_ion_row_1_Template_ion_button_click_8_listener(){b.eBV(e);const o=b.XpG();return b.Njj(o.goToActivity(!0))})),b.j41(9,"div",6),b.EFF(10),b.nI1(11,"translate"),b.k0s(),b.nrm(12,"ion-icon",8),b.k0s()()()}if(2&e){const e=b.XpG();b.R7$(2),b.Y8G("disabled",!e.previousModule),b.R7$(3),b.JRh(b.bMT(6,4,"core.course.previousactivity")),b.R7$(3),b.Y8G("disabled",!e.nextModule),b.R7$(2),b.JRh(b.bMT(11,6,"core.course.nextactivity"))}}let A=(()=>{var e;class CoreCourseModuleNavigationComponent{constructor(e,o){var n=this;this.ionContent=e,this.loaded=!1;const t=u.CoreSites.getCurrentSiteId();this.element=o.nativeElement,this.completionObserver=c.z.on(c.z.COMPLETION_MODULE_VIEWED,function(){var e=(0,i.A)((function*(e){e&&e.courseId==n.courseId&&(yield n.setNextAndPreviousModules(3,!n.nextModule,!n.previousModule))}));return function(o){return e.apply(this,arguments)}}(),t)}ngOnInit(){var e=this;return(0,i.A)((function*(){try{yield e.setNextAndPreviousModules(1)}finally{e.loaded=!0}}))()}ngOnDestroy(){var e=this;return(0,i.A)((function*(){e.completionObserver.off()}))()}setNextAndPreviousModules(e,o=!0,n=!0){var s=this;return(0,i.A)((function*(){if(!o&&!n)return;const i=u.CoreSites.getReadingStrategyPreSets(e),r=yield t.CoreCourse.getSections(s.courseId,!1,!0,i),a=yield t.CoreCourse.getSectionsModules(r,{ignoreSection:e=>!s.isSectionAvailable(e)}),d=a.findIndex((e=>e.id===s.currentModuleId));if(!(d<0)){if(o){s.nextModule=void 0;for(let e=d+1;e<a.length&&void 0===s.nextModule;e++){const o=a[e];s.isModuleAvailable(o)&&(s.nextModule=o)}}if(n){s.previousModule=void 0;for(let e=d-1;e>=0&&void 0===s.previousModule;e--){const o=a[e];s.isModuleAvailable(o)&&(s.previousModule=o)}}s.element.classList.toggle("empty",!s.nextModule&&!s.previousModule)}}))()}isModuleAvailable(e){return!s.CoreCourseHelper.isModuleStealth(e)&&h.CoreCourseModuleHelper.moduleHasView(e)}isSectionAvailable(e){return s.CoreCourseHelper.canUserViewSection(e)&&!s.CoreCourseHelper.isSectionStealth(e)}goToActivity(e=!0){var o=this;return(0,i.A)((function*(){if(!o.loaded)return;const n=yield a.CoreLoadings.show();yield l.g.ignoreErrors(o.setNextAndPreviousModules(3,e,!e)),n.dismiss();const i=e?o.nextModule:o.previousModule;if(!i)return g.CoreAlerts.showError(m.HT.instant(e?"core.course.nextactivitynotfound":"core.course.previousactivitynotfound")),void 0;const t={replace:!0,animationDirection:e?"forward":"back"};s.CoreCourseHelper.canUserViewModule(i)?r.CoreCourseModuleDelegate.openActivityPage(i.modname,i,o.courseId,t):(t.params={module:i},d.CoreNavigator.navigateToSitePath(`course/${o.courseId}/${i.id}/module-preview`,t))}))()}}return(e=CoreCourseModuleNavigationComponent).ɵfac=function CoreCourseModuleNavigationComponent_Factory(o){return new(o||e)(b.rXU(p.W9),b.rXU(b.aKT))},e.ɵcmp=b.VBU({type:e,selectors:[["core-course-module-navigation"]],inputs:{courseId:"courseId",currentModuleId:"currentModuleId"},standalone:!0,features:[b.aNF],decls:2,vars:3,consts:[[3,"hideUntil","fullscreen"],["class","ion-justify-content-between ion-align-items-center ion-no-padding",4,"ngIf"],[1,"ion-justify-content-between","ion-align-items-center","ion-no-padding"],["size","6",1,"ion-no-padding","core-course-module-navigation-arrow"],["fill","clear",1,"core-course-previous-module","ion-text-wrap",3,"click","disabled"],["name","fas-chevron-left","slot","start","aria-hidden","true"],[1,"button-text"],["fill","clear",1,"core-course-next-module","ion-text-wrap",3,"click","disabled"],["name","fas-chevron-right","slot","end","aria-hidden","true"]],template:function CoreCourseModuleNavigationComponent_Template(e,o){1&e&&(b.j41(0,"core-loading",0),b.DNE(1,CoreCourseModuleNavigationComponent_ion_row_1_Template,13,8,"ion-row",1),b.k0s()),2&e&&(b.Y8G("hideUntil",o.loaded)("fullscreen",!1),b.R7$(),b.Y8G("ngIf",o.previousModule||o.nextModule))},dependencies:[v.n,M.bT,p.Jm,p.hU,p.iq,p.ln,C.R,f.t,_.T,I.D9],styles:["[_nghost-%COMP%]{--height: var(--core-navigation-max-height);--background: var(--core-navigation-background);--button-color: var(--gray-700);height:var(--height);width:100%;background-color:var(--background);display:block;border-top:1px solid var(--stroke)}[_nghost-%COMP%]   core-loading[_ngcontent-%COMP%]{text-align:center;--loading-inline-min-height: var(--height)}.empty[_nghost-%COMP%]{display:none}[_nghost-%COMP%]   .core-course-module-navigation-arrow[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;--border-radius: 0;width:100%;font:var(--mdl-typography-body-font-sm);--color: var(--button-color)}[_nghost-%COMP%]   .core-course-module-navigation-arrow[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   .button-text[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .core-course-module-navigation-arrow[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:var(--mdl-typography-body-fontSize-sm)}[_nghost-%COMP%]   .core-course-module-navigation-arrow[_ngcontent-%COMP%]   .core-course-previous-module[_ngcontent-%COMP%]{text-align:start}[_nghost-%COMP%]   .core-course-module-navigation-arrow[_ngcontent-%COMP%]   .core-course-next-module[_ngcontent-%COMP%]{text-align:end}core-course-format.core-course-format-singleactivity[_nghost-%COMP%], core-course-format.core-course-format-singleactivity   [_nghost-%COMP%]{opacity:0!important;height:0!important}:root.dark[_nghost-%COMP%], :root.dark   [_nghost-%COMP%]{--button-color: var(--gray-100)}"]}),CoreCourseModuleNavigationComponent})()}}]);