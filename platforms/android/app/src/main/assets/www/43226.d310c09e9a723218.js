"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[43226],{43226:(e,n,o)=>{o.r(n),o.d(n,{AddonModResourceIndexComponent:()=>X});var t=o(10467),i=o(74431),d=o(75629),r=o(23063),a=o(51024),s=o(44682),c=o(8979),l=o(94455),_=o(88436),m=o(52749),u=o(12364),p=o(75383),f=o(79555),I=o(85105),g=o(34890),R=o(18022),x=o(37057),C=o(55554),M=o(86552),T=o(25572),h=o(30864),b=o(6736),A=o(86654),v=o(54438),y=o(60177),F=o(2910),k=o(69502),w=o(17388),G=o(7476),j=o(64422),E=o(13988),$=o(86198),O=o(58197),S=o(66731),D=o(43570),Y=o(73955),N=o(59528);function AddonModResourceIndexComponent_Conditional_1_Template(e,n){if(1&e){const e=v.RV6();v.j41(0,"ion-button",9),v.nI1(1,"translate"),v.bIt("click",(function AddonModResourceIndexComponent_Conditional_1_Template_ion_button_click_0_listener(){v.eBV(e);const n=v.XpG();return v.Njj(n.openModuleSummary())})),v.nrm(2,"ion-icon",10),v.k0s()}2&e&&v.Y8G("ariaLabel",v.bMT(1,1,"core.info"))}function AddonModResourceIndexComponent_Conditional_2_Template(e,n){if(1&e){const e=v.RV6();v.j41(0,"core-context-menu")(1,"core-context-menu-item",11),v.nI1(2,"translate"),v.bIt("action",(function AddonModResourceIndexComponent_Conditional_2_Template_core_context_menu_item_action_1_listener(){v.eBV(e);const n=v.XpG();return v.Njj(n.openModuleSummary())})),v.k0s()()}2&e&&(v.R7$(),v.Y8G("priority",5e3)("content",v.bMT(2,2,"core.info")))}function AddonModResourceIndexComponent_div_5_Template(e,n){if(1&e&&(v.j41(0,"div",12),v.nrm(1,"core-format-text",13),v.k0s()),2&e){const e=v.XpG();v.R7$(),v.Y8G("text",e.module.afterlink)("contextInstanceId",e.module.id)("courseId",e.courseId)}}function AddonModResourceIndexComponent_ion_card_6_Template(e,n){if(1&e&&(v.j41(0,"ion-card",14)(1,"ion-item"),v.nrm(2,"ion-icon",15),v.j41(3,"ion-label"),v.nrm(4,"span",16),v.k0s()()()),2&e){const e=v.XpG();v.R7$(4),v.Y8G("innerHTML",e.warning,v.npT)}}function AddonModResourceIndexComponent_ng_container_7_Template(e,n){if(1&e&&(v.qex(0),v.nrm(1,"core-iframe",17),v.bVm()),2&e){const e=v.XpG();v.R7$(),v.Y8G("src",e.src)}}function AddonModResourceIndexComponent_div_8_Template(e,n){if(1&e&&(v.j41(0,"div",18),v.nrm(1,"core-format-text",13),v.k0s()),2&e){const e=v.XpG();v.R7$(),v.Y8G("text",e.contentText)("contextInstanceId",e.module.id)("courseId",e.courseId)}}function AddonModResourceIndexComponent_ng_container_9_ion_item_2_Template(e,n){if(1&e&&(v.j41(0,"ion-item",20)(1,"ion-label")(2,"p",21),v.EFF(3),v.nI1(4,"translate"),v.k0s(),v.j41(5,"p"),v.EFF(6),v.k0s()()()),2&e){const e=v.XpG(2);v.R7$(3),v.JRh(v.bMT(4,2,"core.type")),v.R7$(3),v.JRh(e.type)}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_1_Template(e,n){if(1&e&&(v.j41(0,"ion-item",20)(1,"ion-label")(2,"p",21),v.EFF(3),v.nI1(4,"translate"),v.k0s(),v.j41(5,"p"),v.EFF(6),v.k0s()()()),2&e){const e=v.XpG(3);v.R7$(3),v.JRh(v.bMT(4,2,"core.size")),v.R7$(3),v.JRh(e.readableSize)}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_2_Template(e,n){if(1&e&&(v.j41(0,"ion-item",20)(1,"ion-label")(2,"p",21),v.EFF(3),v.nI1(4,"translate"),v.k0s(),v.j41(5,"p"),v.EFF(6),v.nI1(7,"coreFormatDate"),v.k0s()()()),2&e){const e=v.XpG(3);v.R7$(3),v.JRh(v.bMT(4,2,"core.datecreated")),v.R7$(3),v.JRh(v.bMT(7,4,e.timecreated))}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_3_Template(e,n){if(1&e&&(v.j41(0,"ion-item",20)(1,"ion-label")(2,"p",21),v.EFF(3),v.nI1(4,"translate"),v.k0s(),v.j41(5,"p"),v.EFF(6),v.nI1(7,"coreFormatDate"),v.k0s()()()),2&e){const e=v.XpG(3);v.R7$(3),v.JRh(v.bMT(4,2,"core.lastmodified")),v.R7$(3),v.JRh(v.bMT(7,4,e.timemodified))}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_4_ion_grid_7_Template(e,n){1&e&&(v.j41(0,"ion-grid",23)(1,"ion-row",24)(2,"ion-col",25),v.nrm(3,"ion-icon",26),v.k0s(),v.j41(4,"ion-col")(5,"p")(6,"strong"),v.EFF(7),v.nI1(8,"translate"),v.k0s()()()()()),2&e&&(v.R7$(7),v.JRh(v.bMT(8,1,"addon.mod_resource.resourcestatusoutdated")))}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_4_Template(e,n){if(1&e&&(v.j41(0,"ion-item",20)(1,"ion-label")(2,"p",21),v.EFF(3),v.nI1(4,"translate"),v.k0s(),v.j41(5,"p"),v.EFF(6),v.k0s(),v.DNE(7,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_4_ion_grid_7_Template,9,3,"ion-grid",22),v.k0s()()),2&e){const e=v.XpG(3);v.R7$(3),v.JRh(v.bMT(4,3,"core.lastdownloaded")),v.R7$(3),v.JRh(e.downloadTimeReadable),v.R7$(),v.Y8G("ngIf",e.currentStatus===e.outdatedStatus)}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_Template(e,n){if(1&e&&(v.qex(0),v.DNE(1,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_1_Template,7,4,"ion-item",19)(2,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_2_Template,8,6,"ion-item",19)(3,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_3_Template,8,6,"ion-item",19)(4,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_4_Template,8,5,"ion-item",19),v.bVm()),2&e){const e=v.XpG(2);v.R7$(),v.Y8G("ngIf",e.readableSize),v.R7$(),v.Y8G("ngIf",e.timecreated>0),v.R7$(),v.Y8G("ngIf",e.timemodified>0),v.R7$(),v.Y8G("ngIf",e.downloadTimeReadable)}}function AddonModResourceIndexComponent_ng_container_9_Template(e,n){if(1&e&&(v.qex(0),v.j41(1,"ion-list"),v.DNE(2,AddonModResourceIndexComponent_ng_container_9_ion_item_2_Template,7,4,"ion-item",19)(3,AddonModResourceIndexComponent_ng_container_9_ng_container_3_Template,5,4,"ng-container",6),v.k0s(),v.bVm()),2&e){const e=v.XpG();v.R7$(2),v.Y8G("ngIf",e.type),v.R7$(),v.Y8G("ngIf",!e.isExternalFile)}}function AddonModResourceIndexComponent_div_10_div_1_ion_button_1_Template(e,n){if(1&e){const e=v.RV6();v.j41(0,"ion-button",33),v.bIt("click",(function AddonModResourceIndexComponent_div_10_div_1_ion_button_1_Template_ion_button_click_0_listener(){v.eBV(e);const n=v.XpG(3);return v.Njj(n.open(n.openFileAction.OPEN_WITH))})),v.nrm(1,"ion-icon",34),v.EFF(2),v.nI1(3,"translate"),v.k0s()}2&e&&(v.R7$(2),v.SpI(" ",v.bMT(3,1,"core.openwith")," "))}function AddonModResourceIndexComponent_div_10_div_1_ng_container_3_Template(e,n){1&e&&(v.qex(0),v.nrm(1,"ion-icon",35),v.EFF(2),v.nI1(3,"translate"),v.bVm()),2&e&&(v.R7$(2),v.SpI(" ",v.bMT(3,1,"core.play")," "))}function AddonModResourceIndexComponent_div_10_div_1_ng_container_4_Template(e,n){1&e&&(v.qex(0),v.nrm(1,"ion-icon",36),v.EFF(2),v.nI1(3,"translate"),v.bVm()),2&e&&(v.R7$(2),v.SpI(" ",v.bMT(3,1,"addon.mod_resource.openthefile")," "))}function AddonModResourceIndexComponent_div_10_div_1_Template(e,n){if(1&e){const e=v.RV6();v.j41(0,"div",30),v.DNE(1,AddonModResourceIndexComponent_div_10_div_1_ion_button_1_Template,4,3,"ion-button",31),v.j41(2,"ion-button",32),v.bIt("click",(function AddonModResourceIndexComponent_div_10_div_1_Template_ion_button_click_2_listener(){v.eBV(e);const n=v.XpG(2);return v.Njj(n.open(n.openFileAction.OPEN))})),v.DNE(3,AddonModResourceIndexComponent_div_10_div_1_ng_container_3_Template,4,3,"ng-container",6)(4,AddonModResourceIndexComponent_div_10_div_1_ng_container_4_Template,4,3,"ng-container",6),v.k0s()()}if(2&e){const e=v.XpG(2);v.R7$(),v.Y8G("ngIf",e.isIOS&&(!e.shouldOpenInBrowser||!e.isOnline)),v.R7$(2),v.Y8G("ngIf",e.isStreamedFile),v.R7$(),v.Y8G("ngIf",!e.isStreamedFile)}}function AddonModResourceIndexComponent_div_10_Template(e,n){if(1&e&&(v.j41(0,"div",27),v.DNE(1,AddonModResourceIndexComponent_div_10_div_1_Template,5,3,"div",28),v.nrm(2,"core-course-module-navigation",29),v.k0s()),2&e){const e=v.XpG();v.R7$(),v.Y8G("ngIf","external"===e.mode),v.R7$(),v.Y8G("courseId",e.courseId)("currentModuleId",e.module.id)}}let X=(()=>{var e;class AddonModResourceIndexComponent extends r.x{constructor(e){super("AddonModResourceIndexComponent",e),this.component=x.Bv,this.pluginName="resource",this.mode="",this.src="",this.contentText="",this.displayDescription=!0,this.warning="",this.isIOS=!1,this.openFileAction=M.n,this.isOnline=!1,this.isStreamedFile=!1,this.shouldOpenInBrowser=!1,this.type="",this.readableSize="",this.timecreated=-1,this.timemodified=-1,this.isExternalFile=!1,this.outdatedStatus=i.DownloadStatus.OUTDATED}ngOnInit(){var _superprop_getNgOnInit=()=>super.ngOnInit,e=this;return(0,t.A)((function*(){_superprop_getNgOnInit().call(e),e.isIOS=R.CorePlatform.isIOS(),e.isOnline=l.WE.isOnline(),e.onlineObserver=l.WE.onChange().subscribe((()=>{f.SK.run((()=>{e.isOnline=l.WE.isOnline()}))})),yield e.loadContent()}))()}invalidateContent(){var e=this;return(0,t.A)((function*(){return I.x.invalidateContent(e.module.id,e.courseId)}))()}fetchContent(e){var n=this;return(0,t.A)((function*(){const o=yield s.CoreCourse.getModuleContents(n.module,void 0,void 0,!1,e);if(!o.length)throw new d.CoreError(f.HT.instant("core.filenotfound"));n.module.afterlink=yield g.j.getAfterLinkDetails(n.module,n.courseId);const t=yield I.x.getResourceData(n.courseId,n.module.id);n.description=t.intro||"";const i=t.displayoptions?p.Ni.unserialize(t.displayoptions):{};if(n.displayDescription=void 0===i.printintro||!!i.printintro,n.dataRetrieved.emit(t),n.setStatusListener(),g.j.isDisplayedInIframe(n.module)){var r;const o=yield n.downloadResourceIfNeeded(e,!0),t=yield g.j.getIframeSrc(n.module);return n.mode="iframe",n.src&&t.toString()==n.src.toString()?(n.src="",setTimeout((()=>{n.src=t}))):n.src=t,n.displayDescription=!1,n.warning=o.failed?n.getErrorDownloadingSomeFilesMessage(null!==(r=o.error)&&void 0!==r?r:""):"",void 0}if(t&&"display"in t&&g.j.isDisplayedEmbedded(n.module,t.display))n.mode="embedded",n.warning="",n.contentText=yield g.j.getEmbeddedHtml(n.module),n.mode=n.contentText.length>0?"embedded":"external";else{let e;n.mode="external",n.warning="",n.displayDescription=!0,n.isIOS&&(n.shouldOpenInBrowser=_.CoreFileHelper.shouldOpenInBrowser(o[0])),"contentsinfo"in n.module&&n.module.contentsinfo?(e=n.module.contentsinfo.mimetypes[0],n.readableSize=p.Ni.bytesToSize(n.module.contentsinfo.filessize,1),n.timemodified=1e3*n.module.contentsinfo.lastmodified):(e=yield u.A.getMimeTypeFromUrl(_.CoreFileHelper.getFileUrl(o[0])),n.readableSize=p.Ni.bytesToSize(o[0].filesize,1),n.timemodified=1e3*o[0].timemodified),n.timecreated=1e3*o[0].timecreated,n.isExternalFile=!!o[0].isexternalfile,n.type=u.A.getMimetypeDescription(e),n.isStreamedFile=u.A.isStreamedMimetype(e)}}))()}logActivity(){var e=this;return(0,t.A)((function*(){yield C.g.ignoreErrors(I.x.logView(e.module.instance)),e.analyticsLogEvent("mod_resource_view_resource")}))()}open(e){var n=this;return(0,t.A)((function*(){var o;let t=yield c.CoreCourseModulePrefetchDelegate.isModuleDownloadable(n.module,n.courseId);if(t&&(t=yield g.j.isMainFileDownloadable(n.module),t)){if(n.currentStatus===i.DownloadStatus.OUTDATED&&!n.isOnline&&!n.isExternalFile){const e=yield T.CoreAlerts.show({message:f.HT.instant("addon.mod_resource.resourcestatusoutdatedconfirm")});yield e.onWillDismiss()}return g.j.openModuleFile(n.module,n.courseId,{iOSOpenFileAction:e})}yield null===(o=m.CoreSites.getCurrentSite())||void 0===o?void 0:o.openInBrowserWithAutoLogin(n.module.url||"")}))()}ngOnDestroy(){var e;super.ngOnDestroy(),null===(e=this.onlineObserver)||void 0===e||e.unsubscribe()}}return(e=AddonModResourceIndexComponent).ɵfac=function AddonModResourceIndexComponent_Factory(n){return new(n||e)(v.rXU(a.A,8))},e.ɵcmp=v.VBU({type:e,selectors:[["addon-mod-resource-index"]],standalone:!0,features:[v.Vt3,v.aNF],decls:11,vars:13,consts:[["slot","end"],["fill","clear","aria-haspopup","true",3,"ariaLabel"],[3,"hideUntil"],[3,"completionChanged","module","courseId","description","component","componentId"],["class","addon-mod_resource-afterlink ion-text-wrap","description","",4,"ngIf"],["class","core-warning-card",4,"ngIf"],[4,"ngIf"],["class","ion-padding",4,"ngIf"],["collapsible-footer","","appearOnBottom","","slot","fixed",4,"ngIf"],["fill","clear","aria-haspopup","true",3,"click","ariaLabel"],["name","fas-circle-info","slot","icon-only","aria-hidden","true"],["iconAction","fas-circle-info",3,"action","priority","content"],["description","",1,"addon-mod_resource-afterlink","ion-text-wrap"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"core-warning-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[3,"innerHTML"],[3,"src"],[1,"ion-padding"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap"],[1,"item-heading"],["class","addon-mod_resource-outdated",4,"ngIf"],[1,"addon-mod_resource-outdated"],[1,"ion-align-items-center"],["size","auto"],["color","warning","name","fas-triangle-exclamation","aria-hidden","true"],["collapsible-footer","","appearOnBottom","","slot","fixed"],["class","list-item-limited-width",4,"ngIf"],[3,"courseId","currentModuleId"],[1,"list-item-limited-width"],["expand","block","fill","outline","class","ion-margin ion-text-wrap",3,"click",4,"ngIf"],["expand","block",1,"ion-margin","ion-text-wrap",3,"click"],["expand","block","fill","outline",1,"ion-margin","ion-text-wrap",3,"click"],["name","far-share-from-square","slot","start","aria-hidden","true"],["name","fas-play","slot","start","aria-hidden","true"],["name","far-file","slot","start","aria-hidden","true"]],template:function AddonModResourceIndexComponent_Template(e,n){1&e&&(v.j41(0,"core-navbar-buttons",0),v.DNE(1,AddonModResourceIndexComponent_Conditional_1_Template,3,3,"ion-button",1)(2,AddonModResourceIndexComponent_Conditional_2_Template,3,4),v.k0s(),v.j41(3,"core-loading",2)(4,"core-course-module-info",3),v.bIt("completionChanged",(function AddonModResourceIndexComponent_Template_core_course_module_info_completionChanged_4_listener(){return n.onCompletionChange()})),v.DNE(5,AddonModResourceIndexComponent_div_5_Template,2,3,"div",4),v.k0s(),v.DNE(6,AddonModResourceIndexComponent_ion_card_6_Template,5,1,"ion-card",5)(7,AddonModResourceIndexComponent_ng_container_7_Template,2,1,"ng-container",6)(8,AddonModResourceIndexComponent_div_8_Template,2,3,"div",7)(9,AddonModResourceIndexComponent_ng_container_9_Template,4,2,"ng-container",6)(10,AddonModResourceIndexComponent_div_10_Template,3,3,"div",8),v.k0s()),2&e&&(v.R7$(),v.vxM(1,n.courseContentsPage?2:1),v.R7$(2),v.Y8G("hideUntil",!n.showLoading),v.R7$(),v.Y8G("module",n.module)("courseId",n.courseId)("description",n.displayDescription&&n.description)("component",n.component)("componentId",n.componentId),v.R7$(),v.Y8G("ngIf",n.module.afterlink),v.R7$(),v.Y8G("ngIf",n.warning),v.R7$(),v.Y8G("ngIf","iframe"===n.mode),v.R7$(),v.Y8G("ngIf","embedded"===n.mode),v.R7$(),v.Y8G("ngIf","external"===n.mode),v.R7$(),v.Y8G("ngIf",!n.showLoading))},dependencies:[A.n,y.bT,F.Jm,F.b_,F.hU,F.lO,F.iq,F.uz,F.he,F.nf,F.ln,k.B,w.Q,G.l,j.R,E.c,$.t,O.B,S.i,D.T,Y.D9,N.f,b.CoreCourseModuleInfoComponent,h.CoreCourseModuleNavigationComponent],styles:["[_nghost-%COMP%]   .addon-mod_resource-outdated[_ngcontent-%COMP%]{padding-inline-start:0px;padding-inline-end:0px;padding-top:4px;padding-bottom:0}[_nghost-%COMP%]   .addon-mod_resource-outdated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:var(--mdl-typography-icon-fontSize-lg)}[_nghost-%COMP%]   .addon-mod_resource-afterlink[_ngcontent-%COMP%]{font-size:var(--text-size)}"]}),AddonModResourceIndexComponent})()}}]);