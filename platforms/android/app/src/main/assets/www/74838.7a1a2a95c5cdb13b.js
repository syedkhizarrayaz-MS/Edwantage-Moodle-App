"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[74838],{74838:(e,o,r)=>{r.r(o),r.d(o,{default:()=>D});var t=r(10467),s=r(47142),n=r(14001),c=r(78765),a=r(49882),i=r(44682),u=r(94247),l=r(55554),d=r(15324),g=r(86123),m=r(83219),C=r(55351),h=r(8756),p=r(52749),_=r(53794),b=r(25572),v=r(86654),P=r(54438),f=r(21182),I=r(60177),T=r(2910),x=r(69502),O=r(17388),M=r(49234),N=r(10892),y=r(86198),R=r(58197),E=r(68273),G=r(43570),k=r(73955);const S=["courseThumb"];function CoreCourseIndexPage_Conditional_9_Template(e,o){if(1&e){const e=P.RV6();P.j41(0,"ion-button",11),P.nI1(1,"translate"),P.bIt("click",(function CoreCourseIndexPage_Conditional_9_Template_ion_button_click_0_listener(){P.eBV(e);const o=P.XpG();return P.Njj(o.openCourseSummary())})),P.nrm(2,"ion-icon",12),P.k0s(),P.nrm(3,"core-context-menu")}2&e&&P.Y8G("ariaLabel",P.bMT(1,1,"core.course.coursesummary"))}function CoreCourseIndexPage_Conditional_10_Template(e,o){if(1&e){const e=P.RV6();P.j41(0,"core-context-menu")(1,"core-context-menu-item",13),P.nI1(2,"translate"),P.bIt("action",(function CoreCourseIndexPage_Conditional_10_Template_core_context_menu_item_action_1_listener(){P.eBV(e);const o=P.XpG();return P.Njj(o.openCourseSummary())})),P.k0s()()}2&e&&(P.R7$(),P.Y8G("priority",1)("content",P.bMT(2,2,"core.course.coursesummary")))}function CoreCourseIndexPage_ng_container_13_div_1_Template(e,o){1&e&&(P.j41(0,"div",15,0),P.nrm(2,"ion-icon",16),P.k0s())}function CoreCourseIndexPage_ng_container_13_ion_avatar_2_Template(e,o){if(1&e&&(P.j41(0,"ion-avatar",15),P.nrm(1,"img",17),P.k0s()),2&e){const e=P.XpG(2);P.R7$(),P.Y8G("url",e.course.courseimage)}}function CoreCourseIndexPage_ng_container_13_Template(e,o){if(1&e&&(P.qex(0),P.DNE(1,CoreCourseIndexPage_ng_container_13_div_1_Template,3,0,"div",14)(2,CoreCourseIndexPage_ng_container_13_ion_avatar_2_Template,2,1,"ion-avatar",14),P.bVm()),2&e){const e=P.XpG();P.R7$(),P.Y8G("ngIf",!e.course.courseimage),P.R7$(),P.Y8G("ngIf",e.course.courseimage)}}function CoreCourseIndexPage_div_17_Template(e,o){if(1&e&&(P.j41(0,"div",18),P.nrm(1,"core-progress-bar",19),P.k0s()),2&e){const e=P.XpG();P.R7$(),P.Y8G("progress",e.progress)}}let D=(()=>{var e;class CoreCourseIndexPage{constructor(e){this.route=e,this.title="",this.category="",this.tabs=[],this.loaded=!1,this.fullScreenEnabled=!1,this.currentPagePath="",this.sections=[],this.isGuest=!1,this.openModule=!0,this.contentsTab={page:g.CORE_COURSE_CONTENTS_PAGE_NAME,title:"core.course",pageParams:{}},this.selectTabObserver=a.z.on(a.z.SELECT_COURSE_TAB,(e=>{var o;if(e.name){if(this.tabs){const o=this.tabs.findIndex((o=>o.name==e.name));var r;if(o>=0)null===(r=this.tabsComponent)||void 0===r||r.selectByIndex(o)}}else e.sectionId&&(this.contentsTab.pageParams.sectionId=e.sectionId),void 0!==e.sectionNumber&&(this.contentsTab.pageParams.sectionNumber=e.sectionNumber),null===(o=this.tabsComponent)||void 0===o||o.selectByIndex(0)}));const o=p.CoreSites.getCurrentSiteId();this.progressObserver=a.z.on(g.CORE_COURSE_PROGRESS_UPDATED_EVENT,(e=>{this.course&&this.course.id===e.courseId&&"progress"in this.course&&(this.course.progress=e.progress,this.updateProgress())}),o),this.fullScreenObserver=a.z.on(a.z.FULL_SCREEN_CHANGED,(e=>{this.fullScreenEnabled=e.enabled}))}ngOnInit(){var e=this;return(0,t.A)((function*(){var o,r;const t=d.CoreNavigator.getRouteFullPath(e.route);d.CoreNavigator.increaseRouteDepth(t.replace(/(\/deep)+/,""));try{e.course=d.CoreNavigator.getRequiredRouteParam("course")}catch(o){return b.CoreAlerts.showError(o),d.CoreNavigator.back(),e.loaded=!0,void 0}e.firstTabName=d.CoreNavigator.getRouteParam("selectedTab"),e.module=d.CoreNavigator.getRouteParam("module"),e.isGuest=null!==(o=d.CoreNavigator.getRouteBooleanParam("isGuest"))&&void 0!==o?o:!!e.course&&(yield u.CoreCourseHelper.courseUsesGuestAccessInfo(e.course.id)).guestAccess,e.modNavOptions=d.CoreNavigator.getRouteParam("modNavOptions"),e.openModule=null===(r=d.CoreNavigator.getRouteBooleanParam("openModule"))||void 0===r||r,e.currentPagePath=d.CoreNavigator.getCurrentPath(),e.contentsTab.page=h.$.concatenatePaths(e.currentPagePath,e.contentsTab.page),e.contentsTab.pageParams={course:e.course,sectionId:d.CoreNavigator.getRouteNumberParam("sectionId"),sectionNumber:d.CoreNavigator.getRouteNumberParam("sectionNumber"),blockInstanceId:d.CoreNavigator.getRouteNumberParam("blockInstanceId"),isGuest:e.isGuest},e.module&&(e.contentsTab.pageParams.moduleId=e.module.id,e.contentsTab.pageParams.sectionId||void 0!==e.contentsTab.pageParams.sectionNumber||(e.contentsTab.pageParams.sectionId=e.module.section)),e.tabs.push(e.contentsTab),e.loaded=!0,yield Promise.all([e.loadCourseHandlers(),e.loadBasinInfo()])}))()}tabSelected(){this.module&&this.course&&this.openModule&&(u.CoreCourseHelper.openModule(this.module,this.course.id,{sectionId:this.contentsTab.pageParams.sectionId,modNavOptions:this.modNavOptions}),delete this.module)}loadCourseHandlers(){var e=this;return(0,t.A)((function*(){if(!e.course)return;const o=yield c.CoreCourseOptionsDelegate.getHandlersToDisplay(e.course,!1,e.isGuest);let r;var t;(o.forEach(((o,t)=>{o.data.page=h.$.concatenatePaths(e.currentPagePath,o.data.page),o.data.pageParams=o.data.pageParams||{},e.firstTabName&&o.name==e.firstTabName&&(r=t+1)})),e.tabs=[...e.tabs,...o.map((e=>({...e.data,name:e.name})))],e.firstTabName=void 0,r)&&(yield _.H.nextTick(),null===(t=e.tabsComponent)||void 0===t||t.selectByIndex(r))}))()}loadBasinInfo(){var e=this;return(0,t.A)((function*(){e.course&&(e.title=n.CoreCourseFormatDelegate.getCourseTitle(e.course),yield e.setCourseColor(),e.updateProgress(),e.sections=yield l.g.ignoreErrors(i.CoreCourse.getSections(e.course.id,!1,!0),[]),e.sections&&(e.title=n.CoreCourseFormatDelegate.getCourseTitle(e.course,e.sections)))}))()}ngOnDestroy(){var e,o,r;const t=d.CoreNavigator.getRouteFullPath(this.route);d.CoreNavigator.decreaseRouteDepth(t.replace(/(\/deep)+/,"")),null===(e=this.selectTabObserver)||void 0===e||e.off(),null===(o=this.progressObserver)||void 0===o||o.off(),null===(r=this.fullScreenObserver)||void 0===r||r.off()}ionViewDidEnter(){var e;null===(e=this.tabsComponent)||void 0===e||e.ionViewDidEnter()}ionViewDidLeave(){var e;null===(e=this.tabsComponent)||void 0===e||e.ionViewDidLeave()}openCourseSummary(){this.course&&u.CoreCourseHelper.openCourseSummary(this.course)}updateProgress(){if(!this.course||!("progress"in this.course)||"number"!=typeof this.course.progress||this.course.progress<0||!1===this.course.completionusertracked)return this.progress=void 0,void 0;this.progress=this.course.progress}setCourseColor(){var e=this;return(0,t.A)((function*(){if(e.course&&(yield m.CoreCoursesHelper.loadCourseColorAndImage(e.course),e.courseThumb))if(e.course.color){e.courseThumb.nativeElement.style.setProperty("--course-color",e.course.color);const o=C.a.lighter(e.course.color,50);e.courseThumb.nativeElement.style.setProperty("--course-color-tint",o)}else void 0!==e.course.colorNumber&&e.courseThumb.nativeElement.classList.add(`course-color-${e.course.colorNumber}`)}))()}}return(e=CoreCourseIndexPage).ɵfac=function CoreCourseIndexPage_Factory(o){return new(o||e)(P.rXU(f.nX))},e.ɵcmp=P.VBU({type:e,selectors:[["page-core-course-index"]],viewQuery:function CoreCourseIndexPage_Query(e,o){if(1&e&&(P.GBs(s.k,5),P.GBs(S,5)),2&e){let e;P.mGM(e=P.lsd())&&(o.tabsComponent=e.first),P.mGM(e=P.lsd())&&(o.courseThumb=e.first)}},standalone:!0,features:[P.aNF],decls:19,vars:13,consts:[["courseThumb",""],[3,"collapsible"],["slot","start"],[3,"text"],["contextLevel","course",3,"text","contextInstanceId"],["slot","end"],[1,"core-course-header"],["collapsible","",1,"core-format-progress-list","ion-text-wrap","list-item-limited-width"],[4,"ngIf"],["class","core-course-progress",4,"ngIf"],[3,"ionChange","tabs","hideUntil"],["fill","clear",3,"click","ariaLabel"],["name","fas-circle-info","slot","icon-only","aria-hidden","true"],["iconAction","fas-graduation-cap",3,"action","priority","content"],["slot","start","class","core-course-thumb",4,"ngIf"],["slot","start",1,"core-course-thumb"],["name","fas-graduation-cap","aria-hidden","true",1,"course-icon"],["core-external-content","","alt","",3,"url"],[1,"core-course-progress"],["a11yText","core.course.aria:sectionprogress",3,"progress"]],template:function CoreCourseIndexPage_Template(e,o){1&e&&(P.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),P.nrm(3,"ion-back-button",3),P.nI1(4,"translate"),P.k0s(),P.j41(5,"ion-title")(6,"h1"),P.nrm(7,"core-format-text",4),P.k0s()(),P.j41(8,"ion-buttons",5),P.DNE(9,CoreCourseIndexPage_Conditional_9_Template,4,3)(10,CoreCourseIndexPage_Conditional_10_Template,3,4),P.k0s()()(),P.j41(11,"div",6)(12,"ion-item",7),P.DNE(13,CoreCourseIndexPage_ng_container_13_Template,3,2,"ng-container",8),P.j41(14,"ion-label")(15,"h1"),P.nrm(16,"core-format-text",4),P.k0s(),P.DNE(17,CoreCourseIndexPage_div_17_Template,2,1,"div",9),P.k0s()()(),P.j41(18,"core-tabs-outlet",10),P.bIt("ionChange",(function CoreCourseIndexPage_Template_core_tabs_outlet_ionChange_18_listener(){return o.tabSelected()})),P.k0s()),2&e&&(P.Y8G("collapsible",(0===(null==o.tabsComponent?null:o.tabsComponent.selectedIndex)||void 0===(null==o.tabsComponent?null:o.tabsComponent.selectedIndex))&&!o.fullScreenEnabled),P.R7$(3),P.Y8G("text",P.bMT(4,11,"core.back")),P.R7$(4),P.Y8G("text",o.title)("contextInstanceId",null==o.course?null:o.course.id),P.R7$(2),P.vxM(9,"singleactivity"!==(null==o.course?null:o.course.format)?9:10),P.R7$(4),P.Y8G("ngIf",o.course),P.R7$(3),P.Y8G("text",o.title)("contextInstanceId",null==o.course?null:o.course.id),P.R7$(),P.Y8G("ngIf",void 0!==o.progress),P.R7$(),P.Y8G("tabs",o.tabs)("hideUntil",o.loaded))},dependencies:[v.n,I.bT,T.mC,T.Jm,T.QW,T.eU,T.iq,T.uz,T.he,T.BC,T.ai,T.el,x.B,O.Q,M.z,s.k,N.l,y.t,R.B,E.M,G.T,k.D9],styles:['[_nghost-%COMP%]   .core-format-progress-list[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .core-course-thumb[_ngcontent-%COMP%]{height:var(--core-courseimage-on-course-size);min-height:var(--core-courseimage-on-course-size);width:var(--core-courseimage-on-course-size);min-width:var(--core-courseimage-on-course-size);--border-radius: var(--core-courseimage-radius);margin-inline-start:0px;margin-inline-end:16px;margin-top:8px;margin-bottom:8px}[_nghost-%COMP%]   .core-course-thumb.course-color-0[_ngcontent-%COMP%]{--course-color: var(--core-course-color-0);--course-color-tint: var(--core-course-color-0-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-1[_ngcontent-%COMP%]{--course-color: var(--core-course-color-1);--course-color-tint: var(--core-course-color-1-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-2[_ngcontent-%COMP%]{--course-color: var(--core-course-color-2);--course-color-tint: var(--core-course-color-2-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-3[_ngcontent-%COMP%]{--course-color: var(--core-course-color-3);--course-color-tint: var(--core-course-color-3-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-4[_ngcontent-%COMP%]{--course-color: var(--core-course-color-4);--course-color-tint: var(--core-course-color-4-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-5[_ngcontent-%COMP%]{--course-color: var(--core-course-color-5);--course-color-tint: var(--core-course-color-5-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-6[_ngcontent-%COMP%]{--course-color: var(--core-course-color-6);--course-color-tint: var(--core-course-color-6-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-7[_ngcontent-%COMP%]{--course-color: var(--core-course-color-7);--course-color-tint: var(--core-course-color-7-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-8[_ngcontent-%COMP%]{--course-color: var(--core-course-color-8);--course-color-tint: var(--core-course-color-8-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-9[_ngcontent-%COMP%]{--course-color: var(--core-course-color-9);--course-color-tint: var(--core-course-color-9-tint)}[_nghost-%COMP%]   .core-course-thumb[_ngcontent-%COMP%]   ion-icon.course-icon[_ngcontent-%COMP%]{padding:12px;font-size:calc(var(--core-courseimage-on-course-size) - 24px);border-radius:var(--border-radius);color:var(--course-color-tint);background:var(--course-color, transparent)}[_nghost-%COMP%]   .core-course-thumb[_ngcontent-%COMP%]   img[src$=".svg"][_ngcontent-%COMP%]{min-width:100%}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--mdl-typography-heading4-fontSize)}[_nghost-%COMP%]   .core-course-header[_ngcontent-%COMP%]{background:var(--ion-item-background)}']}),CoreCourseIndexPage})()}}]);