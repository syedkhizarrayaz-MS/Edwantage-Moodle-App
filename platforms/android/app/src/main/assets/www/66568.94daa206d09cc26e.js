"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[66568],{66568:(e,n,o)=>{o.r(n),o.d(n,{default:()=>C});var t=o(52749),a=o(82461),s=o(79555),r=o(15324),i=o(49882),l=o(60378),g=o(86552),c=o(86654),d=o(54438),h=o(60177),p=o(2910),u=o(86198),_=o(88246),b=o(43570),w=o(73955);function CoreLoginChangePasswordPage_h1_6_Template(e,n){1&e&&(d.j41(0,"h1"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.JRh(d.bMT(2,1,"core.login.changepassword")))}function CoreLoginChangePasswordPage_h1_7_Template(e,n){1&e&&(d.j41(0,"h1"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.JRh(d.bMT(2,1,"core.login.reconnecttosite")))}function CoreLoginChangePasswordPage_ng_container_14_Template(e,n){if(1&e){const e=d.RV6();d.qex(0),d.j41(1,"ion-item",7)(2,"ion-label")(3,"h2"),d.EFF(4),d.nI1(5,"translate"),d.k0s()()(),d.j41(6,"ion-button",9),d.bIt("click",(function CoreLoginChangePasswordPage_ng_container_14_Template_ion_button_click_6_listener(){d.eBV(e);const n=d.XpG();return d.Njj(n.openChangePasswordPage())})),d.EFF(7),d.nI1(8,"translate"),d.k0s(),d.bVm()}2&e&&(d.R7$(4),d.JRh(d.bMT(5,2,"core.login.forcepasswordchangenotice")),d.R7$(3),d.SpI(" ",d.bMT(8,4,"core.login.changepasswordbutton")," "))}function CoreLoginChangePasswordPage_ng_container_15_Template(e,n){if(1&e){const e=d.RV6();d.qex(0),d.j41(1,"ion-item",7)(2,"ion-label")(3,"p"),d.EFF(4),d.nI1(5,"translate"),d.k0s()()(),d.j41(6,"ion-button",9),d.bIt("click",(function CoreLoginChangePasswordPage_ng_container_15_Template_ion_button_click_6_listener(){d.eBV(e);const n=d.XpG();return d.Njj(n.login())})),d.EFF(7),d.nI1(8,"translate"),d.k0s(),d.bVm()}2&e&&(d.R7$(4),d.JRh(d.bMT(5,2,"core.login.changepasswordreconnectinstructions")),d.R7$(3),d.SpI(" ",d.bMT(8,4,"core.login.reconnect")," "))}let C=(()=>{var e;class CoreLoginChangePasswordPage{constructor(){this.changingPassword=!1,this.logoutLabel=a.CoreLoginHelper.getLogoutLabel()}showHelp(){l.I.showHelp(s.HT.instant("core.login.changepasswordhelp"),s.HT.instant("core.login.changepasswordsupportsubject"))}openChangePasswordPage(){a.CoreLoginHelper.openInAppForEdit(t.CoreSites.getCurrentSiteId(),"/login/change_password.php",void 0,!0),this.changingPassword=!0,this.detectPasswordChanged()}login(){r.CoreNavigator.navigateToSiteHome(),this.changingPassword=!1}logout(){t.CoreSites.logout(),this.changingPassword=!1}detectPasswordChanged(){this.urlLoadedObserver||(this.urlLoadedObserver=i.z.on(i.z.IAB_LOAD_STOP,(e=>{var n;if(e.url.match(/\/login\/change_password\.php.*return=1/))return g.j.closeInAppBrowser(),this.login(),void 0;e.url.match(/\/login\/change_password\.php/)&&(null===(n=g.j.getInAppBrowserInstance())||void 0===n||n.executeScript({code:"\n                    if (\n                        document.querySelector('input[type=\"password\"]') === null &&\n                        document.querySelector('button[type=\"submit\"]') !== null\n                    ) {\n                        webkit.messageHandlers.cordova_iab.postMessage(JSON.stringify({ passwordChanged: true }));\n                    }\n                "}))})),this.messageObserver=i.z.on(i.z.IAB_MESSAGE,(e=>{e.passwordChanged&&(g.j.closeInAppBrowser(),this.login())})),this.browserClosedObserver=i.z.on(i.z.IAB_EXIT,(()=>{var e,n,o;null===(e=this.urlLoadedObserver)||void 0===e||e.off(),null===(n=this.messageObserver)||void 0===n||n.off(),null===(o=this.browserClosedObserver)||void 0===o||o.off(),delete this.urlLoadedObserver,delete this.messageObserver,delete this.browserClosedObserver})))}ngOnDestroy(){var e,n,o;null===(e=this.urlLoadedObserver)||void 0===e||e.off(),null===(n=this.messageObserver)||void 0===n||n.off(),null===(o=this.browserClosedObserver)||void 0===o||o.off()}}return(e=CoreLoginChangePasswordPage).ɵfac=function CoreLoginChangePasswordPage_Factory(n){return new(n||e)},e.ɵcmp=d.VBU({type:e,selectors:[["page-core-login-change-password"]],standalone:!0,features:[d.aNF],decls:24,vars:16,consts:[["slot","start"],[3,"text"],[4,"ngIf"],["slot","end"],["fill","clear",3,"click","ariaLabel"],["slot","icon-only","name","far-circle-question","aria-hidden","true"],[1,"list-item-limited-width"],[1,"ion-text-wrap"],["expand","block","fill","outline",1,"ion-text-wrap","ion-margin",3,"click"],["expand","block",1,"ion-text-wrap","ion-margin",3,"click"]],template:function CoreLoginChangePasswordPage_Template(e,n){1&e&&(d.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d.nrm(3,"ion-back-button",1),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title"),d.DNE(6,CoreLoginChangePasswordPage_h1_6_Template,3,3,"h1",2)(7,CoreLoginChangePasswordPage_h1_7_Template,3,3,"h1",2),d.k0s(),d.j41(8,"ion-buttons",3)(9,"ion-button",4),d.nI1(10,"translate"),d.bIt("click",(function CoreLoginChangePasswordPage_Template_ion_button_click_9_listener(){return n.showHelp()})),d.nrm(11,"ion-icon",5),d.k0s()()()(),d.j41(12,"ion-content")(13,"ion-list",6),d.DNE(14,CoreLoginChangePasswordPage_ng_container_14_Template,9,6,"ng-container",2)(15,CoreLoginChangePasswordPage_ng_container_15_Template,9,6,"ng-container",2),d.j41(16,"ion-item",7)(17,"ion-label")(18,"p"),d.EFF(19),d.nI1(20,"translate"),d.k0s()()(),d.j41(21,"ion-button",8),d.bIt("click",(function CoreLoginChangePasswordPage_Template_ion_button_click_21_listener(){return n.logout()})),d.EFF(22),d.nI1(23,"translate"),d.k0s()()()),2&e&&(d.R7$(3),d.Y8G("text",d.bMT(4,8,"core.back")),d.R7$(3),d.Y8G("ngIf",!n.changingPassword),d.R7$(),d.Y8G("ngIf",n.changingPassword),d.R7$(2),d.Y8G("ariaLabel",d.bMT(10,10,"core.help")),d.R7$(5),d.Y8G("ngIf",!n.changingPassword),d.R7$(),d.Y8G("ngIf",n.changingPassword),d.R7$(4),d.JRh(d.bMT(20,12,"core.wanttochangesite")),d.R7$(3),d.SpI(" ",d.bMT(23,14,n.logoutLabel)," "))},dependencies:[c.n,h.bT,p.Jm,p.QW,p.W9,p.eU,p.iq,p.uz,p.he,p.nf,p.BC,p.ai,p.el,u.t,_.i,b.T,w.D9],encapsulation:2}),CoreLoginChangePasswordPage})()}}]);