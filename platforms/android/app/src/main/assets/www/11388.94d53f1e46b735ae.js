"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[11388],{11388:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v});var n=i(10467),o=i(70318),r=i(77083),s=i(55554),a=i(25572),c=i(86654),l=i(54438),d=i(60177),u=i(89417),p=i(2910),g=i(76954),f=i(64422),m=i(88246),_=i(73955),h=i(59528);function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_p_6_Template(e,t){1&e&&(l.j41(0,"p")(1,"strong"),l.EFF(2),l.nI1(3,"translate"),l.k0s()()),2&e&&(l.R7$(2),l.JRh(l.bMT(3,1,"core.currentdevice")))}function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"ion-item",8)(1,"ion-label")(2,"p",9)(3,"strong"),l.EFF(4),l.k0s(),l.EFF(5),l.k0s(),l.DNE(6,AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_p_6_Template,4,3,"p",10),l.j41(7,"p"),l.EFF(8),l.nI1(9,"translate"),l.nI1(10,"coreFormatDate"),l.k0s()(),l.j41(11,"core-button-with-spinner",11)(12,"ion-toggle",12),l.mxI("ngModelChange",(function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_Template_ion_toggle_ngModelChange_12_listener(t){const i=l.eBV(e).$implicit;return l.DH7(i.enable,t)||(i.enable=t),l.Njj(t)})),l.bIt("ngModelChange",(function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_Template_ion_toggle_ngModelChange_12_listener(){const t=l.eBV(e).$implicit,i=l.XpG(2);return l.Njj(i.enableDevice(t,!!t.enable))})),l.k0s()()()}if(2&e){const e=t.$implicit,i=l.XpG().$implicit;l.AVh("item-current",e.current),l.R7$(2),l.Mz_("id","device-",e.id,""),l.R7$(2),l.Lme("",e.name," ",e.model,""),l.R7$(),l.Lme(" (",i.platform," ",e.version,") "),l.R7$(),l.Y8G("ngIf",e.current),l.R7$(2),l.Lme(" ",l.bMT(9,14,"core.lastmodified"),": ",l.i5U(10,16,1e3*e.timemodified,"strftimedatetimeshort")," "),l.R7$(3),l.Y8G("loading",e.updating),l.R7$(),l.R50("ngModel",e.enable),l.BMQ("aria-labelledby","device-"+e.id)}}function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_Template(e,t){if(1&e&&(l.qex(0),l.j41(1,"ion-item-divider",6)(2,"ion-label")(3,"h2"),l.EFF(4),l.k0s()()(),l.j41(5,"ion-card")(6,"ion-list"),l.DNE(7,AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_Template,13,19,"ion-item",7),l.k0s()(),l.bVm()),2&e){const e=t.$implicit;l.R7$(4),l.JRh(e.platform),l.R7$(3),l.Y8G("ngForOf",e.devices)}}let v=(()=>{var e;class AddonMessageOutputAirnotifierDevicesPage{constructor(){this.platformDevices=[],this.loaded=!1}ngOnInit(){this.fetchDevices()}fetchDevices(){var e=this;return(0,n.A)((function*(){try{const t=yield r.n.getUserDevices();e.formatDevices(t)}catch(e){a.CoreAlerts.showError(e)}finally{e.loaded=!0}}))()}formatDevices(e){this.platformDevices=[];const t={},i=o.CorePushNotifications.getPushId();e.forEach((e=>{void 0===t[e.platform]&&(t[e.platform]={platform:e.platform,devices:[]}),e.enable=!!e.enable,e.current=i===e.pushid,t[e.platform].devices.push(e)}));for(const e in t){const i=t[e];i.devices.sort(((e,t)=>t.timemodified-e.timemodified)),i.platform=i.platform.replace("-fcm",""),this.platformDevices.push(i)}}updateDevicesAfterDelay(){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=window.setTimeout((()=>{this.updateTimeout=void 0,this.updateDevices()}),5e3)}updateDevices(){return(0,n.A)((function*(){yield s.g.ignoreErrors(r.n.invalidateUserDevices()),yield r.n.getUserDevices()}))()}refreshDevices(e){var t=this;return(0,n.A)((function*(){try{yield s.g.ignoreErrors(r.n.invalidateUserDevices()),yield t.fetchDevices()}finally{null==e||e.complete()}}))()}enableDevice(e,t){var i=this;return(0,n.A)((function*(){e.updating=!0;try{yield r.n.enableDevice(e.id,t),i.updateDevicesAfterDelay()}catch(t){a.CoreAlerts.showError(t),e.enable=!e.enable}finally{e.updating=!1}}))()}ngOnDestroy(){this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateDevices())}}return(e=AddonMessageOutputAirnotifierDevicesPage).ɵfac=function AddonMessageOutputAirnotifierDevicesPage_Factory(t){return new(t||e)},e.ɵcmp=l.VBU({type:e,selectors:[["page-addon-message-output-airnotifier-devices"]],standalone:!0,features:[l.aNF],decls:15,vars:12,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["class","ion-text-wrap","lines","none",3,"item-current",4,"ngFor","ngForOf"],["lines","none",1,"ion-text-wrap"],[1,"item-heading",3,"id"],[4,"ngIf"],["slot","end",3,"loading"],[3,"ngModelChange","ngModel"]],template:function AddonMessageOutputAirnotifierDevicesPage_Template(e,t){1&e&&(l.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),l.nrm(3,"ion-back-button",1),l.nI1(4,"translate"),l.k0s(),l.j41(5,"ion-title")(6,"h1"),l.EFF(7),l.nI1(8,"translate"),l.k0s()()()(),l.j41(9,"ion-content")(10,"ion-refresher",2),l.bIt("ionRefresh",(function AddonMessageOutputAirnotifierDevicesPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshDevices(e.target)})),l.nrm(11,"ion-refresher-content",3),l.nI1(12,"translate"),l.k0s(),l.j41(13,"core-loading",4),l.DNE(14,AddonMessageOutputAirnotifierDevicesPage_ng_container_14_Template,8,2,"ng-container",5),l.k0s()()),2&e&&(l.R7$(3),l.Y8G("text",l.bMT(4,6,"core.back")),l.R7$(4),l.JRh(l.bMT(8,8,"addon.messageoutput_airnotifier.processorsettingsdesc")),l.R7$(3),l.Y8G("disabled",!t.loaded),l.R7$(),l.FS9("pullingText",l.bMT(12,10,"core.pulltorefresh")),l.R7$(2),l.Y8G("hideUntil",t.loaded),l.R7$(),l.Y8G("ngForOf",t.platformDevices))},dependencies:[c.n,d.Sq,d.bT,u.BC,u.vS,p.QW,p.b_,p.W9,p.eU,p.uz,p.Dg,p.he,p.nf,p.To,p.Ki,p.BC,p.BY,p.ai,p.hB,p.el,g.q,f.R,m.i,_.D9,h.f],encapsulation:2}),AddonMessageOutputAirnotifierDevicesPage})()}}]);