"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[21401],{21401:(e,n,o)=>{o.r(n),o.d(n,{AddonMessagesConversationInfoComponent:()=>M});var t=o(10467),s=o(20728),a=o(79555),r=o(25572),i=o(86654),l=o(54438),c=o(21182),d=o(60177),m=o(2910),f=o(66198),_=o(64422),p=o(16658),u=o(10892),g=o(86198),v=o(58197),h=o(88246),I=o(43570),b=o(73955);const _c0=e=>({$a:e});function AddonMessagesConversationInfoComponent_ion_item_15_core_format_text_7_Template(e,n){if(1&e&&l.nrm(0,"core-format-text",14),2&e){const e=l.XpG(2);l.Y8G("text",e.conversation.subname)("contextInstanceId",0)}}function AddonMessagesConversationInfoComponent_ion_item_15_Template(e,n){if(1&e&&(l.j41(0,"ion-item",9)(1,"ion-label")(2,"div",10),l.nrm(3,"img",11),l.k0s(),l.j41(4,"h2"),l.nrm(5,"core-format-text",12),l.k0s(),l.j41(6,"p"),l.DNE(7,AddonMessagesConversationInfoComponent_ion_item_15_core_format_text_7_Template,1,2,"core-format-text",13),l.k0s(),l.j41(8,"p"),l.EFF(9),l.nI1(10,"translate"),l.k0s()()()),2&e){const e=l.XpG();l.R7$(3),l.Y8G("url",e.conversation.imageurl)("alt",e.conversation.name),l.R7$(2),l.Y8G("text",e.conversation.name)("contextInstanceId",0)("wsNotFiltered",!0),l.R7$(2),l.Y8G("ngIf",e.conversation.subname),l.R7$(2),l.JRh(l.i5U(10,7,"addon.messages.numparticipants",l.eq3(10,_c0,e.conversation.membercount)))}}function AddonMessagesConversationInfoComponent_ion_item_16_ion_icon_5_Template(e,n){1&e&&(l.nrm(0,"ion-icon",19),l.nI1(1,"translate")),2&e&&l.BMQ("aria-label",l.bMT(1,1,"addon.messages.contactblocked"))}function AddonMessagesConversationInfoComponent_ion_item_16_Template(e,n){if(1&e){const e=l.RV6();l.j41(0,"ion-item",15),l.bIt("click",(function AddonMessagesConversationInfoComponent_ion_item_16_Template_ion_item_click_0_listener(){const n=l.eBV(e).$implicit,o=l.XpG();return l.Njj(o.closeModal(n.id))})),l.nrm(1,"core-user-avatar",16),l.j41(2,"ion-label")(3,"p",17),l.EFF(4),l.DNE(5,AddonMessagesConversationInfoComponent_ion_item_16_ion_icon_5_Template,2,3,"ion-icon",18),l.k0s()()()}if(2&e){const e=n.$implicit;l.Y8G("detail",!0),l.R7$(),l.Y8G("user",e)("linkProfile",!1)("checkOnline",e.showonlinestatus),l.R7$(3),l.SpI(" ",e.fullname," "),l.R7$(),l.Y8G("ngIf",e.isblocked)}}let M=(()=>{var e;class AddonMessagesConversationInfoComponent{constructor(e){this.route=e,this.conversationId=0,this.loaded=!1,this.members=[],this.canLoadMore=!1,this.loadMoreError=!1}ngOnInit(){this.fetchData().finally((()=>{this.loaded=!0}))}fetchData(){var e=this;return(0,t.A)((function*(){try{const n=yield s.AddonMessages.getConversation(e.conversationId,!1,!0,0,0);e.conversation=n,yield e.fetchMembers()}catch(e){r.CoreAlerts.showError(e,{default:"Error getting members."})}}))()}fetchMembers(e){var n=this;return(0,t.A)((function*(){n.loadMoreError=!1;const o=e?n.members.length:0,t=yield s.AddonMessages.getConversationMembers(n.conversationId,o);n.members=e?n.members.concat(t.members):t.members,n.canLoadMore=t.canLoadMore}))()}loadMoreMembers(e){var n=this;return(0,t.A)((function*(){try{yield n.fetchMembers(!0)}catch(e){r.CoreAlerts.showError(e,{default:"Error getting members."}),n.loadMoreError=!0}finally{e&&e()}}))()}refreshData(e){var n=this;return(0,t.A)((function*(){const o=[];o.push(s.AddonMessages.invalidateConversation(n.conversationId)),o.push(s.AddonMessages.invalidateConversationMembers(n.conversationId)),yield Promise.all(o),yield n.fetchData().finally((()=>{null==e||e.complete()}))}))()}closeModal(e){a.W3.dismiss(e)}}return(e=AddonMessagesConversationInfoComponent).ɵfac=function AddonMessagesConversationInfoComponent_Factory(n){return new(n||e)(l.rXU(c.nX))},e.ɵcmp=l.VBU({type:e,selectors:[["page-addon-messages-conversation-info"]],inputs:{conversationId:"conversationId"},standalone:!0,features:[l.aNF],decls:18,vars:15,consts:[["slot","end"],["fill","clear",3,"click","ariaLabel"],["name","fas-xmark","slot","icon-only","aria-hidden","true"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],["placeholderType","imageandboxes",3,"hideUntil"],["class","ion-text-center",4,"ngIf"],["class","ion-text-wrap addon-messages-conversation-item","button","",3,"detail","click",4,"ngFor","ngForOf"],[3,"action","enabled","error"],[1,"ion-text-center"],[1,"large-avatar"],["core-external-content","","onError","this.src='assets/img/group-avatar.svg'",1,"avatar",3,"url","alt"],["contextLevel","system",3,"text","contextInstanceId","wsNotFiltered"],["contextLevel","system",3,"text","contextInstanceId",4,"ngIf"],["contextLevel","system",3,"text","contextInstanceId"],["button","",1,"ion-text-wrap","addon-messages-conversation-item",3,"click","detail"],["slot","start",3,"user","linkProfile","checkOnline"],[1,"item-heading"],["name","fas-user-slash",4,"ngIf"],["name","fas-user-slash"]],template:function AddonMessagesConversationInfoComponent_Template(e,n){1&e&&(l.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title")(3,"h1"),l.EFF(4),l.nI1(5,"translate"),l.k0s()(),l.j41(6,"ion-buttons",0)(7,"ion-button",1),l.nI1(8,"translate"),l.bIt("click",(function AddonMessagesConversationInfoComponent_Template_ion_button_click_7_listener(){return n.closeModal()})),l.nrm(9,"ion-icon",2),l.k0s()()()(),l.j41(10,"ion-content")(11,"ion-refresher",3),l.bIt("ionRefresh",(function AddonMessagesConversationInfoComponent_Template_ion_refresher_ionRefresh_11_listener(e){return n.refreshData(e.target)})),l.nrm(12,"ion-refresher-content",4),l.nI1(13,"translate"),l.k0s(),l.j41(14,"core-loading",5),l.DNE(15,AddonMessagesConversationInfoComponent_ion_item_15_Template,11,12,"ion-item",6)(16,AddonMessagesConversationInfoComponent_ion_item_16_Template,6,6,"ion-item",7),l.j41(17,"core-infinite-loading",8),l.bIt("action",(function AddonMessagesConversationInfoComponent_Template_core_infinite_loading_action_17_listener(e){return n.loadMoreMembers(e)})),l.k0s()()()),2&e&&(l.R7$(4),l.JRh(l.bMT(5,9,"addon.messages.groupinfo")),l.R7$(3),l.Y8G("ariaLabel",l.bMT(8,11,"core.close")),l.R7$(4),l.Y8G("disabled",!n.loaded),l.R7$(),l.FS9("pullingText",l.bMT(13,13,"core.pulltorefresh")),l.R7$(2),l.Y8G("hideUntil",n.loaded),l.R7$(),l.Y8G("ngIf",n.conversation),l.R7$(),l.Y8G("ngForOf",n.members),l.R7$(),l.Y8G("enabled",n.canLoadMore)("error",n.loadMoreError))},dependencies:[i.n,d.Sq,d.bT,m.Jm,m.QW,m.W9,m.eU,m.iq,m.uz,m.he,m.To,m.Ki,m.BC,m.ai,f.b,_.R,p.T,u.l,g.t,v.B,h.i,I.T,b.D9],encapsulation:2}),AddonMessagesConversationInfoComponent})()}}]);