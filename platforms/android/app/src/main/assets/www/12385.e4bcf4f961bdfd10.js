"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[12385],{12385:(e,o,n)=>{n.r(o),n.d(o,{default:()=>G});var t=n(10467),r=n(15221),a=n(15324),d=n(55554),s=n(4593),i=n(2538),c=n(24742),l=n(22693),u=n(25572),_=n(79555),p=n(86654),g=n(54438),f=n(60177),b=n(2910),h=n(97818),m=n(66198),k=n(64422),R=n(16658),I=n(88246),F=n(73955);const _c0=e=>({$a:e});function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template(e,o){1&e&&(g.j41(0,"ion-badge",15),g.EFF(1),g.nI1(2,"translate"),g.k0s()),2&e&&(g.R7$(),g.SpI(" ",g.bMT(2,1,"addon.mod_feedback.started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template(e,o){1&e&&(g.j41(0,"ion-badge",16),g.EFF(1),g.nI1(2,"translate"),g.k0s()),2&e&&(g.R7$(),g.SpI(" ",g.bMT(2,1,"addon.mod_feedback.not_started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template(e,o){if(1&e&&(g.j41(0,"ion-item",10),g.nrm(1,"core-user-avatar",11),g.j41(2,"ion-label")(3,"p",12),g.EFF(4),g.k0s(),g.j41(5,"p"),g.DNE(6,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template,3,3,"ion-badge",13)(7,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template,3,3,"ion-badge",14),g.k0s()()()),2&e){const e=o.$implicit;g.R7$(),g.Y8G("user",e),g.R7$(3),g.JRh(e.fullname),g.R7$(2),g.Y8G("ngIf",e.started),g.R7$(),g.Y8G("ngIf",!e.started)}}function AddonModFeedbackNonRespondentsPage_ng_container_21_Template(e,o){if(1&e&&(g.qex(0),g.DNE(1,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template,8,4,"ion-item",9),g.bVm()),2&e){const e=g.XpG();g.R7$(),g.Y8G("ngForOf",e.users)}}let G=(()=>{var e;class AddonModFeedbackNonRespondentsPage{constructor(){this.page=0,this.users=[],this.total=0,this.canLoadMore=!1,this.loaded=!1,this.loadMoreError=!1,this.logView=c.j.once((()=>{this.feedback&&l.OF.logEvent({type:l.qr.VIEW_ITEM_LIST,ws:"mod_feedback_get_non_respondents",name:this.feedback.name,data:{feedbackid:this.feedback.id,category:"feedback"},url:`/mod/feedback/show_nonrespondents.php?id=${this.cmId}&courseid=${this.courseId}`})}))}ngOnInit(){try{this.cmId=a.CoreNavigator.getRequiredRouteNumberParam("cmId"),this.courseId=a.CoreNavigator.getRequiredRouteNumberParam("courseId"),this.selectedGroup=a.CoreNavigator.getRouteNumberParam("group")||0}catch(e){return u.CoreAlerts.showError(e),a.CoreNavigator.back(),void 0}this.fetchData()}fetchData(e=!1){var o=this;return(0,t.A)((function*(){o.page=0,o.total=0,o.users=[];try{o.feedback=yield s.o.getFeedback(o.courseId,o.cmId),o.groupInfo=yield r.CoreGroups.getActivityGroupInfo(o.cmId),o.selectedGroup=r.CoreGroups.validateGroupId(o.selectedGroup,o.groupInfo),yield o.loadGroupUsers(o.selectedGroup),o.logView()}catch(o){u.CoreAlerts.showError(o,{default:_.HT.instant("core.course.errorgetmodule")}),e||a.CoreNavigator.back()}}))()}loadGroupUsers(e){var o=this;return(0,t.A)((function*(){o.loadMoreError=!1,void 0===e?o.page++:(o.selectedGroup=e,o.page=0,o.total=0,o.users=[],o.loaded=!1);try{const e=yield i._.getNonRespondents(o.feedback.id,{groupId:o.selectedGroup,page:o.page,cmId:o.cmId});o.total=e.total,o.users.length<e.total&&(o.users=o.users.concat(e.users)),o.canLoadMore=o.users.length<e.total}catch(e){throw o.loadMoreError=!0,e}finally{o.loaded=!0}}))()}loadAttempts(e,o){var n=this;return(0,t.A)((function*(){try{yield n.loadGroupUsers(e)}catch(e){u.CoreAlerts.showError(e,{default:_.HT.instant("core.course.errorgetmodule")})}finally{o&&o()}}))()}refreshFeedback(e){var o=this;return(0,t.A)((function*(){try{const e=[];e.push(r.CoreGroups.invalidateActivityGroupInfo(o.cmId)),o.feedback&&e.push(s.o.invalidateNonRespondentsData(o.feedback.id)),yield d.g.ignoreErrors(Promise.all(e)),yield o.fetchData(!0)}finally{e.complete()}}))()}}return(e=AddonModFeedbackNonRespondentsPage).ɵfac=function AddonModFeedbackNonRespondentsPage_Factory(o){return new(o||e)},e.ɵcmp=g.VBU({type:e,selectors:[["page-addon-mod-feedback-nonrespondents"]],standalone:!0,features:[g.aNF],decls:23,vars:23,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-no-margin"],[3,"selectedChange","groupInfo","selected","courseId"],[4,"ngIf"],[3,"action","enabled","error"],["class","ion-text-wrap",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["color","success",4,"ngIf"],["color","danger",4,"ngIf"],["color","success"],["color","danger"]],template:function AddonModFeedbackNonRespondentsPage_Template(e,o){1&e&&(g.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),g.nrm(3,"ion-back-button",1),g.nI1(4,"translate"),g.k0s(),g.j41(5,"ion-title")(6,"h1"),g.EFF(7),g.nI1(8,"translate"),g.k0s()()()(),g.j41(9,"ion-content")(10,"ion-refresher",2),g.bIt("ionRefresh",(function AddonModFeedbackNonRespondentsPage_Template_ion_refresher_ionRefresh_10_listener(e){return o.refreshFeedback(e.target)})),g.nrm(11,"ion-refresher-content",3),g.nI1(12,"translate"),g.k0s(),g.j41(13,"core-loading",4)(14,"ion-list",5)(15,"core-group-selector",6),g.mxI("selectedChange",(function AddonModFeedbackNonRespondentsPage_Template_core_group_selector_selectedChange_15_listener(e){return g.DH7(o.selectedGroup,e)||(o.selectedGroup=e),e})),g.bIt("selectedChange",(function AddonModFeedbackNonRespondentsPage_Template_core_group_selector_selectedChange_15_listener(){return o.loadAttempts(o.selectedGroup)})),g.k0s(),g.j41(16,"ion-item-divider")(17,"ion-label")(18,"h2"),g.EFF(19),g.nI1(20,"translate"),g.k0s()()(),g.DNE(21,AddonModFeedbackNonRespondentsPage_ng_container_21_Template,2,1,"ng-container",7),g.j41(22,"core-infinite-loading",8),g.bIt("action",(function AddonModFeedbackNonRespondentsPage_Template_core_infinite_loading_action_22_listener(e){return o.loadAttempts(void 0,e)})),g.k0s()()()()),2&e&&(g.R7$(3),g.Y8G("text",g.bMT(4,12,"core.back")),g.R7$(4),g.JRh(g.bMT(8,14,"addon.mod_feedback.responses")),g.R7$(3),g.Y8G("disabled",!o.loaded),g.R7$(),g.FS9("pullingText",g.bMT(12,16,"core.pulltorefresh")),g.R7$(2),g.Y8G("hideUntil",o.loaded),g.R7$(2),g.Y8G("groupInfo",o.groupInfo),g.R50("selected",o.selectedGroup),g.Y8G("courseId",o.courseId),g.R7$(4),g.JRh(g.i5U(20,18,"addon.mod_feedback.non_respondents_students",g.eq3(21,_c0,o.total))),g.R7$(2),g.Y8G("ngIf",o.total>0),g.R7$(),g.Y8G("enabled",o.canLoadMore)("error",o.loadMoreError))},dependencies:[p.n,f.Sq,f.bT,b.In,b.QW,b.W9,b.eU,b.uz,b.Dg,b.he,b.nf,b.To,b.Ki,b.BC,b.ai,b.el,h.F,m.b,k.R,R.T,I.i,F.D9],encapsulation:2}),AddonModFeedbackNonRespondentsPage})()}}]);