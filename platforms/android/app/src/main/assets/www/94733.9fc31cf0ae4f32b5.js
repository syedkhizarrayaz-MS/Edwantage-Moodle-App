"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[94733],{94733:(e,t,r)=>{r.r(t),r.d(t,{default:()=>A});var s=r(10467),i=r(70548),a=r(52749),o=r(55554),n=r(29492),d=r(15324),l=r(2401),g=r(57648),u=r(83696),c=r(22693),p=r(24742),m=r(79555),h=r(25572),_=r(86654),b=r(54438),f=r(60177),v=r(2910),I=r(16986),R=r(64422),B=r(10892),S=r(88246),w=r(73955),y=r(59528);function AddonBadgesUserBadgesPage_core_empty_box_15_Template(e,t){1&e&&(b.nrm(0,"core-empty-box",7),b.nI1(1,"translate")),2&e&&b.Y8G("message",b.bMT(1,1,"addon.badges.nobadges"))}function AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_ion_badge_9_Template(e,t){1&e&&(b.j41(0,"ion-badge",14),b.EFF(1),b.nI1(2,"translate"),b.k0s()),2&e&&(b.R7$(),b.SpI(" ",b.bMT(2,1,"addon.badges.expired")," "))}function AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_Template(e,t){if(1&e){const e=b.RV6();b.j41(0,"ion-item",10),b.bIt("click",(function AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_Template_ion_item_click_0_listener(){const t=b.eBV(e).$implicit,r=b.XpG(2);return b.Njj(r.badges.select(t))})),b.j41(1,"ion-avatar",0),b.nrm(2,"img",11),b.k0s(),b.j41(3,"ion-label")(4,"p",12),b.EFF(5),b.k0s(),b.j41(6,"p"),b.EFF(7),b.nI1(8,"coreFormatDate"),b.k0s()(),b.DNE(9,AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_ion_badge_9_Template,3,3,"ion-badge",13),b.k0s()}if(2&e){const e=t.$implicit,r=b.XpG(2);b.Y8G("detail",!0),b.BMQ("aria-label",e.name)("aria-current",r.badges.getItemAriaCurrent(e)),b.R7$(2),b.Y8G("url",e.badgeurl)("alt",e.name),b.R7$(3),b.JRh(e.name),b.R7$(2),b.JRh(b.i5U(8,8,1e3*e.dateissued,"strftimedatetimeshort")),b.R7$(2),b.Y8G("ngIf",e.dateexpire&&r.currentTime>=e.dateexpire)}}function AddonBadgesUserBadgesPage_ion_list_16_Template(e,t){if(1&e&&(b.j41(0,"ion-list",8),b.DNE(1,AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_Template,10,11,"ion-item",9),b.k0s()),2&e){const e=b.XpG();b.R7$(),b.Y8G("ngForOf",e.badges.items)}}let A=(()=>{var e;class AddonBadgesUserBadgesPage{constructor(){var e,t;this.currentTime=0;let r=null!==(e=d.CoreNavigator.getRouteNumberParam("courseId"))&&void 0!==e?e:0;const s=null!==(t=d.CoreNavigator.getRouteNumberParam("userId"))&&void 0!==t?t:a.CoreSites.getCurrentSiteUserId();r===a.CoreSites.getCurrentSiteHomeId()&&(r=0),this.badges=new l.R(u.u.getOrCreateSource(g.j,[r,s]),AddonBadgesUserBadgesPage),this.logView=p.j.once((()=>{c.OF.logEvent({type:c.qr.VIEW_ITEM_LIST,ws:"core_badges_view_user_badges",name:m.HT.instant("addon.badges.badges"),data:{courseId:this.badges.getSource().COURSE_ID,category:"badges"},url:"/badges/mybadges.php"})}))}ngAfterViewInit(){var e=this;return(0,s.A)((function*(){yield e.fetchInitialBadges(),e.badges.start(e.splitView)}))()}ngOnDestroy(){this.badges.destroy()}refreshBadges(e){var t=this;return(0,s.A)((function*(){yield o.g.ignoreErrors(i.AddonBadges.invalidateUserBadges(t.badges.getSource().COURSE_ID,t.badges.getSource().USER_ID)),yield o.g.ignoreErrors(t.badges.reload()),null==e||e.complete()}))()}fetchInitialBadges(){var e=this;return(0,s.A)((function*(){e.currentTime=p.j.timestamp();try{yield e.badges.reload(),e.logView()}catch(t){h.CoreAlerts.showError(t,{default:"Error loading badges"}),e.badges.reset()}}))()}}return(e=AddonBadgesUserBadgesPage).ɵfac=function AddonBadgesUserBadgesPage_Factory(t){return new(t||e)},e.ɵcmp=b.VBU({type:e,selectors:[["page-addon-badges-user-badges"]],viewQuery:function AddonBadgesUserBadgesPage_Query(e,t){if(1&e&&b.GBs(n.M,5),2&e){let e;b.mGM(e=b.lsd())&&(t.splitView=e.first)}},standalone:!0,features:[b.aNF],decls:17,vars:13,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],["placeholderType","listwithavatar",3,"hideUntil"],["icon","fas-trophy",3,"message",4,"ngIf"],["class","ion-no-margin",4,"ngIf"],["icon","fas-trophy",3,"message"],[1,"ion-no-margin"],["button","","class","ion-text-wrap",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"click","detail"],["core-external-content","",3,"url","alt"],[1,"item-heading"],["slot","end","color","danger",4,"ngIf"],["slot","end","color","danger"]],template:function AddonBadgesUserBadgesPage_Template(e,t){1&e&&(b.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),b.nrm(3,"ion-back-button",1),b.nI1(4,"translate"),b.k0s(),b.j41(5,"ion-title")(6,"h1"),b.EFF(7),b.nI1(8,"translate"),b.k0s()()()(),b.j41(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),b.bIt("ionRefresh",(function AddonBadgesUserBadgesPage_Template_ion_refresher_ionRefresh_11_listener(e){return t.refreshBadges(e.target)})),b.nrm(12,"ion-refresher-content",3),b.nI1(13,"translate"),b.k0s(),b.j41(14,"core-loading",4),b.DNE(15,AddonBadgesUserBadgesPage_core_empty_box_15_Template,2,3,"core-empty-box",5)(16,AddonBadgesUserBadgesPage_ion_list_16_Template,2,1,"ion-list",6),b.k0s()()()),2&e&&(b.R7$(3),b.Y8G("text",b.bMT(4,7,"core.back")),b.R7$(4),b.JRh(b.bMT(8,9,"addon.badges.badges")),b.R7$(4),b.Y8G("disabled",!t.badges.loaded),b.R7$(),b.FS9("pullingText",b.bMT(13,11,"core.pulltorefresh")),b.R7$(2),b.Y8G("hideUntil",t.badges.loaded),b.R7$(),b.Y8G("ngIf",t.badges.empty),b.R7$(),b.Y8G("ngIf",!t.badges.empty))},dependencies:[_.n,f.Sq,f.bT,v.mC,v.In,v.QW,v.W9,v.eU,v.uz,v.he,v.nf,v.To,v.Ki,v.BC,v.ai,v.el,I.h,R.R,n.M,B.l,S.i,w.D9,y.f],encapsulation:2}),AddonBadgesUserBadgesPage})()},2401:(e,t,r)=>{r.d(t,{R:()=>CoreListItemsManager});var s=r(10467),i=r(21182),a=r(15324),o=r(93417),n=r(81690),d=r(95990),l=r(82907),g=r(24742),u=r(55554);class CoreListItemsManager extends d.u{constructor(e,t){super(e);const r=n.j.debounce((()=>this.scrollToCurrentElement()),300);this.pageRouteLocator=t,this.addListener({onSelectedItemUpdated:r}),this.finishSuccessfulFetch=g.j.once((()=>u.g.ignoreErrors(this.logActivity())))}get items(){return this.getSource().getItems()||[]}get loaded(){return null!==this.itemsMap}get completed(){return this.getSource().isCompleted()}get empty(){const e=this.getSource().getItems();return null===e||0===e.length}start(e){var t=this;return(0,s.A)((function*(){e&&t.watchSplitViewOutlet(e),t.updateSelectedItem()}))()}destroy(){var e;super.destroy(),null===(e=this.splitViewOutletSubscription)||void 0===e||e.unsubscribe()}watchSplitViewOutlet(e){var t;this.splitView=e,this.splitViewOutletSubscription=e.outletRouteObservable.subscribe((e=>this.updateSelectedItem(this.getPageRouteFromSplitViewOutlet(e)))),this.updateSelectedItem(null!==(t=this.getPageRouteFromSplitViewOutlet(e.outletRoute))&&void 0!==t?t:null)}isSelected(e){return this.selectedItem===e}getItemAriaCurrent(e){return this.isSelected(e)?"page":"false"}select(e){var t=this;return(0,s.A)((function*(){if(!e)return yield t.navigateToIndex({reset:t.resetNavigation()}),void 0;yield t.navigateToItem(e,{reset:t.resetNavigation()})}))()}reset(){this.getSource().reset()}reload(){var e=this;return(0,s.A)((function*(){yield e.getSource().reload(),e.finishSuccessfulFetch()}))()}load(){var e=this;return(0,s.A)((function*(){yield e.getSource().load(),e.finishSuccessfulFetch()}))()}logActivity(){return(0,s.A)((function*(){}))()}resetNavigation(){var e;return!!o.CoreScreen.isTablet&&!(!this.splitView||null!==(e=this.splitView)&&void 0!==e&&e.isNested)}updateSelectedItem(e=null){super.updateSelectedItem(e);this.select(o.CoreScreen.isTablet&&null===this.selectedItem&&this.splitView&&!this.splitView.isNested?this.getDefaultItem():this.selectedItem)}scrollToCurrentElement(){var e=this;return(0,s.A)((function*(){var t,r,s;if(o.CoreScreen.isMobile)return;const i=(null!==(t=null===(r=e.splitView)||void 0===r?void 0:r.nativeElement)&&void 0!==t?t:document).querySelector('[aria-current="page"]');if(!i)return;l.y.isElementInViewport(i,1,null===(s=e.splitView)||void 0===s?void 0:s.nativeElement)||i.scrollIntoView({behavior:"smooth"})}))()}getDefaultItem(){return this.items[0]||null}getCurrentPageRoute(){return this.pageRouteLocator instanceof i.nX?a.CoreNavigator.isRouteActive(this.pageRouteLocator)?this.pageRouteLocator:null:a.CoreNavigator.getCurrentRoute({pageComponent:this.pageRouteLocator})}getSelectedItemPathFromRoute(e){const t=[];for(;e.firstChild;)t.push(...a.CoreNavigator.getRouteUrl(e=e.firstChild));return t.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}getPageRouteFromSplitViewOutlet(e){const t=this.buildRouteMatcher();for(;e&&!t(e);)e=e.parent;return e}buildRouteMatcher(){if(this.pageRouteLocator instanceof i.nX){const e=a.CoreNavigator.getRouteFullPath(this.pageRouteLocator);return t=>a.CoreNavigator.getRouteFullPath(t)===e}return e=>e.component===this.pageRouteLocator}}}}]);