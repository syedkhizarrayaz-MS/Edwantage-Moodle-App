"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[96455],{96455:(e,r,o)=>{o.r(r),o.d(r,{default:()=>x});var a=o(10467),t=o(16179),n=o(25124),s=o(10883),c=o(44682),l=o(45155),d=o(89014),i=o(22693),u=o(15324),_=o(52749),h=o(8014),m=o(81690),g=o(79555),p=o(55554),f=o(25572),S=o(33014),b=o(75357),F=o(86654),M=o(4193),A=o(54438),y=o(60177),I=o(2910),R=o(16986),T=o(66198),C=o(86198),k=o(58197),P=o(88246),v=o(73955);const _c0=e=>({$a:e});function AddonModForumSearchPage_h1_6_Template(e,r){if(1&e&&(A.j41(0,"h1"),A.EFF(1),A.k0s()),2&e){const e=A.XpG();A.R7$(),A.JRh(e.forum.name)}}function AddonModForumSearchPage_h1_7_Template(e,r){1&e&&(A.j41(0,"h1"),A.EFF(1),A.nI1(2,"translate"),A.k0s()),2&e&&(A.R7$(),A.JRh(A.bMT(2,1,"addon.block_searchforums.pluginname")))}function AddonModForumSearchPage_ion_card_10_Template(e,r){if(1&e&&(A.j41(0,"ion-card",8)(1,"ion-item",9),A.nrm(2,"ion-icon",10),A.j41(3,"ion-label"),A.nrm(4,"core-format-text",1),A.k0s()()()),2&e){const e=A.XpG();A.R7$(4),A.Y8G("text",e.searchBanner)}}function AddonModForumSearchPage_ion_list_14_core_search_global_search_result_1_Template(e,r){if(1&e){const e=A.RV6();A.j41(0,"core-search-global-search-result",12),A.bIt("onClick",(function AddonModForumSearchPage_ion_list_14_core_search_global_search_result_1_Template_core_search_global_search_result_onClick_0_listener(){const r=A.eBV(e).$implicit,o=A.XpG(2);return A.Njj(o.visitResult(r))})),A.k0s()}if(2&e){A.Y8G("result",r.$implicit)("showCourse",!1)}}function AddonModForumSearchPage_ion_list_14_Template(e,r){if(1&e&&(A.j41(0,"ion-list"),A.DNE(1,AddonModForumSearchPage_ion_list_14_core_search_global_search_result_1_Template,1,2,"core-search-global-search-result",11),A.k0s()),2&e){const e=A.XpG();A.R7$(),A.Y8G("ngForOf",e.resultsSource.getItems())}}function AddonModForumSearchPage_core_empty_box_16_p_1_Template(e,r){1&e&&(A.j41(0,"p"),A.EFF(1),A.nI1(2,"translate"),A.k0s()),2&e&&(A.R7$(),A.JRh(A.bMT(2,1,"core.search.empty")))}function AddonModForumSearchPage_core_empty_box_16_ng_container_2_Template(e,r){if(1&e&&(A.qex(0),A.j41(1,"p")(2,"strong"),A.EFF(3),A.nI1(4,"translate"),A.k0s()(),A.j41(5,"p")(6,"small"),A.EFF(7),A.nI1(8,"translate"),A.k0s()(),A.bVm()),2&e){const e=A.XpG(2);A.R7$(3),A.JRh(A.i5U(4,2,"core.search.noresults",A.eq3(7,_c0,e.resultsSource.getQuery()))),A.R7$(4),A.JRh(A.bMT(8,5,"core.search.noresultshelp"))}}function AddonModForumSearchPage_core_empty_box_16_Template(e,r){if(1&e&&(A.j41(0,"core-empty-box",13),A.DNE(1,AddonModForumSearchPage_core_empty_box_16_p_1_Template,3,3,"p",2)(2,AddonModForumSearchPage_core_empty_box_16_ng_container_2_Template,9,9,"ng-container",2),A.k0s()),2&e){const e=A.XpG();A.Y8G("dimmed",!e.resultsSource.isLoaded()),A.R7$(),A.Y8G("ngIf",!e.resultsSource.isLoaded()),A.R7$(),A.Y8G("ngIf",e.resultsSource.isLoaded())}}let x=(()=>{var e;class AddonModForumSearchPage{constructor(){this.loadMoreError=!1,this.searchBanner=null,this.resultsSource=new l.u("",{}),this.ready=new n._}ngOnInit(){var e=this;return(0,a.A)((function*(){try{var r,o,a;const n=_.CoreSites.getRequiredCurrentSite(),s=null!==(r=null===(o=n.config)||void 0===o||null===(o=o.searchbanner)||void 0===o?void 0:o.trim())&&void 0!==r?r:"",l=u.CoreNavigator.getRequiredRouteNumberParam("courseId"),d=u.CoreNavigator.getRouteNumberParam("forumId"),i={courseIds:[l]};if(m.j.isTrueOrOne(null===(a=n.config)||void 0===a?void 0:a.searchbannerenable)&&s.length>0&&(e.searchBanner=s),d){e.forum=yield t.AddonModForum.getForumById(l,d);const r=yield c.CoreCourse.getModule(e.forum.cmid,l);i.searchAreaIds=["mod_forum-post"],r.contextid&&(i.contextIds=[r.contextid]),e.searchAreaId=`AddonModForumSearch-${l}-${e.forum.id}`}else i.searchAreaIds=["mod_forum-activity","mod_forum-post"],e.searchAreaId=`AddonModForumSearch-${l}`;e.resultsSource.setFilters(i),e.ready.resolve()}catch(e){return f.CoreAlerts.showError(e),u.CoreNavigator.back(),void 0}}))()}search(e){var r=this;return(0,a.A)((function*(){yield r.ready,r.resultsSource.setQuery(e),r.resultsSource.hasEmptyQuery()||(yield S.CoreLoadings.showOperationModals("core.searching",!0,(0,a.A)((function*(){yield r.resultsSource.reload(),yield p.g.ignoreErrors(d.CoreSearchGlobalSearch.logViewResults(r.resultsSource.getQuery(),r.resultsSource.getFilters())),i.OF.logEvent({type:i.qr.VIEW_ITEM_LIST,ws:"core_search_view_results",name:g.HT.instant("core.search.globalsearch"),data:{query:e,filters:JSON.stringify(r.resultsSource.getFilters())},url:h.F.addParamsToUrl("/search/index.php",{q:e})})}))))}))()}clearSearch(){this.loadMoreError=!1,this.resultsSource.setQuery(""),this.resultsSource.reset()}visitResult(e){return(0,a.A)((function*(){yield s.CoreContentLinksHelper.handleLink(e.url)}))()}loadMoreResults(e){var r=this;return(0,a.A)((function*(){try{var o;yield null===(o=r.resultsSource)||void 0===o?void 0:o.load()}catch(e){r.loadMoreError=!0}finally{e()}}))()}}return(e=AddonModForumSearchPage).ɵfac=function AddonModForumSearchPage_Factory(r){return new(r||e)},e.ɵcmp=A.VBU({type:e,selectors:[["page-addon-mod-forum-search"]],standalone:!0,features:[A.aNF],decls:17,vars:18,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[1,"limited-width"],["class","core-danger-card",4,"ngIf"],[3,"onSubmit","onClear","placeholder","searchLabel","autoFocus","searchArea"],[3,"action","enabled","error"],["icon","fas-magnifying-glass","role","alert",3,"dimmed",4,"ngIf"],[1,"core-danger-card"],[1,"ion-text-wrap"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[3,"result","showCourse","onClick",4,"ngFor","ngForOf"],[3,"onClick","result","showCourse"],["icon","fas-magnifying-glass","role","alert",3,"dimmed"]],template:function AddonModForumSearchPage_Template(e,r){1&e&&(A.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),A.nrm(3,"ion-back-button",1),A.nI1(4,"translate"),A.k0s(),A.j41(5,"ion-title"),A.DNE(6,AddonModForumSearchPage_h1_6_Template,2,1,"h1",2)(7,AddonModForumSearchPage_h1_7_Template,3,3,"h1",2),A.k0s()()(),A.j41(8,"ion-content",3)(9,"div"),A.DNE(10,AddonModForumSearchPage_ion_card_10_Template,5,1,"ion-card",4),A.j41(11,"core-search-box",5),A.nI1(12,"translate"),A.nI1(13,"translate"),A.bIt("onSubmit",(function AddonModForumSearchPage_Template_core_search_box_onSubmit_11_listener(e){return r.search(e)}))("onClear",(function AddonModForumSearchPage_Template_core_search_box_onClear_11_listener(){return r.clearSearch()})),A.k0s(),A.DNE(14,AddonModForumSearchPage_ion_list_14_Template,2,1,"ion-list",2),A.j41(15,"core-infinite-loading",6),A.bIt("action",(function AddonModForumSearchPage_Template_core_infinite_loading_action_15_listener(e){return r.loadMoreResults(e)})),A.k0s(),A.DNE(16,AddonModForumSearchPage_core_empty_box_16_Template,3,3,"core-empty-box",7),A.k0s()()),2&e&&(A.R7$(3),A.Y8G("text",A.bMT(4,12,"core.back")),A.R7$(3),A.Y8G("ngIf",r.forum),A.R7$(),A.Y8G("ngIf",!r.forum),A.R7$(3),A.Y8G("ngIf",r.searchBanner),A.R7$(),A.Y8G("placeholder",A.bMT(12,14,"core.search"))("searchLabel",A.bMT(13,16,"core.search"))("autoFocus",!0)("searchArea",r.searchAreaId),A.R7$(3),A.Y8G("ngIf",r.resultsSource.isLoaded()),A.R7$(),A.Y8G("enabled",r.resultsSource.isLoaded()&&!r.resultsSource.isCompleted())("error",r.loadMoreError),A.R7$(),A.Y8G("ngIf",r.resultsSource.isEmpty()))},dependencies:[F.n,y.Sq,y.bT,I.QW,I.b_,I.W9,I.eU,I.iq,I.uz,I.he,I.nf,I.BC,I.ai,I.el,R.h,T.b,C.t,k.B,P.i,v.D9,b.CoreSearchBoxComponent,M.CoreSearchGlobalSearchResultComponent],encapsulation:2}),AddonModForumSearchPage})()}}]);