"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[14647],{14647:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var o=n(10467),a=n(83696),i=n(52266),d=n(15324),_=n(88436),r=n(4856),c=n(4593),m=n(2538),s=n(24742),p=n(22693),l=n(19634),g=n(25572),u=n(79555),f=n(86654),b=n(54438),k=n(60177),A=n(2910),I=n(64422),h=n(17778),F=n(16658),M=n(4060),P=n(58197),R=n(37557),T=n(28988),G=n(88246),$=n(73955),Y=n(59528);function AddonModFeedbackAttemptPage_h1_6_Template(e,t){if(1&e&&(b.j41(0,"h1"),b.EFF(1),b.k0s()),2&e){const e=b.XpG();b.R7$(),b.JRh(e.attempt.fullname)}}function AddonModFeedbackAttemptPage_h1_7_Template(e,t){1&e&&(b.j41(0,"h1"),b.EFF(1),b.nI1(2,"translate"),b.k0s()),2&e&&(b.R7$(),b.JRh(b.bMT(2,1,"addon.mod_feedback.anonymous_user")))}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template(e,t){if(1&e&&(b.j41(0,"p"),b.EFF(1),b.nI1(2,"coreFormatDate"),b.k0s()),2&e){const e=b.XpG(3);b.R7$(),b.JRh(b.bMT(2,1,1e3*e.attempt.timemodified))}}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template(e,t){if(1&e&&(b.j41(0,"ion-item",9),b.nI1(1,"translate"),b.nrm(2,"core-user-avatar",10),b.j41(3,"ion-label")(4,"h2"),b.EFF(5),b.k0s(),b.DNE(6,AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template,3,3,"p",2),b.k0s()()),2&e){const e=b.XpG(2);b.Y8G("userId",e.attempt.userid)("courseId",e.attempt.courseid),b.BMQ("aria-label",b.bMT(1,7,"core.user.viewprofile")),b.R7$(2),b.Y8G("user",e.attempt)("linkProfile",!1),b.R7$(3),b.JRh(e.attempt.fullname),b.R7$(),b.Y8G("ngIf",e.attempt.timemodified)}}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template(e,t){if(1&e&&(b.j41(0,"ion-item",11),b.nrm(1,"core-user-avatar",12),b.j41(2,"ion-label")(3,"h2"),b.EFF(4),b.nI1(5,"translate"),b.k0s(),b.j41(6,"p"),b.EFF(7),b.nI1(8,"translate"),b.k0s()()()),2&e){const e=b.XpG(2);b.R7$(),b.Y8G("linkProfile",!1),b.R7$(3),b.JRh(b.bMT(5,4,"addon.mod_feedback.anonymous_user")),b.R7$(3),b.Lme("",b.bMT(8,6,"addon.mod_feedback.response_nr"),": ",e.anonAttempt.number,"")}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template(e,t){1&e&&b.nrm(0,"core-spacer")}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template(e,t){if(1&e&&(b.j41(0,"span"),b.EFF(1),b.k0s()),2&e){const e=b.XpG(3).$implicit;b.R7$(),b.SpI("",e.itemnumber,". ")}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template(e,t){if(1&e&&(b.j41(0,"p",17),b.DNE(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template,2,1,"span",2),b.nrm(2,"core-format-text",18),b.k0s()),2&e){const e=b.XpG(2).$implicit,t=b.XpG(3);b.Y8G("core-mark-required",e.required),b.R7$(),b.Y8G("ngIf",t.feedback.autonumbering&&e.itemnumber),b.R7$(),b.Y8G("component",t.component)("componentId",t.cmId)("text",e.name)("contextInstanceId",t.cmId)("courseId",t.courseId)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template(e,t){if(1&e&&(b.j41(0,"p"),b.nrm(1,"core-format-text",18),b.k0s()),2&e){const e=b.XpG(2).$implicit,t=b.XpG(3);b.R7$(),b.Y8G("component",t.component)("componentId",t.cmId)("text",e.submittedValue)("contextInstanceId",t.cmId)("courseId",t.courseId)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template(e,t){if(1&e&&(b.j41(0,"ion-item",15)(1,"ion-label"),b.DNE(2,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template,3,7,"p",16)(3,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template,2,5,"p",2),b.k0s()()),2&e){const e=b.XpG().$implicit;b.Y8G("color",e.dependitem>0?"light":""),b.R7$(2),b.Y8G("ngIf",e.name),b.R7$(),b.Y8G("ngIf",e.submittedValue)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template(e,t){if(1&e&&(b.qex(0),b.DNE(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template,1,0,"core-spacer",2)(2,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template,4,3,"ion-item",14),b.bVm()),2&e){const e=t.$implicit;b.R7$(),b.Y8G("ngIf","pagebreak"===e.typ),b.R7$(),b.Y8G("ngIf","pagebreak"!==e.typ)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template(e,t){if(1&e&&(b.qex(0),b.DNE(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template,3,2,"ng-container",13),b.bVm()),2&e){const e=b.XpG(2);b.R7$(),b.Y8G("ngForOf",e.items)}}function AddonModFeedbackAttemptPage_ion_list_10_Template(e,t){if(1&e&&(b.j41(0,"ion-list",6),b.DNE(1,AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template,7,9,"ion-item",7)(2,AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template,9,8,"ion-item",8)(3,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template,2,1,"ng-container",2),b.k0s()),2&e){const e=b.XpG();b.R7$(),b.Y8G("ngIf",e.attempt),b.R7$(),b.Y8G("ngIf",e.anonAttempt),b.R7$(),b.Y8G("ngIf",e.items&&e.items.length)}}let w=(()=>{var e;class AddonModFeedbackAttemptPage{constructor(){this.items=[],this.component=l.yH,this.loaded=!1,this.cmId=d.CoreNavigator.getRequiredRouteNumberParam("cmId"),this.courseId=d.CoreNavigator.getRequiredRouteNumberParam("courseId"),this.attemptId=d.CoreNavigator.getRequiredRouteNumberParam("attemptId"),this.groupId=d.CoreNavigator.getRouteNumberParam("groupId");const e=a.u.getOrCreateSource(r.D,[this.courseId,this.cmId]);this.attempts=new AddonModFeedbackAttemptsSwipeManager(e),this.logView=s.j.once((()=>{this.feedback&&p.OF.logEvent({type:p.qr.VIEW_ITEM,ws:"mod_feedback_get_responses_analysis",name:this.feedback.name,data:{id:this.attemptId,feedbackid:this.feedback.id,category:"feedback"},url:`/mod/feedback/show_entries.php?id=${this.cmId}`+(this.attempt?`userid=${this.attempt.userid}`:"")+`&showcompleted=${this.attemptId}`})}))}ngOnInit(){var e=this;return(0,o.A)((function*(){try{yield e.attempts.start()}catch(e){return g.CoreAlerts.showError(e),d.CoreNavigator.back(),void 0}e.fetchData()}))()}ngOnDestroy(){this.attempts.destroy()}fetchData(){var e=this;return(0,o.A)((function*(){try{e.feedback=yield c.o.getFeedback(e.courseId,e.cmId);const t=yield c.o.getAttempt(e.feedback.id,e.attemptId,{cmId:e.cmId,groupId:e.groupId});e.isAnonAttempt(t)?(e.anonAttempt=t,delete e.attempt):(e.attempt=(yield m._.addImageProfile([t]))[0],delete e.anonAttempt);const n=yield c.o.getItems(e.feedback.id,{cmId:e.cmId});e.items=n.items.map((e=>{const n=m._.getItemForm(e,!0);if(!n)return;const o=n;if(e.typ===l.AB.LABEL)o.submittedValue=_.CoreFileHelper.replacePluginfileUrls(e.presentation,e.itemfiles);else for(const n in t.responses)if(t.responses[n].id==e.id){o.submittedValue=t.responses[n].printval;break}return o})).filter((e=>e)),e.logView()}catch(e){g.CoreAlerts.showError(e,{default:u.HT.instant("core.course.errorgetmodule")}),d.CoreNavigator.back()}finally{e.loaded=!0}}))()}isAnonAttempt(e){return!("fullname"in e)}}return(e=AddonModFeedbackAttemptPage).ɵfac=function AddonModFeedbackAttemptPage_Factory(t){return new(t||e)},e.ɵcmp=b.VBU({type:e,selectors:[["page-addon-mod-feedback-attempt"]],standalone:!0,features:[b.aNF],decls:11,vars:8,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[3,"core-swipe-navigation"],[3,"hideUntil"],["class","ion-no-margin",4,"ngIf"],[1,"ion-no-margin"],["class","ion-text-wrap","core-user-link","",3,"userId","courseId",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],["core-user-link","",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","linkProfile"],[1,"ion-text-wrap"],["slot","start",3,"linkProfile"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",3,"color",4,"ngIf"],[1,"ion-text-wrap",3,"color"],["class","item-heading",3,"core-mark-required",4,"ngIf"],[1,"item-heading",3,"core-mark-required"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","courseId"]],template:function AddonModFeedbackAttemptPage_Template(e,t){1&e&&(b.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),b.nrm(3,"ion-back-button",1),b.nI1(4,"translate"),b.k0s(),b.j41(5,"ion-title"),b.DNE(6,AddonModFeedbackAttemptPage_h1_6_Template,2,1,"h1",2)(7,AddonModFeedbackAttemptPage_h1_7_Template,3,3,"h1",2),b.k0s()()(),b.j41(8,"ion-content",3)(9,"core-loading",4),b.DNE(10,AddonModFeedbackAttemptPage_ion_list_10_Template,4,3,"ion-list",5),b.k0s()()),2&e&&(b.R7$(3),b.Y8G("text",b.bMT(4,6,"core.back")),b.R7$(3),b.Y8G("ngIf",t.attempt),b.R7$(),b.Y8G("ngIf",t.anonAttempt),b.R7$(),b.Y8G("core-swipe-navigation",t.attempts),b.R7$(),b.Y8G("hideUntil",t.loaded),b.R7$(),b.Y8G("ngIf",t.attempt||t.anonAttempt))},dependencies:[f.n,k.Sq,k.bT,A.QW,A.W9,A.eU,A.uz,A.he,A.nf,A.BC,A.ai,A.el,I.R,h.j,F.T,M.f,P.B,R.O,T.n,G.i,$.D9,Y.f],encapsulation:2}),AddonModFeedbackAttemptPage})();class AddonModFeedbackAttemptsSwipeManager extends i.Z{getSelectedItemPathFromRoute(e){return d.CoreNavigator.getRouteParams(e).attemptId}}}}]);