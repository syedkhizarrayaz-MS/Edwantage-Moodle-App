"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[29813],{29813:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var n=a(10467),o=a(41094),r=a(88452),i=a(93417),s=a(15324),d=a(24742),l=a(22693),g=a(79555),c=a(8014),m=a(25572),p=a(86654),_=a(54438),I=a(60177),u=a(2910),h=a(16986),f=a(64422),x=a(29492),T=a(86198),C=a(88246),b=a(73955);const _c0=e=>({count:e}),_c1=e=>({$a:e});function CoreTagIndexPage_ion_list_15_ion_item_1_Template(e,t){1&e&&(_.j41(0,"ion-item",9),_.nrm(1,"ion-icon",10),_.j41(2,"ion-label",11),_.EFF(3),_.nI1(4,"translate"),_.k0s()()),2&e&&(_.R7$(3),_.JRh(_.bMT(4,1,"core.tag.warningareasnotsupported")))}function CoreTagIndexPage_ion_list_15_ion_item_2_ion_badge_6_Template(e,t){if(1&e&&(_.j41(0,"ion-badge",15)(1,"span",16),_.EFF(2),_.k0s(),_.j41(3,"span",17),_.EFF(4),_.nI1(5,"translate"),_.k0s()()),2&e){const e=_.XpG().$implicit;_.R7$(2),_.JRh(e.badge),_.R7$(2),_.JRh(_.i5U(5,2,"core.tag.tagareabadgedescription",_.eq3(5,_c0,e.badge)))}}function CoreTagIndexPage_ion_list_15_ion_item_2_Template(e,t){if(1&e){const e=_.RV6();_.j41(0,"ion-item",12),_.nI1(1,"translate"),_.bIt("click",(function CoreTagIndexPage_ion_list_15_ion_item_2_Template_ion_item_click_0_listener(){const t=_.eBV(e).$implicit,a=_.XpG(2);return _.Njj(a.openArea(t))})),_.j41(2,"ion-label")(3,"p",13),_.EFF(4),_.nI1(5,"translate"),_.k0s()(),_.DNE(6,CoreTagIndexPage_ion_list_15_ion_item_2_ion_badge_6_Template,6,7,"ion-badge",14),_.k0s()}if(2&e){const e=t.$implicit,a=_.XpG(2);_.Y8G("detail",!0),_.BMQ("aria-label",_.bMT(1,5,e.nameKey))("aria-current",e.id===a.selectedAreaId?"page":"false"),_.R7$(4),_.JRh(_.bMT(5,7,e.nameKey)),_.R7$(2),_.Y8G("ngIf",e.badge)}}function CoreTagIndexPage_ion_list_15_Template(e,t){if(1&e&&(_.j41(0,"ion-list"),_.DNE(1,CoreTagIndexPage_ion_list_15_ion_item_1_Template,5,3,"ion-item",7)(2,CoreTagIndexPage_ion_list_15_ion_item_2_Template,7,9,"ion-item",8),_.k0s()),2&e){const e=_.XpG();_.R7$(),_.Y8G("ngIf",e.hasUnsupportedAreas),_.R7$(),_.Y8G("ngForOf",e.areas)}}function CoreTagIndexPage_core_empty_box_16_Template(e,t){if(1&e&&(_.nrm(0,"core-empty-box",18),_.nI1(1,"translate")),2&e){const e=_.XpG();_.Y8G("message",_.i5U(1,1,"core.tag.noresultsfor",_.eq3(4,_c1,e.tagName)))}}let v=(()=>{var e;class CoreTagIndexPage{constructor(){var e=this;this.tagId=0,this.tagName="",this.collectionId=0,this.areaId=0,this.fromContextId=0,this.contextId=0,this.recursive=!0,this.loaded=!1,this.hasUnsupportedAreas=!1,this.areas=[],this.logView=d.j.once((0,n.A)((function*(){const t={tc:e.collectionId||void 0,tag:e.tagName||void 0,ta:e.areaId||void 0,from:e.fromContextId||void 0,ctx:e.contextId||void 0};l.OF.logEvent({type:l.qr.VIEW_ITEM_LIST,ws:"core_tag_get_tagindex_per_area",name:e.tagName||g.HT.instant("core.tag.tag"),data:{id:e.tagId||void 0,...t,category:"tag"},url:c.F.addParamsToUrl("/tag/index.php",t)})})))}ngOnInit(){var e=this;return(0,n.A)((function*(){var t;e.tagId=s.CoreNavigator.getRouteNumberParam("tagId")||e.tagId,e.tagName=s.CoreNavigator.getRouteParam("tagName")||e.tagName,e.collectionId=s.CoreNavigator.getRouteNumberParam("collectionId")||e.collectionId,e.areaId=s.CoreNavigator.getRouteNumberParam("areaId")||e.areaId,e.fromContextId=s.CoreNavigator.getRouteNumberParam("fromContextId")||e.fromContextId,e.contextId=s.CoreNavigator.getRouteNumberParam("contextId")||e.contextId,e.recursive=null===(t=s.CoreNavigator.getRouteBooleanParam("recursive"))||void 0===t||t;try{if(yield e.fetchData(),i.CoreScreen.isTablet&&e.areas&&e.areas.length>0){const t=e.areas.find((t=>t.id==e.areaId));e.openArea(t||e.areas[0])}}finally{e.loaded=!0}}))()}fetchData(){var e=this;return(0,n.A)((function*(){try{const t=yield o.CoreTag.getTagIndexPerArea(e.tagId,e.tagName,e.collectionId,e.areaId,e.fromContextId,e.contextId,e.recursive,0);e.areas=[],e.hasUnsupportedAreas=!1;const a=[];yield Promise.all(t.map(function(){var t=(0,n.A)((function*(t){const n=yield r.CoreTagAreaDelegate.parseContent(t.component,t.itemtype,t.content);if(!n||!n.length)return e.hasUnsupportedAreas=!0,void 0;a.push({id:t.ta,componentName:t.component,itemType:t.itemtype,nameKey:r.CoreTagAreaDelegate.getDisplayNameKey(t.component,t.itemtype),items:n,canLoadMore:!!t.nextpageurl,badge:n&&n.length?n.length+(t.nextpageurl?"+":""):""})}));return function(e){return t.apply(this,arguments)}}())),e.areas=a,e.logView()}catch(e){m.CoreAlerts.showError(e,{default:"Error loading tag index"})}}))()}refreshData(e){o.CoreTag.invalidateTagIndexPerArea(this.tagId,this.tagName,this.collectionId,this.areaId,this.fromContextId,this.contextId,this.recursive).finally((()=>{this.fetchData().finally((()=>{null==e||e.complete()}))}))}openArea(e){if(e.id===this.selectedAreaId)return;i.CoreScreen.isTablet&&(this.selectedAreaId=e.id);const t={tagId:this.tagId,tagName:this.tagName,collectionId:this.collectionId,areaId:e.id,fromContextId:this.fromContextId,contextId:this.contextId,recursive:this.recursive,areaNameKey:e.nameKey,componentName:e.componentName,itemType:e.itemType,items:e.items.slice(),canLoadMore:e.canLoadMore,nextPage:1},a=s.CoreNavigator.isCurrentPathInTablet("**/tag/index/index-area");s.CoreNavigator.navigate((a?"../":"")+"index-area",{params:t})}}return(e=CoreTagIndexPage).ɵfac=function CoreTagIndexPage_Factory(t){return new(t||e)},e.ɵcmp=_.VBU({type:e,selectors:[["page-core-tag-index"]],standalone:!0,features:[_.aNF],decls:17,vars:14,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["icon","fas-tag",3,"message",4,"ngIf"],["class","core-warning-item",4,"ngIf"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],[1,"core-warning-item"],["slot","start","name","fas-triangle-exclamation","color","warning","aria-hidden","true"],[1,"ion-text-wrap"],["button","",1,"ion-text-wrap",3,"click","detail"],[1,"item-heading"],["slot","end",4,"ngIf"],["slot","end"],["aria-hidden","true"],[1,"sr-only"],["icon","fas-tag",3,"message"]],template:function CoreTagIndexPage_Template(e,t){1&e&&(_.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),_.nrm(3,"ion-back-button",1),_.nI1(4,"translate"),_.k0s(),_.j41(5,"ion-title")(6,"h1"),_.EFF(7),_.nI1(8,"translate"),_.k0s()()()(),_.j41(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),_.bIt("ionRefresh",(function CoreTagIndexPage_Template_ion_refresher_ionRefresh_11_listener(e){return t.refreshData(e.target)})),_.nrm(12,"ion-refresher-content",3),_.nI1(13,"translate"),_.k0s(),_.j41(14,"core-loading",4),_.DNE(15,CoreTagIndexPage_ion_list_15_Template,3,2,"ion-list",5)(16,CoreTagIndexPage_core_empty_box_16_Template,2,6,"core-empty-box",6),_.k0s()()()),2&e&&(_.R7$(3),_.Y8G("text",_.bMT(4,8,"core.back")),_.R7$(4),_.Lme("",_.bMT(8,10,"core.tag.tag"),": ",t.tagName,""),_.R7$(4),_.Y8G("disabled",!t.loaded),_.R7$(),_.FS9("pullingText",_.bMT(13,12,"core.pulltorefresh")),_.R7$(2),_.Y8G("hideUntil",t.loaded),_.R7$(),_.Y8G("ngIf",t.hasUnsupportedAreas||t.areas.length),_.R7$(),_.Y8G("ngIf",!(t.hasUnsupportedAreas||t.areas&&t.areas.length)))},dependencies:[p.n,I.Sq,I.bT,u.In,u.QW,u.W9,u.eU,u.iq,u.uz,u.he,u.nf,u.To,u.Ki,u.BC,u.ai,u.el,h.h,f.R,x.M,T.t,C.i,b.D9],encapsulation:2}),CoreTagIndexPage})()}}]);